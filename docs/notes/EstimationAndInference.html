<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chris Slaughter">
<meta name="dcterms.date" content="2026-02-16">

<title>Frequentist Estimation and Bayesian Inference – BIOS 6312 - Spring 2026</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notes/Set6.pdf" rel="next">
<link href="../notes/Lec07.MultivariableModels.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Frequentist Estimation and Bayesian Inference – BIOS 6312 - Spring 2026">
<meta property="og:description" content="Homepage for BIOS 6312 - Modern Biostatistics Methodology II (Modern Regression) at Vanderbilt University, Spring 2026.">
<meta property="og:site_name" content="BIOS 6312 - Spring 2026">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/Lec02.review.html">Course Notes</a></li><li class="breadcrumb-item"><a href="../notes/EstimationAndInference.html">Frequentist Estimation and Bayesian Inference</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">BIOS 6312 - Spring 2026</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/Lec01.Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introductory Slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../officehours.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Office Hours</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec02.review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Review of Key Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec03.SimpleLinearRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec04.Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec05.Precision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Precision of Statistical Intefence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec06.ConfoundingEffectModificationMediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confouding, Effect Modification, and Mediation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec07.MultivariableModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariable Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/EstimationAndInference.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Frequentist Estimation and Bayesian Inference</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set6.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weighted Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec08.Survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec09.Poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec10.Modeling.Effect.Modification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Effect Modification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set8.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial and Ordinal Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec11.DoseResponse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flexible Modeling of Continuous Predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec12.ANOVA.Model.Choice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA and Model Choice</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec13.Prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Based Prediction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/BayesDiagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Model Diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set13.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Missing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set14.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Bootstrap</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/quarto-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab1-linearregression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Linear regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab2-linearassumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2: Assumption in Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab3-logistic-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3: Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab4-precision-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Precision and adjustment for baseline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab-weighted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(Mini) Lab: Weighted Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab5-multivariable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 5: Multivariable Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab6-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 6: Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab7-effectmodification-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 7: Poisson Regression and Effect Modification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab-DiscreteOutcomeRegression.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 8: Discrete Outcomes Lab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://vanderbilt.box.com/s/rpftvmc9vua2w3gz3jy16phlnsojs6on" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Box folder with .qmd files</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Supplemental notes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/slr-derivations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SLR derivations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/model-diagnostics-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/mlr-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MLR matrix notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/log-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Log transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/model-selection-criteria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model selection criteria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/ReviewMatrixAlgebra.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix algebra review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/Baseline_Change_MACH.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Change from baseline and precision</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/log-transform-interpretations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interpreting Regression Coefficients: Log Transformations and Scale</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Statcomp2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Main directory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/lectures/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lectures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/lectures/data" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression"><span class="header-section-number">2</span> Linear Regression</a>
  <ul>
  <li><a href="#frequentist-estimation" id="toc-frequentist-estimation" class="nav-link" data-scroll-target="#frequentist-estimation"><span class="header-section-number">2.1</span> Frequentist Estimation</a>
  <ul class="collapse">
  <li><a href="#maximum-likelihood-estimation" id="toc-maximum-likelihood-estimation" class="nav-link" data-scroll-target="#maximum-likelihood-estimation"><span class="header-section-number">2.1.1</span> Maximum Likelihood Estimation</a>
  <ul class="collapse">
  <li><a href="#standard-error-via-fisher-information" id="toc-standard-error-via-fisher-information" class="nav-link" data-scroll-target="#standard-error-via-fisher-information"><span class="header-section-number">2.1.1.1</span> Standard Error via Fisher Information</a></li>
  <li><a href="#standard-error-via-basic-variance-principles" id="toc-standard-error-via-basic-variance-principles" class="nav-link" data-scroll-target="#standard-error-via-basic-variance-principles"><span class="header-section-number">2.1.1.2</span> Standard Error via Basic Variance Principles</a></li>
  </ul></li>
  <li><a href="#estimating-equations-approach-least-squares" id="toc-estimating-equations-approach-least-squares" class="nav-link" data-scroll-target="#estimating-equations-approach-least-squares"><span class="header-section-number">2.1.2</span> Estimating Equations Approach (Least Squares)</a></li>
  <li><a href="#demonstration-with-real-data" id="toc-demonstration-with-real-data" class="nav-link" data-scroll-target="#demonstration-with-real-data"><span class="header-section-number">2.1.3</span> Demonstration with Real Data</a>
  <ul class="collapse">
  <li><a href="#d-likelihood-surface" id="toc-d-likelihood-surface" class="nav-link" data-scroll-target="#d-likelihood-surface"><span class="header-section-number">2.1.3.1</span> 3D Likelihood Surface</a></li>
  <li><a href="#comparison-with-lm" id="toc-comparison-with-lm" class="nav-link" data-scroll-target="#comparison-with-lm"><span class="header-section-number">2.1.3.2</span> Comparison with lm()</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bayesian-inference" id="toc-bayesian-inference" class="nav-link" data-scroll-target="#bayesian-inference"><span class="header-section-number">2.2</span> Bayesian Inference</a>
  <ul class="collapse">
  <li><a href="#complete-conditional-distributions" id="toc-complete-conditional-distributions" class="nav-link" data-scroll-target="#complete-conditional-distributions"><span class="header-section-number">2.2.1</span> Complete Conditional Distributions</a></li>
  <li><a href="#gibbs-sampling" id="toc-gibbs-sampling" class="nav-link" data-scroll-target="#gibbs-sampling"><span class="header-section-number">2.2.8</span> Gibbs Sampling</a></li>
  <li><a href="#implementation-with-diffuse-priors" id="toc-implementation-with-diffuse-priors" class="nav-link" data-scroll-target="#implementation-with-diffuse-priors"><span class="header-section-number">2.2.9</span> Implementation with Diffuse Priors</a>
  <ul class="collapse">
  <li><a href="#trace-plots" id="toc-trace-plots" class="nav-link" data-scroll-target="#trace-plots"><span class="header-section-number">2.2.9.1</span> Trace Plots</a></li>
  <li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics"><span class="header-section-number">2.2.9.2</span> Summary Statistics</a></li>
  </ul></li>
  <li><a href="#comparison-with-brms" id="toc-comparison-with-brms" class="nav-link" data-scroll-target="#comparison-with-brms"><span class="header-section-number">2.2.10</span> Comparison with brms</a></li>
  <li><a href="#d-posterior-distribution" id="toc-d-posterior-distribution" class="nav-link" data-scroll-target="#d-posterior-distribution"><span class="header-section-number">2.2.11</span> 3D Posterior Distribution</a></li>
  <li><a href="#joint-distribution-under-independent-priors" id="toc-joint-distribution-under-independent-priors" class="nav-link" data-scroll-target="#joint-distribution-under-independent-priors"><span class="header-section-number">2.2.12</span> Joint Distribution Under Independent Priors</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression"><span class="header-section-number">3</span> Logistic Regression</a>
  <ul>
  <li><a href="#frequentist-estimation-1" id="toc-frequentist-estimation-1" class="nav-link" data-scroll-target="#frequentist-estimation-1"><span class="header-section-number">3.1</span> Frequentist Estimation</a>
  <ul class="collapse">
  <li><a href="#maximum-likelihood-estimation-1" id="toc-maximum-likelihood-estimation-1" class="nav-link" data-scroll-target="#maximum-likelihood-estimation-1"><span class="header-section-number">3.1.1</span> Maximum Likelihood Estimation</a></li>
  <li><a href="#demonstration-with-real-data-1" id="toc-demonstration-with-real-data-1" class="nav-link" data-scroll-target="#demonstration-with-real-data-1"><span class="header-section-number">3.1.2</span> Demonstration with Real Data</a>
  <ul class="collapse">
  <li><a href="#comparison-with-glm" id="toc-comparison-with-glm" class="nav-link" data-scroll-target="#comparison-with-glm"><span class="header-section-number">3.1.2.1</span> Comparison with glm()</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#bayesian-inference-1" id="toc-bayesian-inference-1" class="nav-link" data-scroll-target="#bayesian-inference-1"><span class="header-section-number">3.2</span> Bayesian Inference</a>
  <ul class="collapse">
  <li><a href="#metropolis-hastings-algorithm" id="toc-metropolis-hastings-algorithm" class="nav-link" data-scroll-target="#metropolis-hastings-algorithm"><span class="header-section-number">3.2.1</span> Metropolis-Hastings Algorithm</a></li>
  <li><a href="#gibbs-sampling-with-data-augmentation" id="toc-gibbs-sampling-with-data-augmentation" class="nav-link" data-scroll-target="#gibbs-sampling-with-data-augmentation"><span class="header-section-number">3.2.2</span> Gibbs Sampling with Data Augmentation</a>
  <ul class="collapse">
  <li><a href="#trace-plot-and-summary" id="toc-trace-plot-and-summary" class="nav-link" data-scroll-target="#trace-plot-and-summary"><span class="header-section-number">3.2.2.1</span> Trace Plot and Summary</a></li>
  </ul></li>
  <li><a href="#comparison-with-brms-1" id="toc-comparison-with-brms-1" class="nav-link" data-scroll-target="#comparison-with-brms-1"><span class="header-section-number">3.2.3</span> Comparison with brms</a></li>
  <li><a href="#probit-regression-via-auxiliary-variables" id="toc-probit-regression-via-auxiliary-variables" class="nav-link" data-scroll-target="#probit-regression-via-auxiliary-variables"><span class="header-section-number">3.2.4</span> Probit Regression via Auxiliary Variables</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">4</span> Summary</a>
  <ul>
  <li><a href="#why-frequentist-estimation-vs-bayesian-inference" id="toc-why-frequentist-estimation-vs-bayesian-inference" class="nav-link" data-scroll-target="#why-frequentist-estimation-vs-bayesian-inference"><span class="header-section-number">4.1</span> Why “Frequentist Estimation” vs “Bayesian Inference”?</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">5</span> References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chrissl789/modern-regression/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header">


<div class="quarto-title-block d-none d-lg-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/Lec02.review.html">Course Notes</a></li><li class="breadcrumb-item"><a href="../notes/EstimationAndInference.html">Frequentist Estimation and Bayesian Inference</a></li></ol></nav><div><h1 class="title">Frequentist Estimation and Bayesian Inference</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="author">Chris Slaughter</p>

<p class="date">February 16, 2026</p>

</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(truncnorm)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>These notes provide a comparison of <strong>Frequentist Estimation</strong> and <strong>Bayesian Inference</strong> approaches to regression modeling. This material is presented as one of the final lectures before the exam and builds upon foundational concepts covered in earlier course materials.</p>
<p><strong>Prerequisites:</strong> Before working through these notes, we will first review <a href="Set2.pdf">Model Estimation (Set2.pdf)</a>, which covers key concepts in simple linear regression and details on estimation from a frequentist standpoint. That material provides a review of many applied concepts already discussed (and thus serves as a review for the midterm exam) and is the foundation for understanding the comparisons presented here.</p>
<p><strong>Scope and Purpose:</strong> These following notes present mathematical derivations and theoretical foundations to provide clarity and deeper understanding of both approaches. The derivations demonstrate in linear and logistic regression</p>
<ul>
<li><p>How maximum likelihood estimation works</p></li>
<li><p>How Bayesian posterior distributions are derived</p></li>
<li><p>The relationship between different estimation methods</p></li>
<li><p>The underlying theory behind the functions you use in practice</p></li>
</ul>
<p><strong>Important Note on Exam Coverage:</strong></p>
<p>The exam focuses on <strong>applied data analysis</strong>. While the mathematical derivations in these notes are provided for clarity and understanding, in this course you are <strong>NOT</strong> be asked to:</p>
<ul>
<li><p>Derive posterior distributions</p></li>
<li><p>Maximize likelihood functions by hand</p></li>
<li><p>Perform calculus-based derivations</p></li>
</ul>
<p>These derivation skills are the purview of other courses. For this course, you should focus on:</p>
<ul>
<li><p>Understanding the conceptual differences between approaches</p></li>
<li><p>Knowing when to use each method</p></li>
<li><p>Applying the methods using R (lm(), glm(), brms(), etc.)</p></li>
<li><p>Interpreting and communicating results</p></li>
</ul>
</section>
<section id="linear-regression" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Linear Regression</h1>
<p>We consider a simplified linear regression model with only a slope parameter (no intercept) with <span class="math inline">\(X_i\)</span> fixed. This model takes the form:</p>
<p><span class="math display">\[Y_i = \beta X_i + \varepsilon_i\]</span></p>
<p>where <span class="math inline">\(\varepsilon_i \sim N(0, \sigma^2)\)</span> for the likelihood-based approach.</p>
<p><strong>Important Note:</strong> This model forces the regression line through the origin <span class="math inline">\((0,0)\)</span>. While mathematically simpler (reducing the parameter space), this constraint is often not scientifically useful. Even if we expect <span class="math inline">\(Y=0\)</span> when <span class="math inline">\(X=0\)</span>, this point may lie outside the range of our data and assumes linearity, making the constraint arbitrary and potentially misleading.</p>
<section id="frequentist-estimation" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="frequentist-estimation"><span class="header-section-number">2.1</span> Frequentist Estimation</h2>
<section id="maximum-likelihood-estimation" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="maximum-likelihood-estimation"><span class="header-section-number">2.1.1</span> Maximum Likelihood Estimation</h3>
<p>The maximum likelihood approach assumes conditional normality of the residuals. Given <span class="math inline">\(Y_i \sim N(\beta X_i, \sigma^2)\)</span>, the likelihood function is:</p>
<p><span class="math display">\[L(\beta, \sigma^2 | \mathbf{y}, \mathbf{x}) = \prod_{i=1}^n \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(y_i - \beta x_i)^2}{2\sigma^2}\right)\]</span></p>
<p>The log-likelihood is:</p>
<p><span class="math display">\[\ell(\beta, \sigma^2) = -\frac{n}{2}\log(2\pi) - \frac{n}{2}\log(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^n(y_i - \beta x_i)^2\]</span></p>
<p><strong>Deriving the MLE for</strong> <span class="math inline">\(\beta\)</span>:</p>
<p>Taking the derivative with respect to <span class="math inline">\(\beta\)</span> and setting equal to zero:</p>
<p><span class="math display">\[\frac{\partial \ell}{\partial \beta} = \frac{1}{\sigma^2}\sum_{i=1}^n x_i(y_i - \beta x_i) = 0\]</span></p>
<p><span class="math display">\[\sum_{i=1}^n x_i y_i - \beta \sum_{i=1}^n x_i^2 = 0\]</span></p>
<p><span class="math display">\[\hat{\beta}_{MLE} = \frac{\sum_{i=1}^n x_i y_i}{\sum_{i=1}^n x_i^2}\]</span></p>
<p><strong>Deriving the MLE for</strong> <span class="math inline">\(\sigma^2\)</span>:</p>
<p>Taking the derivative with respect to <span class="math inline">\(\sigma^2\)</span>:</p>
<p><span class="math display">\[\frac{\partial \ell}{\partial \sigma^2} = -\frac{n}{2\sigma^2} + \frac{1}{2\sigma^4}\sum_{i=1}^n(y_i - \beta x_i)^2 = 0\]</span></p>
<p><span class="math display">\[\hat{\sigma}^2_{MLE} = \frac{1}{n}\sum_{i=1}^n(y_i - \hat{\beta} x_i)^2\]</span></p>
<section id="standard-error-via-fisher-information" class="level4" data-number="2.1.1.1">
<h4 data-number="2.1.1.1" class="anchored" data-anchor-id="standard-error-via-fisher-information"><span class="header-section-number">2.1.1.1</span> Standard Error via Fisher Information</h4>
<p>The Fisher Information matrix provides the asymptotic variance of the MLE. For our model:</p>
<p><span class="math display">\[I(\beta, \sigma^2) = -E\left[\frac{\partial^2 \ell}{\partial \theta \partial \theta^T}\right]\]</span></p>
<p>The second derivatives are:</p>
<p><span class="math display">\[\frac{\partial^2 \ell}{\partial \beta^2} = -\frac{1}{\sigma^2}\sum_{i=1}^n x_i^2\]</span></p>
<p><span class="math display">\[\frac{\partial^2 \ell}{\partial (\sigma^2)^2} = \frac{n}{2\sigma^4} - \frac{1}{\sigma^6}\sum_{i=1}^n(y_i - \beta x_i)^2\]</span></p>
<p><span class="math display">\[\frac{\partial^2 \ell}{\partial \beta \partial \sigma^2} = -\frac{1}{\sigma^4}\sum_{i=1}^n x_i(y_i - \beta x_i)\]</span></p>
<p>Taking expectations (where <span class="math inline">\(E[(y_i - \beta x_i)^2] = \sigma^2\)</span> and <span class="math inline">\(E[y_i - \beta x_i] = 0\)</span>):</p>
<p><span class="math display">\[I(\beta) = \frac{1}{\sigma^2}\sum_{i=1}^n x_i^2\]</span></p>
<p>Therefore, the asymptotic variance is:</p>
<p><span class="math display">\[\text{Var}(\hat{\beta}) = \frac{\sigma^2}{\sum_{i=1}^n x_i^2}\]</span></p>
<p><span class="math display">\[SE(\hat{\beta}) = \frac{\sigma}{\sqrt{\sum_{i=1}^n x_i^2}}\]</span></p>
<p>In practice, we substitute <span class="math inline">\(\hat{\sigma}\)</span> for <span class="math inline">\(\sigma\)</span>.</p>
<p><strong>Important Note on Bias:</strong> The MLE estimate of <span class="math inline">\(\sigma^2\)</span> is:</p>
<p><span class="math display">\[\hat{\sigma}^2_{MLE} = \frac{1}{n}\sum_{i=1}^n(y_i - \hat{\beta} x_i)^2\]</span></p>
<p>This estimator is biased because it uses <span class="math inline">\(n\)</span> in the denominator rather than the degrees of freedom <span class="math inline">\((n-1)\)</span>. The MLE is asymptotically unbiased but has finite-sample bias. To obtain an unbiased estimator of <span class="math inline">\(\sigma^2\)</span>, we use:</p>
<p><span class="math display">\[\hat{\sigma}^2_{unbiased} = \frac{1}{n-1}\sum_{i=1}^n(y_i - \hat{\beta} x_i)^2\]</span></p>
<p>The correction factor is <span class="math inline">\(\frac{n}{n-1}\)</span>, so:</p>
<p><span class="math display">\[\hat{\sigma}_{unbiased} = \sqrt{\frac{n}{n-1}} \cdot \hat{\sigma}_{MLE}\]</span></p>
<p>When calculating the standard error of <span class="math inline">\(\hat{\beta}\)</span>, using the unbiased estimator ensures:</p>
<p><span class="math display">\[SE(\hat{\beta}) = \frac{\hat{\sigma}_{unbiased}}{\sqrt{\sum_{i=1}^n x_i^2}} = \frac{\sqrt{\frac{1}{n-1}\sum_{i=1}^n(y_i - \hat{\beta} x_i)^2}}{\sqrt{\sum_{i=1}^n x_i^2}}\]</span></p>
<p>This matches the standard error reported by <code>lm()</code> exactly.</p>
</section>
<section id="standard-error-via-basic-variance-principles" class="level4" data-number="2.1.1.2">
<h4 data-number="2.1.1.2" class="anchored" data-anchor-id="standard-error-via-basic-variance-principles"><span class="header-section-number">2.1.1.2</span> Standard Error via Basic Variance Principles</h4>
<p>We can also derive the standard error directly from the formula for <span class="math inline">\(\hat{\beta}\)</span>:</p>
<p><span class="math display">\[\hat{\beta} = \frac{\sum_{i=1}^n x_i Y_i}{\sum_{i=1}^n x_i^2}\]</span></p>
<p>Since <span class="math inline">\(Y_i = \beta x_i + \varepsilon_i\)</span> where <span class="math inline">\(\varepsilon_i \sim N(0, \sigma^2)\)</span> independently:</p>
<p><span class="math display">\[\text{Var}(\hat{\beta}) = \text{Var}\left(\frac{\sum_{i=1}^n x_i Y_i}{\sum_{i=1}^n x_i^2}\right) = \frac{1}{(\sum_{i=1}^n x_i^2)^2} \text{Var}\left(\sum_{i=1}^n x_i Y_i\right)\]</span></p>
<p>Since the <span class="math inline">\(Y_i\)</span> are independent:</p>
<p><span class="math display">\[\text{Var}\left(\sum_{i=1}^n x_i Y_i\right) = \sum_{i=1}^n x_i^2 \text{Var}(Y_i) = \sum_{i=1}^n x_i^2 \sigma^2 = \sigma^2 \sum_{i=1}^n x_i^2\]</span></p>
<p>Therefore:</p>
<p><span class="math display">\[\text{Var}(\hat{\beta}) = \frac{\sigma^2 \sum_{i=1}^n x_i^2}{(\sum_{i=1}^n x_i^2)^2} = \frac{\sigma^2}{\sum_{i=1}^n x_i^2}\]</span></p>
<p>This confirms our Fisher Information result.</p>
</section>
</section>
<section id="estimating-equations-approach-least-squares" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="estimating-equations-approach-least-squares"><span class="header-section-number">2.1.2</span> Estimating Equations Approach (Least Squares)</h3>
<p>The least squares approach minimizes the residual sum of squares without assuming normality. We minimize:</p>
<p><span class="math display">\[RSS(\beta) = \sum_{i=1}^n (y_i - \beta x_i)^2\]</span></p>
<p>Taking the derivative and setting to zero:</p>
<p><span class="math display">\[\frac{\partial RSS}{\partial \beta} = -2\sum_{i=1}^n x_i(y_i - \beta x_i) = 0\]</span></p>
<p><span class="math display">\[\hat{\beta}_{LS} = \frac{\sum_{i=1}^n x_i y_i}{\sum_{i=1}^n x_i^2}\]</span></p>
<p>Note that <span class="math inline">\(\hat{\beta}_{LS} = \hat{\beta}_{MLE}\)</span> even though the least squares approach does not require the normality assumption. The normality assumption is only needed for inference (standard errors, confidence intervals, hypothesis tests) in small samples, though large-sample inference can rely on asymptotic normality via the Central Limit Theorem.</p>
</section>
<section id="demonstration-with-real-data" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="demonstration-with-real-data"><span class="header-section-number">2.1.3</span> Demonstration with Real Data</h3>
<p>We’ll use the <code>cars</code> dataset in R, which contains speed and stopping distance for cars.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load and prepare data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(cars)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># We'll model distance as a function of speed with no intercept</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> cars<span class="sc">$</span>dist</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> cars<span class="sc">$</span>speed</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate estimates</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>beta_hat <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">*</span> y) <span class="sc">/</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> beta_hat <span class="sc">*</span> x</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>RSS <span class="ot">&lt;-</span> <span class="fu">sum</span>(residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co"># MLE estimate of sigma (biased)</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>sigma_hat_mle <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(RSS <span class="sc">/</span> n)</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Unbiased estimate of sigma</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>sigma_hat_unbiased <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(RSS <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Correction factor</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>correction_factor <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(n <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">"β̂"</span>, <span class="st">"σ̂ (MLE)"</span>, <span class="st">"σ̂ (unbiased)"</span>, <span class="st">"Correction factor"</span>, <span class="st">"SE(β̂) using MLE σ"</span>, <span class="st">"SE(β̂) using unbiased σ"</span>),</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(beta_hat, <span class="dv">4</span>),</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(sigma_hat_mle, <span class="dv">4</span>),</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(sigma_hat_unbiased, <span class="dv">4</span>),</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(correction_factor, <span class="dv">4</span>),</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(sigma_hat_mle <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)), <span class="dv">4</span>),</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(sigma_hat_unbiased <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)), <span class="dv">4</span>)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_df, <span class="at">caption =</span> <span class="st">"Manual Calculation Results"</span>, <span class="at">align =</span> <span class="st">'ll'</span>, <span class="at">format=</span><span class="st">'html'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Manual Calculation Results</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">β̂</td>
<td style="text-align: left;">2.9091</td>
</tr>
<tr class="even">
<td style="text-align: left;">σ̂ (MLE)</td>
<td style="text-align: left;">16.0958</td>
</tr>
<tr class="odd">
<td style="text-align: left;">σ̂ (unbiased)</td>
<td style="text-align: left;">16.2592</td>
</tr>
<tr class="even">
<td style="text-align: left;">Correction factor</td>
<td style="text-align: left;">1.0102</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SE(β̂) using MLE σ</td>
<td style="text-align: left;">0.1399</td>
</tr>
<tr class="even">
<td style="text-align: left;">SE(β̂) using unbiased σ</td>
<td style="text-align: left;">0.1414</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="d-likelihood-surface" class="level4" data-number="2.1.3.1">
<h4 data-number="2.1.3.1" class="anchored" data-anchor-id="d-likelihood-surface"><span class="header-section-number">2.1.3.1</span> 3D Likelihood Surface</h4>
<p>Now we’ll create a 3D plot showing the likelihood function as a function of <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\sigma\)</span>:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure beta_hat and sigma_hat_mle are on the grid</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>beta_grid  <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">seq</span>(beta_hat <span class="sc">-</span> <span class="fl">0.5</span>, beta_hat <span class="sc">+</span> <span class="fl">0.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>), beta_hat)))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>sigma_grid <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(<span class="fu">seq</span>(<span class="fu">max</span>(<span class="dv">1</span>, sigma_hat_unbiased <span class="sc">-</span> <span class="dv">5</span>), sigma_hat_unbiased <span class="sc">+</span> <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">50</span>), sigma_hat_mle)))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute log-likelihood</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>log_lik <span class="ot">&lt;-</span> <span class="fu">outer</span>(beta_grid, sigma_grid, <span class="fu">Vectorize</span>(<span class="cf">function</span>(beta, sigma) {</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> y <span class="sc">-</span> beta <span class="sc">*</span> x</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span>n<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">-</span> n <span class="sc">*</span> <span class="fu">log</span>(sigma) <span class="sc">-</span> <span class="fu">sum</span>(res<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>}))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Relative likelihood (max = 1 at MLE on the grid)</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>likelihood <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_lik <span class="sc">-</span> <span class="fu">max</span>(log_lik))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Relative likelihood values at the two sigma points with beta fixed at beta_hat</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>rel_at <span class="ot">&lt;-</span> <span class="cf">function</span>(beta0, sigma0) {</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> y <span class="sc">-</span> beta0 <span class="sc">*</span> x</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  ll <span class="ot">&lt;-</span> <span class="sc">-</span>n<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>pi) <span class="sc">-</span> n <span class="sc">*</span> <span class="fu">log</span>(sigma0) <span class="sc">-</span> <span class="fu">sum</span>(res<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sigma0<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(ll <span class="sc">-</span> <span class="fu">max</span>(log_lik))</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>z_mle      <span class="ot">&lt;-</span> <span class="fu">rel_at</span>(beta_hat, sigma_hat_mle)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>z_unbiased <span class="ot">&lt;-</span> <span class="fu">rel_at</span>(beta_hat, sigma_hat_unbiased)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> <span class="sc">~</span>sigma_grid, <span class="at">y =</span> <span class="sc">~</span>beta_grid, <span class="at">z =</span> <span class="sc">~</span>likelihood) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_surface</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">x =</span> sigma_hat_mle, <span class="at">y =</span> beta_hat, <span class="at">z =</span> z_mle,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>              <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">'red'</span>),</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>              <span class="at">name =</span> <span class="st">'MLE (σ)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">x =</span> sigma_hat_unbiased, <span class="at">y =</span> beta_hat, <span class="at">z =</span> z_unbiased,</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">'blue'</span>),</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>              <span class="at">name =</span> <span class="st">'Unbiased (σ)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'σ'</span>),</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'β'</span>),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Relative Likelihood'</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-062c64447f3fdbf6b5a6" style="width:100%;height:520px;"></div>
<script type="application/json" data-for="htmlwidget-062c64447f3fdbf6b5a6">{"x":{"visdat":{"2bda6d13acac7b":["function () ","plotlyVisDat"]},"cur_data":"2bda6d13acac7b","attrs":{"2bda6d13acac7b":{"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true},"2bda6d13acac7b.1":{"x":16.095823580676075,"y":2.9091321439371032,"z":1,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","marker":{"size":5,"color":"red"},"name":"MLE (σ)","inherit":true},"2bda6d13acac7b.2":{"x":16.259237146683411,"y":2.9091321439371032,"z":0.99494513610375346,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","marker":{"size":5,"color":"blue"},"name":"Unbiased (σ)","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"σ"},"yaxis":{"title":"β"},"zaxis":{"title":"Relative Likelihood"}},"hovermode":"closest","showlegend":true,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"likelihood","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[11.259237146683411,11.463318779336472,11.667400411989533,11.871482044642594,12.075563677295655,12.279645309948718,12.483726942601779,12.68780857525484,12.891890207907901,13.095971840560962,13.300053473214023,13.504135105867086,13.708216738520147,13.912298371173208,14.116380003826269,14.32046163647933,14.524543269132391,14.728624901785452,14.932706534438513,15.136788167091574,15.340869799744635,15.544951432397696,15.749033065050758,15.953114697703819,16.095823580676075,16.157196330356882,16.36127796300994,16.565359595663004,16.769441228316065,16.973522860969126,17.177604493622187,17.381686126275248,17.585767758928309,17.78984939158137,17.993931024234431,18.198012656887492,18.402094289540553,18.606175922193614,18.810257554846675,19.014339187499736,19.218420820152801,19.422502452805858,19.626584085458923,19.83066571811198,20.034747350765045,20.238828983418106,20.442910616071167,20.646992248724228,20.851073881377289,21.05515551403035,21.259237146683411],"y":[2.4091321439371032,2.4295403072024091,2.4499484704677155,2.4703566337330214,2.4907647969983278,2.5111729602636337,2.53158112352894,2.551989286794246,2.5723974500595523,2.5928056133248583,2.6132137765901642,2.6336219398554706,2.6540301031207765,2.6744382663860828,2.6948464296513888,2.7152545929166951,2.7356627561820011,2.7560709194473074,2.7764790827126133,2.7968872459779197,2.8172954092432256,2.8377035725085316,2.8581117357738379,2.8785198990391438,2.8989280623044502,2.9091321439371032,2.9193362255697561,2.9397443888350621,2.9601525521003684,2.9805607153656748,3.0009688786309807,3.0213770418962866,3.041785205161593,3.0621933684268989,3.0826015316922053,3.1030096949575112,3.1234178582228171,3.1438260214881235,3.1642341847534299,3.1846423480187358,3.2050505112840417,3.2254586745493481,3.245866837814654,3.2662750010799604,3.2866831643452663,3.3070913276105722,3.3274994908758786,3.347907654141185,3.3683158174064909,3.3887239806717968,3.4091321439371032],"z":[[5.810436604908478e-10,2.2754028325429503e-09,8.0475787573396439e-09,2.5898587161672719e-08,7.6358519530151878e-08,2.0755083010811054e-07,5.2307632902397592e-07,1.2287470919233909e-06,2.7034277551586465e-06,5.5956697052553391e-06,1.0940884378936733e-05,2.0284093065560372e-05,3.5782900594417432e-05,6.0257575524703946e-05,9.7153573513815739e-05,0.00015038907410190128,0.00022407644780404295,0.00032212959776488175,0.00044779403614385993,0.00060315746766294092,0.00078871024979567847,0.0010030241685344387,0.0012426042595603175,0.0015019446043807983,0.0016912142804288589,0.0017737899434865122,0.0020495761994146987,0.002319999690909407,0.0025756504795994397,0.0028076413741978906,0.0030081700224456201,0.0031709650535726168,0.0032915853015710356,0.003367560476160126,0.0033983794104170853,0.0033853461593469536,0.0033313336559297134,0.0032404691461895684,0.0031177857228252091,0.0029688709123123279,0.0027995376000436124,0.0026155357501783903,0.002422316382007606,0.0022248528528980224,0.0020275191539543169,0.001834020885802403,0.0016473718830257154,0.0014699079850212357,0.0013033290066650385,0.0011487603016568184,0.0010068261894505947],[1.6488813751920095e-09,6.2237719157077265e-09,2.1257236525897507e-08,6.6181807369415769e-08,1.8908796395064181e-07,4.9882693780571254e-07,1.2219148454564763e-06,2.793701133310171e-06,5.9900129387552548e-06,1.2097074013040059e-05,2.3103833073634604e-05,4.188411438695784e-05,7.2320778163683662e-05,0.0001193162344549959,0.0001886384388486333,0.00028657132643342554,0.0004193716078733745,0.00059257367418022705,0.00081022188746503719,0.0010741353554859657,0.0013833174600432355,0.001733608440594918,0.0021176467602036773,0.0025251604929524057,0.0028174122025230236,0.002943562503714396,0.0033587816347329415,0.0037562333439504505,0.0041218209112989087,0.0044428626021339778,0.004708858260768862,0.0049120360153043843,0.0050476507456762359,0.0051140357446980015,0.0051124337929306773,0.005046651400515678,0.004922589495410302,0.0047477058779754645,0.0045304607079593136,0.0042797879782847451,0.0040046252686643941,0.0037135227634150247,0.0034143418935009065,0.0031140449198351701,0.0028185697907573311,0.0025327798055697808,0.0022604748597376489,0.0020044500300142321,0.0017665875909126279,0.0015479698337251858,0.0013490019133616756],[4.4801841398264e-09,1.6324538111977508e-08,5.3922701517343524e-08,1.6263857758063058e-07,4.5088072739016277e-07,1.155866284600906e-06,2.7552667664937444e-06,6.138102808426009e-06,1.2839389621538075e-05,2.5325464888711998e-05,4.7292179642786324e-05,8.3911697525165682e-05,0.00014194425653040678,0.00022962830956444426,0.00035628247897693719,0.00053159615397540823,0.00076464535441085342,0.0010627336241493125,0.0014302086518568169,0.0018674305890246155,0.0023700602334863004,0.0029287950187515486,0.0035296163561790951,0.0041545366610475721,0.0045948004573681178,0.0047827631494348271,0.0053921409116708761,0.0059607079028032792,0.0064681917142569208,0.0068972994195388672,0.0072346907588117888,0.0074715729666528273,0.0076039042640594044,0.0076322355717871699,0.0075612518449961396,0.0073990935986734396,0.0071565459387126365,0.0068461786159744456,0.0064815090941772015,0.006076244464729659,0.0056436401290077126,0.0051959958328269915,0.0047442945182193785,0.0042979774948780566,0.0038648409606724752,0.0034510337846603281,0.0030611342650297573,0.0026982836818288947,0.0023643562264534452,0.0020601476902460739,0.0017855686061333806],[1.1655425224859258e-08,4.1060099282362126e-08,1.3135897390332336e-07,3.8435355756315241e-07,1.0352633968446763e-06,2.5822457284225808e-06,5.9969883488536923e-06,1.3032422344882405e-05,2.662346766345922e-05,5.1343247774130294e-05,9.3835744930287023e-05,0.00016310794055182339,0.00027054514441265546,0.00042952586723953799,0.00065456321461426986,0.00095998307119129632,0.0013582487063159264,0.0018581331631891997,0.0024630010367850431,0.0031694731650835604,0.0039667064230472287,0.0048364342833356585,0.0057538004173909437,0.0066889006288049901,0.0073357991188865591,0.0076088500486412875,0.0084801289960178949,0.0092709397164908707,0.0099533259066827539,0.010504858927278959,0.01090976614575693,0.011159454217765661,0.011252451294981616,0.0111938485255965,0.010994358236023264,0.010669123107802417,0.01023640972846695,0.0097163052077976798,0.0091295119955202494,0.0084963083705357351,0.0078357143094811496,0.0071648775327268124,0.0064986742811259683,0.0058495045811434747,0.0052272523781997727,0.004639376363071426,0.0040910966669985942,0.0035856448215188649,0.0031245484637514244,0.002707927339173436,0.0023347825112392368],[2.9032617152741696e-08,9.903551117716966e-08,3.0730605714535033e-07,8.7349542938767663e-07,2.2889243903465644e-06,5.5618569331106314e-06,1.2599392194181331e-05,2.6739476881289204e-05,5.3405807891260578e-05,0.00010079942853168904,0.0001804766264893628,0.00030761473092352673,0.00050075909837088179,0.00078089244804699137,0.0011697729712583994,0.0016876328362623375,0.0023504810917396091,0.0031673757860686495,0.0041380863824156131,0.0052515420082115336,0.0064853569813799151,0.0078065645336974562,0.0091735068274074634,0.010538660914761281,0.011465492514167121,0.011852056546655347,0.013064880648709979,0.014132868371299732,0.015019142606846879,0.015696264822649617,0.016147378509647699,0.016366442182360313,0.016357645889943009,0.016134174019191597,0.015716514502964164,0.015130522377382117,0.014405429554965441,0.013571960112941888,0.012660669000564484,0.011700578614125988,0.010718147378819546,0.0097365707216110989,0.0087753893249920278,0.0078503626202244877,0.0069735563997302364,0.0061535908739947555,0.005395997868440576,0.0047036415409065068,0.0040771645593382817,0.0035154299361148931,0.0030159367940152592],[6.9242072490187048e-08,2.2906237502509708e-07,6.9040791497711434e-07,1.9090300391754714e-06,4.8730788119155489e-06,1.1549796520593978e-05,2.5551289537342764e-05,5.3017279745036181e-05,0.00010363727439449123,0.00019163799796208624,0.00033647074190647257,0.00056288358141949721,0.00090008834714442644,0.0013798476143532623,0.0020335011737790164,0.0028881849935880389,0.0039627113593181619,0.0052637189789085147,0.0067827260084900899,0.0084946162219100632,0.01035787974680886,0.012316660391319945,0.014304388230035284,0.0162485517134952,0.017542945340549058,0.018076025401872267,0.019718333027070621,0.021116284821416597,0.022223560138569257,0.023008979555580719,0.02345739196997022,0.023569263917159054,0.023359181542092163,0.02285355147998562,0.022087815457765655,0.021103481535048201,0.01994523326253279,0.018658318590223755,0.017286354230985859,0.01586961735964499,0.014443841253454848,0.013039488258799454,0.011681443436295182,0.010389054740538455,0.009176438824183189,0.0080529731281209788,0.0070239023122379467,0.0060909979678333186,0.0052532229861719697,0.0045073644502762848,0.0038486104417491912],[1.5811742601194014e-07,5.0805231029723907e-07,1.4895794444763655e-06,4.0122434920317071e-06,9.9900307299723769e-06,2.3123902354116109e-05,5.0017604735115729e-05,0.00010158246524722424,0.00019455710780409433,0.00035282065556925578,0.00060806125288718051,0.00099933123189477552,0.0015711173156162863,0.0023697854904187964,0.0034385878971246657,0.0048117681753260611,0.0065085812968631099,0.0085281757642160488,0.010846228744796302,0.013413985592481761,0.016159986508934101,0.018994345292655621,0.021815064115836953,0.024515594057926353,0.026277062593647229,0.02699272372698933,0.029153903387674474,0.030923265449909872,0.03224584037741593,0.033089739409654643,0.033446335295710693,0.033328684436640908,0.032768578378604481,0.031812684213758199,0.030518238750868031,0.028948714681439211,0.027169796229613789,0.025245904651081261,0.023237415532470412,0.021198621276621431,0.019176420294153201,0.0172096622179333,0.015329045794205916,0.013557450749263088,0.011910583466210371,0.010397824903254443,0.0090231841654422069,0.0077862793349179876,0.0066832860793913972,0.0057078124186036756,0.0048516737161479447],[3.4571260918859054e-07,1.0805751136504518e-06,3.086347675891967e-06,8.1093154392806443e-06,1.9720667631105579e-05,4.463547846812384e-05,9.4510442326169414e-05,0.00018808615527791194,0.00035333108401000758,0.0006290355672880604,0.0010651751774358319,0.0017213919490262964,0.002663172370199151,0.0039557145968150218,0.005655990753753737,0.0078039958846088482,0.010414500472438732,0.013470692886030604,0.016920882464817582,0.020678977585913319,0.024628857967538189,0.028632155230773847,0.032538460697632964,0.036196678858122951,0.038531474723723903,0.039466172972106479,0.042226490268209411,0.044384754894362138,0.045880204223407058,0.046685743942930957,0.046806747989314994,0.046277590235991178,0.045156548342939057,0.04351976896329577,0.041454944785671334,0.039055252840840091,0.036413967259048226,0.033620012797227143,0.030754587211611412,0.027888863770383087,0.025082696521280212,0.022384191816049559,0.019829977755640479,0.017445994066307587,0.015248632831881609,0.013246079828470656,0.0114397318747526,0.0098255935222176863,0.0083955835413110896,0.0071387060197674289,0.0060420613741723741],[7.2372989164638192e-07,2.2039074413809895e-06,6.1411441626826995e-06,1.576171609707857e-05,3.7485888036647884e-05,8.3067575772371847e-05,0.00017237867568015139,0.00033653611975679196,0.00062075498424016544,0.0010860385073702436,0.0018087078660001515,0.0028769313694936814,0.0043838645116319715,0.006417691970901143,0.009049615121531792,0.012321455587027831,0.016234868313256143,0.02074407491523976,0.025753545213252189,0.031121279463400892,0.036667449762383834,0.042187335874412028,0.047466894479608356,0.052299021885089836,0.055311948396921773,0.056498622436848743,0.059914925510294592,0.062440007057815196,0.064013055901077989,0.064620478334485587,0.064292381473398885,0.063096274080369094,0.061128963888034973,0.05850762910173736,0.055360931563504988,0.051820859543412215,0.048015777782050906,0.044064953352039138,0.040074641209487324,0.036135666540053193,0.032322337329155543,0.028692458683439188,0.025288194699463105,0.022137526271528211,0.019256075713149679,0.016649103561467701,0.014313522825909622,0.012239816178166258,0.010413778681688579,0.0088180405517149004,0.0074333501850846412],[1.4506532229017376e-06,4.3104598156635022e-06,1.1734835483540825e-05,2.9460845118620754e-05,6.8612839758564633e-05,0.00014904422462813888,0.00030348282813524364,0.00058189323790446717,0.001055023686531226,0.0018157835125208052,0.0029770731122694969,0.0046650753561083384,0.0070078073726737751,0.010119773490833942,0.014084595705499975,0.018938241405097228,0.02465569860986409,0.031143581464674507,0.038240256738998404,0.04572386970664398,0.05332738504010711,0.060758705254158378,0.0677232730091121,0.073946384941477136,0.07772966448644654,0.07919271664659995,0.083281171206894489,0.086093963366947635,0.087579679941621663,0.087750783147343206,0.086676561094728877,0.084472841921345507,0.081289881484478785,0.077299746544827727,0.072684299865025184,0.067624608130656572,0.062292289544069623,0.056843035066040243,0.051412301483181919,0.046112998492988118,0.041034877771350571,0.036245273806892526,0.031790833921273555,0.027699896282464123,0.023985217977039577,0.02064680993419734,0.017674693429109534,0.015051448097970876,0.012754470098428785,0.010757899291878842,0.0090342055468960562],[2.7840466656049134e-06,8.0843612099666961e-06,2.1534162511157039e-05,5.2955283199165762e-05,0.00012093009264256346,0.00025782857115647491,0.00051574086444284163,0.00097228080292326179,0.0017346339030486157,0.0029398944254800346,0.004749897701832281,0.0073395131424457711,0.010878634195862663,0.015509604383780396,0.02132315770795834,0.028336742807548981,0.036479096307697557,0.045584099651884223,0.05539548136601425,0.065582152637168864,0.075762277533492128,0.085532914371113308,0.094501426473844047,0.10231489587354503,0.1069348191904456,0.10868438755990982,0.11340191463035158,0.1163491189699874,0.11749779661179219,0.11690330293737553,0.11469248082490539,0.11104804304099022,0.10619134097048732,0.10036523183368162,0.093818396747975347,0.086792041003507681,0.079509491086630649,0.072168836854257137,0.06493847876625837,0.057955238908258683,0.051324577238025477,0.045122409085718705,0.039398030138937223,0.034177703702868524,0.02946853607374848,0.025262346254243815,0.021539316092602942,0.018271279593116651,0.015424571803279,0.012962406765899156,0.010846790599891385],[5.1158195865349088e-06,1.4539841687297739e-05,3.7949165914373283e-05,9.1536811942856332e-05,0.00020523658392497318,0.00043001064387619735,0.00084601059843785007,0.0015699176961644931,0.002759034148811618,0.0046094406065507795,0.0073460299607635143,0.011203539997330259,0.016399619687451884,0.023103014623858782,0.03140158072303021,0.041275548824769442,0.052581024727710417,0.06504719196817528,0.078288441157257679,0.091830195904580497,0.10514506806316727,0.11769455706825241,0.12897100800832417,0.13853494118468959,0.1440177415114004,0.146043967313185,0.15127101204198992,0.15411117689548556,0.15457799389574844,0.15279090746380611,0.14895645780471004,0.14334585082797702,0.13627145052616985,0.12806432540789853,0.11905443445170054,0.1095544522778656,0.099847686927048832,0.090180088392154661,0.080756007219184731,0.07173714390921726,0.063244020135347814,0.055359281651639169,0.048132186417043497,0.041583716572509345,0.035711859218966094,0.030496712489391838,0.025905178849404856,0.021895099822105225,0.018418761882567528,0.015425761256900131,0.012865256779957967],[9.0007715006109333e-06,2.5076418291108231e-05,6.4224355044303934e-05,0.00015216145911075692,0.00033540271192108783,0.00069144818891929904,0.0013395745937708253,0.0024496206367337499,0.0042453152584285342,0.0069986380608076113,0.011012725572963501,0.016592915931282658,0.024008242300029792,0.033448341665702715,0.044982579880994189,0.058528640007470968,0.073836692833564033,0.090492809103217206,0.10794206315329793,0.12552854878459513,0.1425469542311722,0.15829887811427631,0.17214686943155816,0.18356011513763276,0.18987918669507575,0.19214744783941207,0.19767547921331263,0.20007177040022892,0.19941470775352069,0.19591296925041338,0.18987808399106892,0.18169365315338501,0.17178443524604176,0.1605878530956821,0.14852970524615502,0.13600508717506235,0.1233648394476234,0.11090729446440215,0.098874711195570703,0.087453562935029983,0.07677775457087628,0.066933862502562211,0.057967579483760294,0.049890678230422418,0.042687956689880152,0.036323775750962399,0.030747934389656173,0.025900740685404957,0.021717226978210387,0.018130523913698206,0.01507445347075987],[1.5162473653224032e-05,4.1472784268798733e-05,0.0001043807796325414,0.00024324052907007275,0.0005278004580547541,0.0010719446356181887,0.0020474100897789464,0.0036936654113307252,0.0063192631775779943,0.01029029126069109,0.016003339622664692,0.023843476832622251,0.034131402926037412,0.047067218440569145,0.062680155743545185,0.080793543657127959,0.10101215652793309,0.12273542520425852,0.14519563073334277,0.16751614082556296,0.18878180281247234,0.20811224994544261,0.22472918114648396,0.23801035763485814,0.24507738623837108,0.24752562015657686,0.2530530934040352,0.25457639569321083,0.25226574468469992,0.24644715631605152,0.23756445464349496,0.2261386526516185,0.21272861040842289,0.19789593335039632,0.18217603086475523,0.16605626487728922,0.14996128111982354,0.13424498442672489,0.119188205226025,0.10500088936875732,0.091827592003547495,0.07975512539553864,0.068821357758029986,0.059024347930221245,0.050331199522096075,0.042686206862904336,0.036018030518124862,0.030245775635992643,0.025283950282879546,0.021046354971637111,0.017449002566128503],[2.4456042945201426e-05,6.5773770576636688e-05,0.00016291631901346499,0.00037392939624980885,0.00079976861329520018,0.001602202264047463,0.003020574938736747,0.0053821159073298742,0.0090996893039351854,0.014651787885791754,0.022542397813099285,0.033242668803326769,0.04712106520987154,0.064372515521568113,0.084958851274414188,0.10857192278310822,0.13462734028788409,0.16229163590629672,0.19053999282114364,0.21823678980398714,0.24422800794934177,0.26743349584521126,0.28692812107729965,0.30200346868003303,0.30966607338816998,0.31220527222529254,0.31734544088186867,0.3174907610234502,0.31293270332451611,0.30414409134371506,0.29172872562250685,0.27636959152652762,0.25878026541066024,0.23966283889675374,0.21967433776495476,0.19940239379347652,0.1793499420481868,0.15992800886005443,0.1414552252207745,0.12416251234899567,0.10820138905426346,0.093654487341420178,0.080547079981279288,0.068858676659650786,0.058533999790770411,0.049492884074378976,0.041638842004192878,0.034866195161878749,0.029065788241333795,0.024129382982787287,0.019952878202323745],[3.7768359726910065e-05,0.00010003089280802823,0.00024419226854071474,0.00055279699173756797,0.0011669449005535248,0.0023088440568998902,0.0043015128932808108,0.0075785359206287069,0.012676235851096391,0.020202373699953119,0.030779621878718126,0.044967796695453047,0.063174708208053793,0.085569783414979589,0.1120159984338135,0.14203358509703692,0.17480389478797215,0.20921493765149157,0.2439430813671756,0.27755970938335106,0.30864834758475318,0.33591725107274018,0.35829443637528358,0.37499592123002695,0.3830438772612117,0.38556255256542354,0.38986535047557225,0.38808306393926117,0.38065820709217285,0.36823910317161723,0.35161552670480251,0.33165467697583417,0.30924277639596864,0.28523589711478631,0.26042195185137079,0.23549433315591717,0.21103655758682852,0.18751650293362229,0.16528839831510195,0.1446005849873388,0.12560714003383625,0.10838167369611508,0.092931909198045726,0.079213979277532973,0.067145688239045778,0.056618267724052804,0.047506385627356817,0.039676346598693485,0.032992551470830959,0.027322367643726104,0.022539610693812207],[5.5846487863004329e-05,0.00014588391522073223,0.00035149770839497949,0.00078589427918619378,0.0016395616266558094,0.0032077767464833993,0.0059128883940564895,0.010312271861968595,0.017082745983364903,0.026975096077498442,0.040738040340886822,0.059018309048775759,0.082250505426923623,0.11055500018838742,0.14366280261490796,0.1808827772256684,0.22111955920880283,0.26294177208487918,0.30469170427688058,0.34462123746444023,0.38103563760537373,0.4124270704488634,0.43758287717574779,0.45565873025446008,0.46383971651223438,0.46621259220035521,0.46920083514602395,0.46494216023570067,0.45405767290916343,0.43739656951056499,0.41595658993342299,0.39080706704484081,0.36302048488577104,0.33361634047435212,0.30351910084401307,0.27353036488962379,0.24431408322488291,0.2163928782325393,0.19015310017205755,0.1658561776500827,0.14365398210254493,0.12360623824725928,0.10569839971884117,0.089858812065921972,0.075974362547027385,0.063904142529100955,0.053490911908748134,0.044570353874656778,0.036978247154400387,0.030555770087319072,0.02515319651102824],[7.906593559596522e-05,0.0002040199022193274,0.00048588820249734747,0.0010744469503407975,0.0022181787506062372,0.0042968079479666207,0.0078455785171955353,0.013560014921871108,0.022270433998241398,0.034879674408593291,0.052264965785781832,0.075153868939222934,0.1039922779483034,0.13882713187048681,0.1792261899663434,0.22425184950327473,0.27249681538133169,0.32217870132947296,0.37128082347430713,0.41771955347463041,0.45951573533062046,0.49494890562003513,0.52267758951773435,0.5418154513042267,0.54985964915024543,0.55196010767442838,0.55317771579928465,0.54595117871122933,0.53110258557575984,0.50970135588928522,0.48296881424095345,0.45218807400710626,0.41862567456178773,0.38346885731328589,0.34778002789816631,0.31246805164659136,0.27827466260107248,0.24577343275696406,0.215378382840648,0.18735931888871363,0.16186123958720675,0.13892557391051641,0.1185114901565877,0.1005160004447843,0.084792025016124928,0.071163953034810198,0.059440530818240196,0.049425125097136209,0.040923555518309833,0.033749778346957214,0.027729744692561085],[0.00010717877013346211,0.00027360845844865344,0.00064502044238227963,0.0014126293373914421,0.0028897264725139911,0.0055490677159634114,0.010048404354350343,0.017230693386342748,0.028086867354931305,0.043674774023545582,0.064997236176313977,0.092852874143019237,0.12768232820631176,0.16943702515908343,0.21749609722406416,0.27064966735398044,0.32715526838353148,0.38486145066376648,0.44138154567973614,0.49429330330976379,0.54133777054130749,0.58059317020448564,0.61060554601476491,0.63046591901353244,0.63811694732365687,0.63983194669443755,0.63889919270628837,0.62833221517357096,0.60916842967531726,0.58270823159953233,0.5504036225294292,0.51375517876298971,0.47422423782396816,0.43316418037407145,0.3917720260971424,0.35105946343285416,0.31184097686382922,0.27473589873311993,0.24018090421220969,0.20844956333912573,0.17967593180257038,0.15387968311275887,0.13099086195954787,0.11087290084277614,0.093343043433681439,0.078189733949013657,0.065186853978838818,0.054104920131757266,0.044719508061939008,0.036817254946430157,0.030199828203686181],[0.00013910858421481339,0.00035186685782365564,0.00082230678006045565,0.001786051013039653,0.0036250026883659038,0.0069091779844662271,0.012422702120369942,0.021158365478767528,0.034267431341971577,0.052958750898676091,0.078352488126704922,0.11130605411471331,0.15223961615556444,0.20099270224579993,0.2567404640561452,0.31798864325966147,0.38265255878196874,0.44821082716061655,0.51191232706460432,0.57100748648194866,0.62297328537870877,0.66570501164388296,0.69765532693753607,0.71791062799214322,0.72495861885754875,0.72620408737166298,0.72287260185975999,0.70877025973868291,0.68515358635820889,0.65355398250307117,0.61565100585127908,0.57315717618740536,0.52772150590911626,0.48085554137621672,0.43388274676294442,0.3879097902459589,0.34381676862684579,0.30226258328522698,0.26370144010883806,0.22840663975462766,0.19649830135669347,0.16797228910467113,0.14272828094421,0.12059555635089579,0.10135563845450127,0.084761381164856861,0.07055243865755538,0.058467299025154136,0.048252219644996021,0.039667485656684265,0.03249144212770453],[0.00017287209627832737,0.0004339293898666001,0.0010067404797252542,0.0021716102874591008,0.0043787618946801365,0.0082940187043727236,0.014824562269457641,0.0251071980381537,0.040444868217796304,0.062186143107275008,0.091555487116159143,0.12945584086756673,0.17627541787824025,0.23173427054657797,0.29480173362089462,0.36370424485815733,0.43602715908222556,0.50889785342370741,0.57922429291043165,0.64395575975130137,0.70033151160428808,0.74608804244989879,0.77960459404333238,0.79997734686293276,0.80628887256032755,0.80702315570327188,0.8012221595913277,0.78361417847795012,0.75566630624585618,0.71912887236185463,0.67589466454264591,0.62787279942852103,0.57688466959212326,0.52458560122620379,0.47241264385442494,0.42155649727574013,0.37295400993598787,0.32729688512682859,0.28505206395749055,0.24648954535367215,0.21171398461484403,0.18069713717723487,0.1533089694650982,0.12934596479533914,0.10855576137060524,0.090657749248459846,0.075359620571407382,0.062370121607554098,0.051408412729917093,0.042210522733012221,0.034533406227409982],[0.0002056940231496867,0.0005131586194501291,0.0011836531537882029,0.0025391731403432271,0.0050931413313085334,0.0095992193191449544,0.017076329424722977,0.028790629121125465,0.046179467784728853,0.070712848641120332,0.10370260020385588,0.14608443338310892,0.19820883594045141,0.25967984664501337,0.3292748815049969,0.40496526845911085,0.48403935868030445,0.56331230687533929,0.63939275711163801,0.70896927738556992,0.76907919599410401,0.81732857380391144,0.85204232677106162,0.8723354753142003,0.87787488644460232,0.87810781360204049,0.86997325636411116,0.84914083167849275,0.81726661138777768,0.77629525890840956,0.72830712392850139,0.67538283199856852,0.61949294076470951,0.56241611814446246,0.50568586953984174,0.45056331100750524,0.39803188407226076,0.34880914135993618,0.30337063500935524,0.26198132063518303,0.22473056435064184,0.19156765233414463,0.16233553168777304,0.13680127589794819,0.11468242003437901,0.09566882917227644,0.079440147494727997,0.065679137094046505,0.054081373650612566,0.044361842555983355,0.036258994880919423],[0.00023433882783840238,0.00058193710586790595,0.0013364559712686075,0.0028551250487264808,0.005704420421679038,0.010711223770150432,0.018986897617972478,0.031903684006117407,0.05100797087791932,0.077866717326267473,0.11385932296822641,0.1599431548743788,0.21643199095439589,0.2828291912380102,0.35775031835176224,0.43895483182918532,0.52348715361106901,0.60790848463952629,0.68858636788105032,0.76200172346531081,0.82503355159084368,0.87518856370636,0.9107543509961602,0.93086760808663538,0.93570531100866139,0.9355009348713389,0.92538107794462632,0.90185725721257637,0.86674038055247149,0.8221330170390061,0.77026685956370511,0.71336003944621795,0.65350194546959195,0.59256882966520696,0.53216988840700008,0.47362089327337781,0.41794082758606055,0.36586624876086016,0.31787805984002215,0.27423582878816555,0.23501554515657971,0.20014758568588351,0.16945254869235915,0.14267342776978736,0.11950328048735798,0.099608087969566411,0.08264489758865734,0.068275607629776733,0.056176910789150769,0.046046986172977575,0.037609539753016979],[0.00025561871091218079,0.00063283768190063169,0.0014491325777290045,0.0030873107615357691,0.0061521756266082975,0.011523238330139865,0.020377942450658947,0.034163887929457286,0.054504303817881752,0.083033667722506463,0.1211772887355226,0.16990525189026529,0.22950232183230965,0.29939753615699694,0.37808923600082406,0.46318505481476069,0.55155597840810977,0.63958388866248694,0.72346727759749807,0.79954266882208669,0.86458024527735144,0.91601995628949562,0.9521264822644212,0.97205500504709985,0.9763602142642126,0.97583220902217038,0.96426652422217762,0.93880744301143759,0.90137576996143576,0.85418549822090539,0.79957458776669521,0.73985728004605578,0.67720564056231414,0.61356347611533357,0.55059206749157652,0.48964448942846073,0.43176366248802817,0.37769856999844958,0.32793308075154859,0.28272232665342512,0.2421323895164364,0.20607998222238402,0.17436973882106352,0.14672757066411218,0.12282925363096099,0.10232396649041056,0.084852904977484364,0.07006336594875906,0.057618853559201981,0.047205829476920938,0.038537735404262023],[0.00026697268783893704,0.00065993395092691308,0.001508984754041483,0.0032103911759100157,0.0063890652606157844,0.011952046394586927,0.021111227839950595,0.035353345315241327,0.056341339948121627,0.085744327709674648,0.12501080398464778,0.17511662398745464,0.23633056763703272,0.30804220061672916,0.38868828893298074,0.47579720878123483,0.56614982868949359,0.6560352422381861,0.74156483750854207,0.81900111201620063,0.88505886623384922,0.93714455433462729,0.97351206835207826,0.99332714111257503,0.99734534222268301,0.9966452701920705,0.98431777431504541,0.95784642787607999,0.91920907671070184,0.87067734853372791,0.81464400861798425,0.75347272949307464,0.68937798097485947,0.62433811294255914,0.56004094080151856,0.49785844755862912,0.43884558587674583,0.38375746535902633,0.33307924125398841,0.28706355708412401,0.24577122664572976,0.20911179715255104,0.17688158568737464,0.14879763991942446,0.12452679358317556,0.10370954964950901,0.085978932729110752,0.070974723534204934,0.05835364549355429,0.047796142212503001,0.039010388596791054],[0.00026842694466570644,0.0006634015611701082,0.0015166380356663484,0.0032261172980628887,0.0064193107405096268,0.012006757409913789,0.021204724680730459,0.035504910202886014,0.056575280816832135,0.086089323832202344,0.12549844304128449,0.17577918543261156,0.23719826056236401,0.30914018798495552,0.39003389357237889,0.47739768529833582,0.56800100380820751,0.65812119438559691,0.74385863418961651,0.82146648087307506,0.8876525666469649,0.93981915461753207,0.97621882147956485,0.9960186826704861,1,0.99927792314279906,0.9868533214031241,0.96025329027041795,0.92146290613697812,0.87276109307473315,0.81654754688843156,0.75519218459184201,0.69091482722667563,0.62569817884041068,0.56123339486802171,0.4988948337922029,0.43973895501999971,0.38452162952874136,0.33372816375958292,0.28761087708058458,0.24622990962629535,0.2094938968417433,0.17719810010722334,0.14905844366229695,0.12474062904058916,0.10388406159645075,0.08612073282094003,0.07108947361525049,0.058446150914609835,0.047870448462823102,0.039069876393650796],[0.00026697268783893704,0.00065993395092689433,0.001508984754041483,0.0032103911759099246,0.0063890652606157844,0.011952046394586927,0.021111227839950595,0.035353345315241327,0.056341339948121627,0.085744327709672219,0.12501080398464778,0.17511662398744968,0.23633056763703272,0.30804220061672916,0.38868828893298074,0.47579720878123483,0.56614982868949359,0.6560352422381861,0.74156483750854207,0.81900111201617742,0.88505886623384922,0.93714455433462729,0.97351206835207826,0.99332714111257503,0.99734534222268301,0.9966452701920705,0.98431777431504541,0.95784642787607999,0.91920907671070184,0.87067734853372791,0.81464400861796105,0.75347272949307464,0.68937798097485947,0.62433811294255914,0.56004094080151856,0.49785844755862912,0.43884558587674583,0.38375746535902633,0.33307924125398841,0.28706355708412401,0.24577122664572976,0.20911179715255104,0.17688158568736961,0.14879763991942446,0.12452679358317556,0.10370954964950901,0.085978932729110752,0.070974723534204934,0.05835364549355429,0.047796142212501641,0.039010388596791054],[0.00025561871091218079,0.00063283768190063169,0.0014491325777290045,0.0030873107615357691,0.0061521756266082975,0.011523238330139865,0.020377942450658947,0.034163887929457286,0.054504303817881752,0.083033667722506463,0.1211772887355226,0.16990525189026529,0.22950232183230965,0.29939753615699694,0.37808923600082406,0.46318505481476069,0.55155597840810977,0.63958388866248694,0.72346727759749807,0.79954266882208669,0.86458024527735144,0.91601995628949562,0.9521264822644212,0.97205500504709985,0.9763602142642126,0.97583220902217038,0.96426652422217762,0.93880744301143759,0.90137576996143576,0.85418549822090539,0.79957458776669521,0.73985728004605578,0.67720564056231414,0.61356347611533357,0.55059206749157652,0.48964448942846073,0.43176366248802817,0.37769856999844958,0.32793308075154859,0.28272232665342512,0.2421323895164364,0.20607998222238402,0.17436973882106352,0.14672757066411218,0.12282925363096099,0.10232396649041056,0.084852904977484364,0.07006336594875906,0.057618853559201981,0.047205829476920938,0.038537735404262023],[0.00023433882783840238,0.00058193710586790595,0.0013364559712686075,0.0028551250487264808,0.005704420421679038,0.010711223770150432,0.018986897617972478,0.031903684006117407,0.05100797087791932,0.077866717326267473,0.11385932296822641,0.1599431548743788,0.21643199095439589,0.2828291912380102,0.35775031835176224,0.43895483182918532,0.52348715361106901,0.60790848463952629,0.68858636788105032,0.76200172346531081,0.82503355159084368,0.87518856370636,0.9107543509961602,0.93086760808663538,0.93570531100866139,0.9355009348713389,0.92538107794462632,0.90185725721257637,0.86674038055247149,0.8221330170390061,0.77026685956370511,0.71336003944621795,0.65350194546959195,0.59256882966520696,0.53216988840700008,0.47362089327337781,0.41794082758606055,0.36586624876086016,0.31787805984002215,0.27423582878816555,0.23501554515657971,0.20014758568588351,0.16945254869235915,0.14267342776978736,0.11950328048735798,0.099608087969566411,0.08264489758865734,0.068275607629776733,0.056176910789150769,0.046046986172977575,0.037609539753016979],[0.0002056940231496867,0.0005131586194501291,0.0011836531537882029,0.0025391731403432271,0.0050931413313085334,0.009599219319144682,0.017076329424722977,0.028790629121125465,0.046179467784727542,0.07071284864111832,0.10370260020385588,0.14608443338310892,0.19820883594045141,0.25967984664501337,0.32927488150498752,0.40496526845911085,0.48403935868030445,0.56331230687533929,0.63939275711161991,0.70896927738556992,0.76907919599410401,0.81732857380391144,0.85204232677106162,0.8723354753142003,0.87787488644460232,0.87810781360204049,0.86997325636411116,0.84914083167849275,0.81726661138777768,0.77629525890840956,0.72830712392850139,0.67538283199856852,0.61949294076470951,0.56241611814444648,0.50568586953984174,0.45056331100750524,0.39803188407226076,0.3488091413599263,0.30337063500935524,0.26198132063518303,0.22473056435064184,0.19156765233414463,0.16233553168777304,0.13680127589794819,0.11468242003437901,0.09566882917227644,0.079440147494727997,0.065679137094046505,0.054081373650612566,0.044361842555983355,0.036258994880919423],[0.00017287209627832737,0.0004339293898666001,0.0010067404797252542,0.0021716102874590388,0.0043787618946801365,0.0082940187043724876,0.014824562269457641,0.025107198038152988,0.040444868217795152,0.062186143107275008,0.091555487116159143,0.12945584086756673,0.17627541787824025,0.23173427054657797,0.29480173362088624,0.36370424485815733,0.43602715908222556,0.50889785342370741,0.57922429291043165,0.64395575975130137,0.70033151160428808,0.74608804244989879,0.77960459404333238,0.79997734686293276,0.80628887256032755,0.80702315570327188,0.8012221595913277,0.78361417847795012,0.75566630624585618,0.7191288723618342,0.67589466454264591,0.62787279942852103,0.57688466959210682,0.52458560122618891,0.47241264385442494,0.42155649727574013,0.37295400993598787,0.32729688512682859,0.28505206395749055,0.24648954535367215,0.21171398461484403,0.18069713717723487,0.1533089694650982,0.12934596479533914,0.10855576137060524,0.090657749248459846,0.075359620571407382,0.062370121607554098,0.051408412729915628,0.042210522733012221,0.034533406227409982],[0.00013910858421481735,0.00035186685782365564,0.00082230678006045565,0.001786051013039653,0.0036250026883659038,0.0069091779844662271,0.012422702120369942,0.021158365478767528,0.034267431341972548,0.052958750898676091,0.078352488126704922,0.11130605411471331,0.15223961615556444,0.20099270224579993,0.2567404640561452,0.31798864325966147,0.38265255878196874,0.44821082716061655,0.51191232706461887,0.57100748648194866,0.62297328537870877,0.66570501164388296,0.69765532693755594,0.71791062799214322,0.72495861885754875,0.72620408737166298,0.72287260185975999,0.70877025973868291,0.68515358635820889,0.65355398250307117,0.61565100585127908,0.57315717618740536,0.52772150590911626,0.48085554137621672,0.43388274676294442,0.3879097902459589,0.34381676862685556,0.30226258328523559,0.26370144010883806,0.22840663975462766,0.19649830135669347,0.16797228910467113,0.14272828094421,0.12059555635089579,0.10135563845450127,0.084761381164859276,0.07055243865755538,0.058467299025154136,0.048252219644996021,0.039667485656684265,0.03249144212770453],[0.00010717877013346211,0.00027360845844865344,0.00064502044238227963,0.0014126293373914421,0.0028897264725139911,0.0055490677159634114,0.010048404354350343,0.017230693386342748,0.028086867354931305,0.043674774023545582,0.064997236176313977,0.092852874143019237,0.12768232820631176,0.16943702515908343,0.21749609722406416,0.27064966735398044,0.32715526838353148,0.38486145066376648,0.44138154567973614,0.49429330330976379,0.54133777054130749,0.58059317020448564,0.61060554601476491,0.63046591901353244,0.63811694732365687,0.63983194669443755,0.63889919270628837,0.62833221517357096,0.60916842967531726,0.58270823159953233,0.5504036225294292,0.51375517876298971,0.47422423782396816,0.43316418037407145,0.3917720260971424,0.35105946343285416,0.31184097686382922,0.27473589873311993,0.24018090421220969,0.20844956333912573,0.17967593180257038,0.15387968311275887,0.13099086195954787,0.11087290084277614,0.093343043433681439,0.078189733949013657,0.065186853978838818,0.054104920131757266,0.044719508061939008,0.036817254946430157,0.030199828203686181],[7.906593559596522e-05,0.0002040199022193274,0.00048588820249734747,0.0010744469503407975,0.0022181787506062372,0.0042968079479666207,0.0078455785171955353,0.013560014921871108,0.022270433998241398,0.034879674408593291,0.052264965785781832,0.075153868939222934,0.1039922779483034,0.13882713187048681,0.1792261899663434,0.22425184950327473,0.27249681538133169,0.32217870132947296,0.37128082347430713,0.41771955347463041,0.45951573533062046,0.49494890562003513,0.52267758951773435,0.5418154513042267,0.54985964915024543,0.55196010767442838,0.55317771579928465,0.54595117871122933,0.53110258557575984,0.50970135588928522,0.48296881424095345,0.45218807400710626,0.41862567456178773,0.38346885731328589,0.34778002789816631,0.31246805164659136,0.27827466260107248,0.24577343275696406,0.215378382840648,0.18735931888871363,0.16186123958720675,0.13892557391051641,0.1185114901565877,0.1005160004447843,0.084792025016124928,0.071163953034810198,0.059440530818240196,0.049425125097136209,0.040923555518309833,0.033749778346957214,0.027729744692561085],[5.5846487863004329e-05,0.00014588391522073223,0.00035149770839498946,0.00078589427918619378,0.0016395616266558094,0.0032077767464833993,0.0059128883940564895,0.010312271861968595,0.017082745983365389,0.026975096077498442,0.040738040340886822,0.059018309048775759,0.082250505426923623,0.11055500018838742,0.14366280261491204,0.1808827772256684,0.22111955920880283,0.26294177208487918,0.30469170427688058,0.34462123746444023,0.38103563760537373,0.4124270704488634,0.43758287717574779,0.45565873025446008,0.46383971651223438,0.46621259220035521,0.46920083514602395,0.46494216023570067,0.45405767290916343,0.43739656951056499,0.41595658993343482,0.39080706704484081,0.36302048488577104,0.33361634047435212,0.30351910084401307,0.27353036488962379,0.24431408322488291,0.2163928782325393,0.19015310017205755,0.1658561776500827,0.14365398210254493,0.1236062382472628,0.10569839971884117,0.089858812065921972,0.075974362547027385,0.063904142529100955,0.053490911908748134,0.044570353874656778,0.036978247154400387,0.030555770087319072,0.02515319651102824],[3.7768359726910065e-05,0.00010003089280802823,0.00024419226854071474,0.00055279699173756797,0.0011669449005535248,0.0023088440568998902,0.0043015128932808108,0.0075785359206287069,0.012676235851096391,0.020202373699953119,0.030779621878718126,0.044967796695453047,0.063174708208053793,0.085569783414979589,0.1120159984338135,0.14203358509703692,0.17480389478797215,0.20921493765149157,0.2439430813671756,0.27755970938335106,0.30864834758475318,0.33591725107274018,0.35829443637528358,0.37499592123002695,0.3830438772612117,0.38556255256542354,0.38986535047557225,0.38808306393926117,0.38065820709217285,0.36823910317161723,0.35161552670480251,0.33165467697583417,0.30924277639596864,0.28523589711478631,0.26042195185137079,0.23549433315591717,0.21103655758682852,0.18751650293362229,0.16528839831510195,0.1446005849873388,0.12560714003383625,0.10838167369611508,0.092931909198045726,0.079213979277532973,0.067145688239045778,0.056618267724052804,0.047506385627356817,0.039676346598693485,0.032992551470830959,0.027322367643726104,0.022539610693812207],[2.4456042945201426e-05,6.5773770576636688e-05,0.00016291631901346499,0.00037392939624980885,0.00079976861329520018,0.001602202264047463,0.003020574938736747,0.0053821159073298742,0.0090996893039351854,0.014651787885791754,0.022542397813099285,0.033242668803326769,0.04712106520987154,0.064372515521568113,0.084958851274414188,0.10857192278310822,0.13462734028788409,0.16229163590629672,0.19053999282114364,0.21823678980398714,0.24422800794934177,0.26743349584521126,0.28692812107729965,0.30200346868003303,0.30966607338816998,0.31220527222529254,0.31734544088186867,0.3174907610234502,0.31293270332451611,0.30414409134371506,0.29172872562250685,0.27636959152652762,0.25878026541066024,0.23966283889675374,0.21967433776495476,0.19940239379347652,0.1793499420481868,0.15992800886005443,0.1414552252207745,0.12416251234899567,0.10820138905426346,0.093654487341420178,0.080547079981279288,0.068858676659650786,0.058533999790770411,0.049492884074378976,0.041638842004192878,0.034866195161878749,0.029065788241333795,0.024129382982787287,0.019952878202323745],[1.5162473653224032e-05,4.1472784268798733e-05,0.0001043807796325414,0.00024324052907007275,0.0005278004580547541,0.0010719446356181887,0.0020474100897789464,0.0036936654113307252,0.0063192631775779943,0.01029029126069109,0.016003339622664692,0.023843476832622251,0.034131402926037412,0.047067218440569145,0.062680155743545185,0.080793543657127959,0.10101215652793309,0.12273542520425852,0.14519563073334277,0.16751614082556296,0.18878180281247234,0.20811224994544261,0.22472918114648396,0.23801035763485814,0.24507738623837108,0.24752562015657686,0.2530530934040352,0.25457639569321083,0.25226574468469992,0.24644715631605152,0.23756445464349496,0.2261386526516185,0.21272861040842289,0.19789593335039632,0.18217603086475523,0.16605626487728922,0.14996128111982354,0.13424498442672489,0.119188205226025,0.10500088936875732,0.091827592003547495,0.07975512539553864,0.068821357758029986,0.059024347930221245,0.050331199522096075,0.042686206862904336,0.036018030518124862,0.030245775635992643,0.025283950282879546,0.021046354971637111,0.017449002566128503],[9.0007715006109333e-06,2.5076418291108231e-05,6.4224355044303934e-05,0.00015216145911075692,0.00033540271192109738,0.00069144818891931866,0.0013395745937708253,0.0024496206367337499,0.0042453152584285342,0.0069986380608078099,0.011012725572963501,0.01659291593128313,0.024008242300029792,0.033448341665702715,0.044982579880994189,0.058528640007470968,0.073836692833564033,0.090492809103217206,0.107942063153301,0.12552854878459513,0.1425469542311722,0.15829887811427631,0.17214686943155816,0.18356011513763276,0.18987918669507575,0.19214744783941207,0.19767547921331263,0.20007177040022892,0.19941470775352069,0.19591296925041338,0.18987808399106892,0.18169365315338501,0.17178443524604176,0.1605878530956821,0.14852970524615502,0.13600508717506235,0.1233648394476234,0.11090729446440215,0.098874711195570703,0.087453562935029983,0.07677775457087628,0.066933862502564112,0.057967579483760294,0.049890678230422418,0.042687956689880152,0.036323775750962399,0.030747934389656173,0.025900740685404957,0.021717226978210387,0.018130523913698206,0.01507445347075987],[5.1158195865349088e-06,1.4539841687297739e-05,3.7949165914373283e-05,9.1536811942856332e-05,0.00020523658392497318,0.00043001064387619735,0.00084601059843785007,0.0015699176961644931,0.002759034148811618,0.0046094406065507795,0.0073460299607635143,0.011203539997330259,0.016399619687451884,0.023103014623858782,0.03140158072303021,0.041275548824769442,0.052581024727710417,0.06504719196817528,0.078288441157257679,0.091830195904580497,0.10514506806316727,0.11769455706825241,0.12897100800832417,0.13853494118468959,0.1440177415114004,0.146043967313185,0.15127101204198992,0.15411117689548556,0.15457799389574844,0.15279090746380611,0.14895645780471004,0.14334585082797702,0.13627145052616985,0.12806432540789853,0.11905443445170054,0.1095544522778656,0.099847686927048832,0.090180088392154661,0.080756007219184731,0.07173714390921726,0.063244020135347814,0.055359281651639169,0.048132186417043497,0.041583716572509345,0.035711859218966094,0.030496712489391838,0.025905178849404856,0.021895099822105225,0.018418761882567528,0.015425761256900131,0.012865256779957967],[2.7840466656049926e-06,8.0843612099666961e-06,2.1534162511157039e-05,5.2955283199165762e-05,0.00012093009264256346,0.00025782857115648223,0.00051574086444284163,0.00097228080292326179,0.0017346339030486157,0.0029398944254800346,0.0047498977018324163,0.0073395131424457711,0.010878634195862972,0.015509604383780396,0.02132315770795834,0.028336742807548981,0.036479096307697557,0.045584099651884223,0.05539548136601425,0.065582152637168864,0.075762277533492128,0.085532914371113308,0.094501426473844047,0.10231489587354793,0.1069348191904456,0.10868438755990982,0.11340191463035158,0.1163491189699874,0.11749779661179219,0.11690330293737553,0.11469248082490539,0.11104804304099022,0.10619134097048732,0.10036523183368162,0.093818396747975347,0.086792041003507681,0.079509491086630649,0.072168836854257137,0.06493847876625837,0.057955238908258683,0.051324577238026942,0.045122409085719989,0.039398030138937223,0.034177703702868524,0.02946853607374848,0.025262346254243815,0.021539316092602942,0.018271279593116651,0.015424571803279,0.012962406765899525,0.010846790599891385],[1.4506532229016965e-06,4.3104598156635022e-06,1.1734835483540825e-05,2.9460845118620754e-05,6.8612839758562695e-05,0.00014904422462813888,0.00030348282813523502,0.00058189323790445058,0.0010550236865311958,0.0018157835125208052,0.0029770731122694969,0.0046650753561082057,0.0070078073726737751,0.010119773490833942,0.014084595705499576,0.018938241405097228,0.02465569860986409,0.031143581464674507,0.038240256738997315,0.04572386970664398,0.05332738504010559,0.060758705254158378,0.0677232730091121,0.073946384941477136,0.07772966448644654,0.079192716646597688,0.083281171206894489,0.086093963366947635,0.087579679941621663,0.087750783147340722,0.086676561094728877,0.084472841921345507,0.081289881484476467,0.077299746544825534,0.072684299865025184,0.067624608130656572,0.062292289544069623,0.056843035066040243,0.051412301483181919,0.046112998492988118,0.041034877771350571,0.036245273806892526,0.031790833921273555,0.027699896282464123,0.023985217977039577,0.02064680993419734,0.017674693429109534,0.015051448097970876,0.012754470098428422,0.010757899291878842,0.0090342055468960562],[7.2372989164638192e-07,2.2039074413809895e-06,6.141144162682525e-06,1.576171609707857e-05,3.7485888036647884e-05,8.3067575772371847e-05,0.00017237867568015139,0.00033653611975679196,0.00062075498424016544,0.0010860385073702436,0.0018087078660001515,0.0028769313694935995,0.0043838645116319715,0.006417691970901143,0.009049615121531792,0.012321455587027831,0.016234868313255681,0.02074407491523917,0.025753545213252189,0.031121279463400892,0.036667449762383834,0.042187335874410828,0.047466894479608356,0.052299021885089836,0.055311948396920205,0.056498622436848743,0.059914925510294592,0.062440007057815196,0.064013055901077989,0.064620478334485587,0.064292381473398885,0.063096274080369094,0.061128963888034973,0.05850762910173736,0.055360931563504988,0.051820859543412215,0.048015777782050906,0.044064953352039138,0.040074641209487324,0.036135666540053193,0.032322337329155543,0.028692458683439188,0.025288194699463105,0.022137526271528211,0.019256075713149679,0.016649103561467229,0.014313522825909622,0.012239816178166258,0.010413778681688579,0.0088180405517149004,0.0074333501850846412],[3.4571260918858075e-07,1.080575113650421e-06,3.086347675891967e-06,8.1093154392806443e-06,1.9720667631105579e-05,4.4635478468122573e-05,9.4510442326169414e-05,0.00018808615527791194,0.00035333108401000758,0.0006290355672880604,0.0010651751774358319,0.0017213919490262964,0.002663172370199151,0.0039557145968150218,0.005655990753753737,0.0078039958846088482,0.010414500472438732,0.013470692886030604,0.0169208824648171,0.020678977585913319,0.024628857967538189,0.028632155230773847,0.032538460697632964,0.036196678858122951,0.038531474723723903,0.039466172972105362,0.042226490268209411,0.044384754894362138,0.045880204223407058,0.046685743942930957,0.046806747989314994,0.046277590235991178,0.045156548342939057,0.04351976896329577,0.041454944785671334,0.039055252840840091,0.036413967259048226,0.033620012797227143,0.030754587211611412,0.027888863770383087,0.025082696521280212,0.022384191816049559,0.019829977755640479,0.017445994066307587,0.015248632831881609,0.013246079828470656,0.0114397318747526,0.0098255935222176863,0.0083955835413110896,0.0071387060197674289,0.0060420613741723741],[1.5811742601194014e-07,5.0805231029723907e-07,1.4895794444763655e-06,4.0122434920315936e-06,9.9900307299723769e-06,2.3123902354116109e-05,5.0017604735115729e-05,0.00010158246524722424,0.0001945571078040888,0.00035282065556925578,0.00060806125288718051,0.00099933123189477552,0.0015711173156162863,0.0023697854904187964,0.0034385878971246657,0.0048117681753260611,0.0065085812968631099,0.0085281757642158059,0.010846228744796302,0.013413985592481761,0.016159986508934101,0.018994345292655083,0.021815064115836953,0.024515594057926353,0.02627706259364648,0.02699272372698933,0.029153903387674474,0.030923265449909872,0.03224584037741593,0.033089739409654643,0.033446335295709742,0.033328684436639965,0.032768578378604481,0.031812684213758199,0.030518238750868031,0.028948714681439211,0.027169796229613789,0.025245904651081261,0.023237415532470412,0.021198621276621431,0.019176420294153201,0.0172096622179333,0.015329045794205916,0.013557450749262701,0.011910583466210371,0.010397824903254443,0.0090231841654422069,0.0077862793349179876,0.0066832860793913972,0.0057078124186036756,0.0048516737161479447],[6.924207249018902e-08,2.2906237502509708e-07,6.9040791497711434e-07,1.9090300391755256e-06,4.873078811915687e-06,1.1549796520594306e-05,2.5551289537342764e-05,5.3017279745036181e-05,0.00010363727439449417,0.00019163799796209169,0.00033647074190648211,0.00056288358141951325,0.00090008834714442644,0.0013798476143532623,0.0020335011737790745,0.0028881849935880389,0.0039627113593181619,0.0052637189789086639,0.0067827260084900899,0.0084946162219100632,0.010357879746809155,0.012316660391320294,0.014304388230035691,0.016248551713495662,0.017542945340549058,0.018076025401872781,0.019718333027070621,0.021116284821416597,0.022223560138569888,0.023008979555580719,0.02345739196997022,0.023569263917159054,0.023359181542092163,0.02285355147998562,0.022087815457765655,0.021103481535048801,0.01994523326253279,0.018658318590223755,0.017286354230985859,0.01586961735964499,0.014443841253454848,0.013039488258799454,0.011681443436295182,0.010389054740538455,0.009176438824183189,0.0080529731281209788,0.0070239023122381462,0.0060909979678333186,0.0052532229861719697,0.0045073644502762848,0.0038486104417491912],[2.9032617152740872e-08,9.903551117716966e-08,3.0730605714535033e-07,8.7349542938767663e-07,2.2889243903465644e-06,5.561856933110473e-06,1.2599392194181331e-05,2.6739476881289204e-05,5.3405807891260578e-05,0.00010079942853168904,0.0001804766264893628,0.00030761473092352673,0.00050075909837086748,0.00078089244804699137,0.0011697729712583662,0.0016876328362623375,0.0023504810917396091,0.0031673757860686495,0.0041380863824156131,0.0052515420082115336,0.0064853569813799151,0.0078065645336974562,0.0091735068274074634,0.010538660914761281,0.011465492514167121,0.011852056546655347,0.013064880648709608,0.014132868371299732,0.015019142606846879,0.015696264822649617,0.016147378509647699,0.016366442182360313,0.016357645889942544,0.016134174019191597,0.015716514502964164,0.015130522377382117,0.014405429554965441,0.013571960112941888,0.012660669000564484,0.011700578614125988,0.010718147378819546,0.0097365707216110989,0.0087753893249920278,0.0078503626202244877,0.0069735563997302364,0.0061535908739947555,0.005395997868440576,0.0047036415409065068,0.0040771645593382817,0.0035154299361148931,0.0030159367940152592],[1.1655425224858927e-08,4.1060099282362126e-08,1.3135897390332336e-07,3.8435355756315241e-07,1.0352633968446763e-06,2.5822457284225808e-06,5.9969883488536923e-06,1.3032422344882035e-05,2.662346766345922e-05,5.1343247774130294e-05,9.3835744930287023e-05,0.00016310794055182339,0.00027054514441264777,0.00042952586723953799,0.00065456321461426986,0.000959983071191269,0.0013582487063159264,0.0018581331631891997,0.0024630010367850431,0.0031694731650835604,0.0039667064230472287,0.0048364342833356585,0.0057538004173909437,0.0066889006288049901,0.0073357991188865591,0.0076088500486412875,0.0084801289960178949,0.0092709397164908707,0.0099533259066827539,0.010504858927278959,0.01090976614575693,0.011159454217765661,0.011252451294981616,0.0111938485255965,0.010994358236023264,0.010669123107802417,0.01023640972846695,0.0097163052077976798,0.0091295119955202494,0.0084963083705357351,0.0078357143094809258,0.0071648775327268124,0.0064986742811259683,0.0058495045811434747,0.0052272523781997727,0.004639376363071426,0.0040910966669985942,0.0035856448215188649,0.0031245484637514244,0.0027079273391733588,0.0023347825112392368],[4.4801841398264e-09,1.6324538111977508e-08,5.3922701517343524e-08,1.6263857758063058e-07,4.5088072739016277e-07,1.155866284600906e-06,2.7552667664937444e-06,6.138102808426009e-06,1.2839389621538075e-05,2.5325464888711998e-05,4.7292179642786324e-05,8.3911697525165682e-05,0.00014194425653040678,0.00022962830956444426,0.00035628247897693719,0.00053159615397540823,0.00076464535441085342,0.0010627336241493125,0.0014302086518568169,0.0018674305890246155,0.0023700602334863004,0.0029287950187515486,0.0035296163561790951,0.0041545366610475721,0.0045948004573681178,0.0047827631494348271,0.0053921409116708761,0.0059607079028032792,0.0064681917142569208,0.0068972994195388672,0.0072346907588117888,0.0074715729666528273,0.0076039042640594044,0.0076322355717871699,0.0075612518449961396,0.0073990935986734396,0.0071565459387126365,0.0068461786159744456,0.0064815090941772015,0.006076244464729659,0.0056436401290077126,0.0051959958328269915,0.0047442945182193785,0.0042979774948780566,0.0038648409606724752,0.0034510337846603281,0.0030611342650297573,0.0026982836818288947,0.0023643562264534452,0.0020601476902460739,0.0017855686061333806],[1.6488813751920095e-09,6.2237719157077265e-09,2.1257236525897507e-08,6.6181807369415769e-08,1.8908796395064181e-07,4.9882693780571254e-07,1.2219148454564763e-06,2.793701133310171e-06,5.9900129387552548e-06,1.2097074013040059e-05,2.3103833073634604e-05,4.188411438695784e-05,7.2320778163683662e-05,0.0001193162344549959,0.0001886384388486333,0.00028657132643342554,0.0004193716078733745,0.00059257367418022705,0.00081022188746503719,0.0010741353554859657,0.0013833174600432355,0.001733608440594918,0.0021176467602036773,0.0025251604929524057,0.0028174122025230236,0.002943562503714396,0.0033587816347329415,0.0037562333439504505,0.0041218209112989087,0.0044428626021339778,0.004708858260768862,0.0049120360153043843,0.0050476507456762359,0.0051140357446980015,0.0051124337929306773,0.005046651400515678,0.004922589495410302,0.0047477058779754645,0.0045304607079593136,0.0042797879782847451,0.0040046252686643941,0.0037135227634150247,0.0034143418935009065,0.0031140449198351701,0.0028185697907573311,0.0025327798055697808,0.0022604748597376489,0.0020044500300142321,0.0017665875909126279,0.0015479698337251858,0.0013490019133616756],[5.810436604908478e-10,2.2754028325429503e-09,8.0475787573396439e-09,2.5898587161672719e-08,7.6358519530151878e-08,2.0755083010811054e-07,5.2307632902397592e-07,1.2287470919233909e-06,2.7034277551586465e-06,5.5956697052553391e-06,1.0940884378936733e-05,2.0284093065560372e-05,3.5782900594417432e-05,6.0257575524703946e-05,9.7153573513815739e-05,0.00015038907410190128,0.00022407644780404295,0.00032212959776488175,0.00044779403614385993,0.00060315746766294092,0.00078871024979567847,0.0010030241685344387,0.0012426042595603175,0.0015019446043807983,0.0016912142804288589,0.0017737899434865122,0.0020495761994146987,0.002319999690909407,0.0025756504795994397,0.0028076413741978906,0.0030081700224456201,0.0031709650535726168,0.0032915853015710356,0.003367560476160126,0.0033983794104170853,0.0033853461593469536,0.0033313336559297134,0.0032404691461895684,0.0031177857228252091,0.0029688709123123279,0.0027995376000436124,0.0026155357501783903,0.002422316382007606,0.0022248528528980224,0.0020275191539543169,0.001834020885802403,0.0016473718830257154,0.0014699079850212357,0.0013033290066650385,0.0011487603016568184,0.0010068261894505947]],"type":"surface","frame":null},{"x":[16.095823580676075],"y":[2.9091321439371032],"z":[1],"type":"scatter3d","mode":"markers","marker":{"color":"red","size":5,"line":{"color":"rgba(255,127,14,1)"}},"name":"MLE (σ)","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null},{"x":[16.259237146683411],"y":[2.9091321439371032],"z":[0.99494513610375346],"type":"scatter3d","mode":"markers","marker":{"color":"blue","size":5,"line":{"color":"rgba(44,160,44,1)"}},"name":"Unbiased (σ)","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The red point shows the MLE estimate <span class="math inline">\((\hat{\beta}, \hat{\sigma}_{MLE})\)</span>, which corresponds to the maximum of the likelihood function. The blue point shows <span class="math inline">\((\hat{\beta}, \hat{\sigma}_{unbiased})\)</span>, which uses the degrees-of-freedom correction. Note that <span class="math inline">\(\hat{\beta}\)</span> is the same for both (it maximizes the likelihood), but the unbiased estimator of <span class="math inline">\(\sigma\)</span> is slightly larger.</p>
</section>
<section id="comparison-with-lm" class="level4" data-number="2.1.3.2">
<h4 data-number="2.1.3.2" class="anchored" data-anchor-id="comparison-with-lm"><span class="header-section-number">2.1.3.2</span> Comparison with lm()</h4>
<p>Now let’s verify our results using R’s built-in <code>lm()</code> function:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model with lm (forcing through origin with -1)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>model_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> cars)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>comparison_lm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">"β̂"</span>, <span class="st">"SE(β̂)"</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Manual =</span> <span class="fu">c</span>(<span class="fu">round</span>(beta_hat, <span class="dv">4</span>), <span class="fu">round</span>(sigma_hat_unbiased <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)), <span class="dv">4</span>)),</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">lm()</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">coef</span>(model_lm)[<span class="dv">1</span>], <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">summary</span>(model_lm)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">4</span>)),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_lm, <span class="at">caption =</span> <span class="st">"Comparison: Manual Calculation vs lm()"</span>, <span class="at">align =</span> <span class="st">'lrr'</span>, <span class="at">format=</span><span class="st">'html'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Comparison: Manual Calculation vs lm()</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Manual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">lm()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">speed</td>
<td style="text-align: left;">β̂</td>
<td style="text-align: right;">2.9091</td>
<td style="text-align: right;">2.9091</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">SE(β̂)</td>
<td style="text-align: right;">0.1414</td>
<td style="text-align: right;">0.1414</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>The estimates match perfectly, confirming our derivations.</p>
</section>
</section>
</section>
<section id="bayesian-inference" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="bayesian-inference"><span class="header-section-number">2.2</span> Bayesian Inference</h2>
<p>For the Bayesian approach, we use conditionally conjugate priors. Let <span class="math inline">\(\tau = 1/\sigma^2\)</span> denote the precision. We specify:</p>
<ul>
<li><p>Prior for <span class="math inline">\(\beta\)</span>: <span class="math inline">\(\beta \sim N(\mu_0, 1/\tau_0)\)</span></p></li>
<li><p>Prior for <span class="math inline">\(\tau\)</span>: <span class="math inline">\(\tau \sim \text{Gamma}(\alpha_0, \beta_0)\)</span></p></li>
</ul>
<p>These priors are conditionally conjugate, meaning each complete conditional distribution has a recognizable form.</p>
<section id="complete-conditional-distributions" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="complete-conditional-distributions"><span class="header-section-number">2.2.1</span> Complete Conditional Distributions</h3>
<p><strong>Complete Conditional for</strong> <span class="math inline">\(\beta\)</span>:</p>
<p>The likelihood contribution is: <span class="math display">\[p(\mathbf{y}|\beta, \tau) \propto \exp\left(-\frac{\tau}{2}\sum_{i=1}^n(y_i - \beta x_i)^2\right)\]</span></p>
<p>The prior is: <span class="math display">\[p(\beta) \propto \exp\left(-\frac{\tau_0}{2}(\beta - \mu_0)^2\right)\]</span></p>
<p>The posterior (using kernel recognition) is: <span class="math display">\[p(\beta | \mathbf{y}, \tau) \propto \exp\left(-\frac{1}{2}\left[\tau\sum_{i=1}^n(y_i - \beta x_i)^2 + \tau_0(\beta - \mu_0)^2\right]\right)\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Background: Kernel Recognition for Posterior Distributions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Kernel recognition</strong> is a technique for identifying probability distributions from their unnormalized forms. The key insight is that we can recognize a distribution by its “kernel”—the part that depends on the parameter of interest, ignoring normalizing constants.</p>
<section id="the-basic-principle" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="the-basic-principle"><span class="header-section-number">2.2.2</span> The Basic Principle</h3>
<p>For a probability density <span class="math inline">\(p(\theta)\)</span>, we can write:</p>
<p><span class="math display">\[p(\theta) = \frac{1}{c} \times k(\theta)\]</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(k(\theta)\)</span> is the <strong>kernel</strong> (the part depending on <span class="math inline">\(\theta\)</span>)</p></li>
<li><p><span class="math inline">\(c\)</span> is the <strong>normalizing constant</strong> (makes the integral/sum equal 1)</p></li>
</ul>
<p>In Bayesian inference, we compute:</p>
<p><span class="math display">\[p(\theta | \text{data}) \propto p(\text{data} | \theta) \times p(\theta)\]</span></p>
<p>The <span class="math inline">\(\propto\)</span> symbol means “proportional to”—we ignore constants that don’t depend on <span class="math inline">\(\theta\)</span>. If we can recognize the resulting kernel as belonging to a known distribution family, we’ve identified the posterior.</p>
</section>
<section id="common-kernels-to-recognize" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="common-kernels-to-recognize"><span class="header-section-number">2.2.3</span> Common Kernels to Recognize</h3>
<p><strong>Normal Distribution:</strong> <span class="math inline">\(N(\mu, \sigma^2)\)</span></p>
<p>Kernel: <span class="math inline">\(\exp\left(-\frac{1}{2\sigma^2}(x - \mu)^2\right)\)</span></p>
<p>Key pattern: Quadratic in the exponent <span class="math display">\[\exp\left(-\frac{1}{2}[\text{constant} \times \theta^2 - 2 \times \text{constant} \times \theta]\right)\]</span></p>
<p><strong>Gamma Distribution:</strong> <span class="math inline">\(\text{Gamma}(\alpha, \beta)\)</span></p>
<p>Kernel: <span class="math inline">\(x^{\alpha-1} e^{-\beta x}\)</span></p>
<p>Key pattern: Power times exponential</p>
<p><strong>Beta Distribution:</strong> <span class="math inline">\(\text{Beta}(\alpha, \beta)\)</span></p>
<p>Kernel: <span class="math inline">\(x^{\alpha-1}(1-x)^{\beta-1}\)</span></p>
<p>Key pattern: Product of powers</p>
</section>
<section id="example-normal-posterior" class="level3" data-number="2.2.4">
<h3 data-number="2.2.4" class="anchored" data-anchor-id="example-normal-posterior"><span class="header-section-number">2.2.4</span> Example: Normal Posterior</h3>
<p>Suppose we have:</p>
<ul>
<li><p>Data: <span class="math inline">\(y_i \sim N(\theta, \sigma^2)\)</span> with known <span class="math inline">\(\sigma^2\)</span></p></li>
<li><p>Prior: <span class="math inline">\(\theta \sim N(\mu_0, \tau_0^2)\)</span></p></li>
</ul>
<p>The posterior is: <span class="math display">\[p(\theta | \mathbf{y}) \propto \exp\left(-\frac{1}{2\sigma^2}\sum(y_i - \theta)^2\right) \times \exp\left(-\frac{1}{2\tau_0^2}(\theta - \mu_0)^2\right)\]</span></p>
<p><strong>Step 1:</strong> Expand and combine exponents: <span class="math display">\[\propto \exp\left(-\frac{1}{2}\left[\frac{n}{\sigma^2}\theta^2 - \frac{2\sum y_i}{\sigma^2}\theta + \frac{1}{\tau_0^2}\theta^2 - \frac{2\mu_0}{\tau_0^2}\theta\right]\right)\]</span></p>
<p><strong>Step 2:</strong> Collect terms: <span class="math display">\[\propto \exp\left(-\frac{1}{2}\left[\left(\frac{n}{\sigma^2} + \frac{1}{\tau_0^2}\right)\theta^2 - 2\left(\frac{\sum y_i}{\sigma^2} + \frac{\mu_0}{\tau_0^2}\right)\theta\right]\right)\]</span></p>
<p><strong>Step 3:</strong> Recognize the pattern <span class="math inline">\(\exp(-\frac{1}{2}[A\theta^2 - 2B\theta])\)</span> as Normal with:</p>
<ul>
<li><p>Precision: <span class="math inline">\(\tau_n = \frac{n}{\sigma^2} + \frac{1}{\tau_0^2}\)</span></p></li>
<li><p>Mean: <span class="math inline">\(\mu_n = \frac{B}{A} = \frac{\sum y_i/\sigma^2 + \mu_0/\tau_0^2}{n/\sigma^2 + 1/\tau_0^2}\)</span></p></li>
</ul>
<p>Therefore: <span class="math inline">\(\theta | \mathbf{y} \sim N(\mu_n, 1/\tau_n)\)</span></p>
</section>
<section id="the-completing-the-square-trick" class="level3" data-number="2.2.5">
<h3 data-number="2.2.5" class="anchored" data-anchor-id="the-completing-the-square-trick"><span class="header-section-number">2.2.5</span> The “Completing the Square” Trick</h3>
<p>For normal kernels, we often need to complete the square:</p>
<p>Starting with: <span class="math inline">\(A\theta^2 - 2B\theta + C\)</span></p>
<p>Rewrite as: <span class="math inline">\(A(\theta - B/A)^2 + \text{constant}\)</span></p>
<p>The constant doesn’t depend on <span class="math inline">\(\theta\)</span>, so we can ignore it! This reveals:</p>
<ul>
<li><p>Mean: <span class="math inline">\(\mu = B/A\)</span></p></li>
<li><p>Variance: <span class="math inline">\(\sigma^2 = 1/A\)</span></p></li>
</ul>
</section>
<section id="why-this-works" class="level3" data-number="2.2.6">
<h3 data-number="2.2.6" class="anchored" data-anchor-id="why-this-works"><span class="header-section-number">2.2.6</span> Why This Works</h3>
<p>The normalizing constant ensures the distribution integrates to 1, but it’s the same for any value of the data. Since we’re conditioning on the observed data, the normalizing constant is just a number that makes the probabilities sum/integrate to 1. We can figure out what distribution we have without computing it!</p>
</section>
<section id="practical-tips" class="level3" data-number="2.2.7">
<h3 data-number="2.2.7" class="anchored" data-anchor-id="practical-tips"><span class="header-section-number">2.2.7</span> Practical Tips</h3>
<ol type="1">
<li><strong>Expand everything</strong> in the posterior expression</li>
<li><strong>Collect like terms</strong> (all <span class="math inline">\(\theta^2\)</span> terms together, all <span class="math inline">\(\theta\)</span> terms together)</li>
<li><strong>Ignore constants</strong> that don’t involve <span class="math inline">\(\theta\)</span></li>
<li><strong>Match the pattern</strong> to a known distribution</li>
<li><strong>Extract parameters</strong> from the coefficients</li>
</ol>
<p>This technique is powerful because it lets us derive closed-form posteriors without doing any integration!</p>
</section>
</div>
</div>
</div>
<p>Expanding and completing the square: <span class="math display">\[\tau\sum_{i=1}^n(y_i - \beta x_i)^2 + \tau_0(\beta - \mu_0)^2 = (\tau\sum x_i^2 + \tau_0)\beta^2 - 2\beta(\tau\sum x_i y_i + \tau_0\mu_0) + C\]</span></p>
<p>This is the kernel of a normal distribution: <span class="math display">\[\beta | \mathbf{y}, \tau \sim N\left(\frac{\tau\sum x_i y_i + \tau_0\mu_0}{\tau\sum x_i^2 + \tau_0}, \frac{1}{\tau\sum x_i^2 + \tau_0}\right)\]</span></p>
<p>Let <span class="math inline">\(\tau_n = \tau\sum x_i^2 + \tau_0\)</span> and <span class="math inline">\(\mu_n = \frac{\tau\sum x_i y_i + \tau_0\mu_0}{\tau_n}\)</span>.</p>
<p><strong>Complete Conditional for</strong> <span class="math inline">\(\tau\)</span>:</p>
<p>The likelihood contribution is: <span class="math display">\[p(\mathbf{y}|\beta, \tau) \propto \tau^{n/2} \exp\left(-\frac{\tau}{2}\sum_{i=1}^n(y_i - \beta x_i)^2\right)\]</span></p>
<p>The prior is: <span class="math display">\[p(\tau) \propto \tau^{\alpha_0-1} \exp(-\beta_0\tau)\]</span></p>
<p>The posterior is: <span class="math display">\[p(\tau | \mathbf{y}, \beta) \propto \tau^{n/2 + \alpha_0 - 1} \exp\left(-\tau\left[\frac{1}{2}\sum_{i=1}^n(y_i - \beta x_i)^2 + \beta_0\right]\right)\]</span></p>
<p>This is the kernel of a Gamma distribution: <span class="math display">\[\tau | \mathbf{y}, \beta \sim \text{Gamma}\left(\alpha_0 + \frac{n}{2}, \beta_0 + \frac{1}{2}\sum_{i=1}^n(y_i - \beta x_i)^2\right)\]</span></p>
</section>
<section id="gibbs-sampling" class="level3" data-number="2.2.8">
<h3 data-number="2.2.8" class="anchored" data-anchor-id="gibbs-sampling"><span class="header-section-number">2.2.8</span> Gibbs Sampling</h3>
<p>Gibbs sampling is a Markov Chain Monte Carlo (MCMC) method that generates samples from a joint posterior distribution by iteratively sampling from complete conditional distributions. The algorithm proceeds as follows:</p>
<ol type="1">
<li><p>Initialize <span class="math inline">\(\beta^{(0)}\)</span> and <span class="math inline">\(\tau^{(0)}\)</span></p></li>
<li><p>For iteration <span class="math inline">\(t = 1, 2, \ldots, T\)</span>:</p>
<ul>
<li><p>Sample <span class="math inline">\(\beta^{(t)} \sim p(\beta | \mathbf{y}, \tau^{(t-1)})\)</span></p></li>
<li><p>Sample <span class="math inline">\(\tau^{(t)} \sim p(\tau | \mathbf{y}, \beta^{(t)})\)</span></p></li>
</ul></li>
</ol>
<p>Under regularity conditions, the samples <span class="math inline">\((\beta^{(t)}, \tau^{(t)})\)</span> converge to samples from the joint posterior <span class="math inline">\(p(\beta, \tau | \mathbf{y})\)</span>.</p>
</section>
<section id="implementation-with-diffuse-priors" class="level3" data-number="2.2.9">
<h3 data-number="2.2.9" class="anchored" data-anchor-id="implementation-with-diffuse-priors"><span class="header-section-number">2.2.9</span> Implementation with Diffuse Priors</h3>
<p>We’ll use diffuse (weakly informative) priors: - <span class="math inline">\(\beta \sim N(0, 1000)\)</span> (equivalent to <span class="math inline">\(\tau_0 = 0.001\)</span>, <span class="math inline">\(\mu_0 = 0\)</span>) - <span class="math inline">\(\tau \sim \text{Gamma}(0.001, 0.001)\)</span> (equivalent to <span class="math inline">\(\alpha_0 = 0.001\)</span>, <span class="math inline">\(\beta_0 = 0.001\)</span>)</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Gibbs sampler function</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(y, x, <span class="at">n_iter =</span> <span class="dv">10000</span>, <span class="at">burn_in =</span> <span class="dv">1000</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">mu0 =</span> <span class="dv">0</span>, <span class="at">tau0 =</span> <span class="fl">0.001</span>, <span class="at">alpha0 =</span> <span class="fl">0.001</span>, <span class="at">beta0 =</span> <span class="fl">0.001</span>) {</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Storage</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  beta_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  tau_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Initialize</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">*</span> y) <span class="sc">/</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)  <span class="co"># Start at OLS estimate</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Precompute</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  sum_x2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  sum_xy <span class="ot">&lt;-</span> <span class="fu">sum</span>(x <span class="sc">*</span> y)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Gibbs sampling</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter) {</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample beta | tau, y</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    tau_n <span class="ot">&lt;-</span> tau <span class="sc">*</span> sum_x2 <span class="sc">+</span> tau0</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    mu_n <span class="ot">&lt;-</span> (tau <span class="sc">*</span> sum_xy <span class="sc">+</span> tau0 <span class="sc">*</span> mu0) <span class="sc">/</span> tau_n</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, mu_n, <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>tau_n))</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample tau | beta, y</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>    residuals <span class="ot">&lt;-</span> y <span class="sc">-</span> beta <span class="sc">*</span> x</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>    alpha_n <span class="ot">&lt;-</span> alpha0 <span class="sc">+</span> n<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>    beta_n <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> <span class="fu">sum</span>(residuals<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>    tau <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="dv">1</span>, alpha_n, beta_n)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>    beta_samples[i] <span class="ot">&lt;-</span> beta</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    tau_samples[i] <span class="ot">&lt;-</span> tau</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove burn-in</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  beta_samples <span class="ot">&lt;-</span> beta_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  tau_samples <span class="ot">&lt;-</span> tau_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">beta =</span> beta_samples, <span class="at">tau =</span> tau_samples, <span class="at">sigma =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(tau_samples))</span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Gibbs sampler</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>gibbs_results <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(y, x, <span class="at">n_iter =</span> <span class="dv">11000</span>, <span class="at">burn_in =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="trace-plots" class="level4" data-number="2.2.9.1">
<h4 data-number="2.2.9.1" class="anchored" data-anchor-id="trace-plots"><span class="header-section-number">2.2.9.1</span> Trace Plots</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Beta trace plot</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gibbs_results<span class="sc">$</span>beta, <span class="at">type =</span> <span class="st">'l'</span>, <span class="at">main =</span> <span class="st">'Trace Plot for β'</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Iteration'</span>, <span class="at">ylab =</span> <span class="st">'β'</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> beta_hat, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Beta density</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(gibbs_results<span class="sc">$</span>beta), <span class="at">main =</span> <span class="st">'Posterior Density for β'</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'β'</span>, <span class="at">ylab =</span> <span class="st">'Density'</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> beta_hat, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Tau trace plot</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gibbs_results<span class="sc">$</span>tau, <span class="at">type =</span> <span class="st">'l'</span>, <span class="at">main =</span> <span class="st">'Trace Plot for τ'</span>,</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Iteration'</span>, <span class="at">ylab =</span> <span class="st">'τ'</span>)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sigma density (more interpretable than tau)</span></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(gibbs_results<span class="sc">$</span>sigma), <span class="at">main =</span> <span class="st">'Posterior Density for σ'</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'σ'</span>, <span class="at">ylab =</span> <span class="st">'Density'</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> sigma_hat_unbiased, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="st">'Unbiased estimate'</span>, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EstimationAndInference_files/figure-html/trace_plots-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="summary-statistics" class="level4" data-number="2.2.9.2">
<h4 data-number="2.2.9.2" class="anchored" data-anchor-id="summary-statistics"><span class="header-section-number">2.2.9.2</span> Summary Statistics</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table for Gibbs results</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>gibbs_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"β"</span>, <span class="st">"σ"</span>), <span class="at">each =</span> <span class="dv">4</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Median"</span>, <span class="st">"SD"</span>, <span class="st">"95% CI"</span>), <span class="dv">2</span>),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>),</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">median</span>(gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>),</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sd</span>(gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">round</span>(<span class="fu">quantile</span>(gibbs_results<span class="sc">$</span>beta, <span class="fl">0.025</span>), <span class="dv">4</span>), <span class="st">", "</span>, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>           <span class="fu">round</span>(<span class="fu">quantile</span>(gibbs_results<span class="sc">$</span>beta, <span class="fl">0.975</span>), <span class="dv">4</span>), <span class="st">")"</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(gibbs_results<span class="sc">$</span>sigma), <span class="dv">4</span>),</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">median</span>(gibbs_results<span class="sc">$</span>sigma), <span class="dv">4</span>),</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sd</span>(gibbs_results<span class="sc">$</span>sigma), <span class="dv">4</span>),</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">round</span>(<span class="fu">quantile</span>(gibbs_results<span class="sc">$</span>sigma, <span class="fl">0.025</span>), <span class="dv">4</span>), <span class="st">", "</span>, </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>           <span class="fu">round</span>(<span class="fu">quantile</span>(gibbs_results<span class="sc">$</span>sigma, <span class="fl">0.975</span>), <span class="dv">4</span>), <span class="st">")"</span>)</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(gibbs_summary, <span class="at">caption =</span> <span class="st">"Posterior Summary from Gibbs Sampling"</span>, <span class="at">align =</span> <span class="st">'llr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"β"</span>, <span class="dv">1</span>, <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"σ"</span>, <span class="dv">5</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Posterior Summary from Gibbs Sampling</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Parameter</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="4">
<td colspan="3" style="border-bottom: 1px solid"><strong>β</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">β</td>
<td style="text-align: left;">Mean</td>
<td style="text-align: right;">2.9079</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">β</td>
<td style="text-align: left;">Median</td>
<td style="text-align: right;">2.9067</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">β</td>
<td style="text-align: left;">SD</td>
<td style="text-align: right;">0.1422</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">β</td>
<td style="text-align: left;">95% CI</td>
<td style="text-align: right;">(2.633, 3.1911)</td>
</tr>
<tr class="even" data-grouplength="4">
<td colspan="3" style="border-bottom: 1px solid"><strong>σ</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">σ</td>
<td style="text-align: left;">Mean</td>
<td style="text-align: right;">16.4968</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">σ</td>
<td style="text-align: left;">Median</td>
<td style="text-align: right;">16.3794</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">σ</td>
<td style="text-align: left;">SD</td>
<td style="text-align: right;">1.7022</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">σ</td>
<td style="text-align: left;">95% CI</td>
<td style="text-align: right;">(13.5867, 20.2191)</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison table</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>comparison_freq_bayes <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Parameter =</span> <span class="fu">c</span>(<span class="st">"β"</span>, <span class="st">"σ"</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">MLE (biased)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(beta_hat, <span class="dv">4</span>), <span class="fu">round</span>(sigma_hat_mle, <span class="dv">4</span>)),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">MLE (unbiased)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(beta_hat, <span class="dv">4</span>), <span class="fu">round</span>(sigma_hat_unbiased, <span class="dv">4</span>)),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">Posterior Mean</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">mean</span>(gibbs_results<span class="sc">$</span>sigma), <span class="dv">4</span>)),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_freq_bayes, <span class="at">caption =</span> <span class="st">"Comparison: Frequentist vs Bayesian Estimates"</span>, <span class="at">align =</span> <span class="st">'lrrr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Comparison: Frequentist vs Bayesian Estimates</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Parameter</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MLE (biased)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MLE (unbiased)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Posterior Mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">β</td>
<td style="text-align: right;">2.9091</td>
<td style="text-align: right;">2.9091</td>
<td style="text-align: right;">2.9079</td>
</tr>
<tr class="even">
<td style="text-align: left;">σ</td>
<td style="text-align: right;">16.0958</td>
<td style="text-align: right;">16.2592</td>
<td style="text-align: right;">16.4968</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="comparison-with-brms" class="level3" data-number="2.2.10">
<h3 data-number="2.2.10" class="anchored" data-anchor-id="comparison-with-brms"><span class="header-section-number">2.2.10</span> Comparison with brms</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model with brms (no intercept)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>brms_model <span class="ot">&lt;-</span> <span class="fu">brm</span>(dist <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> speed, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">data =</span> cars,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">prior =</span> <span class="fu">c</span>(<span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="fl">31.62</span>), <span class="at">class =</span> <span class="st">"b"</span>),  <span class="co"># SD = sqrt(1000)</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">prior</span>(<span class="fu">gamma</span>(<span class="fl">0.001</span>, <span class="fl">0.001</span>), <span class="at">class =</span> <span class="st">"sigma"</span>)),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">chains =</span> <span class="dv">4</span>, </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">seed =</span> <span class="dv">123</span>,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">refresh =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(brms_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: gaussian 
  Links: mu = identity; sigma = identity 
Formula: dist ~ 0 + speed 
   Data: cars (Number of observations: 50) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
speed     2.91      0.14     2.63     3.19 1.00     2908     2371

Further Distributional Parameters:
      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
sigma    16.60      1.78    13.52    20.51 1.00     2981     2518

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>comparison_gibbs_brms <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Manual Gibbs"</span>, <span class="st">"brms"</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">β (Mean)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">fixef</span>(brms_model)[<span class="dv">1</span>, <span class="dv">1</span>], <span class="dv">4</span>)),</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">β (SD)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">sd</span>(gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">fixef</span>(brms_model)[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">4</span>)),</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_gibbs_brms, <span class="at">caption =</span> <span class="st">"Comparison: Manual Gibbs Sampling vs brms"</span>, <span class="at">align =</span> <span class="st">'lrr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Comparison: Manual Gibbs Sampling vs brms</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">β (Mean)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">β (SD)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Manual Gibbs</td>
<td style="text-align: right;">2.9079</td>
<td style="text-align: right;">0.1422</td>
</tr>
<tr class="even">
<td style="text-align: left;">brms</td>
<td style="text-align: right;">2.9108</td>
<td style="text-align: right;">0.1448</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="d-posterior-distribution" class="level3" data-number="2.2.11">
<h3 data-number="2.2.11" class="anchored" data-anchor-id="d-posterior-distribution"><span class="header-section-number">2.2.11</span> 3D Posterior Distribution</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample for visualization</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>sample_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">length</span>(gibbs_results<span class="sc">$</span>beta), <span class="dv">2000</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>beta_sample <span class="ot">&lt;-</span> gibbs_results<span class="sc">$</span>beta[sample_indices]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>sigma_sample <span class="ot">&lt;-</span> gibbs_results<span class="sc">$</span>sigma[sample_indices]</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density estimate</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>dens <span class="ot">&lt;-</span> <span class="fu">kde2d</span>(sigma_sample, beta_sample, <span class="at">n =</span> <span class="dv">50</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x =</span> dens<span class="sc">$</span>x, <span class="at">y =</span> dens<span class="sc">$</span>y, <span class="at">z =</span> dens<span class="sc">$</span>z) <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_surface</span>() <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_markers</span>(<span class="at">x =</span> <span class="fu">mean</span>(sigma_sample), <span class="at">y =</span> <span class="fu">mean</span>(beta_sample), <span class="at">z =</span> <span class="fu">max</span>(dens<span class="sc">$</span>z),</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">'red'</span>),</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">name =</span> <span class="st">'Posterior Mean'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">layout</span>(<span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'σ'</span>),</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">yaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'β'</span>),</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">'Posterior Density'</span>),</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">camera =</span> <span class="fu">list</span>(<span class="at">eye =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fl">1.5</span>, <span class="at">y =</span> <span class="fl">1.5</span>, <span class="at">z =</span> <span class="fl">1.3</span>))</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a90e7029fc1e7555db2c" style="width:100%;height:520px;"></div>
<script type="application/json" data-for="htmlwidget-a90e7029fc1e7555db2c">{"x":{"visdat":{"2bda6d54a06756":["function () ","plotlyVisDat"]},"cur_data":"2bda6d54a06756","attrs":{"2bda6d54a06756":{"x":[11.708098668680865,11.952293058971588,12.196487449262312,12.440681839553035,12.684876229843759,12.929070620134482,13.173265010425204,13.417459400715929,13.661653791006652,13.905848181297376,14.150042571588099,14.394236961878821,14.638431352169544,14.882625742460268,15.126820132750991,15.371014523041715,15.615208913332438,15.859403303623161,16.103597693913883,16.347792084204606,16.591986474495332,16.836180864786055,17.080375255076778,17.3245696453675,17.568764035658226,17.812958425948949,18.057152816239672,18.301347206530394,18.545541596821117,18.78973598711184,19.033930377402562,19.278124767693289,19.522319157984011,19.766513548274734,20.01070793856546,20.254902328856183,20.499096719146905,20.743291109437628,20.987485499728351,21.231679890019073,21.475874280309796,21.720068670600519,21.964263060891245,22.208457451181967,22.45265184147269,22.696846231763416,22.941040622054139,23.185235012344862,23.429429402635584,23.673623792926307],"y":[2.4792434273053625,2.5012551133078422,2.5232667993103224,2.5452784853128021,2.5672901713152818,2.5893018573177615,2.6113135433202417,2.6333252293227214,2.6553369153252011,2.6773486013276813,2.699360287330161,2.7213719733326407,2.7433836593351204,2.7653953453376006,2.7874070313400803,2.80941871734256,2.8314304033450401,2.8534420893475199,2.8754537753499996,2.8974654613524793,2.9194771473549594,2.9414888333574392,2.9635005193599189,2.985512205362399,3.0075238913648787,3.0295355773673585,3.0515472633698382,3.0735589493723183,3.095570635374798,3.1175823213772782,3.1395940073797579,3.1616056933822376,3.1836173793847173,3.2056290653871971,3.2276407513896772,3.2496524373921569,3.2716641233946371,3.2936758093971168,3.3156874953995965,3.3376991814020762,3.3597108674045559,3.3817225534070361,3.4037342394095158,3.425745925411996,3.4477576114144757,3.4697692974169554,3.4917809834194351,3.5137926694219148,3.535804355424395,3.5578160414268747],"z":[[4.4025074491985937e-11,7.082379901379953e-10,7.3297362187161058e-09,4.9734680060092255e-08,2.3758848024422024e-07,9.5885509152619961e-07,3.9156211584531001e-06,1.4701101328043684e-05,4.2600254802230549e-05,9.3842428117001025e-05,0.00018388472471964125,0.00042215293979430891,0.0011876950460720467,0.0030228375104107523,0.0055494823789947701,0.0068463269732390612,0.0056841039723225803,0.0033290083830014448,0.0015473757681082534,0.00076650426708042407,0.00070067182781964718,0.0010488401082356577,0.0014062274822370558,0.0014828830529975347,0.0016238052946441703,0.0026117581101332715,0.0044794795031739224,0.0056518502229413346,0.0046891120130313621,0.0024941271938647919,0.00084533199949721519,0.00018230237940928745,2.5016668477445523e-05,2.1874122511490698e-06,1.2463335231697289e-07,7.6802729474014139e-09,2.5836299350702511e-09,1.1719967960985752e-09,3.498885641064858e-10,6.6355028808171992e-11,7.9849423268410684e-12,6.0968879022805914e-13,2.9538106024974446e-14,9.0801933218110617e-16,1.771110200492717e-17,2.191967648289422e-19,1.7213167466719625e-21,8.57680638282301e-24,2.7116200774002996e-26,5.4396684884296691e-29],[5.3388784098775012e-10,8.5140127980985369e-09,8.7445878724855269e-08,5.8097282943586604e-07,2.5853868730475732e-06,8.6485966479613967e-06,2.706465137316102e-05,8.5552886580084626e-05,0.00022964282682648194,0.00046996460774959448,0.00076899441919070673,0.0011476522869248904,0.0018376051156898869,0.003348856401022894,0.0057610736988120605,0.007757173798948783,0.0077925235181414074,0.0060501863102482229,0.0039491511635438093,0.0026101734058278339,0.0025353761264085579,0.0035682043977695124,0.0046250925162088603,0.0047088238530685845,0.0042667797661582003,0.0045927368882577348,0.0059795551257240676,0.0067953517898765243,0.0054587182971484122,0.0028900960358057264,0.00098858290528417748,0.00021741071476990645,3.0762920803345161e-05,2.8400536126806134e-06,2.3011465687085815e-07,8.1730278338343625e-08,5.6109751274715053e-08,2.6359364651348449e-08,7.878186247696403e-09,1.4941584750017891e-09,1.7980721152532216e-10,1.3729545738198301e-11,6.6518712731165868e-13,2.0448909770320362e-14,3.9887350779537834e-16,4.936725819883627e-18,3.8768745073117294e-20,1.9318083041010667e-22,6.1078781755741093e-25,1.2254569470353451e-27],[4.5517159491390965e-09,7.0535106992149335e-08,7.1818639284261317e-07,4.7172700999948832e-06,2.0255083052740085e-05,6.0518748559391033e-05,0.00014946296569880776,0.00037379478800950774,0.0008923228428533176,0.0017110153650717935,0.0025605437090405218,0.0031986998745627479,0.0036231434228889115,0.0043958245830215421,0.0066085489819774999,0.010164524122263881,0.012810706959175777,0.012480687930163242,0.0098282781411568199,0.0073602082111424933,0.0072420578192383877,0.0096032610117773292,0.011960163345111754,0.011982496240762502,0.010239996627861252,0.0086285451657931462,0.007884493201836637,0.0071171438803629399,0.0052419826743773899,0.0027688464070367161,0.00099181148177262765,0.00023621286897885122,3.7341254468061315e-05,4.393688199265151e-06,1.2572851803616569e-06,1.1748299410883026e-06,8.6382592199435284e-07,4.0679311314603957e-07,1.2159727780263542e-07,2.3063274183106736e-08,2.7756087450186593e-09,2.1195098011650495e-10,1.0269577576677865e-11,3.1572561219892978e-13,6.1589585869616175e-15,7.6233404976209741e-17,5.9872231055898861e-19,2.9837215867504078e-21,9.4369016008887082e-24,1.8974677023502971e-26],[2.9550863425468352e-08,4.0918090448798115e-07,4.0660478601890401e-06,2.6443923782327808e-05,0.00011145702784986171,0.00031347547539622311,0.00065563006316666909,0.0012743902034617024,0.002562364856977781,0.0045429620966601801,0.0063601053683841726,0.0072205812426353409,0.0071319853848048785,0.0072485466627513111,0.010032101017946637,0.016334493787139928,0.02248528969599279,0.023793997042021148,0.020341293820980388,0.016569031830797769,0.016852927380389009,0.021421640065795437,0.025522196298123943,0.025106040445490838,0.021223178077605067,0.016552845370522748,0.01231598798111788,0.0088350165304287784,0.0058372557497853939,0.0031576864528054479,0.0012511137063709247,0.00034048503338093557,6.3383075760862847e-05,1.2968322701890248e-05,1.108084156490706e-05,1.233925395558774e-05,9.1420108790977951e-06,4.3068612811687898e-06,1.2875638836282068e-06,2.4424325740237657e-07,2.9398109879320465e-08,2.2452209036044218e-09,1.0880322222280229e-10,3.3455518691275575e-12,6.5273649053173455e-14,8.080828605785059e-16,6.3481522930540981e-18,3.1659991816947793e-20,1.0062483532163563e-22,2.105903520245032e-25],[1.8278536102194593e-07,1.7787780095566724e-06,1.6091751235590163e-05,0.00010234782250295522,0.00042574446545136976,0.0011602151325596716,0.0021986531099481075,0.0034578143867041913,0.0056321725039600199,0.0090468266007453363,0.012043004079985827,0.01287966838249175,0.011995481493982826,0.012045267203954308,0.016820498923100186,0.026897178758727248,0.036551548469805149,0.039318871049219918,0.035556808047120428,0.031655870600530302,0.033709885267901862,0.041257714625847118,0.046789668369070787,0.044793942700633714,0.037437068165477497,0.028589519785921624,0.020062898826163255,0.013308264269461207,0.0085276379887753231,0.0047778363691699495,0.0020171357299680033,0.00058759274963928214,0.00012626549589956728,5.5628336350817366e-05,7.772553614916374e-05,8.961019721060759e-05,6.6495094446372089e-05,3.1335099195683701e-05,9.3703404025955511e-06,1.778008138630229e-06,2.1407308007325039e-07,1.635459614948863e-08,7.9280710196369977e-10,2.4386362808360579e-11,4.7597894654145048e-13,5.8959256588615841e-15,4.6398738415242972e-17,2.3399591777996185e-19,8.1100564350322058e-22,2.8871681937843761e-24],[1.3244253818701021e-06,7.1087053018729944e-06,4.7331621965653369e-05,0.00027733834107321835,0.001127534565250091,0.0030125440655599635,0.0054105077857765499,0.0073719641291685864,0.0098143551435603115,0.014179146737811354,0.0185430237060643,0.019772464909117469,0.018487033405831816,0.019451956374045648,0.027770754173034512,0.042651464730593856,0.056032096805609881,0.060768334978846122,0.058282852811021975,0.05635687873181866,0.061237335920280231,0.070858397788808897,0.075770197476691892,0.070032929311925757,0.057241437308459472,0.04286266074466942,0.029611561579242128,0.019506017381872767,0.01250199374479829,0.0070209310570606758,0.0029840923129459572,0.00089756047555261231,0.00025128370576190344,0.00023508571060443484,0.00038709741380919002,0.00044937998974800585,0.00033358775676726841,0.0001572725528340743,4.7057117398996178e-05,8.9345851978782109e-06,1.0764391309583018e-06,8.2294197928431658e-08,3.9922477364800239e-09,1.2290171282058771e-10,2.4018405387500489e-12,2.9873087087312308e-14,2.4113298863238832e-16,1.4567408008868625e-18,1.1579267712584063e-20,1.4956455204882074e-22],[9.4802233460931127e-06,3.2993344734466038e-05,0.00012529983734183418,0.00056032493579519899,0.0021084492284321652,0.0054867703376528772,0.0095617602558514328,0.012038420145827273,0.013960478164583231,0.01882710036635651,0.025622675114724949,0.029444269266239411,0.029562937136593109,0.032281897038430367,0.044546883042646146,0.065064707836443025,0.084193298029655861,0.093895100632545705,0.095533728544242622,0.096832075079302887,0.10284327299236858,0.11038915961658764,0.11063024486663324,0.098729063879260837,0.079174767923931577,0.058605348874815832,0.040525305694310433,0.026748151095870989,0.016796001414292151,0.0091790345394929737,0.003939818789297474,0.0013349270749361019,0.0005902552561370916,0.0008091975626266704,0.0013555706520592139,0.0015679266008773397,0.001163611383152772,0.00054906195220009188,0.00016447730104254512,3.1269847019882383e-05,3.7726846951619768e-06,2.888566503841407e-07,1.4037149503144787e-08,4.3332957999454431e-10,8.5488402058855111e-12,1.1255071858667276e-13,1.2869256928966505e-15,2.3343299683024538e-17,5.4905273955734474e-19,9.8362382984685772e-21],[5.2699077810753234e-05,0.00015665615379578432,0.00038112341059243833,0.0010235027656398522,0.0030168396619471398,0.0072718895223212636,0.012348890888430232,0.015182003316457703,0.017067339449426934,0.023553551996591218,0.035093877481522581,0.044911286497437024,0.049153174893377637,0.053941488246211707,0.06852039046949529,0.093934712221458785,0.12145331296848506,0.14101380323622709,0.15018975929815659,0.15406331453774205,0.15686806173417589,0.15685642316664861,0.14877711435153082,0.13014460486947144,0.10492131805581517,0.079033227192066902,0.05599058807351058,0.037354034971914231,0.023141707761452558,0.012838475133977699,0.0062463526025213021,0.0028310508720761265,0.0016957465843149334,0.0021752446175684614,0.0034020643516066919,0.0038749471825537344,0.0028703897445237735,0.0013562167782912261,0.00040717744118249065,7.7612717699138267e-05,9.3908123672537037e-06,7.2146215748857892e-07,3.5267221992456892e-08,1.1122005883947961e-09,2.4775688943298029e-11,5.8771459459761492e-13,2.2687881765594152e-14,8.9600004266883512e-16,2.5205946886976945e-17,4.6625804561874846e-19],[0.00020776552038160537,0.00059063134844323498,0.0012087973331886756,0.0021424204053909469,0.0041053863939456061,0.008042993687378576,0.012994274965668851,0.016530152081350835,0.020432289924117879,0.031091070339667282,0.04963398601497105,0.067682142772836587,0.078084282127031196,0.085425329167347117,0.10059754325592603,0.1288233046717277,0.16498475595224957,0.1969149048095776,0.21518783279149875,0.22039888803081592,0.21767201763442529,0.20846555144450746,0.19183465642262143,0.16814873006952485,0.13939007492699945,0.10866200482349232,0.079523195485683221,0.054670741525492408,0.035549302770891064,0.02226570220753879,0.013459161782288693,0.007758878004358323,0.0048538751700527615,0.00479190644284418,0.0064268444035920731,0.0070371564505375319,0.0051744120916926966,0.0024470150582567469,0.00073720708768857334,0.00014116706374347516,1.7183553247368817e-05,1.3357764228782122e-06,6.8326901540132739e-08,2.7246536957808975e-09,1.3987797313745948e-10,1.0231941314497012e-11,6.4628990376031491e-13,2.8277412989049032e-14,8.1533742243004729e-16,1.5237105470774423e-17],[0.00057339588516638505,0.0015932815020696391,0.0030932162830164967,0.0046460698244120933,0.0064574754889889742,0.0095567164320736891,0.014174458342230812,0.01946106160491488,0.02758988374557458,0.044345833135921116,0.070211708346969312,0.095903293145685714,0.11294609332013178,0.1248653351343884,0.14258435898352884,0.17354239780174718,0.21606819444981024,0.25749441796029143,0.28296346815521278,0.29030614714716868,0.28630896990004245,0.27282715647379557,0.25020348051755104,0.22172790950491889,0.18780148642723596,0.14905051792576174,0.11106470628400703,0.079488987225818999,0.056590426631008689,0.041042105205536215,0.029081056207344049,0.018903736217373193,0.011858793688535752,0.009305521581686578,0.0099775753262369878,0.010032508882502037,0.0072024733757178388,0.0033917622398981148,0.0010248338256322838,0.00019776062656122448,2.4568643275752015e-05,2.0814122358896206e-06,1.5693381591333549e-07,1.6686683828483373e-08,2.0914550254656313e-09,2.0574929916877507e-10,1.3905833433825558e-11,6.2287587714069123e-13,1.8180887445521912e-14,3.4218851094319401e-16],[0.0011414174804438375,0.0030389196898476735,0.005718468878092426,0.0081607492149375835,0.010120434082227374,0.012923882402292527,0.018180323033708014,0.026598125923725457,0.040204301206396106,0.062999511708044131,0.094201852410266948,0.12527377125718089,0.14938404635014632,0.17029428141016473,0.19678836016830115,0.23352771008005599,0.27908768272075807,0.32304148899945101,0.35151577007336948,0.36376832421381761,0.36650871075748814,0.35635045438983048,0.33050798416603611,0.2947443198841922,0.25044506934351873,0.19860746923980416,0.14871137955035965,0.11007635360535231,0.084611717881972803,0.067629481883427434,0.052138326040201521,0.036166424122426738,0.023283271504946752,0.016351030406396783,0.014137606347021853,0.012350877046467531,0.0083448541897697716,0.0038428036105048508,0.0011583239653729014,0.00022936272724915894,3.2708466167229133e-05,4.7320081444010342e-06,9.4935516304691795e-07,1.9158417985121659e-07,2.8930338741451382e-08,3.0030711110419699e-09,2.081745606939332e-10,9.4661836349111961e-12,2.7883739935917304e-13,5.2765213416164136e-15],[0.0018059346058506348,0.0042917220989544458,0.0076003208579406289,0.010570865764497346,0.013027428131474008,0.016644226469749012,0.023911334445565969,0.03661108579049642,0.056057877849581751,0.083496211722021041,0.11736603581680249,0.15258821990634894,0.18602877219770281,0.22128770100755837,0.26229176270350568,0.30637647480461183,0.34979814099407702,0.38799161411011701,0.41473583786253859,0.43253990957699223,0.44505274150539109,0.44189021380978222,0.41562293214583279,0.37294579487950702,0.31808132189046401,0.25367455152159324,0.19166289207100506,0.1448941100659957,0.11569886953789488,0.096252993945210252,0.076668137279255019,0.054957500552987301,0.036642675723885625,0.025401624285476414,0.019426334224109391,0.014536968852756939,0.008804267231119248,0.0038260792343356416,0.001156604117796867,0.00027211425195089331,7.2094950885690748e-05,2.4935704616262887e-05,7.8353206386611303e-06,1.800257525703332e-06,2.8546495400593176e-07,3.0491935835987309e-08,2.1532447287892873e-09,9.9058892394203518e-11,2.9384448199952779e-12,5.583442366066806e-14],[0.002682411221077131,0.0050991698284714743,0.0077967575933781544,0.010405306292568731,0.013694334990818227,0.019507819696587415,0.030145583375276772,0.047697241812999364,0.072663672321491804,0.10356168482301115,0.13917428323727765,0.17960280208641669,0.22501531813016273,0.27664439860640333,0.33144328236319759,0.37832002179393376,0.41239955567339359,0.43859418257423355,0.4604664659692087,0.48086788165970568,0.49862870469657589,0.50082377741056117,0.47788087076896818,0.43528814115871989,0.37876403757238158,0.30982500434479221,0.23880900830209464,0.18242169135148878,0.14660738286471181,0.1224170963185177,0.097787352787189946,0.070638142851640329,0.048217272948320317,0.034542833820460965,0.025895042216790433,0.01760774838663183,0.0094866279442304604,0.0038495279360215759,0.0013191363392076126,0.00055317312906867091,0.00030043423871101426,0.00014341083398204882,4.9752080382720751e-05,1.1981379365480023e-05,1.9619333417322502e-06,2.1431299604966102e-07,1.5357311644087969e-08,7.1291988308302243e-10,2.1261753922047582e-11,4.0526616436422257e-13],[0.0039772320680246057,0.005969175918163607,0.0072253115415257486,0.0088951058251834306,0.01338604246028767,0.022615927436519773,0.037778252218362444,0.060228318075757126,0.089834132078624354,0.12407489018964102,0.16326848313350156,0.21132184463745166,0.26867696571602318,0.3322033987960738,0.39224107034571437,0.43237073628141909,0.45100828398979209,0.46452154384569944,0.4832964852850391,0.50529869049100962,0.52413043737855558,0.52965934039076212,0.51357924430981994,0.47876752154425634,0.42962142663700348,0.36361534352394392,0.28682129610359636,0.21964693800224741,0.17465524094260917,0.14466415713639166,0.11551534371621285,0.083446629944010933,0.057219357386449982,0.042344249016990007,0.03285158053296023,0.022110451657635883,0.011477505238553268,0.0048777980725244032,0.0024227370402599723,0.0017276747006704511,0.0011925670853590745,0.00061550467430532502,0.00022319344795136922,5.5648123216221175e-05,9.3545780757956438e-06,1.0404403339716109e-06,7.5417154728838283e-08,3.5254739619609571e-09,1.0557284679584652e-10,2.017061019304326e-12],[0.0051156051403596506,0.0067575547978598422,0.0068431760861206717,0.0079349854454321151,0.013964606554395737,0.027091601298194479,0.047535711194749281,0.075043951329297559,0.10822945835974591,0.14553418864324011,0.19033573924911612,0.24755376642916999,0.3140267957515866,0.38125259697761521,0.43550842645996685,0.4604967699084529,0.46242687165149277,0.46848923006029397,0.49107288648189795,0.51927170145776425,0.54096520102939116,0.55017991880377282,0.54144356827272277,0.5151550216454206,0.47392775093641709,0.41295004810036562,0.33380324949396645,0.2563980227983173,0.19977219037361754,0.16300688585019313,0.13115334836593581,0.09588003094042849,0.065529055096182356,0.0485477516229572,0.038740909564513849,0.027164531330972883,0.015157092252444713,0.0078950244728542059,0.0055330052882329598,0.0047669947592911032,0.0034893966672156877,0.001867588894544173,0.00070058612886985793,0.00017978465377512746,3.0873622031976384e-05,3.483034852717512e-06,2.547193107006704e-07,1.1970495073475231e-08,3.5957547676333774e-10,6.8822272203272683e-12],[0.0049477768976429696,0.0062956914132823389,0.0061713160441870208,0.0078150358058655146,0.015877347974876218,0.03295376221032608,0.059114915510591615,0.092056665155588899,0.12754960924963032,0.16559317253953298,0.21432630779025749,0.27882208787036261,0.35083469851424315,0.41656767023820784,0.46028519669816875,0.46958115037683773,0.45992009431363279,0.46641653713900122,0.49971630511550069,0.53872242896194289,0.56520222737192494,0.57643220910724668,0.57065257175744832,0.54777094904554302,0.51076844373553798,0.45620413047473962,0.3805366812000105,0.29586664659488832,0.22483786537671338,0.17798474130501959,0.14368880971817108,0.10749900107774855,0.073543305382358468,0.052637050409269352,0.041634200805980348,0.030971981456721909,0.019917595381203856,0.013055059087092293,0.010860590187425715,0.0097602618245645426,0.0072642124947589421,0.0039834793111783529,0.001535229844266039,0.00040315573456111038,7.0397332591133437e-05,8.0291947606002869e-06,5.91151015717584e-07,2.7892270877353434e-08,8.3978903537627122e-10,1.6094881830946064e-11],[0.0033836737724480558,0.0043610885747664037,0.0048010480814901111,0.0080064005071975239,0.018682002018400302,0.039767706080496699,0.071294843942247041,0.10879922063553003,0.14474726769947618,0.18019469278535721,0.22793571964756276,0.29427183700212012,0.36850529623546968,0.43343714481114776,0.47154019991814561,0.47390196458269657,0.46259312121945523,0.47632045838670928,0.5221835854743303,0.57020015613532904,0.59703260787240187,0.6033282293727007,0.59288263587016765,0.56821449993224893,0.53420888174384207,0.48858166993109681,0.4212001476146453,0.33305770162558013,0.24785008405851783,0.1890167448359121,0.15177916297773247,0.11647528839853906,0.080222510235447145,0.054379473516350106,0.041110822069088122,0.032427515390543574,0.02425288719418826,0.018635974064152357,0.01634109462579917,0.01449755025855747,0.010749171215458757,0.0059715469100115985,0.0023451751315602728,0.00062633710916699568,0.00011072704016439206,1.2731647278509045e-05,9.4205641346474158e-07,4.4581008060846403e-08,1.3445772324287727e-09,2.579493177770837e-11],[0.0016152522195722286,0.0022490649141443872,0.0034066610263380225,0.0082923559403207028,0.021492635093593181,0.045846911432564315,0.080512854243318943,0.11942674555624314,0.1538332692578275,0.18513629084581895,0.22773598539473019,0.29004350335972723,0.36359967658573966,0.43088417466150086,0.47242153099950451,0.48027419472001676,0.47801999164801512,0.50274709192701938,0.55769819153804356,0.60815704828914396,0.62882401221326301,0.62387121688956459,0.60272539035170702,0.57228598110624374,0.5395846445433663,0.50114477878054575,0.44125401310195239,0.35351220072206613,0.26086037861979228,0.19456507991985186,0.15605064751565706,0.12290350961201973,0.085762009906327055,0.055364965236980222,0.039171558407799976,0.031826598663537022,0.026292990055885302,0.021594635373441695,0.018582784488064236,0.01571780585798576,0.011359565988560239,0.0062974784204753711,0.0024947655337355934,0.00067318893847093477,0.00011999484974462563,1.387524427404757e-05,1.030334055396805e-06,4.8863633360830906e-08,1.4756206762611191e-09,2.833012355515686e-11],[0.0005591601925727034,0.0010228863011962584,0.0027085317163669416,0.0087356583763437724,0.023363510228208824,0.048623888452737511,0.082338152786751009,0.11857193165442687,0.15037047152349592,0.17841979043935777,0.21460461446855311,0.26943272278186942,0.34026211594534511,0.41195522109653188,0.46382572606239147,0.48704700373086646,0.50186434575552841,0.53851309624234511,0.59629353738937996,0.64215517793065413,0.65440406429969733,0.63917160382104643,0.60672078231816395,0.56668291157808981,0.52883560495352733,0.48968026676503235,0.43306891108800216,0.35098190017593639,0.26193952274530014,0.1956616492704597,0.15715937346012285,0.12586813168488409,0.089562807106833425,0.057309396030879027,0.039086849867342705,0.03158190930349785,0.026477086410882908,0.021111526898389268,0.016613069391047983,0.0127657853892166,0.0086818636954739525,0.0046921838329837496,0.0018493308637135785,0.00050033950559923114,8.9551753214870029e-05,1.0390926425500493e-05,7.7350894696612582e-07,3.6745946415546601e-08,1.111028444254256e-09,2.135132681432617e-11],[0.00018607591918585182,0.00064776042804144088,0.0027035215928779797,0.0093238952519328795,0.023974773322626777,0.047325297645586385,0.076513957086346326,0.10781891903831398,0.13764911120910123,0.16478100860446407,0.19585670261489804,0.24237909132171059,0.308598517161497,0.38425238302826781,0.44947733855651939,0.49369236626512569,0.53009895220486614,0.57772225371267405,0.63165123327098116,0.66671013439144011,0.67063148705349107,0.64964381046413067,0.60889836724219104,0.5572960610009946,0.50774239972697133,0.46056259770695862,0.40519572114516295,0.3352100954488258,0.25950745600228603,0.19726704573737247,0.15568132474597368,0.12290344511943323,0.089188245492007351,0.060137076169204724,0.043235616790791,0.035215046400171084,0.028287465163297467,0.02031120520973834,0.013449017418789842,0.0085670206403682739,0.0050626264108695933,0.0025313606137992209,0.00096579451920773005,0.00025885437515067326,4.6328264551492259e-05,5.3937752805739487e-06,4.0350177084441889e-07,1.928998400184516e-08,5.880522668091867e-10,1.1425922656732941e-11],[0.00015325138034727584,0.00066003456088504998,0.0029177478883776376,0.0096619108342699614,0.023437748250421702,0.043921139337875656,0.068728831591715847,0.096696131101533564,0.12655632170456255,0.15503388705928189,0.18350425018390548,0.22203759058869058,0.28008468282142501,0.35495287808091397,0.43132688491148091,0.49702429400182696,0.55501934588298507,0.61031046778883113,0.65512104328871756,0.67598451376896274,0.67130455513091014,0.64603766997229972,0.59907066548093746,0.53738813450643153,0.47642727798648804,0.42192035898607672,0.37065175719125748,0.31787353864345408,0.26070510800109492,0.20374538215833185,0.15526954910744989,0.11675674307971536,0.085730487834086627,0.063385717241843983,0.050532640181046008,0.042320579083657245,0.032854136524236278,0.021783415663395426,0.0123676190216174,0.0062120476178901748,0.0028169117273271036,0.0011493177370514561,0.00039669307741296795,0.00010419137026344197,1.9117033962410585e-05,2.3432905867509358e-06,1.8850364262539331e-07,9.9000198490002048e-09,3.3933186995987441e-10,7.5973253640644894e-12],[0.00038531763517804984,0.00086330091616233697,0.0030321742642874013,0.0094491380986046793,0.022301631558868721,0.041619605636383103,0.066229236440413536,0.095243746587343373,0.12666993212904182,0.15676973635689143,0.18459388482425576,0.21615246988303669,0.26193321129891967,0.32778159870250656,0.40674740818791277,0.48659625543548962,0.55896720447160053,0.6151888653674572,0.64777373218008361,0.65532875943652913,0.64305000714603333,0.61357638020583471,0.56238032320174147,0.49547311357585172,0.42998706273918746,0.3760966817541343,0.33484345109148617,0.30095211042176107,0.26285425419130642,0.21365111418783775,0.16041600820997384,0.11545870898233508,0.084983195442164719,0.06731290118225218,0.056592364585744202,0.04707263598851353,0.035703674944952433,0.023375267761584752,0.012924506285433552,0.0059452308471055655,0.0022923033658237392,0.00080956303099461206,0.00028325324773560321,8.75977912669413e-05,2.0088595459108214e-05,3.1100842812476954e-06,3.1397949655054445e-07,2.0413784624473929e-08,8.5020175392925583e-10,2.261698692066317e-11],[0.0012260687436406481,0.0015691831464360081,0.0033983385680374078,0.0093719282732268767,0.021943343833620996,0.042540650649765838,0.071191643533132093,0.1045963033555713,0.13747375182890731,0.1678306887007282,0.19624616035698472,0.22348283008357966,0.25645555441081286,0.30703897044381084,0.37721460549724933,0.45682435869341631,0.53001901960067321,0.57950412023292019,0.59975078090321854,0.59737063289605608,0.57989473017279247,0.54862351126009201,0.49856695623571073,0.43417717084436291,0.37272995294796946,0.32771490429900008,0.30050498546312188,0.28248135149153031,0.259051052056464,0.21965211868267923,0.16834044885904081,0.12070170974238846,0.088934096399986062,0.071116060379746188,0.058112307365424207,0.045342482742742142,0.032899017864723719,0.021704023340036051,0.01255996186807703,0.0061931476780674455,0.0027864088717611019,0.0013494026267363451,0.0006583321288599124,0.00025043321767601907,6.4290158900637341e-05,1.064616025654543e-05,1.1237848688978264e-06,7.5382642395863527e-08,3.2105414872405968e-09,8.6791289008130403e-11],[0.0031627523412467934,0.0033572284860189784,0.004817370455399002,0.010634160932703134,0.023352771228563024,0.045332896519292086,0.07759359244846542,0.11470749537166115,0.14851487444520955,0.17905522082531886,0.20927045879901907,0.23532092498639942,0.25888395495260141,0.29410949441122153,0.34875089631431916,0.41524917683393037,0.47685853305340475,0.5156351596544646,0.52772771891142478,0.52071600629151549,0.50081001876723108,0.47053833781682403,0.42732610189041942,0.37308391699626997,0.32254244320232517,0.29006362173014055,0.27475057428359051,0.26416929147514617,0.24618964012522762,0.21387659674738249,0.16853188428109422,0.12300234271360874,0.091209992176578117,0.072011403438495158,0.055826498732745214,0.040098765348506947,0.027372227572533613,0.018143021798062712,0.011233197223884253,0.0064902259977308221,0.0040738933385856,0.0028267889390103207,0.0016485762107040873,0.00066437801624666989,0.00017355955305830932,2.8917757113511358e-05,3.0610271639941947e-06,2.0565864626312077e-07,8.7680540432130536e-09,2.3719744798452991e-10],[0.0060054963386746889,0.00633707653794851,0.0077552638652602967,0.013775022893237456,0.026129852196674633,0.046619470216932121,0.077419398669802797,0.11439764145647448,0.14934576346225195,0.18195877488459081,0.21445832547858104,0.24004794689902348,0.25757981927149137,0.28214913092006216,0.32358265049478396,0.37450389426938835,0.42014327575338106,0.44815846336327936,0.45759620829589753,0.45219497762532745,0.43319200143584025,0.40487922810093618,0.36979164009005216,0.32924515464582643,0.29328956211273971,0.2722336969810164,0.26136873689440315,0.24775155460218842,0.22601969771561761,0.19550567045420633,0.15533164290929816,0.11407169304743382,0.085021904133462986,0.067431561844340557,0.051802229906703932,0.036518542990079672,0.025118284042845353,0.017600989585073824,0.011858260531077445,0.0079186117781063457,0.0061791238412824603,0.0049544502959941615,0.0030365115703337164,0.0012399957349103852,0.00032502114266507305,5.4201802977652365e-05,5.7389515148941217e-06,3.8561750110857689e-07,1.6441269445763358e-08,4.4479148100162897e-10],[0.008480502122010479,0.0096564667192755582,0.01181532035728354,0.018367290751236783,0.029577490728825696,0.045767552819509318,0.070521121009680984,0.10381449538771609,0.13957743972288528,0.17479048184387744,0.20791157403690555,0.23082464228471253,0.24312837502184048,0.26181690451421907,0.29700634722541919,0.33838890058550419,0.37124231385444689,0.39017566256361341,0.39938499929165944,0.39910784885950762,0.38436939464077302,0.35901637431526418,0.33033262639496891,0.30185837191172527,0.27912289666800244,0.26493666685151651,0.25121657659072655,0.2291221704690726,0.20142984581389078,0.17141787727162672,0.13510844028161798,0.097456967281758886,0.071554584211231856,0.057739540801287986,0.046571330438290606,0.035623009316984887,0.027714271697987479,0.021938881323219219,0.015836804731436338,0.010688418581540821,0.0081462453056648561,0.0064181660288903089,0.003910093579688005,0.0015940135770086956,0.00041760981063300451,6.9632125465705113e-05,7.3724128972616108e-06,4.953686417890238e-07,2.1120629958716913e-08,5.7144570566120467e-10],[0.0092736813475105748,0.011918613514482796,0.015566892239088217,0.022891039357144764,0.032970264051003943,0.044940900522343202,0.063259378089685819,0.091485954211299986,0.12589216526209726,0.16102388535446321,0.19158492403142111,0.20894913624265266,0.21485071498679709,0.22851021014964851,0.26027386364902849,0.29716212089970306,0.32339529247670024,0.33804453581072857,0.34916116802651115,0.35502608133654379,0.34656539419654669,0.3256858054571955,0.30140400789810917,0.27970936922249556,0.26354862587781286,0.24994555359684903,0.23036340252478207,0.20230373088176068,0.1739738817020072,0.1482005931786714,0.1169986857206432,0.082319319763110813,0.057863346810311328,0.04690270534420557,0.04096991214848731,0.035605611933955394,0.031640858478849634,0.027377297922605844,0.02036027418552808,0.012984986721194204,0.0085297208650838095,0.0059948667632761642,0.0034993304681374747,0.0014091575085559997,0.0003679483735984343,6.1295527521680664e-05,6.4881158532905031e-06,4.3592129726088101e-07,1.858888713020859e-08,5.0701314314543205e-10],[0.0081400640008350046,0.011964760227083523,0.017009397244093664,0.02502083784824664,0.034665976099541564,0.044547974111152029,0.05859841445961575,0.081473291820914104,0.11140288799790836,0.14284323395870388,0.16858012017183507,0.1793896047682082,0.17816180427231409,0.18471198554396373,0.2097627080046045,0.24150224305803447,0.26584718723888218,0.28341952963879041,0.30114994117019844,0.31418240744333026,0.31178876643399245,0.29542301764175122,0.27432995803125942,0.25502319666660972,0.23910338649706023,0.22196229377679375,0.1976629305597557,0.16916870437963527,0.14592424109193686,0.127606931619236,0.10336444111599163,0.07276692418550354,0.049266492690137345,0.039475634524766337,0.036891857363561459,0.034956120503882686,0.032534188979149212,0.028488001933524871,0.021152283747436305,0.012782160831040505,0.0070794007131789018,0.0041238240718283782,0.0021978652254853624,0.00085941613302262438,0.00022252266682920357,3.6982086617067745e-05,3.9119706266351273e-06,2.6286040939609083e-07,1.1354348683506855e-08,4.9276232188789691e-10],[0.0057679126088467075,0.0096691221135175674,0.015241984032763122,0.02357157047470481,0.033284508712844538,0.042575633715491709,0.053757178314731084,0.070938665923117206,0.094159094436892771,0.11959786657042645,0.13997643032200813,0.14593762542819921,0.14010254658028237,0.13984146315668453,0.15510484982887232,0.17872049242494145,0.2018418398253897,0.22515886608160282,0.25087874392742848,0.26989066727906558,0.27130310982361172,0.25853115973582014,0.24168161492728382,0.22580250220389128,0.2103599209050652,0.19087803986866508,0.16464203710024164,0.13822259930505912,0.12064194247064902,0.1090793292792627,0.09194586667796012,0.067067474747290301,0.04579878945365478,0.036209513593855255,0.033957506632895554,0.0318942622610211,0.028221068412280205,0.023381285313726866,0.016901708859081262,0.0098474278934852048,0.0047545297369695882,0.0021985271510998445,0.00099565625811883461,0.00036501251461799438,9.2633757745369901e-05,1.5306075707851957e-05,1.6171137494250726e-06,1.1088031401629019e-07,9.2827902787458461e-09,5.9710436807524262e-09],[0.003243503048969136,0.0062892221266030437,0.011471270733854181,0.019639408274471672,0.029309251338892322,0.037902373436279432,0.046018254569896187,0.057290931994436509,0.073411963476402886,0.092416770086784977,0.10823091741858142,0.11289068417157162,0.10803224642055831,0.1056608842274325,0.1131260896729506,0.12868997921428704,0.14934518947264058,0.17469898319432095,0.20233844561073078,0.2212549757827306,0.22228797195200595,0.21162532849844867,0.20052370377900025,0.1918809556121519,0.18174941829918259,0.16437453230723795,0.1385904800544708,0.11360550660688883,0.099325740865963935,0.092424322053901331,0.081377989105216639,0.062686040561543255,0.044659288680602982,0.034448314969292196,0.029702723943281936,0.025190058627415853,0.019827794947134787,0.014835050722896257,0.010201866848563387,0.0057935601438746862,0.0025695219742402743,0.00096006778630761266,0.00034281418239245003,0.00011038975894255351,2.6736616567495952e-05,4.3580453311166176e-06,4.7389388641312796e-07,8.0398269721005006e-08,9.9615915723540751e-08,1.234500566222308e-07],[0.0014402597283644971,0.0033981261102700631,0.0075962904492842013,0.015013239782204953,0.024172188238314605,0.031564654591122475,0.03634424573274922,0.042157015813691863,0.052349417095144735,0.066445497520553662,0.079674225264328935,0.0860763998935824,0.086354800842389265,0.08683573400348539,0.092088522302746792,0.1045057958331122,0.12388330366338682,0.14671584964244433,0.16793123741742264,0.17885681832625261,0.17429850872101679,0.16253823732289036,0.1552427076938131,0.15410628022135697,0.15220308030917976,0.14069899746189965,0.11768787846689548,0.094230426365354517,0.082182992997945806,0.07859250048687498,0.071892893767635135,0.058207011221649695,0.043401999430621813,0.032287480365364794,0.024066991432988086,0.016984747915593557,0.011180166211118479,0.0072190282841335818,0.0045887975161123693,0.0025358908720061468,0.0010764102142017888,0.00034780288435311968,9.6040535894566104e-05,2.4880764596586595e-05,5.4495630779184743e-06,9.0329842208986891e-07,3.1955078210996674e-07,7.2449879095419179e-07,1.4219120399584919e-06,1.7847532195513933e-06],[0.00052332816717032065,0.001618818190373365,0.0046096803689249328,0.010718041978647591,0.018952393234895535,0.025467757517331279,0.02811862202217422,0.030173958650124819,0.036458126171065669,0.047844515403549871,0.060001270618906463,0.068052046108642475,0.072565791269761537,0.077019085273914115,0.08486326392234253,0.099982639979557544,0.12039477558548889,0.13812867345587379,0.14827800941071109,0.14779382529942617,0.13591308988273179,0.1208994630069474,0.113432543114681,0.1157409171887875,0.12052636289944971,0.11638214566789069,0.099286995976121534,0.079988038617104948,0.070767438819167458,0.069008672724665113,0.063986782971034509,0.053068728270238764,0.041030822273576899,0.030055640125516082,0.019773202784795097,0.011261358033487205,0.0057312106108930285,0.002885099212752529,0.0015610370956265676,0.00081254862961951761,0.00033493493061365477,0.00010009494474750165,2.2689609795004523e-05,4.4864134421018788e-06,8.7179558585796172e-07,5.824691844526461e-07,2.2946620632063224e-06,7.1187524442117669e-06,1.4083165638571614e-05,1.7679929266516162e-05],[0.00016948693173966927,0.00072624529942462998,0.0026367198176418527,0.0072389613639576448,0.014391551694885511,0.020859567470581833,0.02357589174561368,0.024593809638363689,0.029185138954183912,0.039039662128619902,0.049691129220836225,0.056639366030611683,0.061246675221374051,0.067220746492670069,0.078252886661417428,0.096946845873980031,0.11708723685585622,0.12791760360936752,0.12778451205296026,0.11987667516150775,0.1054593743128437,0.08954195446182231,0.08033103063066141,0.081726438103385368,0.088906711756117932,0.09074783000700988,0.081715980239757374,0.069518973074275028,0.063858208323649066,0.062561518905964161,0.057319786216601006,0.047548926694067968,0.037904115705960896,0.028638423633472628,0.018547646900025909,0.0096599777899817867,0.0040405922611880824,0.0014354342884228329,0.00050855116280857369,0.00020321406041721391,7.6373624662010115e-05,2.1647043501605073e-05,4.3730506223848718e-06,7.1533246039590825e-07,5.0162448445537569e-07,3.1636800172799492e-06,1.5490977139743091e-05,4.830080576314169e-05,9.556469846827067e-05,0.00011997167789750219],[5.6103563662375931e-05,0.00033327778612774552,0.001507182616626624,0.0048505104647440728,0.01093829322115423,0.017612040932945005,0.021680312929907783,0.02380510500178119,0.028278661815739153,0.036668912962030578,0.044720476819818007,0.048512438124452051,0.050274444013919485,0.05486358561636473,0.06612362173196433,0.084045715762380097,0.099734434715600714,0.10361472591893224,0.098201310644330672,0.090027341372575231,0.079217498769661915,0.066191648740073161,0.056526658938288725,0.05543718974518292,0.061111022626791217,0.065264713035623617,0.062871187845572982,0.057822431105109186,0.055678721489300871,0.054854445371414658,0.049935136114009508,0.041593797911415056,0.034337451239347332,0.027610961818623426,0.019104170054185698,0.010461404587217334,0.0043757652773529871,0.0013623844634423968,0.00031928861223337075,6.546927527122234e-05,1.5007164253947097e-05,3.5197669721937467e-06,6.5536650581743968e-07,2.4154192646099729e-07,1.9008899432755321e-06,1.4652024089527817e-05,7.2001306393514012e-05,0.00022451543252402791,0.00044421165354064062,0.00055766219037220986],[2.4541163666680883e-05,0.00018777827275099496,0.00099029404593024991,0.0035399522384341898,0.0086658784817791913,0.015088889772775036,0.020247904813864012,0.023939788606021483,0.028654909727374445,0.035283374897175673,0.040521643670595978,0.041409039771844187,0.040398721339238872,0.04278961496286901,0.051785165739930639,0.065008883110101306,0.074137929628882243,0.073793169665418476,0.068677570413927594,0.064172800357215704,0.058020057277481919,0.048294827114649969,0.039478980915174273,0.036829337498103625,0.039812896362583249,0.043135897352390554,0.043575175112186892,0.042737285671541669,0.043039624110593984,0.043298678268179888,0.040209277756363467,0.034552697038178107,0.029935734247701996,0.025566803793024031,0.018790766748756807,0.010837226740105581,0.0046864531008262251,0.001457588475856846,0.00031397519858672787,4.6604927982431569e-05,5.2551361214908818e-06,5.9483352348109138e-07,1.0217629849801615e-07,5.0216465513395237e-07,6.0239560422600017e-06,4.6650723354472372e-05,0.00022925912833335647,0.00071487958215773757,0.0014144143412271792,0.0017756522001742801],[1.9221910678167097e-05,0.00015899455078455073,0.00086078697228826519,0.0030849705673123913,0.0075380054633810197,0.013320605217388832,0.018699222162311735,0.023241487329332414,0.027824146801922467,0.032672261441807814,0.03564920545177757,0.034771209666789309,0.032278319172032638,0.033176878000025285,0.039747150317952111,0.048261208024435752,0.052489432971531462,0.051226643589151057,0.049054507337668557,0.047830586069048019,0.043654979270511811,0.035186107239114812,0.027252346644998152,0.024280012406568092,0.025489894270128682,0.02728973981998755,0.027889639703116045,0.028225491516881585,0.029408724467529093,0.03051054541223315,0.02959342941273943,0.027182649992288165,0.025302350312807319,0.022670569760585475,0.017014791327481391,0.0098302857080841532,0.0042066173147378184,0.0012862996524475477,0.00027041193503765312,3.7943133119825329e-05,3.5251019998085629e-06,2.2943894440783959e-07,6.8475968408275175e-08,1.0770435268155423e-06,1.3137395422569916e-05,0.00010175102982874715,0.00050004325028434277,0.0015592431064140743,0.0030850172068623825,0.0038729228284118795],[2.0836740386664051e-05,0.00016902832264667497,0.00088441544619000004,0.0030331376096750708,0.0070773082467301962,0.012113987227791665,0.016995847460071854,0.021522111773061958,0.025788115582193957,0.029526379537524822,0.031146579696592597,0.029216340221813394,0.025800939392056643,0.025520682722567165,0.030290407271142034,0.036250419851875257,0.03856996089041051,0.037907838902326546,0.038005886428163133,0.038305265263745815,0.034592381086189665,0.026767897148415692,0.019813849942499996,0.017064470062676133,0.017375906571371915,0.018138691251436519,0.018236771868001229,0.018376683656302132,0.019314155048583595,0.020519988556433694,0.021076327606028882,0.02125505630155174,0.021602255541011344,0.020265120087410084,0.015346564239667022,0.0087165690338249571,0.0036023003347941257,0.001055601492711948,0.00021274203546617148,2.8670384611226725e-05,2.5334410143246555e-06,1.4838575071651672e-07,8.912910393604132e-08,1.6081659518839695e-06,1.9628304992869219e-05,0.00015202463748503897,0.00074710689544577459,0.0023296410383580801,0.0046092765519461527,0.0057864741696701926],[2.0412999257464572e-05,0.00016282553230478032,0.00083315327723601897,0.0027772229693549012,0.0062676235352467731,0.010403285207033076,0.014398236294432426,0.018374698311656081,0.022349028046979226,0.025814969498970133,0.027104126339751525,0.024826224859387,0.020894340352786405,0.019603569174235801,0.023002850601442391,0.02792493557901508,0.030023758908384841,0.029777900494472681,0.030383001900307377,0.031069463647844384,0.028199669060560102,0.022113681901137001,0.016990804884372358,0.014872591086764258,0.014519567353911288,0.014368159541654196,0.013901634526416315,0.013531894516239129,0.013745262033338838,0.014534044220907838,0.015591968263172841,0.016813879801955547,0.018145504282461405,0.017912983630497387,0.014207019042913081,0.0083573589735999772,0.0035076292243393717,0.0010217938279456495,0.00020142398200191487,2.6317401243985739e-05,2.2494205939232922e-06,1.2824891744770182e-07,9.0179146993621147e-08,1.645848400741323e-06,2.0088715352006314e-05,0.00015559061146200702,0.00076463144852265781,0.0023842863886910119,0.0047173942953306807,0.0059222049122990943],[1.6755586585053901e-05,0.00013291921364029066,0.00067561512832891473,0.0022350171352295686,0.0050060299406317491,0.0082639261427236155,0.011411144096381476,0.014564121802582783,0.017832221383002458,0.020956973365699787,0.022473657447496041,0.020991727844942042,0.017972928813627231,0.01690366950309375,0.01950659574127071,0.023412811117232743,0.025132577353457232,0.024834553656256472,0.02519678806245922,0.025767406730519762,0.02364950436634054,0.019511638287224475,0.01664792484319607,0.015628512204969584,0.014938413494323786,0.014029248593882387,0.013112735326048657,0.012320108341967949,0.011833411903644396,0.012010456160075315,0.01261644820360674,0.01314894862361243,0.013912165754361968,0.014296375285015372,0.012300187504486269,0.0078763583548467839,0.00353305542720101,0.001073957603841109,0.00021695504920081517,2.8962857544566768e-05,2.6011924921855274e-06,1.6919090123329062e-07,6.8565133256475235e-08,1.1541553496279801e-06,1.4083680753952677e-05,0.00010908047892976204,0.00053606296416098534,0.0016715603725004789,0.0033072408595443397,0.004151901842069111],[1.5022051178370476e-05,0.00011887574517184491,0.00060394069600148829,0.0020011387509477974,0.0044951114662915353,0.0074034470978658912,0.0099792116330099188,0.012019141072864942,0.013700485984508954,0.015496904686639888,0.016980561595774053,0.017251177495966309,0.017037994165224793,0.018024107824845727,0.020331671989884254,0.022227143275045425,0.022512123756961693,0.022129218875467479,0.022626142977093693,0.022786663075050333,0.020342938053423618,0.016997843072901347,0.01575430326369404,0.01585576319674268,0.015370860661089735,0.014438065672881759,0.013654573813094501,0.012900209372142169,0.012324831309738495,0.012327439632600868,0.012114636128294724,0.010888640265690253,0.0098450563983182339,0.0097743307832458132,0.0089754088450442176,0.0062367459006976616,0.0029942692976243084,0.00096605998836454571,0.00021172318858048991,3.3489313220959766e-05,4.2730156917873873e-06,4.7088009144611219e-07,7.0214613609230124e-08,5.5668768255206971e-07,6.7636415901369638e-06,5.2384758008205329e-05,0.00025743861292293801,0.00080274932686116472,0.0015882677152688478,0.0019939072879113368],[1.8653097864544436e-05,0.00014467645105339436,0.00072529136537589683,0.002376931640061088,0.0052493976303672543,0.0083151518268306905,0.010337812349491502,0.010920318607459595,0.010514651265711229,0.010382579704791358,0.011385675175424324,0.013571122163299429,0.01705328164116646,0.020964522188372085,0.022832372251326429,0.021713222210139729,0.0198964024570468,0.019756796301684334,0.02096134137629703,0.020576883299928284,0.017056873749964944,0.013498743837807999,0.012838193701913048,0.01356292479758414,0.013711109493463944,0.013671398955215188,0.013675691042204468,0.013324588403378218,0.013207694687203257,0.013626478654340878,0.012895845624279296,0.010025010640330354,0.0070258609423807291,0.0057656580277325375,0.005220663799825353,0.003849665303321018,0.0020298092497391998,0.00078245015694635323,0.00024429415435275664,6.6056566961213267e-05,1.4389649185917468e-05,2.2389166890712576e-06,2.4071624890023471e-07,1.9767224252883841e-07,2.2256319384211634e-06,1.7232864840579593e-05,8.4688766510077279e-05,0.00026407790699304289,0.00052248740665769111,0.00065592937384632095],[2.6938075767033938e-05,0.00019465611802865158,0.00092715130881577523,0.0029260834132032909,0.0062388403964824968,0.0093853167426789542,0.010658428832181665,0.0097740459297722335,0.0077281083887840701,0.0062493865763773105,0.0068805909485203879,0.010474788265708667,0.016766156439110485,0.022567137244701153,0.023341735464429733,0.019400301035798578,0.016150439279445431,0.016825305629115311,0.018991198444495382,0.018097029113140171,0.013525386088048026,0.0094657637850045478,0.0086341012918579683,0.0095043891551675093,0.01058214541627781,0.011995166397289406,0.012986435968988548,0.012866921266832948,0.012829331241746114,0.013263764179327217,0.01218569107155291,0.0087098153618049897,0.0049787146603834142,0.0030373549177860242,0.0024827809818270432,0.0020973724926726714,0.0015671260499573914,0.0010351657888129349,0.0005560039228627128,0.00021427020785447763,5.4927419561978575e-05,9.0805865838292792e-06,9.5978106293449971e-07,1.0526997089808217e-07,5.0411791226760358e-07,3.8833956899566575e-06,1.9084122242500779e-05,5.9508420672800292e-05,0.00011773949869146425,0.00014780986999789991],[4.3424930118528024e-05,0.00027500728823253372,0.0011697223906091047,0.0033826284693377487,0.0067759888945953389,0.0096843971701292397,0.010265267685262364,0.0083687600797140004,0.005492050750160145,0.0035914370457963739,0.0042066474412985689,0.0083500439407969435,0.015336436015743143,0.020818218448676557,0.020105908928680076,0.01493914513666819,0.011827763326277442,0.013582397948795632,0.016391699214198609,0.01516642584572527,0.010175163313610744,0.0059396543590711764,0.0047916393956965748,0.0056943462286054292,0.0077705699699668089,0.010561471515233442,0.012319015034322908,0.012166989587761506,0.011496180990076736,0.010895203464551362,0.0091771412953593166,0.0060561070653450096,0.0030555865388503219,0.0014981060930013654,0.0013067513150970007,0.0018306917951163787,0.0023895198730233347,0.0022780782496281647,0.0014489608683882318,0.0005947871973750751,0.00015578866784005606,2.5938295837656914e-05,2.7421719151221613e-06,1.9027580316367626e-07,8.5224805058201504e-08,5.9964909203976983e-07,2.9458680238062527e-06,9.1858429752617661e-06,1.8174512621279754e-05,2.2816237351479423e-05],[7.5479550833017911e-05,0.00042790295775846691,0.0016103106631683395,0.0041323124672825225,0.0075052555851402294,0.010031532050603443,0.010093765847381472,0.0076431493576001102,0.0044299602829415106,0.0025144789067798952,0.0030981122972477061,0.0067858802765563822,0.012480489110582523,0.016056835073119235,0.014262559006849414,0.0096560430697047329,0.0076512806912800825,0.0098302266649473637,0.012418123988446442,0.011209165982101147,0.0069257743167155401,0.0033738972840624483,0.0023188240339961511,0.0033357626378182252,0.006076451913390065,0.0096245769033689588,0.011789052312495749,0.011697889910225516,0.010387981679256154,0.0084233531340199078,0.0058792940688212137,0.0033258719649074081,0.0015005285630948426,0.00078100529753300819,0.0012294011420314398,0.0027043952190549891,0.0042496183921243626,0.0043303218872626191,0.0028168293710613772,0.0011648479238096283,0.00030583279407668637,5.0959328006107306e-05,5.3880556984338428e-06,3.6214826673095868e-07,2.3571393448274869e-08,6.3799507863724116e-08,3.1149961217317194e-07,9.7130109189165248e-07,1.9217531448955407e-06,2.4125640553382204e-06],[0.0001133158102453258,0.00061237522330080598,0.002157925065544151,0.0050940727567324344,0.0084396643700054199,0.010404506301354366,0.0099076895011334532,0.0072876930748784589,0.0043045554603077137,0.0026886011034203783,0.002995554342116812,0.0053285603036963437,0.0087110720429795958,0.010250737359756158,0.0083043478645523985,0.005153088841859662,0.0041293601969453562,0.0057512297965895591,0.0074095395465442904,0.0065597711035974395,0.0038532898516255628,0.0016660041727613669,0.001085751132770068,0.0021453823839822196,0.0048650514954828028,0.0082804054731660873,0.010408070111106952,0.010541636893718717,0.0091720869156229415,0.0066074834764907739,0.0037221553779355986,0.0016423571621747947,0.00063075040633878219,0.00050928356916945486,0.001422122624187854,0.0035266523458368092,0.0056908980133700254,0.0058443322656013567,0.0038109073944007604,0.0015770712401744231,0.0004141347252064392,6.9004846706403861e-05,7.2955640922334701e-06,4.8946319162703586e-07,2.1424881892590386e-08,5.1536432435062606e-09,2.2571592357978706e-08,7.0353150815287988e-08,1.3919597118694906e-07,1.7474627060170097e-07],[0.00012556853048722004,0.00066769574253478133,0.0022918195984767999,0.0051873872761843322,0.0080778680888261897,0.0092436923001276601,0.0083090682727623537,0.0062150953658029482,0.0044721633973533416,0.0038243575090315123,0.0038053533009566585,0.0042915209512916176,0.0052261509091859832,0.0053523655155998089,0.003937148098259893,0.002232555078132976,0.0017447335554922605,0.0025088177235869438,0.0032400747106128866,0.0028235103595913567,0.0016101083087645737,0.00066430541668427673,0.00050824136106668359,0.0013488648211202017,0.0033541537098359104,0.005838375211685517,0.0074491488676989674,0.0077217000056343157,0.0067683112221634586,0.004661520896890997,0.0023235043297375217,0.00082945588535484011,0.00027047303540928967,0.00037601433023119795,0.0013323667876911941,0.0033785132731895388,0.0054675719609382474,0.0056169726875263193,0.0036617256705003946,0.0015146766931802504,0.00039755572785611057,6.6209131487387712e-05,6.9964681869872223e-06,4.6911884873155786e-07,1.9987693077406574e-08,7.6656182866170549e-10,1.1286662099450674e-09,3.4907494850327951e-09,6.9063726097241215e-09,8.6702419074914508e-09],[9.7250722334891275e-05,0.00051401790543659134,0.0017441306389151699,0.0038606112117692678,0.0057722968183984806,0.0062246871291120852,0.0053823512446396085,0.0044999356521229859,0.0046519143692663936,0.0053974569114373858,0.0052090206253375326,0.0040198404536425083,0.0030099761681451963,0.0023177653636956164,0.0014932913375881375,0.00076683501661071465,0.00055255939058963344,0.00078294027377481085,0.0010037087407040082,0.00086279899242204625,0.00048306608801207944,0.00020213994707913674,0.00021324757346243527,0.00068116843748311127,0.001743626599068171,0.0030572994734174457,0.003944564919557943,0.0041689836181372673,0.0037040888518850017,0.0025293593272258416,0.0012083190388327701,0.00039238787247947735,0.0001265280792754942,0.00027560584287719881,0.0010530402626801724,0.0026763142636272428,0.0043225764699517961,0.0044302843246589235,0.0028812090613157515,0.0011889656059601462,0.00031132532805237882,5.1726130045468127e-05,5.4532542139144862e-06,3.6479738176311232e-07,1.548551107410911e-08,4.247969224060384e-10,4.5174271335197037e-11,1.1871527067218739e-10,2.3472993622183375e-10,2.9467870515549629e-10],[5.1869830896318045e-05,0.00027337260249768642,0.00092177820021279919,0.0020124473364029625,0.0029264068777329084,0.0030308267015677691,0.0026659217915823252,0.0029163381700313407,0.0044294285409967448,0.0060949388985838439,0.0058908856228797966,0.0038768452794873047,0.0019417133053310325,0.00093258387719704348,0.00045792585477968532,0.00020416100343172229,0.00012823567256503568,0.00017174128008247473,0.00021716991650149787,0.00018441303741002996,0.00010206619057372597,4.5802023400688986e-05,7.0463882265187197e-05,0.0002490596121856451,0.00064364289348201173,0.0011335260483853918,0.00147707204498018,0.0015862550472595597,0.0014274936179523056,0.00097696553640835198,0.00046184277698573184,0.00014778428834790624,6.9547804683292117e-05,0.00025752632053163845,0.0010122232981396196,0.0025621294912467922,0.004116554088519386,0.0041968646634422098,0.0027150014657772795,0.0011144714854240372,0.00029028304534607982,4.7976465349263392e-05,5.031398912569728e-06,3.3481371602889399e-07,1.4137495579207006e-08,3.7896665857362867e-10,7.3255690422611019e-12,2.8315460484853512e-12,5.4653383949894816e-12,6.8605771237561326e-12],[1.8980502815458098e-05,9.9863990175484455e-05,0.0003353796164175044,0.00072548323682165719,0.001035835206254598,0.0010589851954281352,0.0010588821316687988,0.0017159474341202964,0.0033709923696268202,0.0049765027952546901,0.0048297204581331729,0.0030338471781155797,0.0012774461561211685,0.00041006415942797172,0.00012702588654697384,4.2704403087260317e-05,2.1678383091923243e-05,2.6297808492678194e-05,3.2621963908635755e-05,2.7395595917747017e-05,1.5075484600216006e-05,7.7026237673175443e-06,1.7021109716397397e-05,6.3548184524464605e-05,0.0001649363615851342,0.00029168934925422431,0.00038374240619644276,0.00041794823513128349,0.00038040724915249386,0.00026156371027449664,0.00012373182327182829,4.3304988920409873e-05,5.9032203476096513e-05,0.00032351508950230777,0.0012829469580266351,0.0032375583558743367,0.0051843675254062043,0.0052676556353507195,0.0033961107850918777,0.0013892782629714045,0.00036061152956021273,5.9392691877433509e-05,6.2068250492979872e-06,4.115751565121808e-07,1.7316974696800316e-08,4.6231804869689095e-10,7.8456746006326169e-12,1.2822791894968898e-13,8.7727700824097952e-14,1.0941487999092846e-13],[4.7603627865487805e-06,2.5017788565720461e-05,8.3789328040152652e-05,0.00018014526672093149,0.00025498574439798574,0.00026956325080777739,0.00035761053688025874,0.00084047258408357717,0.0018701598231980472,0.0028321685918265144,0.0027548205108631303,0.0017097314918340404,0.00068325431602212514,0.00018329310461429551,3.7785637728031324e-05,7.8674855020948099e-06,2.729929854684226e-06,2.8070935253836389e-06,3.3921554801143865e-06,2.8199019572082368e-06,1.5533802008075822e-06,9.6500116368376942e-07,2.9050756276065227e-06,1.1179629249575562e-05,2.909862520424694e-05,5.168822266545418e-05,6.8650317323426313e-05,7.576065924945664e-05,6.9674525256089204e-05,4.815519620539012e-05,2.3114236889357738e-05,1.2900785389569745e-05,5.9569040523815801e-05,0.00036459381951445009,0.0014482382851264994,0.0036518186389849351,0.0058427991334838404,0.005931592606436142,0.0038208519280474905,0.0015616641633052603,0.00040499870885724065,6.6643562376306865e-05,6.9582712305687631e-06,4.6098107971512793e-07,1.9377754970882737e-08,5.16847560921013e-10,8.7471733136664491e-12,9.4409493204710031e-14,1.5920936810961368e-15,1.1980389095096348e-15]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true},"2bda6d54a06756.1":{"x":16.491295067553189,"y":2.9073870875450041,"z":0.67598451376896274,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","mode":"markers","marker":{"size":5,"color":"red"},"name":"Posterior Mean","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"σ"},"yaxis":{"title":"β"},"zaxis":{"title":"Posterior Density"},"camera":{"eye":{"x":1.5,"y":1.5,"z":1.3}}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[11.708098668680865,11.952293058971588,12.196487449262312,12.440681839553035,12.684876229843759,12.929070620134482,13.173265010425204,13.417459400715929,13.661653791006652,13.905848181297376,14.150042571588099,14.394236961878821,14.638431352169544,14.882625742460268,15.126820132750991,15.371014523041715,15.615208913332438,15.859403303623161,16.103597693913883,16.347792084204606,16.591986474495332,16.836180864786055,17.080375255076778,17.3245696453675,17.568764035658226,17.812958425948949,18.057152816239672,18.301347206530394,18.545541596821117,18.78973598711184,19.033930377402562,19.278124767693289,19.522319157984011,19.766513548274734,20.01070793856546,20.254902328856183,20.499096719146905,20.743291109437628,20.987485499728351,21.231679890019073,21.475874280309796,21.720068670600519,21.964263060891245,22.208457451181967,22.45265184147269,22.696846231763416,22.941040622054139,23.185235012344862,23.429429402635584,23.673623792926307],"y":[2.4792434273053625,2.5012551133078422,2.5232667993103224,2.5452784853128021,2.5672901713152818,2.5893018573177615,2.6113135433202417,2.6333252293227214,2.6553369153252011,2.6773486013276813,2.699360287330161,2.7213719733326407,2.7433836593351204,2.7653953453376006,2.7874070313400803,2.80941871734256,2.8314304033450401,2.8534420893475199,2.8754537753499996,2.8974654613524793,2.9194771473549594,2.9414888333574392,2.9635005193599189,2.985512205362399,3.0075238913648787,3.0295355773673585,3.0515472633698382,3.0735589493723183,3.095570635374798,3.1175823213772782,3.1395940073797579,3.1616056933822376,3.1836173793847173,3.2056290653871971,3.2276407513896772,3.2496524373921569,3.2716641233946371,3.2936758093971168,3.3156874953995965,3.3376991814020762,3.3597108674045559,3.3817225534070361,3.4037342394095158,3.425745925411996,3.4477576114144757,3.4697692974169554,3.4917809834194351,3.5137926694219148,3.535804355424395,3.5578160414268747],"z":[[4.4025074491985937e-11,7.082379901379953e-10,7.3297362187161058e-09,4.9734680060092255e-08,2.3758848024422024e-07,9.5885509152619961e-07,3.9156211584531001e-06,1.4701101328043684e-05,4.2600254802230549e-05,9.3842428117001025e-05,0.00018388472471964125,0.00042215293979430891,0.0011876950460720467,0.0030228375104107523,0.0055494823789947701,0.0068463269732390612,0.0056841039723225803,0.0033290083830014448,0.0015473757681082534,0.00076650426708042407,0.00070067182781964718,0.0010488401082356577,0.0014062274822370558,0.0014828830529975347,0.0016238052946441703,0.0026117581101332715,0.0044794795031739224,0.0056518502229413346,0.0046891120130313621,0.0024941271938647919,0.00084533199949721519,0.00018230237940928745,2.5016668477445523e-05,2.1874122511490698e-06,1.2463335231697289e-07,7.6802729474014139e-09,2.5836299350702511e-09,1.1719967960985752e-09,3.498885641064858e-10,6.6355028808171992e-11,7.9849423268410684e-12,6.0968879022805914e-13,2.9538106024974446e-14,9.0801933218110617e-16,1.771110200492717e-17,2.191967648289422e-19,1.7213167466719625e-21,8.57680638282301e-24,2.7116200774002996e-26,5.4396684884296691e-29],[5.3388784098775012e-10,8.5140127980985369e-09,8.7445878724855269e-08,5.8097282943586604e-07,2.5853868730475732e-06,8.6485966479613967e-06,2.706465137316102e-05,8.5552886580084626e-05,0.00022964282682648194,0.00046996460774959448,0.00076899441919070673,0.0011476522869248904,0.0018376051156898869,0.003348856401022894,0.0057610736988120605,0.007757173798948783,0.0077925235181414074,0.0060501863102482229,0.0039491511635438093,0.0026101734058278339,0.0025353761264085579,0.0035682043977695124,0.0046250925162088603,0.0047088238530685845,0.0042667797661582003,0.0045927368882577348,0.0059795551257240676,0.0067953517898765243,0.0054587182971484122,0.0028900960358057264,0.00098858290528417748,0.00021741071476990645,3.0762920803345161e-05,2.8400536126806134e-06,2.3011465687085815e-07,8.1730278338343625e-08,5.6109751274715053e-08,2.6359364651348449e-08,7.878186247696403e-09,1.4941584750017891e-09,1.7980721152532216e-10,1.3729545738198301e-11,6.6518712731165868e-13,2.0448909770320362e-14,3.9887350779537834e-16,4.936725819883627e-18,3.8768745073117294e-20,1.9318083041010667e-22,6.1078781755741093e-25,1.2254569470353451e-27],[4.5517159491390965e-09,7.0535106992149335e-08,7.1818639284261317e-07,4.7172700999948832e-06,2.0255083052740085e-05,6.0518748559391033e-05,0.00014946296569880776,0.00037379478800950774,0.0008923228428533176,0.0017110153650717935,0.0025605437090405218,0.0031986998745627479,0.0036231434228889115,0.0043958245830215421,0.0066085489819774999,0.010164524122263881,0.012810706959175777,0.012480687930163242,0.0098282781411568199,0.0073602082111424933,0.0072420578192383877,0.0096032610117773292,0.011960163345111754,0.011982496240762502,0.010239996627861252,0.0086285451657931462,0.007884493201836637,0.0071171438803629399,0.0052419826743773899,0.0027688464070367161,0.00099181148177262765,0.00023621286897885122,3.7341254468061315e-05,4.393688199265151e-06,1.2572851803616569e-06,1.1748299410883026e-06,8.6382592199435284e-07,4.0679311314603957e-07,1.2159727780263542e-07,2.3063274183106736e-08,2.7756087450186593e-09,2.1195098011650495e-10,1.0269577576677865e-11,3.1572561219892978e-13,6.1589585869616175e-15,7.6233404976209741e-17,5.9872231055898861e-19,2.9837215867504078e-21,9.4369016008887082e-24,1.8974677023502971e-26],[2.9550863425468352e-08,4.0918090448798115e-07,4.0660478601890401e-06,2.6443923782327808e-05,0.00011145702784986171,0.00031347547539622311,0.00065563006316666909,0.0012743902034617024,0.002562364856977781,0.0045429620966601801,0.0063601053683841726,0.0072205812426353409,0.0071319853848048785,0.0072485466627513111,0.010032101017946637,0.016334493787139928,0.02248528969599279,0.023793997042021148,0.020341293820980388,0.016569031830797769,0.016852927380389009,0.021421640065795437,0.025522196298123943,0.025106040445490838,0.021223178077605067,0.016552845370522748,0.01231598798111788,0.0088350165304287784,0.0058372557497853939,0.0031576864528054479,0.0012511137063709247,0.00034048503338093557,6.3383075760862847e-05,1.2968322701890248e-05,1.108084156490706e-05,1.233925395558774e-05,9.1420108790977951e-06,4.3068612811687898e-06,1.2875638836282068e-06,2.4424325740237657e-07,2.9398109879320465e-08,2.2452209036044218e-09,1.0880322222280229e-10,3.3455518691275575e-12,6.5273649053173455e-14,8.080828605785059e-16,6.3481522930540981e-18,3.1659991816947793e-20,1.0062483532163563e-22,2.105903520245032e-25],[1.8278536102194593e-07,1.7787780095566724e-06,1.6091751235590163e-05,0.00010234782250295522,0.00042574446545136976,0.0011602151325596716,0.0021986531099481075,0.0034578143867041913,0.0056321725039600199,0.0090468266007453363,0.012043004079985827,0.01287966838249175,0.011995481493982826,0.012045267203954308,0.016820498923100186,0.026897178758727248,0.036551548469805149,0.039318871049219918,0.035556808047120428,0.031655870600530302,0.033709885267901862,0.041257714625847118,0.046789668369070787,0.044793942700633714,0.037437068165477497,0.028589519785921624,0.020062898826163255,0.013308264269461207,0.0085276379887753231,0.0047778363691699495,0.0020171357299680033,0.00058759274963928214,0.00012626549589956728,5.5628336350817366e-05,7.772553614916374e-05,8.961019721060759e-05,6.6495094446372089e-05,3.1335099195683701e-05,9.3703404025955511e-06,1.778008138630229e-06,2.1407308007325039e-07,1.635459614948863e-08,7.9280710196369977e-10,2.4386362808360579e-11,4.7597894654145048e-13,5.8959256588615841e-15,4.6398738415242972e-17,2.3399591777996185e-19,8.1100564350322058e-22,2.8871681937843761e-24],[1.3244253818701021e-06,7.1087053018729944e-06,4.7331621965653369e-05,0.00027733834107321835,0.001127534565250091,0.0030125440655599635,0.0054105077857765499,0.0073719641291685864,0.0098143551435603115,0.014179146737811354,0.0185430237060643,0.019772464909117469,0.018487033405831816,0.019451956374045648,0.027770754173034512,0.042651464730593856,0.056032096805609881,0.060768334978846122,0.058282852811021975,0.05635687873181866,0.061237335920280231,0.070858397788808897,0.075770197476691892,0.070032929311925757,0.057241437308459472,0.04286266074466942,0.029611561579242128,0.019506017381872767,0.01250199374479829,0.0070209310570606758,0.0029840923129459572,0.00089756047555261231,0.00025128370576190344,0.00023508571060443484,0.00038709741380919002,0.00044937998974800585,0.00033358775676726841,0.0001572725528340743,4.7057117398996178e-05,8.9345851978782109e-06,1.0764391309583018e-06,8.2294197928431658e-08,3.9922477364800239e-09,1.2290171282058771e-10,2.4018405387500489e-12,2.9873087087312308e-14,2.4113298863238832e-16,1.4567408008868625e-18,1.1579267712584063e-20,1.4956455204882074e-22],[9.4802233460931127e-06,3.2993344734466038e-05,0.00012529983734183418,0.00056032493579519899,0.0021084492284321652,0.0054867703376528772,0.0095617602558514328,0.012038420145827273,0.013960478164583231,0.01882710036635651,0.025622675114724949,0.029444269266239411,0.029562937136593109,0.032281897038430367,0.044546883042646146,0.065064707836443025,0.084193298029655861,0.093895100632545705,0.095533728544242622,0.096832075079302887,0.10284327299236858,0.11038915961658764,0.11063024486663324,0.098729063879260837,0.079174767923931577,0.058605348874815832,0.040525305694310433,0.026748151095870989,0.016796001414292151,0.0091790345394929737,0.003939818789297474,0.0013349270749361019,0.0005902552561370916,0.0008091975626266704,0.0013555706520592139,0.0015679266008773397,0.001163611383152772,0.00054906195220009188,0.00016447730104254512,3.1269847019882383e-05,3.7726846951619768e-06,2.888566503841407e-07,1.4037149503144787e-08,4.3332957999454431e-10,8.5488402058855111e-12,1.1255071858667276e-13,1.2869256928966505e-15,2.3343299683024538e-17,5.4905273955734474e-19,9.8362382984685772e-21],[5.2699077810753234e-05,0.00015665615379578432,0.00038112341059243833,0.0010235027656398522,0.0030168396619471398,0.0072718895223212636,0.012348890888430232,0.015182003316457703,0.017067339449426934,0.023553551996591218,0.035093877481522581,0.044911286497437024,0.049153174893377637,0.053941488246211707,0.06852039046949529,0.093934712221458785,0.12145331296848506,0.14101380323622709,0.15018975929815659,0.15406331453774205,0.15686806173417589,0.15685642316664861,0.14877711435153082,0.13014460486947144,0.10492131805581517,0.079033227192066902,0.05599058807351058,0.037354034971914231,0.023141707761452558,0.012838475133977699,0.0062463526025213021,0.0028310508720761265,0.0016957465843149334,0.0021752446175684614,0.0034020643516066919,0.0038749471825537344,0.0028703897445237735,0.0013562167782912261,0.00040717744118249065,7.7612717699138267e-05,9.3908123672537037e-06,7.2146215748857892e-07,3.5267221992456892e-08,1.1122005883947961e-09,2.4775688943298029e-11,5.8771459459761492e-13,2.2687881765594152e-14,8.9600004266883512e-16,2.5205946886976945e-17,4.6625804561874846e-19],[0.00020776552038160537,0.00059063134844323498,0.0012087973331886756,0.0021424204053909469,0.0041053863939456061,0.008042993687378576,0.012994274965668851,0.016530152081350835,0.020432289924117879,0.031091070339667282,0.04963398601497105,0.067682142772836587,0.078084282127031196,0.085425329167347117,0.10059754325592603,0.1288233046717277,0.16498475595224957,0.1969149048095776,0.21518783279149875,0.22039888803081592,0.21767201763442529,0.20846555144450746,0.19183465642262143,0.16814873006952485,0.13939007492699945,0.10866200482349232,0.079523195485683221,0.054670741525492408,0.035549302770891064,0.02226570220753879,0.013459161782288693,0.007758878004358323,0.0048538751700527615,0.00479190644284418,0.0064268444035920731,0.0070371564505375319,0.0051744120916926966,0.0024470150582567469,0.00073720708768857334,0.00014116706374347516,1.7183553247368817e-05,1.3357764228782122e-06,6.8326901540132739e-08,2.7246536957808975e-09,1.3987797313745948e-10,1.0231941314497012e-11,6.4628990376031491e-13,2.8277412989049032e-14,8.1533742243004729e-16,1.5237105470774423e-17],[0.00057339588516638505,0.0015932815020696391,0.0030932162830164967,0.0046460698244120933,0.0064574754889889742,0.0095567164320736891,0.014174458342230812,0.01946106160491488,0.02758988374557458,0.044345833135921116,0.070211708346969312,0.095903293145685714,0.11294609332013178,0.1248653351343884,0.14258435898352884,0.17354239780174718,0.21606819444981024,0.25749441796029143,0.28296346815521278,0.29030614714716868,0.28630896990004245,0.27282715647379557,0.25020348051755104,0.22172790950491889,0.18780148642723596,0.14905051792576174,0.11106470628400703,0.079488987225818999,0.056590426631008689,0.041042105205536215,0.029081056207344049,0.018903736217373193,0.011858793688535752,0.009305521581686578,0.0099775753262369878,0.010032508882502037,0.0072024733757178388,0.0033917622398981148,0.0010248338256322838,0.00019776062656122448,2.4568643275752015e-05,2.0814122358896206e-06,1.5693381591333549e-07,1.6686683828483373e-08,2.0914550254656313e-09,2.0574929916877507e-10,1.3905833433825558e-11,6.2287587714069123e-13,1.8180887445521912e-14,3.4218851094319401e-16],[0.0011414174804438375,0.0030389196898476735,0.005718468878092426,0.0081607492149375835,0.010120434082227374,0.012923882402292527,0.018180323033708014,0.026598125923725457,0.040204301206396106,0.062999511708044131,0.094201852410266948,0.12527377125718089,0.14938404635014632,0.17029428141016473,0.19678836016830115,0.23352771008005599,0.27908768272075807,0.32304148899945101,0.35151577007336948,0.36376832421381761,0.36650871075748814,0.35635045438983048,0.33050798416603611,0.2947443198841922,0.25044506934351873,0.19860746923980416,0.14871137955035965,0.11007635360535231,0.084611717881972803,0.067629481883427434,0.052138326040201521,0.036166424122426738,0.023283271504946752,0.016351030406396783,0.014137606347021853,0.012350877046467531,0.0083448541897697716,0.0038428036105048508,0.0011583239653729014,0.00022936272724915894,3.2708466167229133e-05,4.7320081444010342e-06,9.4935516304691795e-07,1.9158417985121659e-07,2.8930338741451382e-08,3.0030711110419699e-09,2.081745606939332e-10,9.4661836349111961e-12,2.7883739935917304e-13,5.2765213416164136e-15],[0.0018059346058506348,0.0042917220989544458,0.0076003208579406289,0.010570865764497346,0.013027428131474008,0.016644226469749012,0.023911334445565969,0.03661108579049642,0.056057877849581751,0.083496211722021041,0.11736603581680249,0.15258821990634894,0.18602877219770281,0.22128770100755837,0.26229176270350568,0.30637647480461183,0.34979814099407702,0.38799161411011701,0.41473583786253859,0.43253990957699223,0.44505274150539109,0.44189021380978222,0.41562293214583279,0.37294579487950702,0.31808132189046401,0.25367455152159324,0.19166289207100506,0.1448941100659957,0.11569886953789488,0.096252993945210252,0.076668137279255019,0.054957500552987301,0.036642675723885625,0.025401624285476414,0.019426334224109391,0.014536968852756939,0.008804267231119248,0.0038260792343356416,0.001156604117796867,0.00027211425195089331,7.2094950885690748e-05,2.4935704616262887e-05,7.8353206386611303e-06,1.800257525703332e-06,2.8546495400593176e-07,3.0491935835987309e-08,2.1532447287892873e-09,9.9058892394203518e-11,2.9384448199952779e-12,5.583442366066806e-14],[0.002682411221077131,0.0050991698284714743,0.0077967575933781544,0.010405306292568731,0.013694334990818227,0.019507819696587415,0.030145583375276772,0.047697241812999364,0.072663672321491804,0.10356168482301115,0.13917428323727765,0.17960280208641669,0.22501531813016273,0.27664439860640333,0.33144328236319759,0.37832002179393376,0.41239955567339359,0.43859418257423355,0.4604664659692087,0.48086788165970568,0.49862870469657589,0.50082377741056117,0.47788087076896818,0.43528814115871989,0.37876403757238158,0.30982500434479221,0.23880900830209464,0.18242169135148878,0.14660738286471181,0.1224170963185177,0.097787352787189946,0.070638142851640329,0.048217272948320317,0.034542833820460965,0.025895042216790433,0.01760774838663183,0.0094866279442304604,0.0038495279360215759,0.0013191363392076126,0.00055317312906867091,0.00030043423871101426,0.00014341083398204882,4.9752080382720751e-05,1.1981379365480023e-05,1.9619333417322502e-06,2.1431299604966102e-07,1.5357311644087969e-08,7.1291988308302243e-10,2.1261753922047582e-11,4.0526616436422257e-13],[0.0039772320680246057,0.005969175918163607,0.0072253115415257486,0.0088951058251834306,0.01338604246028767,0.022615927436519773,0.037778252218362444,0.060228318075757126,0.089834132078624354,0.12407489018964102,0.16326848313350156,0.21132184463745166,0.26867696571602318,0.3322033987960738,0.39224107034571437,0.43237073628141909,0.45100828398979209,0.46452154384569944,0.4832964852850391,0.50529869049100962,0.52413043737855558,0.52965934039076212,0.51357924430981994,0.47876752154425634,0.42962142663700348,0.36361534352394392,0.28682129610359636,0.21964693800224741,0.17465524094260917,0.14466415713639166,0.11551534371621285,0.083446629944010933,0.057219357386449982,0.042344249016990007,0.03285158053296023,0.022110451657635883,0.011477505238553268,0.0048777980725244032,0.0024227370402599723,0.0017276747006704511,0.0011925670853590745,0.00061550467430532502,0.00022319344795136922,5.5648123216221175e-05,9.3545780757956438e-06,1.0404403339716109e-06,7.5417154728838283e-08,3.5254739619609571e-09,1.0557284679584652e-10,2.017061019304326e-12],[0.0051156051403596506,0.0067575547978598422,0.0068431760861206717,0.0079349854454321151,0.013964606554395737,0.027091601298194479,0.047535711194749281,0.075043951329297559,0.10822945835974591,0.14553418864324011,0.19033573924911612,0.24755376642916999,0.3140267957515866,0.38125259697761521,0.43550842645996685,0.4604967699084529,0.46242687165149277,0.46848923006029397,0.49107288648189795,0.51927170145776425,0.54096520102939116,0.55017991880377282,0.54144356827272277,0.5151550216454206,0.47392775093641709,0.41295004810036562,0.33380324949396645,0.2563980227983173,0.19977219037361754,0.16300688585019313,0.13115334836593581,0.09588003094042849,0.065529055096182356,0.0485477516229572,0.038740909564513849,0.027164531330972883,0.015157092252444713,0.0078950244728542059,0.0055330052882329598,0.0047669947592911032,0.0034893966672156877,0.001867588894544173,0.00070058612886985793,0.00017978465377512746,3.0873622031976384e-05,3.483034852717512e-06,2.547193107006704e-07,1.1970495073475231e-08,3.5957547676333774e-10,6.8822272203272683e-12],[0.0049477768976429696,0.0062956914132823389,0.0061713160441870208,0.0078150358058655146,0.015877347974876218,0.03295376221032608,0.059114915510591615,0.092056665155588899,0.12754960924963032,0.16559317253953298,0.21432630779025749,0.27882208787036261,0.35083469851424315,0.41656767023820784,0.46028519669816875,0.46958115037683773,0.45992009431363279,0.46641653713900122,0.49971630511550069,0.53872242896194289,0.56520222737192494,0.57643220910724668,0.57065257175744832,0.54777094904554302,0.51076844373553798,0.45620413047473962,0.3805366812000105,0.29586664659488832,0.22483786537671338,0.17798474130501959,0.14368880971817108,0.10749900107774855,0.073543305382358468,0.052637050409269352,0.041634200805980348,0.030971981456721909,0.019917595381203856,0.013055059087092293,0.010860590187425715,0.0097602618245645426,0.0072642124947589421,0.0039834793111783529,0.001535229844266039,0.00040315573456111038,7.0397332591133437e-05,8.0291947606002869e-06,5.91151015717584e-07,2.7892270877353434e-08,8.3978903537627122e-10,1.6094881830946064e-11],[0.0033836737724480558,0.0043610885747664037,0.0048010480814901111,0.0080064005071975239,0.018682002018400302,0.039767706080496699,0.071294843942247041,0.10879922063553003,0.14474726769947618,0.18019469278535721,0.22793571964756276,0.29427183700212012,0.36850529623546968,0.43343714481114776,0.47154019991814561,0.47390196458269657,0.46259312121945523,0.47632045838670928,0.5221835854743303,0.57020015613532904,0.59703260787240187,0.6033282293727007,0.59288263587016765,0.56821449993224893,0.53420888174384207,0.48858166993109681,0.4212001476146453,0.33305770162558013,0.24785008405851783,0.1890167448359121,0.15177916297773247,0.11647528839853906,0.080222510235447145,0.054379473516350106,0.041110822069088122,0.032427515390543574,0.02425288719418826,0.018635974064152357,0.01634109462579917,0.01449755025855747,0.010749171215458757,0.0059715469100115985,0.0023451751315602728,0.00062633710916699568,0.00011072704016439206,1.2731647278509045e-05,9.4205641346474158e-07,4.4581008060846403e-08,1.3445772324287727e-09,2.579493177770837e-11],[0.0016152522195722286,0.0022490649141443872,0.0034066610263380225,0.0082923559403207028,0.021492635093593181,0.045846911432564315,0.080512854243318943,0.11942674555624314,0.1538332692578275,0.18513629084581895,0.22773598539473019,0.29004350335972723,0.36359967658573966,0.43088417466150086,0.47242153099950451,0.48027419472001676,0.47801999164801512,0.50274709192701938,0.55769819153804356,0.60815704828914396,0.62882401221326301,0.62387121688956459,0.60272539035170702,0.57228598110624374,0.5395846445433663,0.50114477878054575,0.44125401310195239,0.35351220072206613,0.26086037861979228,0.19456507991985186,0.15605064751565706,0.12290350961201973,0.085762009906327055,0.055364965236980222,0.039171558407799976,0.031826598663537022,0.026292990055885302,0.021594635373441695,0.018582784488064236,0.01571780585798576,0.011359565988560239,0.0062974784204753711,0.0024947655337355934,0.00067318893847093477,0.00011999484974462563,1.387524427404757e-05,1.030334055396805e-06,4.8863633360830906e-08,1.4756206762611191e-09,2.833012355515686e-11],[0.0005591601925727034,0.0010228863011962584,0.0027085317163669416,0.0087356583763437724,0.023363510228208824,0.048623888452737511,0.082338152786751009,0.11857193165442687,0.15037047152349592,0.17841979043935777,0.21460461446855311,0.26943272278186942,0.34026211594534511,0.41195522109653188,0.46382572606239147,0.48704700373086646,0.50186434575552841,0.53851309624234511,0.59629353738937996,0.64215517793065413,0.65440406429969733,0.63917160382104643,0.60672078231816395,0.56668291157808981,0.52883560495352733,0.48968026676503235,0.43306891108800216,0.35098190017593639,0.26193952274530014,0.1956616492704597,0.15715937346012285,0.12586813168488409,0.089562807106833425,0.057309396030879027,0.039086849867342705,0.03158190930349785,0.026477086410882908,0.021111526898389268,0.016613069391047983,0.0127657853892166,0.0086818636954739525,0.0046921838329837496,0.0018493308637135785,0.00050033950559923114,8.9551753214870029e-05,1.0390926425500493e-05,7.7350894696612582e-07,3.6745946415546601e-08,1.111028444254256e-09,2.135132681432617e-11],[0.00018607591918585182,0.00064776042804144088,0.0027035215928779797,0.0093238952519328795,0.023974773322626777,0.047325297645586385,0.076513957086346326,0.10781891903831398,0.13764911120910123,0.16478100860446407,0.19585670261489804,0.24237909132171059,0.308598517161497,0.38425238302826781,0.44947733855651939,0.49369236626512569,0.53009895220486614,0.57772225371267405,0.63165123327098116,0.66671013439144011,0.67063148705349107,0.64964381046413067,0.60889836724219104,0.5572960610009946,0.50774239972697133,0.46056259770695862,0.40519572114516295,0.3352100954488258,0.25950745600228603,0.19726704573737247,0.15568132474597368,0.12290344511943323,0.089188245492007351,0.060137076169204724,0.043235616790791,0.035215046400171084,0.028287465163297467,0.02031120520973834,0.013449017418789842,0.0085670206403682739,0.0050626264108695933,0.0025313606137992209,0.00096579451920773005,0.00025885437515067326,4.6328264551492259e-05,5.3937752805739487e-06,4.0350177084441889e-07,1.928998400184516e-08,5.880522668091867e-10,1.1425922656732941e-11],[0.00015325138034727584,0.00066003456088504998,0.0029177478883776376,0.0096619108342699614,0.023437748250421702,0.043921139337875656,0.068728831591715847,0.096696131101533564,0.12655632170456255,0.15503388705928189,0.18350425018390548,0.22203759058869058,0.28008468282142501,0.35495287808091397,0.43132688491148091,0.49702429400182696,0.55501934588298507,0.61031046778883113,0.65512104328871756,0.67598451376896274,0.67130455513091014,0.64603766997229972,0.59907066548093746,0.53738813450643153,0.47642727798648804,0.42192035898607672,0.37065175719125748,0.31787353864345408,0.26070510800109492,0.20374538215833185,0.15526954910744989,0.11675674307971536,0.085730487834086627,0.063385717241843983,0.050532640181046008,0.042320579083657245,0.032854136524236278,0.021783415663395426,0.0123676190216174,0.0062120476178901748,0.0028169117273271036,0.0011493177370514561,0.00039669307741296795,0.00010419137026344197,1.9117033962410585e-05,2.3432905867509358e-06,1.8850364262539331e-07,9.9000198490002048e-09,3.3933186995987441e-10,7.5973253640644894e-12],[0.00038531763517804984,0.00086330091616233697,0.0030321742642874013,0.0094491380986046793,0.022301631558868721,0.041619605636383103,0.066229236440413536,0.095243746587343373,0.12666993212904182,0.15676973635689143,0.18459388482425576,0.21615246988303669,0.26193321129891967,0.32778159870250656,0.40674740818791277,0.48659625543548962,0.55896720447160053,0.6151888653674572,0.64777373218008361,0.65532875943652913,0.64305000714603333,0.61357638020583471,0.56238032320174147,0.49547311357585172,0.42998706273918746,0.3760966817541343,0.33484345109148617,0.30095211042176107,0.26285425419130642,0.21365111418783775,0.16041600820997384,0.11545870898233508,0.084983195442164719,0.06731290118225218,0.056592364585744202,0.04707263598851353,0.035703674944952433,0.023375267761584752,0.012924506285433552,0.0059452308471055655,0.0022923033658237392,0.00080956303099461206,0.00028325324773560321,8.75977912669413e-05,2.0088595459108214e-05,3.1100842812476954e-06,3.1397949655054445e-07,2.0413784624473929e-08,8.5020175392925583e-10,2.261698692066317e-11],[0.0012260687436406481,0.0015691831464360081,0.0033983385680374078,0.0093719282732268767,0.021943343833620996,0.042540650649765838,0.071191643533132093,0.1045963033555713,0.13747375182890731,0.1678306887007282,0.19624616035698472,0.22348283008357966,0.25645555441081286,0.30703897044381084,0.37721460549724933,0.45682435869341631,0.53001901960067321,0.57950412023292019,0.59975078090321854,0.59737063289605608,0.57989473017279247,0.54862351126009201,0.49856695623571073,0.43417717084436291,0.37272995294796946,0.32771490429900008,0.30050498546312188,0.28248135149153031,0.259051052056464,0.21965211868267923,0.16834044885904081,0.12070170974238846,0.088934096399986062,0.071116060379746188,0.058112307365424207,0.045342482742742142,0.032899017864723719,0.021704023340036051,0.01255996186807703,0.0061931476780674455,0.0027864088717611019,0.0013494026267363451,0.0006583321288599124,0.00025043321767601907,6.4290158900637341e-05,1.064616025654543e-05,1.1237848688978264e-06,7.5382642395863527e-08,3.2105414872405968e-09,8.6791289008130403e-11],[0.0031627523412467934,0.0033572284860189784,0.004817370455399002,0.010634160932703134,0.023352771228563024,0.045332896519292086,0.07759359244846542,0.11470749537166115,0.14851487444520955,0.17905522082531886,0.20927045879901907,0.23532092498639942,0.25888395495260141,0.29410949441122153,0.34875089631431916,0.41524917683393037,0.47685853305340475,0.5156351596544646,0.52772771891142478,0.52071600629151549,0.50081001876723108,0.47053833781682403,0.42732610189041942,0.37308391699626997,0.32254244320232517,0.29006362173014055,0.27475057428359051,0.26416929147514617,0.24618964012522762,0.21387659674738249,0.16853188428109422,0.12300234271360874,0.091209992176578117,0.072011403438495158,0.055826498732745214,0.040098765348506947,0.027372227572533613,0.018143021798062712,0.011233197223884253,0.0064902259977308221,0.0040738933385856,0.0028267889390103207,0.0016485762107040873,0.00066437801624666989,0.00017355955305830932,2.8917757113511358e-05,3.0610271639941947e-06,2.0565864626312077e-07,8.7680540432130536e-09,2.3719744798452991e-10],[0.0060054963386746889,0.00633707653794851,0.0077552638652602967,0.013775022893237456,0.026129852196674633,0.046619470216932121,0.077419398669802797,0.11439764145647448,0.14934576346225195,0.18195877488459081,0.21445832547858104,0.24004794689902348,0.25757981927149137,0.28214913092006216,0.32358265049478396,0.37450389426938835,0.42014327575338106,0.44815846336327936,0.45759620829589753,0.45219497762532745,0.43319200143584025,0.40487922810093618,0.36979164009005216,0.32924515464582643,0.29328956211273971,0.2722336969810164,0.26136873689440315,0.24775155460218842,0.22601969771561761,0.19550567045420633,0.15533164290929816,0.11407169304743382,0.085021904133462986,0.067431561844340557,0.051802229906703932,0.036518542990079672,0.025118284042845353,0.017600989585073824,0.011858260531077445,0.0079186117781063457,0.0061791238412824603,0.0049544502959941615,0.0030365115703337164,0.0012399957349103852,0.00032502114266507305,5.4201802977652365e-05,5.7389515148941217e-06,3.8561750110857689e-07,1.6441269445763358e-08,4.4479148100162897e-10],[0.008480502122010479,0.0096564667192755582,0.01181532035728354,0.018367290751236783,0.029577490728825696,0.045767552819509318,0.070521121009680984,0.10381449538771609,0.13957743972288528,0.17479048184387744,0.20791157403690555,0.23082464228471253,0.24312837502184048,0.26181690451421907,0.29700634722541919,0.33838890058550419,0.37124231385444689,0.39017566256361341,0.39938499929165944,0.39910784885950762,0.38436939464077302,0.35901637431526418,0.33033262639496891,0.30185837191172527,0.27912289666800244,0.26493666685151651,0.25121657659072655,0.2291221704690726,0.20142984581389078,0.17141787727162672,0.13510844028161798,0.097456967281758886,0.071554584211231856,0.057739540801287986,0.046571330438290606,0.035623009316984887,0.027714271697987479,0.021938881323219219,0.015836804731436338,0.010688418581540821,0.0081462453056648561,0.0064181660288903089,0.003910093579688005,0.0015940135770086956,0.00041760981063300451,6.9632125465705113e-05,7.3724128972616108e-06,4.953686417890238e-07,2.1120629958716913e-08,5.7144570566120467e-10],[0.0092736813475105748,0.011918613514482796,0.015566892239088217,0.022891039357144764,0.032970264051003943,0.044940900522343202,0.063259378089685819,0.091485954211299986,0.12589216526209726,0.16102388535446321,0.19158492403142111,0.20894913624265266,0.21485071498679709,0.22851021014964851,0.26027386364902849,0.29716212089970306,0.32339529247670024,0.33804453581072857,0.34916116802651115,0.35502608133654379,0.34656539419654669,0.3256858054571955,0.30140400789810917,0.27970936922249556,0.26354862587781286,0.24994555359684903,0.23036340252478207,0.20230373088176068,0.1739738817020072,0.1482005931786714,0.1169986857206432,0.082319319763110813,0.057863346810311328,0.04690270534420557,0.04096991214848731,0.035605611933955394,0.031640858478849634,0.027377297922605844,0.02036027418552808,0.012984986721194204,0.0085297208650838095,0.0059948667632761642,0.0034993304681374747,0.0014091575085559997,0.0003679483735984343,6.1295527521680664e-05,6.4881158532905031e-06,4.3592129726088101e-07,1.858888713020859e-08,5.0701314314543205e-10],[0.0081400640008350046,0.011964760227083523,0.017009397244093664,0.02502083784824664,0.034665976099541564,0.044547974111152029,0.05859841445961575,0.081473291820914104,0.11140288799790836,0.14284323395870388,0.16858012017183507,0.1793896047682082,0.17816180427231409,0.18471198554396373,0.2097627080046045,0.24150224305803447,0.26584718723888218,0.28341952963879041,0.30114994117019844,0.31418240744333026,0.31178876643399245,0.29542301764175122,0.27432995803125942,0.25502319666660972,0.23910338649706023,0.22196229377679375,0.1976629305597557,0.16916870437963527,0.14592424109193686,0.127606931619236,0.10336444111599163,0.07276692418550354,0.049266492690137345,0.039475634524766337,0.036891857363561459,0.034956120503882686,0.032534188979149212,0.028488001933524871,0.021152283747436305,0.012782160831040505,0.0070794007131789018,0.0041238240718283782,0.0021978652254853624,0.00085941613302262438,0.00022252266682920357,3.6982086617067745e-05,3.9119706266351273e-06,2.6286040939609083e-07,1.1354348683506855e-08,4.9276232188789691e-10],[0.0057679126088467075,0.0096691221135175674,0.015241984032763122,0.02357157047470481,0.033284508712844538,0.042575633715491709,0.053757178314731084,0.070938665923117206,0.094159094436892771,0.11959786657042645,0.13997643032200813,0.14593762542819921,0.14010254658028237,0.13984146315668453,0.15510484982887232,0.17872049242494145,0.2018418398253897,0.22515886608160282,0.25087874392742848,0.26989066727906558,0.27130310982361172,0.25853115973582014,0.24168161492728382,0.22580250220389128,0.2103599209050652,0.19087803986866508,0.16464203710024164,0.13822259930505912,0.12064194247064902,0.1090793292792627,0.09194586667796012,0.067067474747290301,0.04579878945365478,0.036209513593855255,0.033957506632895554,0.0318942622610211,0.028221068412280205,0.023381285313726866,0.016901708859081262,0.0098474278934852048,0.0047545297369695882,0.0021985271510998445,0.00099565625811883461,0.00036501251461799438,9.2633757745369901e-05,1.5306075707851957e-05,1.6171137494250726e-06,1.1088031401629019e-07,9.2827902787458461e-09,5.9710436807524262e-09],[0.003243503048969136,0.0062892221266030437,0.011471270733854181,0.019639408274471672,0.029309251338892322,0.037902373436279432,0.046018254569896187,0.057290931994436509,0.073411963476402886,0.092416770086784977,0.10823091741858142,0.11289068417157162,0.10803224642055831,0.1056608842274325,0.1131260896729506,0.12868997921428704,0.14934518947264058,0.17469898319432095,0.20233844561073078,0.2212549757827306,0.22228797195200595,0.21162532849844867,0.20052370377900025,0.1918809556121519,0.18174941829918259,0.16437453230723795,0.1385904800544708,0.11360550660688883,0.099325740865963935,0.092424322053901331,0.081377989105216639,0.062686040561543255,0.044659288680602982,0.034448314969292196,0.029702723943281936,0.025190058627415853,0.019827794947134787,0.014835050722896257,0.010201866848563387,0.0057935601438746862,0.0025695219742402743,0.00096006778630761266,0.00034281418239245003,0.00011038975894255351,2.6736616567495952e-05,4.3580453311166176e-06,4.7389388641312796e-07,8.0398269721005006e-08,9.9615915723540751e-08,1.234500566222308e-07],[0.0014402597283644971,0.0033981261102700631,0.0075962904492842013,0.015013239782204953,0.024172188238314605,0.031564654591122475,0.03634424573274922,0.042157015813691863,0.052349417095144735,0.066445497520553662,0.079674225264328935,0.0860763998935824,0.086354800842389265,0.08683573400348539,0.092088522302746792,0.1045057958331122,0.12388330366338682,0.14671584964244433,0.16793123741742264,0.17885681832625261,0.17429850872101679,0.16253823732289036,0.1552427076938131,0.15410628022135697,0.15220308030917976,0.14069899746189965,0.11768787846689548,0.094230426365354517,0.082182992997945806,0.07859250048687498,0.071892893767635135,0.058207011221649695,0.043401999430621813,0.032287480365364794,0.024066991432988086,0.016984747915593557,0.011180166211118479,0.0072190282841335818,0.0045887975161123693,0.0025358908720061468,0.0010764102142017888,0.00034780288435311968,9.6040535894566104e-05,2.4880764596586595e-05,5.4495630779184743e-06,9.0329842208986891e-07,3.1955078210996674e-07,7.2449879095419179e-07,1.4219120399584919e-06,1.7847532195513933e-06],[0.00052332816717032065,0.001618818190373365,0.0046096803689249328,0.010718041978647591,0.018952393234895535,0.025467757517331279,0.02811862202217422,0.030173958650124819,0.036458126171065669,0.047844515403549871,0.060001270618906463,0.068052046108642475,0.072565791269761537,0.077019085273914115,0.08486326392234253,0.099982639979557544,0.12039477558548889,0.13812867345587379,0.14827800941071109,0.14779382529942617,0.13591308988273179,0.1208994630069474,0.113432543114681,0.1157409171887875,0.12052636289944971,0.11638214566789069,0.099286995976121534,0.079988038617104948,0.070767438819167458,0.069008672724665113,0.063986782971034509,0.053068728270238764,0.041030822273576899,0.030055640125516082,0.019773202784795097,0.011261358033487205,0.0057312106108930285,0.002885099212752529,0.0015610370956265676,0.00081254862961951761,0.00033493493061365477,0.00010009494474750165,2.2689609795004523e-05,4.4864134421018788e-06,8.7179558585796172e-07,5.824691844526461e-07,2.2946620632063224e-06,7.1187524442117669e-06,1.4083165638571614e-05,1.7679929266516162e-05],[0.00016948693173966927,0.00072624529942462998,0.0026367198176418527,0.0072389613639576448,0.014391551694885511,0.020859567470581833,0.02357589174561368,0.024593809638363689,0.029185138954183912,0.039039662128619902,0.049691129220836225,0.056639366030611683,0.061246675221374051,0.067220746492670069,0.078252886661417428,0.096946845873980031,0.11708723685585622,0.12791760360936752,0.12778451205296026,0.11987667516150775,0.1054593743128437,0.08954195446182231,0.08033103063066141,0.081726438103385368,0.088906711756117932,0.09074783000700988,0.081715980239757374,0.069518973074275028,0.063858208323649066,0.062561518905964161,0.057319786216601006,0.047548926694067968,0.037904115705960896,0.028638423633472628,0.018547646900025909,0.0096599777899817867,0.0040405922611880824,0.0014354342884228329,0.00050855116280857369,0.00020321406041721391,7.6373624662010115e-05,2.1647043501605073e-05,4.3730506223848718e-06,7.1533246039590825e-07,5.0162448445537569e-07,3.1636800172799492e-06,1.5490977139743091e-05,4.830080576314169e-05,9.556469846827067e-05,0.00011997167789750219],[5.6103563662375931e-05,0.00033327778612774552,0.001507182616626624,0.0048505104647440728,0.01093829322115423,0.017612040932945005,0.021680312929907783,0.02380510500178119,0.028278661815739153,0.036668912962030578,0.044720476819818007,0.048512438124452051,0.050274444013919485,0.05486358561636473,0.06612362173196433,0.084045715762380097,0.099734434715600714,0.10361472591893224,0.098201310644330672,0.090027341372575231,0.079217498769661915,0.066191648740073161,0.056526658938288725,0.05543718974518292,0.061111022626791217,0.065264713035623617,0.062871187845572982,0.057822431105109186,0.055678721489300871,0.054854445371414658,0.049935136114009508,0.041593797911415056,0.034337451239347332,0.027610961818623426,0.019104170054185698,0.010461404587217334,0.0043757652773529871,0.0013623844634423968,0.00031928861223337075,6.546927527122234e-05,1.5007164253947097e-05,3.5197669721937467e-06,6.5536650581743968e-07,2.4154192646099729e-07,1.9008899432755321e-06,1.4652024089527817e-05,7.2001306393514012e-05,0.00022451543252402791,0.00044421165354064062,0.00055766219037220986],[2.4541163666680883e-05,0.00018777827275099496,0.00099029404593024991,0.0035399522384341898,0.0086658784817791913,0.015088889772775036,0.020247904813864012,0.023939788606021483,0.028654909727374445,0.035283374897175673,0.040521643670595978,0.041409039771844187,0.040398721339238872,0.04278961496286901,0.051785165739930639,0.065008883110101306,0.074137929628882243,0.073793169665418476,0.068677570413927594,0.064172800357215704,0.058020057277481919,0.048294827114649969,0.039478980915174273,0.036829337498103625,0.039812896362583249,0.043135897352390554,0.043575175112186892,0.042737285671541669,0.043039624110593984,0.043298678268179888,0.040209277756363467,0.034552697038178107,0.029935734247701996,0.025566803793024031,0.018790766748756807,0.010837226740105581,0.0046864531008262251,0.001457588475856846,0.00031397519858672787,4.6604927982431569e-05,5.2551361214908818e-06,5.9483352348109138e-07,1.0217629849801615e-07,5.0216465513395237e-07,6.0239560422600017e-06,4.6650723354472372e-05,0.00022925912833335647,0.00071487958215773757,0.0014144143412271792,0.0017756522001742801],[1.9221910678167097e-05,0.00015899455078455073,0.00086078697228826519,0.0030849705673123913,0.0075380054633810197,0.013320605217388832,0.018699222162311735,0.023241487329332414,0.027824146801922467,0.032672261441807814,0.03564920545177757,0.034771209666789309,0.032278319172032638,0.033176878000025285,0.039747150317952111,0.048261208024435752,0.052489432971531462,0.051226643589151057,0.049054507337668557,0.047830586069048019,0.043654979270511811,0.035186107239114812,0.027252346644998152,0.024280012406568092,0.025489894270128682,0.02728973981998755,0.027889639703116045,0.028225491516881585,0.029408724467529093,0.03051054541223315,0.02959342941273943,0.027182649992288165,0.025302350312807319,0.022670569760585475,0.017014791327481391,0.0098302857080841532,0.0042066173147378184,0.0012862996524475477,0.00027041193503765312,3.7943133119825329e-05,3.5251019998085629e-06,2.2943894440783959e-07,6.8475968408275175e-08,1.0770435268155423e-06,1.3137395422569916e-05,0.00010175102982874715,0.00050004325028434277,0.0015592431064140743,0.0030850172068623825,0.0038729228284118795],[2.0836740386664051e-05,0.00016902832264667497,0.00088441544619000004,0.0030331376096750708,0.0070773082467301962,0.012113987227791665,0.016995847460071854,0.021522111773061958,0.025788115582193957,0.029526379537524822,0.031146579696592597,0.029216340221813394,0.025800939392056643,0.025520682722567165,0.030290407271142034,0.036250419851875257,0.03856996089041051,0.037907838902326546,0.038005886428163133,0.038305265263745815,0.034592381086189665,0.026767897148415692,0.019813849942499996,0.017064470062676133,0.017375906571371915,0.018138691251436519,0.018236771868001229,0.018376683656302132,0.019314155048583595,0.020519988556433694,0.021076327606028882,0.02125505630155174,0.021602255541011344,0.020265120087410084,0.015346564239667022,0.0087165690338249571,0.0036023003347941257,0.001055601492711948,0.00021274203546617148,2.8670384611226725e-05,2.5334410143246555e-06,1.4838575071651672e-07,8.912910393604132e-08,1.6081659518839695e-06,1.9628304992869219e-05,0.00015202463748503897,0.00074710689544577459,0.0023296410383580801,0.0046092765519461527,0.0057864741696701926],[2.0412999257464572e-05,0.00016282553230478032,0.00083315327723601897,0.0027772229693549012,0.0062676235352467731,0.010403285207033076,0.014398236294432426,0.018374698311656081,0.022349028046979226,0.025814969498970133,0.027104126339751525,0.024826224859387,0.020894340352786405,0.019603569174235801,0.023002850601442391,0.02792493557901508,0.030023758908384841,0.029777900494472681,0.030383001900307377,0.031069463647844384,0.028199669060560102,0.022113681901137001,0.016990804884372358,0.014872591086764258,0.014519567353911288,0.014368159541654196,0.013901634526416315,0.013531894516239129,0.013745262033338838,0.014534044220907838,0.015591968263172841,0.016813879801955547,0.018145504282461405,0.017912983630497387,0.014207019042913081,0.0083573589735999772,0.0035076292243393717,0.0010217938279456495,0.00020142398200191487,2.6317401243985739e-05,2.2494205939232922e-06,1.2824891744770182e-07,9.0179146993621147e-08,1.645848400741323e-06,2.0088715352006314e-05,0.00015559061146200702,0.00076463144852265781,0.0023842863886910119,0.0047173942953306807,0.0059222049122990943],[1.6755586585053901e-05,0.00013291921364029066,0.00067561512832891473,0.0022350171352295686,0.0050060299406317491,0.0082639261427236155,0.011411144096381476,0.014564121802582783,0.017832221383002458,0.020956973365699787,0.022473657447496041,0.020991727844942042,0.017972928813627231,0.01690366950309375,0.01950659574127071,0.023412811117232743,0.025132577353457232,0.024834553656256472,0.02519678806245922,0.025767406730519762,0.02364950436634054,0.019511638287224475,0.01664792484319607,0.015628512204969584,0.014938413494323786,0.014029248593882387,0.013112735326048657,0.012320108341967949,0.011833411903644396,0.012010456160075315,0.01261644820360674,0.01314894862361243,0.013912165754361968,0.014296375285015372,0.012300187504486269,0.0078763583548467839,0.00353305542720101,0.001073957603841109,0.00021695504920081517,2.8962857544566768e-05,2.6011924921855274e-06,1.6919090123329062e-07,6.8565133256475235e-08,1.1541553496279801e-06,1.4083680753952677e-05,0.00010908047892976204,0.00053606296416098534,0.0016715603725004789,0.0033072408595443397,0.004151901842069111],[1.5022051178370476e-05,0.00011887574517184491,0.00060394069600148829,0.0020011387509477974,0.0044951114662915353,0.0074034470978658912,0.0099792116330099188,0.012019141072864942,0.013700485984508954,0.015496904686639888,0.016980561595774053,0.017251177495966309,0.017037994165224793,0.018024107824845727,0.020331671989884254,0.022227143275045425,0.022512123756961693,0.022129218875467479,0.022626142977093693,0.022786663075050333,0.020342938053423618,0.016997843072901347,0.01575430326369404,0.01585576319674268,0.015370860661089735,0.014438065672881759,0.013654573813094501,0.012900209372142169,0.012324831309738495,0.012327439632600868,0.012114636128294724,0.010888640265690253,0.0098450563983182339,0.0097743307832458132,0.0089754088450442176,0.0062367459006976616,0.0029942692976243084,0.00096605998836454571,0.00021172318858048991,3.3489313220959766e-05,4.2730156917873873e-06,4.7088009144611219e-07,7.0214613609230124e-08,5.5668768255206971e-07,6.7636415901369638e-06,5.2384758008205329e-05,0.00025743861292293801,0.00080274932686116472,0.0015882677152688478,0.0019939072879113368],[1.8653097864544436e-05,0.00014467645105339436,0.00072529136537589683,0.002376931640061088,0.0052493976303672543,0.0083151518268306905,0.010337812349491502,0.010920318607459595,0.010514651265711229,0.010382579704791358,0.011385675175424324,0.013571122163299429,0.01705328164116646,0.020964522188372085,0.022832372251326429,0.021713222210139729,0.0198964024570468,0.019756796301684334,0.02096134137629703,0.020576883299928284,0.017056873749964944,0.013498743837807999,0.012838193701913048,0.01356292479758414,0.013711109493463944,0.013671398955215188,0.013675691042204468,0.013324588403378218,0.013207694687203257,0.013626478654340878,0.012895845624279296,0.010025010640330354,0.0070258609423807291,0.0057656580277325375,0.005220663799825353,0.003849665303321018,0.0020298092497391998,0.00078245015694635323,0.00024429415435275664,6.6056566961213267e-05,1.4389649185917468e-05,2.2389166890712576e-06,2.4071624890023471e-07,1.9767224252883841e-07,2.2256319384211634e-06,1.7232864840579593e-05,8.4688766510077279e-05,0.00026407790699304289,0.00052248740665769111,0.00065592937384632095],[2.6938075767033938e-05,0.00019465611802865158,0.00092715130881577523,0.0029260834132032909,0.0062388403964824968,0.0093853167426789542,0.010658428832181665,0.0097740459297722335,0.0077281083887840701,0.0062493865763773105,0.0068805909485203879,0.010474788265708667,0.016766156439110485,0.022567137244701153,0.023341735464429733,0.019400301035798578,0.016150439279445431,0.016825305629115311,0.018991198444495382,0.018097029113140171,0.013525386088048026,0.0094657637850045478,0.0086341012918579683,0.0095043891551675093,0.01058214541627781,0.011995166397289406,0.012986435968988548,0.012866921266832948,0.012829331241746114,0.013263764179327217,0.01218569107155291,0.0087098153618049897,0.0049787146603834142,0.0030373549177860242,0.0024827809818270432,0.0020973724926726714,0.0015671260499573914,0.0010351657888129349,0.0005560039228627128,0.00021427020785447763,5.4927419561978575e-05,9.0805865838292792e-06,9.5978106293449971e-07,1.0526997089808217e-07,5.0411791226760358e-07,3.8833956899566575e-06,1.9084122242500779e-05,5.9508420672800292e-05,0.00011773949869146425,0.00014780986999789991],[4.3424930118528024e-05,0.00027500728823253372,0.0011697223906091047,0.0033826284693377487,0.0067759888945953389,0.0096843971701292397,0.010265267685262364,0.0083687600797140004,0.005492050750160145,0.0035914370457963739,0.0042066474412985689,0.0083500439407969435,0.015336436015743143,0.020818218448676557,0.020105908928680076,0.01493914513666819,0.011827763326277442,0.013582397948795632,0.016391699214198609,0.01516642584572527,0.010175163313610744,0.0059396543590711764,0.0047916393956965748,0.0056943462286054292,0.0077705699699668089,0.010561471515233442,0.012319015034322908,0.012166989587761506,0.011496180990076736,0.010895203464551362,0.0091771412953593166,0.0060561070653450096,0.0030555865388503219,0.0014981060930013654,0.0013067513150970007,0.0018306917951163787,0.0023895198730233347,0.0022780782496281647,0.0014489608683882318,0.0005947871973750751,0.00015578866784005606,2.5938295837656914e-05,2.7421719151221613e-06,1.9027580316367626e-07,8.5224805058201504e-08,5.9964909203976983e-07,2.9458680238062527e-06,9.1858429752617661e-06,1.8174512621279754e-05,2.2816237351479423e-05],[7.5479550833017911e-05,0.00042790295775846691,0.0016103106631683395,0.0041323124672825225,0.0075052555851402294,0.010031532050603443,0.010093765847381472,0.0076431493576001102,0.0044299602829415106,0.0025144789067798952,0.0030981122972477061,0.0067858802765563822,0.012480489110582523,0.016056835073119235,0.014262559006849414,0.0096560430697047329,0.0076512806912800825,0.0098302266649473637,0.012418123988446442,0.011209165982101147,0.0069257743167155401,0.0033738972840624483,0.0023188240339961511,0.0033357626378182252,0.006076451913390065,0.0096245769033689588,0.011789052312495749,0.011697889910225516,0.010387981679256154,0.0084233531340199078,0.0058792940688212137,0.0033258719649074081,0.0015005285630948426,0.00078100529753300819,0.0012294011420314398,0.0027043952190549891,0.0042496183921243626,0.0043303218872626191,0.0028168293710613772,0.0011648479238096283,0.00030583279407668637,5.0959328006107306e-05,5.3880556984338428e-06,3.6214826673095868e-07,2.3571393448274869e-08,6.3799507863724116e-08,3.1149961217317194e-07,9.7130109189165248e-07,1.9217531448955407e-06,2.4125640553382204e-06],[0.0001133158102453258,0.00061237522330080598,0.002157925065544151,0.0050940727567324344,0.0084396643700054199,0.010404506301354366,0.0099076895011334532,0.0072876930748784589,0.0043045554603077137,0.0026886011034203783,0.002995554342116812,0.0053285603036963437,0.0087110720429795958,0.010250737359756158,0.0083043478645523985,0.005153088841859662,0.0041293601969453562,0.0057512297965895591,0.0074095395465442904,0.0065597711035974395,0.0038532898516255628,0.0016660041727613669,0.001085751132770068,0.0021453823839822196,0.0048650514954828028,0.0082804054731660873,0.010408070111106952,0.010541636893718717,0.0091720869156229415,0.0066074834764907739,0.0037221553779355986,0.0016423571621747947,0.00063075040633878219,0.00050928356916945486,0.001422122624187854,0.0035266523458368092,0.0056908980133700254,0.0058443322656013567,0.0038109073944007604,0.0015770712401744231,0.0004141347252064392,6.9004846706403861e-05,7.2955640922334701e-06,4.8946319162703586e-07,2.1424881892590386e-08,5.1536432435062606e-09,2.2571592357978706e-08,7.0353150815287988e-08,1.3919597118694906e-07,1.7474627060170097e-07],[0.00012556853048722004,0.00066769574253478133,0.0022918195984767999,0.0051873872761843322,0.0080778680888261897,0.0092436923001276601,0.0083090682727623537,0.0062150953658029482,0.0044721633973533416,0.0038243575090315123,0.0038053533009566585,0.0042915209512916176,0.0052261509091859832,0.0053523655155998089,0.003937148098259893,0.002232555078132976,0.0017447335554922605,0.0025088177235869438,0.0032400747106128866,0.0028235103595913567,0.0016101083087645737,0.00066430541668427673,0.00050824136106668359,0.0013488648211202017,0.0033541537098359104,0.005838375211685517,0.0074491488676989674,0.0077217000056343157,0.0067683112221634586,0.004661520896890997,0.0023235043297375217,0.00082945588535484011,0.00027047303540928967,0.00037601433023119795,0.0013323667876911941,0.0033785132731895388,0.0054675719609382474,0.0056169726875263193,0.0036617256705003946,0.0015146766931802504,0.00039755572785611057,6.6209131487387712e-05,6.9964681869872223e-06,4.6911884873155786e-07,1.9987693077406574e-08,7.6656182866170549e-10,1.1286662099450674e-09,3.4907494850327951e-09,6.9063726097241215e-09,8.6702419074914508e-09],[9.7250722334891275e-05,0.00051401790543659134,0.0017441306389151699,0.0038606112117692678,0.0057722968183984806,0.0062246871291120852,0.0053823512446396085,0.0044999356521229859,0.0046519143692663936,0.0053974569114373858,0.0052090206253375326,0.0040198404536425083,0.0030099761681451963,0.0023177653636956164,0.0014932913375881375,0.00076683501661071465,0.00055255939058963344,0.00078294027377481085,0.0010037087407040082,0.00086279899242204625,0.00048306608801207944,0.00020213994707913674,0.00021324757346243527,0.00068116843748311127,0.001743626599068171,0.0030572994734174457,0.003944564919557943,0.0041689836181372673,0.0037040888518850017,0.0025293593272258416,0.0012083190388327701,0.00039238787247947735,0.0001265280792754942,0.00027560584287719881,0.0010530402626801724,0.0026763142636272428,0.0043225764699517961,0.0044302843246589235,0.0028812090613157515,0.0011889656059601462,0.00031132532805237882,5.1726130045468127e-05,5.4532542139144862e-06,3.6479738176311232e-07,1.548551107410911e-08,4.247969224060384e-10,4.5174271335197037e-11,1.1871527067218739e-10,2.3472993622183375e-10,2.9467870515549629e-10],[5.1869830896318045e-05,0.00027337260249768642,0.00092177820021279919,0.0020124473364029625,0.0029264068777329084,0.0030308267015677691,0.0026659217915823252,0.0029163381700313407,0.0044294285409967448,0.0060949388985838439,0.0058908856228797966,0.0038768452794873047,0.0019417133053310325,0.00093258387719704348,0.00045792585477968532,0.00020416100343172229,0.00012823567256503568,0.00017174128008247473,0.00021716991650149787,0.00018441303741002996,0.00010206619057372597,4.5802023400688986e-05,7.0463882265187197e-05,0.0002490596121856451,0.00064364289348201173,0.0011335260483853918,0.00147707204498018,0.0015862550472595597,0.0014274936179523056,0.00097696553640835198,0.00046184277698573184,0.00014778428834790624,6.9547804683292117e-05,0.00025752632053163845,0.0010122232981396196,0.0025621294912467922,0.004116554088519386,0.0041968646634422098,0.0027150014657772795,0.0011144714854240372,0.00029028304534607982,4.7976465349263392e-05,5.031398912569728e-06,3.3481371602889399e-07,1.4137495579207006e-08,3.7896665857362867e-10,7.3255690422611019e-12,2.8315460484853512e-12,5.4653383949894816e-12,6.8605771237561326e-12],[1.8980502815458098e-05,9.9863990175484455e-05,0.0003353796164175044,0.00072548323682165719,0.001035835206254598,0.0010589851954281352,0.0010588821316687988,0.0017159474341202964,0.0033709923696268202,0.0049765027952546901,0.0048297204581331729,0.0030338471781155797,0.0012774461561211685,0.00041006415942797172,0.00012702588654697384,4.2704403087260317e-05,2.1678383091923243e-05,2.6297808492678194e-05,3.2621963908635755e-05,2.7395595917747017e-05,1.5075484600216006e-05,7.7026237673175443e-06,1.7021109716397397e-05,6.3548184524464605e-05,0.0001649363615851342,0.00029168934925422431,0.00038374240619644276,0.00041794823513128349,0.00038040724915249386,0.00026156371027449664,0.00012373182327182829,4.3304988920409873e-05,5.9032203476096513e-05,0.00032351508950230777,0.0012829469580266351,0.0032375583558743367,0.0051843675254062043,0.0052676556353507195,0.0033961107850918777,0.0013892782629714045,0.00036061152956021273,5.9392691877433509e-05,6.2068250492979872e-06,4.115751565121808e-07,1.7316974696800316e-08,4.6231804869689095e-10,7.8456746006326169e-12,1.2822791894968898e-13,8.7727700824097952e-14,1.0941487999092846e-13],[4.7603627865487805e-06,2.5017788565720461e-05,8.3789328040152652e-05,0.00018014526672093149,0.00025498574439798574,0.00026956325080777739,0.00035761053688025874,0.00084047258408357717,0.0018701598231980472,0.0028321685918265144,0.0027548205108631303,0.0017097314918340404,0.00068325431602212514,0.00018329310461429551,3.7785637728031324e-05,7.8674855020948099e-06,2.729929854684226e-06,2.8070935253836389e-06,3.3921554801143865e-06,2.8199019572082368e-06,1.5533802008075822e-06,9.6500116368376942e-07,2.9050756276065227e-06,1.1179629249575562e-05,2.909862520424694e-05,5.168822266545418e-05,6.8650317323426313e-05,7.576065924945664e-05,6.9674525256089204e-05,4.815519620539012e-05,2.3114236889357738e-05,1.2900785389569745e-05,5.9569040523815801e-05,0.00036459381951445009,0.0014482382851264994,0.0036518186389849351,0.0058427991334838404,0.005931592606436142,0.0038208519280474905,0.0015616641633052603,0.00040499870885724065,6.6643562376306865e-05,6.9582712305687631e-06,4.6098107971512793e-07,1.9377754970882737e-08,5.16847560921013e-10,8.7471733136664491e-12,9.4409493204710031e-14,1.5920936810961368e-15,1.1980389095096348e-15]],"type":"surface","frame":null},{"x":[16.491295067553189],"y":[2.9073870875450041],"z":[0.67598451376896274],"type":"scatter3d","mode":"markers","marker":{"color":"red","size":5,"line":{"color":"rgba(255,127,14,1)"}},"name":"Posterior Mean","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="joint-distribution-under-independent-priors" class="level3" data-number="2.2.12">
<h3 data-number="2.2.12" class="anchored" data-anchor-id="joint-distribution-under-independent-priors"><span class="header-section-number">2.2.12</span> Joint Distribution Under Independent Priors</h3>
<p>Under certain prior specifications that maintain independence between <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\tau\)</span>, we can derive closed-form marginal posteriors. Specifically, with independent priors where <span class="math inline">\(p(\beta, \tau) = p(\beta)p(\tau)\)</span>, we can integrate out one parameter to obtain marginal distributions.</p>
<p><strong>Marginal for</strong> <span class="math inline">\(\beta\)</span>:</p>
<p>If we use an improper uniform prior for <span class="math inline">\(\beta\)</span> and Jeffrey’s prior for <span class="math inline">\(\sigma^2\)</span> (i.e., <span class="math inline">\(p(\beta, \sigma^2) \propto 1/\sigma^2\)</span>), the marginal posterior for <span class="math inline">\(\beta\)</span> follows a t-distribution:</p>
<p><span class="math display">\[\beta | \mathbf{y} \sim t_{n-1}\left(\hat{\beta}, \frac{\hat{\sigma}^2}{\sum x_i^2}\right)\]</span></p>
<p>where <span class="math inline">\(\hat{\beta} = \frac{\sum x_i y_i}{\sum x_i^2}\)</span> and <span class="math inline">\(\hat{\sigma}^2 = \frac{\sum(y_i - \hat{\beta}x_i)^2}{n-1}\)</span>.</p>
<p><strong>Marginal for</strong> <span class="math inline">\(\tau\)</span>:</p>
<p>With the same prior structure, after integrating out <span class="math inline">\(\beta\)</span>, the marginal posterior for <span class="math inline">\(\tau\)</span> is:</p>
<p><span class="math display">\[\tau | \mathbf{y} \sim \text{Gamma}\left(\frac{n-1}{2}, \frac{RSS}{2}\right)\]</span></p>
<p>where <span class="math inline">\(RSS = \sum(y_i - \hat{\beta}x_i)^2\)</span>.</p>
<p>This special case provides closed-form posteriors but is limited to specific prior choices. The Gibbs sampling approach is more flexible and extends naturally to more complex models.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Analytical t-distribution for beta</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">length</span>(y) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>scale <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sigma_hat_unbiased<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>comparison_analytical <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Analytical (t-dist)"</span>, <span class="st">"Gibbs Sampling"</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">round</span>(beta_hat, <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">mean</span>(gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>)),</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">SD =</span> <span class="fu">c</span>(<span class="fu">round</span>(scale <span class="sc">*</span> <span class="fu">sqrt</span>(df<span class="sc">/</span>(df<span class="dv">-2</span>)), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">sd</span>(gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>)),</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI Lower</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(beta_hat <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.025</span>, df) <span class="sc">*</span> scale, <span class="dv">4</span>),</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">quantile</span>(gibbs_results<span class="sc">$</span>beta, <span class="fl">0.025</span>), <span class="dv">4</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">95% CI Upper</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(beta_hat <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, df) <span class="sc">*</span> scale, <span class="dv">4</span>),</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">quantile</span>(gibbs_results<span class="sc">$</span>beta, <span class="fl">0.975</span>), <span class="dv">4</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_analytical, <span class="at">caption =</span> <span class="st">"Comparison: Analytical vs Gibbs Sampling for β"</span>, <span class="at">align =</span> <span class="st">'lrrrr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Comparison: Analytical vs Gibbs Sampling for β</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI Lower</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">95% CI Upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Analytical (t-dist)</td>
<td style="text-align: right;">2.9091</td>
<td style="text-align: right;">0.1443</td>
<td style="text-align: right;">2.625</td>
<td style="text-align: right;">3.1932</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.5%</td>
<td style="text-align: left;">Gibbs Sampling</td>
<td style="text-align: right;">2.9079</td>
<td style="text-align: right;">0.1422</td>
<td style="text-align: right;">2.633</td>
<td style="text-align: right;">3.1911</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="logistic-regression" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Logistic Regression</h1>
<p>We now consider logistic regression for binary outcomes. The model is:</p>
<p><span class="math display">\[\log\left(\frac{P(Y_i = 1|X_i)}{1 - P(Y_i = 1|X_i)}\right) = \beta X_i\]</span></p>
<p>or equivalently:</p>
<p><span class="math display">\[P(Y_i = 1|X_i) = \frac{\exp(\beta X_i)}{1 + \exp(\beta X_i)} = \frac{1}{1 + \exp(-\beta X_i)}\]</span></p>
<p>Again, we omit the intercept for simplicity, though this is rarely done in practice.</p>
<section id="frequentist-estimation-1" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="frequentist-estimation-1"><span class="header-section-number">3.1</span> Frequentist Estimation</h2>
<section id="maximum-likelihood-estimation-1" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="maximum-likelihood-estimation-1"><span class="header-section-number">3.1.1</span> Maximum Likelihood Estimation</h3>
<p>The likelihood for logistic regression is based on the Bernoulli distribution:</p>
<p><span class="math display">\[L(\beta | \mathbf{y}, \mathbf{x}) = \prod_{i=1}^n p_i^{y_i}(1-p_i)^{1-y_i}\]</span></p>
<p>where <span class="math inline">\(p_i = \frac{1}{1 + \exp(-\beta x_i)}\)</span>.</p>
<p>The log-likelihood is:</p>
<p><span class="math display">\[\ell(\beta) = \sum_{i=1}^n \left[y_i \log(p_i) + (1-y_i)\log(1-p_i)\right]\]</span></p>
<p><span class="math display">\[= \sum_{i=1}^n \left[y_i \log\left(\frac{p_i}{1-p_i}\right) + \log(1-p_i)\right]\]</span></p>
<p><span class="math display">\[= \sum_{i=1}^n \left[y_i(\beta x_i) - \log(1 + \exp(\beta x_i))\right]\]</span></p>
<p><strong>Deriving the MLE:</strong></p>
<p>The score function (first derivative) is:</p>
<p><span class="math display">\[\frac{\partial \ell}{\partial \beta} = \sum_{i=1}^n \left[y_i x_i - \frac{x_i \exp(\beta x_i)}{1 + \exp(\beta x_i)}\right]\]</span></p>
<p><span class="math display">\[= \sum_{i=1}^n x_i(y_i - p_i) = 0\]</span></p>
<p>This equation does not have a closed-form solution and must be solved numerically using methods such as Newton-Raphson or iteratively reweighted least squares (IRLS).</p>
<p><strong>Standard Error:</strong></p>
<p>The observed information is:</p>
<p><span class="math display">\[\mathcal{I}(\beta) = -\frac{\partial^2 \ell}{\partial \beta^2} = \sum_{i=1}^n x_i^2 p_i(1-p_i)\]</span></p>
<p>The asymptotic variance of <span class="math inline">\(\hat{\beta}\)</span> is:</p>
<p><span class="math display">\[\text{Var}(\hat{\beta}) = \frac{1}{\mathcal{I}(\hat{\beta})} = \frac{1}{\sum_{i=1}^n x_i^2 \hat{p}_i(1-\hat{p}_i)}\]</span></p>
<p>where <span class="math inline">\(\hat{p}_i = \frac{1}{1 + \exp(-\hat{\beta} x_i)}\)</span>.</p>
</section>
<section id="demonstration-with-real-data-1" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="demonstration-with-real-data-1"><span class="header-section-number">3.1.2</span> Demonstration with Real Data</h3>
<p>We’ll use a simple dataset to demonstrate logistic regression:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a simple dataset</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">456</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>x_log <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>true_beta <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>p_true <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>true_beta <span class="sc">*</span> x_log))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>y_log <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p_true)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Store in dataframe</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>logistic_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_log, <span class="at">y =</span> y_log)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Manual maximum likelihood (using optim)</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>log_lik_logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, y, x) {</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>beta <span class="sc">*</span> x))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="fu">sum</span>(y <span class="sc">*</span> <span class="fu">log</span>(p) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Find MLE</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>mle_result <span class="ot">&lt;-</span> <span class="fu">optim</span>(<span class="at">par =</span> <span class="dv">0</span>, <span class="at">fn =</span> log_lik_logistic, <span class="at">y =</span> y_log, <span class="at">x =</span> x_log,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">method =</span> <span class="st">"BFGS"</span>, <span class="at">hessian =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>beta_hat_log <span class="ot">&lt;-</span> mle_result<span class="sc">$</span>par</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>se_beta_log <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">solve</span>(mle_result<span class="sc">$</span>hessian)[<span class="dv">1</span>,<span class="dv">1</span>])</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify with observed information</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>beta_hat_log <span class="sc">*</span> x_log))</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>obs_info <span class="ot">&lt;-</span> <span class="fu">sum</span>(x_log<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> p_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat))</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>se_beta_formula <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">/</span> obs_info)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>logistic_manual <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">"β̂"</span>, <span class="st">"SE(β̂) from optim"</span>, <span class="st">"SE(β̂) from formula"</span>),</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(<span class="fu">round</span>(beta_hat_log, <span class="dv">4</span>), <span class="fu">round</span>(se_beta_log, <span class="dv">4</span>), <span class="fu">round</span>(se_beta_formula, <span class="dv">4</span>))</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(logistic_manual, <span class="at">caption =</span> <span class="st">"Manual MLE for Logistic Regression"</span>, <span class="at">align =</span> <span class="st">'lr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Manual MLE for Logistic Regression</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">β̂</td>
<td style="text-align: right;">| 1.577</td>
</tr>
<tr class="even">
<td style="text-align: left;">SE(β̂) from optim</td>
<td style="text-align: right;">| 0.334</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SE(β̂) from formula</td>
<td style="text-align: right;">| 0.334</td>
</tr>
</tbody>
</table>


</div>
</div>
<section id="comparison-with-glm" class="level4" data-number="3.1.2.1">
<h4 data-number="3.1.2.1" class="anchored" data-anchor-id="comparison-with-glm"><span class="header-section-number">3.1.2.1</span> Comparison with glm()</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit with glm</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>logistic_glm <span class="ot">&lt;-</span> <span class="fu">glm</span>(y <span class="sc">~</span> x <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> logistic_data, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>comparison_glm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Estimate =</span> <span class="fu">c</span>(<span class="st">"β̂"</span>, <span class="st">"SE(β̂)"</span>),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Manual =</span> <span class="fu">c</span>(<span class="fu">round</span>(beta_hat_log, <span class="dv">4</span>), <span class="fu">round</span>(se_beta_log, <span class="dv">4</span>)),</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">glm()</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">coef</span>(logistic_glm)[<span class="dv">1</span>], <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">summary</span>(logistic_glm)<span class="sc">$</span>coefficients[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">4</span>)),</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_glm, <span class="at">caption =</span> <span class="st">"Comparison: Manual MLE vs glm()"</span>, <span class="at">align =</span> <span class="st">'lrr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Comparison: Manual MLE vs glm()</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Manual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">glm()</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">x</td>
<td style="text-align: left;">β̂</td>
<td style="text-align: right;">| 1.577</td>
<td style="text-align: right;">| 1.577</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">SE(β̂)</td>
<td style="text-align: right;">| 0.334</td>
<td style="text-align: right;">| 0.334</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="bayesian-inference-1" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="bayesian-inference-1"><span class="header-section-number">3.2</span> Bayesian Inference</h2>
<p>For logistic regression, we don’t have conjugate priors in the traditional sense because the Bernoulli likelihood doesn’t combine nicely with standard distributions. However, we can use flexible approaches.</p>
<section id="metropolis-hastings-algorithm" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="metropolis-hastings-algorithm"><span class="header-section-number">3.2.1</span> Metropolis-Hastings Algorithm</h3>
<p>The Metropolis-Hastings (M-H) algorithm is a general MCMC method for sampling from distributions that don’t have a simple form. Unlike Gibbs sampling, which requires known conditional distributions, M-H can sample from any posterior distribution.</p>
<p><strong>Basic Idea:</strong> M-H generates candidate values from a proposal distribution, then decides whether to accept or reject each candidate based on how well it fits the target posterior. This creates a Markov chain that eventually converges to samples from the posterior.</p>
<p><strong>Algorithm Steps:</strong></p>
<ol type="1">
<li><p>Start with an initial value <span class="math inline">\(\beta^{(0)}\)</span></p></li>
<li><p>For iteration <span class="math inline">\(t = 1, 2, \ldots, T\)</span>:</p>
<ul>
<li><p>Propose a new value: <span class="math inline">\(\beta^* \sim q(\beta^* | \beta^{(t-1)})\)</span> (proposal distribution)</p></li>
<li><p>Calculate acceptance ratio: <span class="math inline">\(r = \frac{p(\beta^* | \mathbf{y}) \cdot q(\beta^{(t-1)} | \beta^*)}{p(\beta^{(t-1)} | \mathbf{y}) \cdot q(\beta^* | \beta^{(t-1)})}\)</span></p></li>
<li><p>Accept $^* $ with probability <span class="math inline">\(\min(r, 1)\)</span>:</p>
<ul>
<li><p>If accepted: <span class="math inline">\(\beta^{(t)} = \beta^*\)</span></p></li>
<li><p>If rejected: <span class="math inline">\(\beta^{(t)} = \beta^{(t-1)}\)</span> (stay at current value)</p></li>
</ul></li>
</ul></li>
</ol>
<p>The “random walk” proposal we use here is symmetric (<span class="math inline">\(q(\beta^* | \beta) = q(\beta | \beta^*)\)</span>), so the proposal terms cancel and we only need the posterior ratio.</p>
<p><strong>Important Notes:</strong></p>
<ul>
<li><p>Proposal variance affects efficiency: too small = slow mixing, too large = low acceptance</p></li>
<li><p>Target acceptance rate is typically 20-40% for complex models</p></li>
<li><p>This goes beyond the scope of this course—see references for details</p></li>
</ul>
<p>For more pedagogical introductions to M-H, see Chib &amp; Greenberg (1995) and Robert &amp; Casella (2011).</p>
</section>
<section id="gibbs-sampling-with-data-augmentation" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="gibbs-sampling-with-data-augmentation"><span class="header-section-number">3.2.2</span> Gibbs Sampling with Data Augmentation</h3>
<p>One approach is to place a normal prior on <span class="math inline">\(\beta\)</span>:</p>
<p><span class="math display">\[\beta \sim N(\mu_0, \sigma_0^2)\]</span></p>
<p>The posterior is:</p>
<p><span class="math display">\[p(\beta | \mathbf{y}) \propto p(\beta) \prod_{i=1}^n p_i^{y_i}(1-p_i)^{1-y_i}\]</span></p>
<p>This doesn’t have a closed form, so we use Metropolis-Hastings within Gibbs or other MCMC methods.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Metropolis-Hastings sampler for logistic regression</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>mh_logistic <span class="ot">&lt;-</span> <span class="cf">function</span>(y, x, <span class="at">n_iter =</span> <span class="dv">10000</span>, <span class="at">burn_in =</span> <span class="dv">1000</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                        <span class="at">mu0 =</span> <span class="dv">0</span>, <span class="at">sigma0 =</span> <span class="dv">10</span>, <span class="at">proposal_sd =</span> <span class="fl">0.1</span>) {</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  beta_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># Initialize</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Log posterior (unnormalized)</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  log_posterior <span class="ot">&lt;-</span> <span class="cf">function</span>(beta, y, x, mu0, sigma0) {</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    p <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>beta <span class="sc">*</span> x))</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    log_lik <span class="ot">&lt;-</span> <span class="fu">sum</span>(y <span class="sc">*</span> <span class="fu">log</span>(p) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> y) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> p))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    log_prior <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(beta, mu0, sigma0, <span class="at">log =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    log_lik <span class="sc">+</span> log_prior</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  accept_count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter) {</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Propose new beta</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>    beta_prop <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, beta, proposal_sd)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate acceptance ratio</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    log_ratio <span class="ot">&lt;-</span> <span class="fu">log_posterior</span>(beta_prop, y, x, mu0, sigma0) <span class="sc">-</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">log_posterior</span>(beta, y, x, mu0, sigma0)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Accept/reject</span></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">log</span>(<span class="fu">runif</span>(<span class="dv">1</span>)) <span class="sc">&lt;</span> log_ratio) {</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>      beta <span class="ot">&lt;-</span> beta_prop</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">&gt;</span> burn_in) accept_count <span class="ot">&lt;-</span> accept_count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>    beta_samples[i] <span class="ot">&lt;-</span> beta</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Acceptance rate:"</span>, accept_count <span class="sc">/</span> (n_iter <span class="sc">-</span> burn_in), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">beta =</span> beta_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)])</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Run sampler</span></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>logistic_gibbs_results <span class="ot">&lt;-</span> <span class="fu">mh_logistic</span>(y_log, x_log, <span class="at">n_iter =</span> <span class="dv">11000</span>, <span class="at">burn_in =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Acceptance rate: 0.9059 </code></pre>
</div>
</div>
<section id="trace-plot-and-summary" class="level4" data-number="3.2.2.1">
<h4 data-number="3.2.2.1" class="anchored" data-anchor-id="trace-plot-and-summary"><span class="header-section-number">3.2.2.1</span> Trace Plot and Summary</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(logistic_gibbs_results<span class="sc">$</span>beta, <span class="at">type =</span> <span class="st">'l'</span>, <span class="at">main =</span> <span class="st">'Trace Plot for β'</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'Iteration'</span>, <span class="at">ylab =</span> <span class="st">'β'</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> beta_hat_log, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(logistic_gibbs_results<span class="sc">$</span>beta), <span class="at">main =</span> <span class="st">'Posterior Density for β'</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">'β'</span>, <span class="at">ylab =</span> <span class="st">'Density'</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> beta_hat_log, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> true_beta, <span class="at">col =</span> <span class="st">'blue'</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>, <span class="fu">c</span>(<span class="st">'MLE'</span>, <span class="st">'True β'</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">'red'</span>, <span class="st">'blue'</span>), <span class="at">lty =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="EstimationAndInference_files/figure-html/logistic_trace-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>logistic_gibbs_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"Median"</span>, <span class="st">"SD"</span>, <span class="st">"95% CI"</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(logistic_gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">median</span>(logistic_gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sd</span>(logistic_gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">round</span>(<span class="fu">quantile</span>(logistic_gibbs_results<span class="sc">$</span>beta, <span class="fl">0.025</span>), <span class="dv">4</span>), <span class="st">", "</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">round</span>(<span class="fu">quantile</span>(logistic_gibbs_results<span class="sc">$</span>beta, <span class="fl">0.975</span>), <span class="dv">4</span>), <span class="st">")"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(logistic_gibbs_summary, <span class="at">caption =</span> <span class="st">"Posterior Summary for β (Logistic Regression)"</span>, <span class="at">align =</span> <span class="st">'lr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Posterior Summary for β (Logistic Regression)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mean</td>
<td style="text-align: right;">1.5792</td>
</tr>
<tr class="even">
<td style="text-align: left;">Median</td>
<td style="text-align: right;">1.5648</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SD</td>
<td style="text-align: right;">0.3307</td>
</tr>
<tr class="even">
<td style="text-align: left;">95% CI</td>
<td style="text-align: right;">(0.9607, 2.2468)</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comparison table</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>comparison_log_methods <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"True β"</span>, <span class="st">"MLE"</span>, <span class="st">"Posterior Mean"</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(<span class="fu">round</span>(true_beta, <span class="dv">4</span>), <span class="fu">round</span>(beta_hat_log, <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">mean</span>(logistic_gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_log_methods, <span class="at">caption =</span> <span class="st">"Comparison: True vs Frequentist vs Bayesian"</span>, <span class="at">align =</span> <span class="st">'lr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Comparison: True vs Frequentist vs Bayesian</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">True β</td>
<td style="text-align: right;">1.5000</td>
</tr>
<tr class="even">
<td style="text-align: left;">MLE</td>
<td style="text-align: right;">1.5773</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Posterior Mean</td>
<td style="text-align: right;">1.5792</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="comparison-with-brms-1" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="comparison-with-brms-1"><span class="header-section-number">3.2.3</span> Comparison with brms</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit with brms</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>logistic_brms <span class="ot">&lt;-</span> <span class="fu">brm</span>(y <span class="sc">~</span> <span class="dv">0</span> <span class="sc">+</span> x, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> logistic_data,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">family =</span> <span class="fu">bernoulli</span>(<span class="at">link =</span> <span class="st">"logit"</span>),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">prior =</span> <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> <span class="st">"b"</span>),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">iter =</span> <span class="dv">2000</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">seed =</span> <span class="dv">789</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">refresh =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logistic_brms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: bernoulli 
  Links: mu = logit 
Formula: y ~ 0 + x 
   Data: logistic_data (Number of observations: 100) 
  Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 4000

Regression Coefficients:
  Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
x     1.60      0.34     0.98     2.30 1.00     1403     1503

Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comparison table</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>comparison_log_gibbs_brms <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">"Manual M-H"</span>, <span class="st">"brms"</span>),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">β (Mean)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">mean</span>(logistic_gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">fixef</span>(logistic_brms)[<span class="dv">1</span>, <span class="dv">1</span>], <span class="dv">4</span>)),</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">β (SD)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(<span class="fu">sd</span>(logistic_gibbs_results<span class="sc">$</span>beta), <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">fixef</span>(logistic_brms)[<span class="dv">1</span>, <span class="dv">2</span>], <span class="dv">4</span>)),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_log_gibbs_brms, <span class="at">caption =</span> <span class="st">"Comparison: Manual Metropolis-Hastings vs brms"</span>, <span class="at">align =</span> <span class="st">'lrr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Comparison: Manual Metropolis-Hastings vs brms</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Method</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">β (Mean)</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">β (SD)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Manual M-H</td>
<td style="text-align: right;">1.5792</td>
<td style="text-align: right;">0.3307</td>
</tr>
<tr class="even">
<td style="text-align: left;">brms</td>
<td style="text-align: right;">1.5993</td>
<td style="text-align: right;">0.3416</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="probit-regression-via-auxiliary-variables" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="probit-regression-via-auxiliary-variables"><span class="header-section-number">3.2.4</span> Probit Regression via Auxiliary Variables</h3>
<p>An alternative to logistic regression is probit regression, which uses the cumulative normal distribution:</p>
<p><span class="math display">\[P(Y_i = 1 | X_i) = \Phi(\beta X_i)\]</span></p>
<p>where <span class="math inline">\(\Phi\)</span> is the standard normal CDF.</p>
<p>The auxiliary variable approach, developed by Albert &amp; Chib (1993), introduces latent variables <span class="math inline">\(Z_i \sim N(\beta X_i, 1)\)</span> where:</p>
<p><span class="math display">\[Y_i = \begin{cases} 1 &amp; \text{if } Z_i &gt; 0 \\ 0 &amp; \text{if } Z_i \leq 0 \end{cases}\]</span></p>
<p>This formulation allows for straightforward Gibbs sampling:</p>
<ol type="1">
<li><p>Sample <span class="math inline">\(\beta | \mathbf{Z} \sim N(\mu_n, \sigma_n^2)\)</span> (normal-normal conjugacy)</p></li>
<li><p>Sample <span class="math inline">\(Z_i | \beta, Y_i\)</span> from truncated normal:</p>
<ul>
<li><p>If <span class="math inline">\(Y_i = 1\)</span>: <span class="math inline">\(Z_i \sim N(\beta X_i, 1)\)</span> truncated to <span class="math inline">\((0, \infty)\)</span></p></li>
<li><p>If <span class="math inline">\(Y_i = 0\)</span>: <span class="math inline">\(Z_i \sim N(\beta X_i, 1)\)</span> truncated to <span class="math inline">\((-\infty, 0)\)</span></p></li>
</ul></li>
</ol>
<p>This method is particularly elegant because it converts a complex discrete outcome model into a straightforward continuous data model with truncation. The data augmentation strategy has been widely applied to other generalized linear models.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probit regression using auxiliary variables</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(truncnorm)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>probit_gibbs <span class="ot">&lt;-</span> <span class="cf">function</span>(y, x, <span class="at">n_iter =</span> <span class="dv">10000</span>, <span class="at">burn_in =</span> <span class="dv">1000</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">mu0 =</span> <span class="dv">0</span>, <span class="at">tau0 =</span> <span class="fl">0.01</span>) {</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  beta_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_iter)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)  <span class="co"># Initialize latent variables</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  beta <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  sum_x2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_iter) {</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample Z | beta, y</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    mu_z <span class="ot">&lt;-</span> beta <span class="sc">*</span> x</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (y[j] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        z[j] <span class="ot">&lt;-</span> <span class="fu">rtruncnorm</span>(<span class="dv">1</span>, <span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="cn">Inf</span>, <span class="at">mean =</span> mu_z[j], <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> {</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>        z[j] <span class="ot">&lt;-</span> <span class="fu">rtruncnorm</span>(<span class="dv">1</span>, <span class="at">a =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">mean =</span> mu_z[j], <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sample beta | Z (normal conjugate)</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>    tau_n <span class="ot">&lt;-</span> sum_x2 <span class="sc">+</span> tau0</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>    mu_n <span class="ot">&lt;-</span> (<span class="fu">sum</span>(x <span class="sc">*</span> z) <span class="sc">+</span> tau0 <span class="sc">*</span> mu0) <span class="sc">/</span> tau_n</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, mu_n, <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>tau_n))</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    beta_samples[i] <span class="ot">&lt;-</span> beta</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">beta =</span> beta_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)])</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Run probit sampler</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">789</span>)</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>probit_results <span class="ot">&lt;-</span> <span class="fu">probit_gibbs</span>(y_log, x_log, <span class="at">n_iter =</span> <span class="dv">11000</span>, <span class="at">burn_in =</span> <span class="dv">1000</span>)</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Create summary table</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>probit_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">Statistic =</span> <span class="fu">c</span>(<span class="st">"Mean"</span>, <span class="st">"SD"</span>, <span class="st">"95% CI"</span>),</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">mean</span>(probit_results<span class="sc">$</span>beta), <span class="dv">4</span>),</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">round</span>(<span class="fu">sd</span>(probit_results<span class="sc">$</span>beta), <span class="dv">4</span>),</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"("</span>, <span class="fu">round</span>(<span class="fu">quantile</span>(probit_results<span class="sc">$</span>beta, <span class="fl">0.025</span>), <span class="dv">4</span>), <span class="st">", "</span>,</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>           <span class="fu">round</span>(<span class="fu">quantile</span>(probit_results<span class="sc">$</span>beta, <span class="fl">0.975</span>), <span class="dv">4</span>), <span class="st">")"</span>)</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(probit_summary, <span class="at">caption =</span> <span class="st">"Probit Posterior Summary for β"</span>, <span class="at">align =</span> <span class="st">'lr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Probit Posterior Summary for β</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Statistic</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Mean</td>
<td style="text-align: right;">0.9312</td>
</tr>
<tr class="even">
<td style="text-align: left;">SD</td>
<td style="text-align: right;">0.1832</td>
</tr>
<tr class="odd">
<td style="text-align: left;">95% CI</td>
<td style="text-align: right;">(0.5933, 1.3034)</td>
</tr>
</tbody>
</table>


</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note: Probit coefficients are on a different scale than logit</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Approximately: beta_logit ≈ 1.6 * beta_probit</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>comparison_scales <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="fu">c</span>(<span class="st">"Logit (MLE)"</span>, <span class="st">"Probit × 1.6"</span>),</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">β estimate</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">round</span>(beta_hat_log, <span class="dv">4</span>), <span class="fu">round</span>(<span class="fu">mean</span>(probit_results<span class="sc">$</span>beta) <span class="sc">*</span> <span class="fl">1.6</span>, <span class="dv">4</span>)),</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names =</span> <span class="cn">FALSE</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(comparison_scales, <span class="at">caption =</span> <span class="st">"Scale Comparison: Logit vs Probit (approximately)"</span>, <span class="at">align =</span> <span class="st">'lr'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-striped table-hover caption-top table-sm small" data-quarto-postprocess="true">
<caption>Scale Comparison: Logit vs Probit (approximately)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">β estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Logit (MLE)</td>
<td style="text-align: right;">1.5773</td>
</tr>
<tr class="even">
<td style="text-align: left;">Probit × 1.6</td>
<td style="text-align: right;">1.4899</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="summary" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Summary</h1>
<p>This document has presented foundational concepts in both <strong>Frequentist Estimation</strong> and <strong>Bayesian Inference</strong> approaches to regression modeling:</p>
<p><strong>Linear Regression:</strong></p>
<ul>
<li><p>Frequentist: Maximum likelihood and least squares produce identical point estimates</p></li>
<li><p>Standard errors can be derived via Fisher information or variance principles</p></li>
<li><p>Bayesian: Conditionally conjugate priors enable Gibbs sampling</p></li>
<li><p>With appropriate priors, closed-form posteriors (t and gamma) are possible</p></li>
</ul>
<p><strong>Logistic Regression:</strong></p>
<ul>
<li><p>Frequentist: Requires numerical optimization (no closed-form MLE)</p></li>
<li><p>Bayesian: Metropolis-Hastings handles the non-conjugate posterior</p></li>
<li><p>Probit alternative: Auxiliary variables enable efficient Gibbs sampling</p></li>
</ul>
<p>These simplified models (no intercept) illustrate core principles that extend to more complex regression settings with multiple predictors, interactions, and hierarchical structures.</p>
<section id="why-frequentist-estimation-vs-bayesian-inference" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="why-frequentist-estimation-vs-bayesian-inference"><span class="header-section-number">4.1</span> Why “Frequentist Estimation” vs “Bayesian Inference”?</h2>
<p>The terminology distinction reflects fundamental philosophical and methodological differences:</p>
<p><strong>Frequentist Estimation:</strong></p>
<ul>
<li><p><strong>View of parameters:</strong> Parameters are fixed, unknown constants</p></li>
<li><p><strong>Goal:</strong> Estimate the true parameter value from the data</p></li>
<li><p><strong>Uncertainty:</strong> Described through sampling distributions (e.g., “if we repeated this experiment many times and calculate many confidence intervals, 95% would contain the true parameter”)</p></li>
<li><p><strong>Output:</strong> Point estimates with standard errors and confidence intervals</p></li>
<li><p><strong>Interpretation:</strong> “We estimate β = 2.7 with 95% CI (2.1, 3.3)” means the procedure would capture the true value 95% of the time across repeated samples</p></li>
</ul>
<p><strong>Bayesian Inference:</strong></p>
<ul>
<li><p><strong>View of parameters:</strong> Parameters are random variables with probability distributions</p></li>
<li><p><strong>Goal:</strong> Update our beliefs about parameters using data (prior → posterior)</p></li>
<li><p><strong>Uncertainty:</strong> Described through probability distributions directly on parameters</p></li>
<li><p><strong>Output:</strong> Full posterior distributions, summarized with credible intervals</p></li>
<li><p><strong>Interpretation:</strong> “P(2.1 &lt; β &lt; 3.3 | data) = 0.95” means there’s a 95% probability that β lies in this interval given the observed data</p></li>
</ul>
<p>The distinction matters because:</p>
<ul>
<li><p>Bayesians don’t “estimate” a fixed value—they make probabilistic statements about parameters</p></li>
<li><p>The interpretation of uncertainty differs fundamentally between approaches</p></li>
<li><p>Each framework has its own logic for inference, prediction, and decision-making</p></li>
</ul>
<p>Understanding both perspectives enriches your statistical toolkit and helps you communicate appropriately with different audiences.</p>
</section>
</section>
<section id="references" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> References</h1>
<p><strong>Bayesian Inference and MCMC:</strong></p>
<p>Albert, J. H., &amp; Chib, S. (1993). Bayesian analysis of binary and polychotomous response data. <em>Journal of the American Statistical Association</em>, 88(422), 669-679.</p>
<p>Chib, S., &amp; Greenberg, E. (1995). Understanding the Metropolis-Hastings algorithm. <em>The American Statistician</em>, 49(4), 327-335.</p>
<p>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., &amp; Rubin, D. B. (2013). <em>Bayesian Data Analysis</em> (3rd ed.). Chapman and Hall/CRC.</p>
<p>Robert, C. P., &amp; Casella, G. (2011). A short history of Markov Chain Monte Carlo: Subjective recollections from incomplete data. <em>Statistical Science</em>, 26(1), 102-115.</p>
<p><strong>Software:</strong></p>
<p>Bürkner, P. C. (2017). brms: An R package for Bayesian multilevel models using Stan. <em>Journal of Statistical Software</em>, 80(1), 1-28.</p>
<p><strong>Note:</strong> A full course on Bayesian regression methods would allow deeper exploration of these topics, including more complex models, prior specification strategies, model comparison, and advanced MCMC diagnostics. The material presented here serves as an introduction.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/modern-regression\.chris-slaughter\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/Lec07.MultivariableModels.html" class="pagination-link" aria-label="Multivariable Models">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Multivariable Models</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notes/Set6.pdf" class="pagination-link" aria-label="Weighted Regression">
        <span class="nav-page-text">Weighted Regression</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb28" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Frequentist Estimation and Bayesian Inference"</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="in">library(rms)</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="in">library(plotly)</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="in">library(brms)</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="in">library(coda)</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="in">library(MASS)</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="in">library(truncnorm)</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="in">library(knitr)</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="in">library(kableExtra)</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>These notes provide a comparison of **Frequentist Estimation** and **Bayesian Inference** approaches to regression modeling. This material is presented as one of the final lectures before the exam and builds upon foundational concepts covered in earlier course materials.</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>**Prerequisites:** Before working through these notes, we will first review <span class="co">[</span><span class="ot">Model Estimation (Set2.pdf)</span><span class="co">](Set2.pdf)</span>, which covers key concepts in simple linear regression and details on estimation from a frequentist standpoint. That material provides a review of many applied concepts already discussed (and thus serves as a review for the midterm exam) and is the foundation for understanding the comparisons presented here.</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>**Scope and Purpose:** These following notes present mathematical derivations and theoretical foundations to provide clarity and deeper understanding of both approaches. The derivations demonstrate in linear and logistic regression</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How maximum likelihood estimation works</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>How Bayesian posterior distributions are derived</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The relationship between different estimation methods</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The underlying theory behind the functions you use in practice</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>**Important Note on Exam Coverage:** </span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>The exam focuses on **applied data analysis**. While the mathematical derivations in these notes are provided for clarity and understanding, in this course you are **NOT** be asked to:</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Derive posterior distributions</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Maximize likelihood functions by hand</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Perform calculus-based derivations</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>These derivation skills are the purview of other courses. For this course, you should focus on:</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Understanding the conceptual differences between approaches</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Knowing when to use each method</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Applying the methods using R (lm(), glm(), brms(), etc.)</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Interpreting and communicating results</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a><span class="fu"># Linear Regression</span></span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>We consider a simplified linear regression model with only a slope parameter (no intercept) with $X_i$ fixed. This model takes the form:</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>$$Y_i = \beta X_i + \varepsilon_i$$</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>where $\varepsilon_i \sim N(0, \sigma^2)$ for the likelihood-based approach.</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>**Important Note:** This model forces the regression line through the origin $(0,0)$. While mathematically simpler (reducing the parameter space), this constraint is often not scientifically useful. Even if we expect $Y=0$ when $X=0$, this point may lie outside the range of our data and assumes linearity, making the constraint arbitrary and potentially misleading.</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a><span class="fu">## Frequentist Estimation</span></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a><span class="fu">### Maximum Likelihood Estimation</span></span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>The maximum likelihood approach assumes conditional normality of the residuals. Given $Y_i \sim N(\beta X_i, \sigma^2)$, the likelihood function is:</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>$$L(\beta, \sigma^2 | \mathbf{y}, \mathbf{x}) = \prod_{i=1}^n \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(y_i - \beta x_i)^2}{2\sigma^2}\right)$$</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>The log-likelihood is:</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>$$\ell(\beta, \sigma^2) = -\frac{n}{2}\log(2\pi) - \frac{n}{2}\log(\sigma^2) - \frac{1}{2\sigma^2}\sum_{i=1}^n(y_i - \beta x_i)^2$$</span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>**Deriving the MLE for** $\beta$:</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>Taking the derivative with respect to $\beta$ and setting equal to zero:</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a>$$\frac{\partial \ell}{\partial \beta} = \frac{1}{\sigma^2}\sum_{i=1}^n x_i(y_i - \beta x_i) = 0$$</span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>$$\sum_{i=1}^n x_i y_i - \beta \sum_{i=1}^n x_i^2 = 0$$</span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>$$\hat{\beta}_{MLE} = \frac{\sum_{i=1}^n x_i y_i}{\sum_{i=1}^n x_i^2}$$</span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>**Deriving the MLE for** $\sigma^2$:</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a>Taking the derivative with respect to $\sigma^2$:</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>$$\frac{\partial \ell}{\partial \sigma^2} = -\frac{n}{2\sigma^2} + \frac{1}{2\sigma^4}\sum_{i=1}^n(y_i - \beta x_i)^2 = 0$$</span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>$$\hat{\sigma}^2_{MLE} = \frac{1}{n}\sum_{i=1}^n(y_i - \hat{\beta} x_i)^2$$</span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Standard Error via Fisher Information</span></span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>The Fisher Information matrix provides the asymptotic variance of the MLE. For our model:</span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a>$$I(\beta, \sigma^2) = -E\left<span class="co">[</span><span class="ot">\frac{\partial^2 \ell}{\partial \theta \partial \theta^T}\right</span><span class="co">]</span>$$</span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>The second derivatives are:</span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>$$\frac{\partial^2 \ell}{\partial \beta^2} = -\frac{1}{\sigma^2}\sum_{i=1}^n x_i^2$$</span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>$$\frac{\partial^2 \ell}{\partial (\sigma^2)^2} = \frac{n}{2\sigma^4} - \frac{1}{\sigma^6}\sum_{i=1}^n(y_i - \beta x_i)^2$$</span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>$$\frac{\partial^2 \ell}{\partial \beta \partial \sigma^2} = -\frac{1}{\sigma^4}\sum_{i=1}^n x_i(y_i - \beta x_i)$$</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>Taking expectations (where $E<span class="co">[</span><span class="ot">(y_i - \beta x_i)^2</span><span class="co">]</span> = \sigma^2$ and $E<span class="co">[</span><span class="ot">y_i - \beta x_i</span><span class="co">]</span> = 0$):</span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>$$I(\beta) = \frac{1}{\sigma^2}\sum_{i=1}^n x_i^2$$</span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>Therefore, the asymptotic variance is:</span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a>$$\text{Var}(\hat{\beta}) = \frac{\sigma^2}{\sum_{i=1}^n x_i^2}$$</span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a>$$SE(\hat{\beta}) = \frac{\sigma}{\sqrt{\sum_{i=1}^n x_i^2}}$$</span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>In practice, we substitute $\hat{\sigma}$ for $\sigma$.</span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a>**Important Note on Bias:** The MLE estimate of $\sigma^2$ is:</span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-122"><a href="#cb28-122" aria-hidden="true" tabindex="-1"></a>$$\hat{\sigma}^2_{MLE} = \frac{1}{n}\sum_{i=1}^n(y_i - \hat{\beta} x_i)^2$$</span>
<span id="cb28-123"><a href="#cb28-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-124"><a href="#cb28-124" aria-hidden="true" tabindex="-1"></a>This estimator is biased because it uses $n$ in the denominator rather than the degrees of freedom $(n-1)$. The MLE is asymptotically unbiased but has finite-sample bias. To obtain an unbiased estimator of $\sigma^2$, we use:</span>
<span id="cb28-125"><a href="#cb28-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-126"><a href="#cb28-126" aria-hidden="true" tabindex="-1"></a>$$\hat{\sigma}^2_{unbiased} = \frac{1}{n-1}\sum_{i=1}^n(y_i - \hat{\beta} x_i)^2$$</span>
<span id="cb28-127"><a href="#cb28-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-128"><a href="#cb28-128" aria-hidden="true" tabindex="-1"></a>The correction factor is $\frac{n}{n-1}$, so:</span>
<span id="cb28-129"><a href="#cb28-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-130"><a href="#cb28-130" aria-hidden="true" tabindex="-1"></a>$$\hat{\sigma}_{unbiased} = \sqrt{\frac{n}{n-1}} \cdot \hat{\sigma}_{MLE}$$</span>
<span id="cb28-131"><a href="#cb28-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-132"><a href="#cb28-132" aria-hidden="true" tabindex="-1"></a>When calculating the standard error of $\hat{\beta}$, using the unbiased estimator ensures:</span>
<span id="cb28-133"><a href="#cb28-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-134"><a href="#cb28-134" aria-hidden="true" tabindex="-1"></a>$$SE(\hat{\beta}) = \frac{\hat{\sigma}_{unbiased}}{\sqrt{\sum_{i=1}^n x_i^2}} = \frac{\sqrt{\frac{1}{n-1}\sum_{i=1}^n(y_i - \hat{\beta} x_i)^2}}{\sqrt{\sum_{i=1}^n x_i^2}}$$</span>
<span id="cb28-135"><a href="#cb28-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-136"><a href="#cb28-136" aria-hidden="true" tabindex="-1"></a>This matches the standard error reported by <span class="in">`lm()`</span> exactly.</span>
<span id="cb28-137"><a href="#cb28-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-138"><a href="#cb28-138" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Standard Error via Basic Variance Principles</span></span>
<span id="cb28-139"><a href="#cb28-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-140"><a href="#cb28-140" aria-hidden="true" tabindex="-1"></a>We can also derive the standard error directly from the formula for $\hat{\beta}$:</span>
<span id="cb28-141"><a href="#cb28-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-142"><a href="#cb28-142" aria-hidden="true" tabindex="-1"></a>$$\hat{\beta} = \frac{\sum_{i=1}^n x_i Y_i}{\sum_{i=1}^n x_i^2}$$</span>
<span id="cb28-143"><a href="#cb28-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-144"><a href="#cb28-144" aria-hidden="true" tabindex="-1"></a>Since $Y_i = \beta x_i + \varepsilon_i$ where $\varepsilon_i \sim N(0, \sigma^2)$ independently:</span>
<span id="cb28-145"><a href="#cb28-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-146"><a href="#cb28-146" aria-hidden="true" tabindex="-1"></a>$$\text{Var}(\hat{\beta}) = \text{Var}\left(\frac{\sum_{i=1}^n x_i Y_i}{\sum_{i=1}^n x_i^2}\right) = \frac{1}{(\sum_{i=1}^n x_i^2)^2} \text{Var}\left(\sum_{i=1}^n x_i Y_i\right)$$</span>
<span id="cb28-147"><a href="#cb28-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-148"><a href="#cb28-148" aria-hidden="true" tabindex="-1"></a>Since the $Y_i$ are independent:</span>
<span id="cb28-149"><a href="#cb28-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-150"><a href="#cb28-150" aria-hidden="true" tabindex="-1"></a>$$\text{Var}\left(\sum_{i=1}^n x_i Y_i\right) = \sum_{i=1}^n x_i^2 \text{Var}(Y_i) = \sum_{i=1}^n x_i^2 \sigma^2 = \sigma^2 \sum_{i=1}^n x_i^2$$</span>
<span id="cb28-151"><a href="#cb28-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-152"><a href="#cb28-152" aria-hidden="true" tabindex="-1"></a>Therefore:</span>
<span id="cb28-153"><a href="#cb28-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-154"><a href="#cb28-154" aria-hidden="true" tabindex="-1"></a>$$\text{Var}(\hat{\beta}) = \frac{\sigma^2 \sum_{i=1}^n x_i^2}{(\sum_{i=1}^n x_i^2)^2} = \frac{\sigma^2}{\sum_{i=1}^n x_i^2}$$</span>
<span id="cb28-155"><a href="#cb28-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-156"><a href="#cb28-156" aria-hidden="true" tabindex="-1"></a>This confirms our Fisher Information result.</span>
<span id="cb28-157"><a href="#cb28-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-158"><a href="#cb28-158" aria-hidden="true" tabindex="-1"></a><span class="fu">### Estimating Equations Approach (Least Squares)</span></span>
<span id="cb28-159"><a href="#cb28-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-160"><a href="#cb28-160" aria-hidden="true" tabindex="-1"></a>The least squares approach minimizes the residual sum of squares without assuming normality. We minimize:</span>
<span id="cb28-161"><a href="#cb28-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-162"><a href="#cb28-162" aria-hidden="true" tabindex="-1"></a>$$RSS(\beta) = \sum_{i=1}^n (y_i - \beta x_i)^2$$</span>
<span id="cb28-163"><a href="#cb28-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-164"><a href="#cb28-164" aria-hidden="true" tabindex="-1"></a>Taking the derivative and setting to zero:</span>
<span id="cb28-165"><a href="#cb28-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-166"><a href="#cb28-166" aria-hidden="true" tabindex="-1"></a>$$\frac{\partial RSS}{\partial \beta} = -2\sum_{i=1}^n x_i(y_i - \beta x_i) = 0$$</span>
<span id="cb28-167"><a href="#cb28-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-168"><a href="#cb28-168" aria-hidden="true" tabindex="-1"></a>$$\hat{\beta}_{LS} = \frac{\sum_{i=1}^n x_i y_i}{\sum_{i=1}^n x_i^2}$$</span>
<span id="cb28-169"><a href="#cb28-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-170"><a href="#cb28-170" aria-hidden="true" tabindex="-1"></a>Note that $\hat{\beta}_{LS} = \hat{\beta}_{MLE}$ even though the least squares approach does not require the normality assumption. The normality assumption is only needed for inference (standard errors, confidence intervals, hypothesis tests) in small samples, though large-sample inference can rely on asymptotic normality via the Central Limit Theorem.</span>
<span id="cb28-171"><a href="#cb28-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-172"><a href="#cb28-172" aria-hidden="true" tabindex="-1"></a><span class="fu">### Demonstration with Real Data</span></span>
<span id="cb28-173"><a href="#cb28-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-174"><a href="#cb28-174" aria-hidden="true" tabindex="-1"></a>We'll use the <span class="in">`cars`</span> dataset in R, which contains speed and stopping distance for cars.</span>
<span id="cb28-175"><a href="#cb28-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-176"><a href="#cb28-176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data_prep}</span></span>
<span id="cb28-177"><a href="#cb28-177" aria-hidden="true" tabindex="-1"></a><span class="in"># Load and prepare data</span></span>
<span id="cb28-178"><a href="#cb28-178" aria-hidden="true" tabindex="-1"></a><span class="in">data(cars)</span></span>
<span id="cb28-179"><a href="#cb28-179" aria-hidden="true" tabindex="-1"></a><span class="in"># We'll model distance as a function of speed with no intercept</span></span>
<span id="cb28-180"><a href="#cb28-180" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- cars$dist</span></span>
<span id="cb28-181"><a href="#cb28-181" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- cars$speed</span></span>
<span id="cb28-182"><a href="#cb28-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-183"><a href="#cb28-183" aria-hidden="true" tabindex="-1"></a><span class="in"># Calculate estimates</span></span>
<span id="cb28-184"><a href="#cb28-184" aria-hidden="true" tabindex="-1"></a><span class="in">beta_hat &lt;- sum(x * y) / sum(x^2)</span></span>
<span id="cb28-185"><a href="#cb28-185" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- length(y)</span></span>
<span id="cb28-186"><a href="#cb28-186" aria-hidden="true" tabindex="-1"></a><span class="in">residuals &lt;- y - beta_hat * x</span></span>
<span id="cb28-187"><a href="#cb28-187" aria-hidden="true" tabindex="-1"></a><span class="in">RSS &lt;- sum(residuals^2)</span></span>
<span id="cb28-188"><a href="#cb28-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-189"><a href="#cb28-189" aria-hidden="true" tabindex="-1"></a><span class="in"># MLE estimate of sigma (biased)</span></span>
<span id="cb28-190"><a href="#cb28-190" aria-hidden="true" tabindex="-1"></a><span class="in">sigma_hat_mle &lt;- sqrt(RSS / n)</span></span>
<span id="cb28-191"><a href="#cb28-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-192"><a href="#cb28-192" aria-hidden="true" tabindex="-1"></a><span class="in"># Unbiased estimate of sigma</span></span>
<span id="cb28-193"><a href="#cb28-193" aria-hidden="true" tabindex="-1"></a><span class="in">sigma_hat_unbiased &lt;- sqrt(RSS / (n - 1))</span></span>
<span id="cb28-194"><a href="#cb28-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-195"><a href="#cb28-195" aria-hidden="true" tabindex="-1"></a><span class="in"># Correction factor</span></span>
<span id="cb28-196"><a href="#cb28-196" aria-hidden="true" tabindex="-1"></a><span class="in">correction_factor &lt;- sqrt(n / (n - 1))</span></span>
<span id="cb28-197"><a href="#cb28-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-198"><a href="#cb28-198" aria-hidden="true" tabindex="-1"></a><span class="in"># Create comparison table</span></span>
<span id="cb28-199"><a href="#cb28-199" aria-hidden="true" tabindex="-1"></a><span class="in">comparison_df &lt;- data.frame(</span></span>
<span id="cb28-200"><a href="#cb28-200" aria-hidden="true" tabindex="-1"></a><span class="in">  Estimate = c("β̂", "σ̂ (MLE)", "σ̂ (unbiased)", "Correction factor", "SE(β̂) using MLE σ", "SE(β̂) using unbiased σ"),</span></span>
<span id="cb28-201"><a href="#cb28-201" aria-hidden="true" tabindex="-1"></a><span class="in">  Value = c(</span></span>
<span id="cb28-202"><a href="#cb28-202" aria-hidden="true" tabindex="-1"></a><span class="in">    round(beta_hat, 4),</span></span>
<span id="cb28-203"><a href="#cb28-203" aria-hidden="true" tabindex="-1"></a><span class="in">    round(sigma_hat_mle, 4),</span></span>
<span id="cb28-204"><a href="#cb28-204" aria-hidden="true" tabindex="-1"></a><span class="in">    round(sigma_hat_unbiased, 4),</span></span>
<span id="cb28-205"><a href="#cb28-205" aria-hidden="true" tabindex="-1"></a><span class="in">    round(correction_factor, 4),</span></span>
<span id="cb28-206"><a href="#cb28-206" aria-hidden="true" tabindex="-1"></a><span class="in">    round(sigma_hat_mle / sqrt(sum(x^2)), 4),</span></span>
<span id="cb28-207"><a href="#cb28-207" aria-hidden="true" tabindex="-1"></a><span class="in">    round(sigma_hat_unbiased / sqrt(sum(x^2)), 4)</span></span>
<span id="cb28-208"><a href="#cb28-208" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb28-209"><a href="#cb28-209" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-210"><a href="#cb28-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-211"><a href="#cb28-211" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison_df, caption = "Manual Calculation Results", align = 'll', format='html') %&gt;%</span></span>
<span id="cb28-212"><a href="#cb28-212" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-213"><a href="#cb28-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-214"><a href="#cb28-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-215"><a href="#cb28-215" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 3D Likelihood Surface</span></span>
<span id="cb28-216"><a href="#cb28-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-217"><a href="#cb28-217" aria-hidden="true" tabindex="-1"></a>Now we'll create a 3D plot showing the likelihood function as a function of $\beta$ and $\sigma$:</span>
<span id="cb28-218"><a href="#cb28-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-219"><a href="#cb28-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r likelihood_surface, fig.width=10, fig.height=8}</span></span>
<span id="cb28-220"><a href="#cb28-220" aria-hidden="true" tabindex="-1"></a><span class="in"># Make sure beta_hat and sigma_hat_mle are on the grid</span></span>
<span id="cb28-221"><a href="#cb28-221" aria-hidden="true" tabindex="-1"></a><span class="in">beta_grid  &lt;- sort(unique(c(seq(beta_hat - 0.5, beta_hat + 0.5, length.out = 50), beta_hat)))</span></span>
<span id="cb28-222"><a href="#cb28-222" aria-hidden="true" tabindex="-1"></a><span class="in">sigma_grid &lt;- sort(unique(c(seq(max(1, sigma_hat_unbiased - 5), sigma_hat_unbiased + 5, length.out = 50), sigma_hat_mle)))</span></span>
<span id="cb28-223"><a href="#cb28-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-224"><a href="#cb28-224" aria-hidden="true" tabindex="-1"></a><span class="in"># Compute log-likelihood</span></span>
<span id="cb28-225"><a href="#cb28-225" aria-hidden="true" tabindex="-1"></a><span class="in">log_lik &lt;- outer(beta_grid, sigma_grid, Vectorize(function(beta, sigma) {</span></span>
<span id="cb28-226"><a href="#cb28-226" aria-hidden="true" tabindex="-1"></a><span class="in">  res &lt;- y - beta * x</span></span>
<span id="cb28-227"><a href="#cb28-227" aria-hidden="true" tabindex="-1"></a><span class="in">  n &lt;- length(y)</span></span>
<span id="cb28-228"><a href="#cb28-228" aria-hidden="true" tabindex="-1"></a><span class="in">  -n/2 * log(2*pi) - n * log(sigma) - sum(res^2)/(2*sigma^2)</span></span>
<span id="cb28-229"><a href="#cb28-229" aria-hidden="true" tabindex="-1"></a><span class="in">}))</span></span>
<span id="cb28-230"><a href="#cb28-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-231"><a href="#cb28-231" aria-hidden="true" tabindex="-1"></a><span class="in"># Relative likelihood (max = 1 at MLE on the grid)</span></span>
<span id="cb28-232"><a href="#cb28-232" aria-hidden="true" tabindex="-1"></a><span class="in">likelihood &lt;- exp(log_lik - max(log_lik))</span></span>
<span id="cb28-233"><a href="#cb28-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-234"><a href="#cb28-234" aria-hidden="true" tabindex="-1"></a><span class="in"># Relative likelihood values at the two sigma points with beta fixed at beta_hat</span></span>
<span id="cb28-235"><a href="#cb28-235" aria-hidden="true" tabindex="-1"></a><span class="in">rel_at &lt;- function(beta0, sigma0) {</span></span>
<span id="cb28-236"><a href="#cb28-236" aria-hidden="true" tabindex="-1"></a><span class="in">  res &lt;- y - beta0 * x</span></span>
<span id="cb28-237"><a href="#cb28-237" aria-hidden="true" tabindex="-1"></a><span class="in">  n &lt;- length(y)</span></span>
<span id="cb28-238"><a href="#cb28-238" aria-hidden="true" tabindex="-1"></a><span class="in">  ll &lt;- -n/2 * log(2*pi) - n * log(sigma0) - sum(res^2)/(2*sigma0^2)</span></span>
<span id="cb28-239"><a href="#cb28-239" aria-hidden="true" tabindex="-1"></a><span class="in">  exp(ll - max(log_lik))</span></span>
<span id="cb28-240"><a href="#cb28-240" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb28-241"><a href="#cb28-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-242"><a href="#cb28-242" aria-hidden="true" tabindex="-1"></a><span class="in">z_mle      &lt;- rel_at(beta_hat, sigma_hat_mle)</span></span>
<span id="cb28-243"><a href="#cb28-243" aria-hidden="true" tabindex="-1"></a><span class="in">z_unbiased &lt;- rel_at(beta_hat, sigma_hat_unbiased)</span></span>
<span id="cb28-244"><a href="#cb28-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-245"><a href="#cb28-245" aria-hidden="true" tabindex="-1"></a><span class="in">plot_ly(x = ~sigma_grid, y = ~beta_grid, z = ~likelihood) %&gt;%</span></span>
<span id="cb28-246"><a href="#cb28-246" aria-hidden="true" tabindex="-1"></a><span class="in">  add_surface() %&gt;%</span></span>
<span id="cb28-247"><a href="#cb28-247" aria-hidden="true" tabindex="-1"></a><span class="in">  add_markers(x = sigma_hat_mle, y = beta_hat, z = z_mle,</span></span>
<span id="cb28-248"><a href="#cb28-248" aria-hidden="true" tabindex="-1"></a><span class="in">              marker = list(size = 5, color = 'red'),</span></span>
<span id="cb28-249"><a href="#cb28-249" aria-hidden="true" tabindex="-1"></a><span class="in">              name = 'MLE (σ)') %&gt;%</span></span>
<span id="cb28-250"><a href="#cb28-250" aria-hidden="true" tabindex="-1"></a><span class="in">  add_markers(x = sigma_hat_unbiased, y = beta_hat, z = z_unbiased,</span></span>
<span id="cb28-251"><a href="#cb28-251" aria-hidden="true" tabindex="-1"></a><span class="in">              marker = list(size = 5, color = 'blue'),</span></span>
<span id="cb28-252"><a href="#cb28-252" aria-hidden="true" tabindex="-1"></a><span class="in">              name = 'Unbiased (σ)') %&gt;%</span></span>
<span id="cb28-253"><a href="#cb28-253" aria-hidden="true" tabindex="-1"></a><span class="in">  layout(scene = list(</span></span>
<span id="cb28-254"><a href="#cb28-254" aria-hidden="true" tabindex="-1"></a><span class="in">    xaxis = list(title = 'σ'),</span></span>
<span id="cb28-255"><a href="#cb28-255" aria-hidden="true" tabindex="-1"></a><span class="in">    yaxis = list(title = 'β'),</span></span>
<span id="cb28-256"><a href="#cb28-256" aria-hidden="true" tabindex="-1"></a><span class="in">    zaxis = list(title = 'Relative Likelihood')</span></span>
<span id="cb28-257"><a href="#cb28-257" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb28-258"><a href="#cb28-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-259"><a href="#cb28-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-260"><a href="#cb28-260" aria-hidden="true" tabindex="-1"></a>The red point shows the MLE estimate $(\hat{\beta}, \hat{\sigma}_{MLE})$, which corresponds to the maximum of the likelihood function. The blue point shows $(\hat{\beta}, \hat{\sigma}_{unbiased})$, which uses the degrees-of-freedom correction. Note that $\hat{\beta}$ is the same for both (it maximizes the likelihood), but the unbiased estimator of $\sigma$ is slightly larger.</span>
<span id="cb28-261"><a href="#cb28-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-262"><a href="#cb28-262" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparison with lm()</span></span>
<span id="cb28-263"><a href="#cb28-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-264"><a href="#cb28-264" aria-hidden="true" tabindex="-1"></a>Now let's verify our results using R's built-in <span class="in">`lm()`</span> function:</span>
<span id="cb28-265"><a href="#cb28-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-266"><a href="#cb28-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r lm_comparison}</span></span>
<span id="cb28-267"><a href="#cb28-267" aria-hidden="true" tabindex="-1"></a><span class="in"># Fit model with lm (forcing through origin with -1)</span></span>
<span id="cb28-268"><a href="#cb28-268" aria-hidden="true" tabindex="-1"></a><span class="in">model_lm &lt;- lm(dist ~ speed - 1, data = cars)</span></span>
<span id="cb28-269"><a href="#cb28-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-270"><a href="#cb28-270" aria-hidden="true" tabindex="-1"></a><span class="in"># Create comparison table</span></span>
<span id="cb28-271"><a href="#cb28-271" aria-hidden="true" tabindex="-1"></a><span class="in">comparison_lm &lt;- data.frame(</span></span>
<span id="cb28-272"><a href="#cb28-272" aria-hidden="true" tabindex="-1"></a><span class="in">  Estimate = c("β̂", "SE(β̂)"),</span></span>
<span id="cb28-273"><a href="#cb28-273" aria-hidden="true" tabindex="-1"></a><span class="in">  Manual = c(round(beta_hat, 4), round(sigma_hat_unbiased / sqrt(sum(x^2)), 4)),</span></span>
<span id="cb28-274"><a href="#cb28-274" aria-hidden="true" tabindex="-1"></a><span class="in">  `lm()` = c(round(coef(model_lm)[1], 4), round(summary(model_lm)$coefficients[1, 2], 4)),</span></span>
<span id="cb28-275"><a href="#cb28-275" aria-hidden="true" tabindex="-1"></a><span class="in">  check.names = FALSE</span></span>
<span id="cb28-276"><a href="#cb28-276" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-277"><a href="#cb28-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-278"><a href="#cb28-278" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison_lm, caption = "Comparison: Manual Calculation vs lm()", align = 'lrr', format='html') %&gt;%</span></span>
<span id="cb28-279"><a href="#cb28-279" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-280"><a href="#cb28-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-281"><a href="#cb28-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-282"><a href="#cb28-282" aria-hidden="true" tabindex="-1"></a>The estimates match perfectly, confirming our derivations.</span>
<span id="cb28-283"><a href="#cb28-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-284"><a href="#cb28-284" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Inference</span></span>
<span id="cb28-285"><a href="#cb28-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-286"><a href="#cb28-286" aria-hidden="true" tabindex="-1"></a>For the Bayesian approach, we use conditionally conjugate priors. Let $\tau = 1/\sigma^2$ denote the precision. We specify:</span>
<span id="cb28-287"><a href="#cb28-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-288"><a href="#cb28-288" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Prior for $\beta$: $\beta \sim N(\mu_0, 1/\tau_0)$</span>
<span id="cb28-289"><a href="#cb28-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-290"><a href="#cb28-290" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Prior for $\tau$: $\tau \sim \text{Gamma}(\alpha_0, \beta_0)$</span>
<span id="cb28-291"><a href="#cb28-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-292"><a href="#cb28-292" aria-hidden="true" tabindex="-1"></a>These priors are conditionally conjugate, meaning each complete conditional distribution has a recognizable form.</span>
<span id="cb28-293"><a href="#cb28-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-294"><a href="#cb28-294" aria-hidden="true" tabindex="-1"></a><span class="fu">### Complete Conditional Distributions</span></span>
<span id="cb28-295"><a href="#cb28-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-296"><a href="#cb28-296" aria-hidden="true" tabindex="-1"></a>**Complete Conditional for** $\beta$:</span>
<span id="cb28-297"><a href="#cb28-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-298"><a href="#cb28-298" aria-hidden="true" tabindex="-1"></a>The likelihood contribution is:</span>
<span id="cb28-299"><a href="#cb28-299" aria-hidden="true" tabindex="-1"></a>$$p(\mathbf{y}|\beta, \tau) \propto \exp\left(-\frac{\tau}{2}\sum_{i=1}^n(y_i - \beta x_i)^2\right)$$</span>
<span id="cb28-300"><a href="#cb28-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-301"><a href="#cb28-301" aria-hidden="true" tabindex="-1"></a>The prior is:</span>
<span id="cb28-302"><a href="#cb28-302" aria-hidden="true" tabindex="-1"></a>$$p(\beta) \propto \exp\left(-\frac{\tau_0}{2}(\beta - \mu_0)^2\right)$$</span>
<span id="cb28-303"><a href="#cb28-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-304"><a href="#cb28-304" aria-hidden="true" tabindex="-1"></a>The posterior (using kernel recognition) is:</span>
<span id="cb28-305"><a href="#cb28-305" aria-hidden="true" tabindex="-1"></a>$$p(\beta | \mathbf{y}, \tau) \propto \exp\left(-\frac{1}{2}\left<span class="co">[</span><span class="ot">\tau\sum_{i=1}^n(y_i - \beta x_i)^2 + \tau_0(\beta - \mu_0)^2\right</span><span class="co">]</span>\right)$$</span>
<span id="cb28-306"><a href="#cb28-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-307"><a href="#cb28-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-308"><a href="#cb28-308" aria-hidden="true" tabindex="-1"></a>::: {.callout-note collapse="true"}</span>
<span id="cb28-309"><a href="#cb28-309" aria-hidden="true" tabindex="-1"></a><span class="fu">## Background: Kernel Recognition for Posterior Distributions</span></span>
<span id="cb28-310"><a href="#cb28-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-311"><a href="#cb28-311" aria-hidden="true" tabindex="-1"></a>**Kernel recognition** is a technique for identifying probability distributions from their unnormalized forms. The key insight is that we can recognize a distribution by its "kernel"—the part that depends on the parameter of interest, ignoring normalizing constants.</span>
<span id="cb28-312"><a href="#cb28-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-313"><a href="#cb28-313" aria-hidden="true" tabindex="-1"></a><span class="fu">### The Basic Principle</span></span>
<span id="cb28-314"><a href="#cb28-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-315"><a href="#cb28-315" aria-hidden="true" tabindex="-1"></a>For a probability density $p(\theta)$, we can write:</span>
<span id="cb28-316"><a href="#cb28-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-317"><a href="#cb28-317" aria-hidden="true" tabindex="-1"></a>$$p(\theta) = \frac{1}{c} \times k(\theta)$$</span>
<span id="cb28-318"><a href="#cb28-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-319"><a href="#cb28-319" aria-hidden="true" tabindex="-1"></a>where:</span>
<span id="cb28-320"><a href="#cb28-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-321"><a href="#cb28-321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$k(\theta)$ is the **kernel** (the part depending on $\theta$)</span>
<span id="cb28-322"><a href="#cb28-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-323"><a href="#cb28-323" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$c$ is the **normalizing constant** (makes the integral/sum equal 1)</span>
<span id="cb28-324"><a href="#cb28-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-325"><a href="#cb28-325" aria-hidden="true" tabindex="-1"></a>In Bayesian inference, we compute:</span>
<span id="cb28-326"><a href="#cb28-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-327"><a href="#cb28-327" aria-hidden="true" tabindex="-1"></a>$$p(\theta | \text{data}) \propto p(\text{data} | \theta) \times p(\theta)$$</span>
<span id="cb28-328"><a href="#cb28-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-329"><a href="#cb28-329" aria-hidden="true" tabindex="-1"></a>The $\propto$ symbol means "proportional to"—we ignore constants that don't depend on $\theta$. If we can recognize the resulting kernel as belonging to a known distribution family, we've identified the posterior.</span>
<span id="cb28-330"><a href="#cb28-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-331"><a href="#cb28-331" aria-hidden="true" tabindex="-1"></a><span class="fu">### Common Kernels to Recognize</span></span>
<span id="cb28-332"><a href="#cb28-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-333"><a href="#cb28-333" aria-hidden="true" tabindex="-1"></a>**Normal Distribution:** $N(\mu, \sigma^2)$</span>
<span id="cb28-334"><a href="#cb28-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-335"><a href="#cb28-335" aria-hidden="true" tabindex="-1"></a>Kernel: $\exp\left(-\frac{1}{2\sigma^2}(x - \mu)^2\right)$</span>
<span id="cb28-336"><a href="#cb28-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-337"><a href="#cb28-337" aria-hidden="true" tabindex="-1"></a>Key pattern: Quadratic in the exponent</span>
<span id="cb28-338"><a href="#cb28-338" aria-hidden="true" tabindex="-1"></a>$$\exp\left(-\frac{1}{2}<span class="co">[</span><span class="ot">\text{constant} \times \theta^2 - 2 \times \text{constant} \times \theta</span><span class="co">]</span>\right)$$</span>
<span id="cb28-339"><a href="#cb28-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-340"><a href="#cb28-340" aria-hidden="true" tabindex="-1"></a>**Gamma Distribution:** $\text{Gamma}(\alpha, \beta)$</span>
<span id="cb28-341"><a href="#cb28-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-342"><a href="#cb28-342" aria-hidden="true" tabindex="-1"></a>Kernel: $x^{\alpha-1} e^{-\beta x}$</span>
<span id="cb28-343"><a href="#cb28-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-344"><a href="#cb28-344" aria-hidden="true" tabindex="-1"></a>Key pattern: Power times exponential</span>
<span id="cb28-345"><a href="#cb28-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-346"><a href="#cb28-346" aria-hidden="true" tabindex="-1"></a>**Beta Distribution:** $\text{Beta}(\alpha, \beta)$</span>
<span id="cb28-347"><a href="#cb28-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-348"><a href="#cb28-348" aria-hidden="true" tabindex="-1"></a>Kernel: $x^{\alpha-1}(1-x)^{\beta-1}$</span>
<span id="cb28-349"><a href="#cb28-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-350"><a href="#cb28-350" aria-hidden="true" tabindex="-1"></a>Key pattern: Product of powers</span>
<span id="cb28-351"><a href="#cb28-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-352"><a href="#cb28-352" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Normal Posterior</span></span>
<span id="cb28-353"><a href="#cb28-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-354"><a href="#cb28-354" aria-hidden="true" tabindex="-1"></a>Suppose we have:</span>
<span id="cb28-355"><a href="#cb28-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-356"><a href="#cb28-356" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Data: $y_i \sim N(\theta, \sigma^2)$ with known $\sigma^2$</span>
<span id="cb28-357"><a href="#cb28-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-358"><a href="#cb28-358" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Prior: $\theta \sim N(\mu_0, \tau_0^2)$</span>
<span id="cb28-359"><a href="#cb28-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-360"><a href="#cb28-360" aria-hidden="true" tabindex="-1"></a>The posterior is:</span>
<span id="cb28-361"><a href="#cb28-361" aria-hidden="true" tabindex="-1"></a>$$p(\theta | \mathbf{y}) \propto \exp\left(-\frac{1}{2\sigma^2}\sum(y_i - \theta)^2\right) \times \exp\left(-\frac{1}{2\tau_0^2}(\theta - \mu_0)^2\right)$$</span>
<span id="cb28-362"><a href="#cb28-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-363"><a href="#cb28-363" aria-hidden="true" tabindex="-1"></a>**Step 1:** Expand and combine exponents:</span>
<span id="cb28-364"><a href="#cb28-364" aria-hidden="true" tabindex="-1"></a>$$\propto \exp\left(-\frac{1}{2}\left<span class="co">[</span><span class="ot">\frac{n}{\sigma^2}\theta^2 - \frac{2\sum y_i}{\sigma^2}\theta + \frac{1}{\tau_0^2}\theta^2 - \frac{2\mu_0}{\tau_0^2}\theta\right</span><span class="co">]</span>\right)$$</span>
<span id="cb28-365"><a href="#cb28-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-366"><a href="#cb28-366" aria-hidden="true" tabindex="-1"></a>**Step 2:** Collect terms:</span>
<span id="cb28-367"><a href="#cb28-367" aria-hidden="true" tabindex="-1"></a>$$\propto \exp\left(-\frac{1}{2}\left<span class="co">[</span><span class="ot">\left(\frac{n}{\sigma^2} + \frac{1}{\tau_0^2}\right)\theta^2 - 2\left(\frac{\sum y_i}{\sigma^2} + \frac{\mu_0}{\tau_0^2}\right)\theta\right</span><span class="co">]</span>\right)$$</span>
<span id="cb28-368"><a href="#cb28-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-369"><a href="#cb28-369" aria-hidden="true" tabindex="-1"></a>**Step 3:** Recognize the pattern $\exp(-\frac{1}{2}<span class="co">[</span><span class="ot">A\theta^2 - 2B\theta</span><span class="co">]</span>)$ as Normal with:</span>
<span id="cb28-370"><a href="#cb28-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-371"><a href="#cb28-371" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Precision: $\tau_n = \frac{n}{\sigma^2} + \frac{1}{\tau_0^2}$</span>
<span id="cb28-372"><a href="#cb28-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-373"><a href="#cb28-373" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mean: $\mu_n = \frac{B}{A} = \frac{\sum y_i/\sigma^2 + \mu_0/\tau_0^2}{n/\sigma^2 + 1/\tau_0^2}$</span>
<span id="cb28-374"><a href="#cb28-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-375"><a href="#cb28-375" aria-hidden="true" tabindex="-1"></a>Therefore: $\theta | \mathbf{y} \sim N(\mu_n, 1/\tau_n)$</span>
<span id="cb28-376"><a href="#cb28-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-377"><a href="#cb28-377" aria-hidden="true" tabindex="-1"></a><span class="fu">### The "Completing the Square" Trick</span></span>
<span id="cb28-378"><a href="#cb28-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-379"><a href="#cb28-379" aria-hidden="true" tabindex="-1"></a>For normal kernels, we often need to complete the square:</span>
<span id="cb28-380"><a href="#cb28-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-381"><a href="#cb28-381" aria-hidden="true" tabindex="-1"></a>Starting with: $A\theta^2 - 2B\theta + C$</span>
<span id="cb28-382"><a href="#cb28-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-383"><a href="#cb28-383" aria-hidden="true" tabindex="-1"></a>Rewrite as: $A(\theta - B/A)^2 + \text{constant}$</span>
<span id="cb28-384"><a href="#cb28-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-385"><a href="#cb28-385" aria-hidden="true" tabindex="-1"></a>The constant doesn't depend on $\theta$, so we can ignore it! This reveals:</span>
<span id="cb28-386"><a href="#cb28-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-387"><a href="#cb28-387" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Mean: $\mu = B/A$  </span>
<span id="cb28-388"><a href="#cb28-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-389"><a href="#cb28-389" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Variance: $\sigma^2 = 1/A$</span>
<span id="cb28-390"><a href="#cb28-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-391"><a href="#cb28-391" aria-hidden="true" tabindex="-1"></a><span class="fu">### Why This Works</span></span>
<span id="cb28-392"><a href="#cb28-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-393"><a href="#cb28-393" aria-hidden="true" tabindex="-1"></a>The normalizing constant ensures the distribution integrates to 1, but it's the same for any value of the data. Since we're conditioning on the observed data, the normalizing constant is just a number that makes the probabilities sum/integrate to 1. We can figure out what distribution we have without computing it!</span>
<span id="cb28-394"><a href="#cb28-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-395"><a href="#cb28-395" aria-hidden="true" tabindex="-1"></a><span class="fu">### Practical Tips</span></span>
<span id="cb28-396"><a href="#cb28-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-397"><a href="#cb28-397" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Expand everything** in the posterior expression</span>
<span id="cb28-398"><a href="#cb28-398" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Collect like terms** (all $\theta^2$ terms together, all $\theta$ terms together)</span>
<span id="cb28-399"><a href="#cb28-399" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Ignore constants** that don't involve $\theta$</span>
<span id="cb28-400"><a href="#cb28-400" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Match the pattern** to a known distribution</span>
<span id="cb28-401"><a href="#cb28-401" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>**Extract parameters** from the coefficients</span>
<span id="cb28-402"><a href="#cb28-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-403"><a href="#cb28-403" aria-hidden="true" tabindex="-1"></a>This technique is powerful because it lets us derive closed-form posteriors without doing any integration!</span>
<span id="cb28-404"><a href="#cb28-404" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb28-405"><a href="#cb28-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-406"><a href="#cb28-406" aria-hidden="true" tabindex="-1"></a>Expanding and completing the square:</span>
<span id="cb28-407"><a href="#cb28-407" aria-hidden="true" tabindex="-1"></a>$$\tau\sum_{i=1}^n(y_i - \beta x_i)^2 + \tau_0(\beta - \mu_0)^2 = (\tau\sum x_i^2 + \tau_0)\beta^2 - 2\beta(\tau\sum x_i y_i + \tau_0\mu_0) + C$$</span>
<span id="cb28-408"><a href="#cb28-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-409"><a href="#cb28-409" aria-hidden="true" tabindex="-1"></a>This is the kernel of a normal distribution:</span>
<span id="cb28-410"><a href="#cb28-410" aria-hidden="true" tabindex="-1"></a>$$\beta | \mathbf{y}, \tau \sim N\left(\frac{\tau\sum x_i y_i + \tau_0\mu_0}{\tau\sum x_i^2 + \tau_0}, \frac{1}{\tau\sum x_i^2 + \tau_0}\right)$$</span>
<span id="cb28-411"><a href="#cb28-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-412"><a href="#cb28-412" aria-hidden="true" tabindex="-1"></a>Let $\tau_n = \tau\sum x_i^2 + \tau_0$ and $\mu_n = \frac{\tau\sum x_i y_i + \tau_0\mu_0}{\tau_n}$.</span>
<span id="cb28-413"><a href="#cb28-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-414"><a href="#cb28-414" aria-hidden="true" tabindex="-1"></a>**Complete Conditional for** $\tau$:</span>
<span id="cb28-415"><a href="#cb28-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-416"><a href="#cb28-416" aria-hidden="true" tabindex="-1"></a>The likelihood contribution is:</span>
<span id="cb28-417"><a href="#cb28-417" aria-hidden="true" tabindex="-1"></a>$$p(\mathbf{y}|\beta, \tau) \propto \tau^{n/2} \exp\left(-\frac{\tau}{2}\sum_{i=1}^n(y_i - \beta x_i)^2\right)$$</span>
<span id="cb28-418"><a href="#cb28-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-419"><a href="#cb28-419" aria-hidden="true" tabindex="-1"></a>The prior is:</span>
<span id="cb28-420"><a href="#cb28-420" aria-hidden="true" tabindex="-1"></a>$$p(\tau) \propto \tau^{\alpha_0-1} \exp(-\beta_0\tau)$$</span>
<span id="cb28-421"><a href="#cb28-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-422"><a href="#cb28-422" aria-hidden="true" tabindex="-1"></a>The posterior is:</span>
<span id="cb28-423"><a href="#cb28-423" aria-hidden="true" tabindex="-1"></a>$$p(\tau | \mathbf{y}, \beta) \propto \tau^{n/2 + \alpha_0 - 1} \exp\left(-\tau\left<span class="co">[</span><span class="ot">\frac{1}{2}\sum_{i=1}^n(y_i - \beta x_i)^2 + \beta_0\right</span><span class="co">]</span>\right)$$</span>
<span id="cb28-424"><a href="#cb28-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-425"><a href="#cb28-425" aria-hidden="true" tabindex="-1"></a>This is the kernel of a Gamma distribution:</span>
<span id="cb28-426"><a href="#cb28-426" aria-hidden="true" tabindex="-1"></a>$$\tau | \mathbf{y}, \beta \sim \text{Gamma}\left(\alpha_0 + \frac{n}{2}, \beta_0 + \frac{1}{2}\sum_{i=1}^n(y_i - \beta x_i)^2\right)$$</span>
<span id="cb28-427"><a href="#cb28-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-428"><a href="#cb28-428" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gibbs Sampling</span></span>
<span id="cb28-429"><a href="#cb28-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-430"><a href="#cb28-430" aria-hidden="true" tabindex="-1"></a>Gibbs sampling is a Markov Chain Monte Carlo (MCMC) method that generates samples from a joint posterior distribution by iteratively sampling from complete conditional distributions. The algorithm proceeds as follows:</span>
<span id="cb28-431"><a href="#cb28-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-432"><a href="#cb28-432" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Initialize $\beta^{(0)}$ and $\tau^{(0)}$</span>
<span id="cb28-433"><a href="#cb28-433" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>For iteration $t = 1, 2, \ldots, T$:</span>
<span id="cb28-434"><a href="#cb28-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-435"><a href="#cb28-435" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sample $\beta^{(t)} \sim p(\beta | \mathbf{y}, \tau^{(t-1)})$</span>
<span id="cb28-436"><a href="#cb28-436" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb28-437"><a href="#cb28-437" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Sample $\tau^{(t)} \sim p(\tau | \mathbf{y}, \beta^{(t)})$</span>
<span id="cb28-438"><a href="#cb28-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-439"><a href="#cb28-439" aria-hidden="true" tabindex="-1"></a>Under regularity conditions, the samples $(\beta^{(t)}, \tau^{(t)})$ converge to samples from the joint posterior $p(\beta, \tau | \mathbf{y})$.</span>
<span id="cb28-440"><a href="#cb28-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-441"><a href="#cb28-441" aria-hidden="true" tabindex="-1"></a><span class="fu">### Implementation with Diffuse Priors</span></span>
<span id="cb28-442"><a href="#cb28-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-443"><a href="#cb28-443" aria-hidden="true" tabindex="-1"></a>We'll use diffuse (weakly informative) priors:</span>
<span id="cb28-444"><a href="#cb28-444" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\beta \sim N(0, 1000)$ (equivalent to $\tau_0 = 0.001$, $\mu_0 = 0$)</span>
<span id="cb28-445"><a href="#cb28-445" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>$\tau \sim \text{Gamma}(0.001, 0.001)$ (equivalent to $\alpha_0 = 0.001$, $\beta_0 = 0.001$)</span>
<span id="cb28-446"><a href="#cb28-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-447"><a href="#cb28-447" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gibbs_sampling}</span></span>
<span id="cb28-448"><a href="#cb28-448" aria-hidden="true" tabindex="-1"></a><span class="in"># Gibbs sampler function</span></span>
<span id="cb28-449"><a href="#cb28-449" aria-hidden="true" tabindex="-1"></a><span class="in">gibbs_sampler &lt;- function(y, x, n_iter = 10000, burn_in = 1000,</span></span>
<span id="cb28-450"><a href="#cb28-450" aria-hidden="true" tabindex="-1"></a><span class="in">                          mu0 = 0, tau0 = 0.001, alpha0 = 0.001, beta0 = 0.001) {</span></span>
<span id="cb28-451"><a href="#cb28-451" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-452"><a href="#cb28-452" aria-hidden="true" tabindex="-1"></a><span class="in">  # Storage</span></span>
<span id="cb28-453"><a href="#cb28-453" aria-hidden="true" tabindex="-1"></a><span class="in">  beta_samples &lt;- numeric(n_iter)</span></span>
<span id="cb28-454"><a href="#cb28-454" aria-hidden="true" tabindex="-1"></a><span class="in">  tau_samples &lt;- numeric(n_iter)</span></span>
<span id="cb28-455"><a href="#cb28-455" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-456"><a href="#cb28-456" aria-hidden="true" tabindex="-1"></a><span class="in">  # Initialize</span></span>
<span id="cb28-457"><a href="#cb28-457" aria-hidden="true" tabindex="-1"></a><span class="in">  beta &lt;- sum(x * y) / sum(x^2)  # Start at OLS estimate</span></span>
<span id="cb28-458"><a href="#cb28-458" aria-hidden="true" tabindex="-1"></a><span class="in">  tau &lt;- 1</span></span>
<span id="cb28-459"><a href="#cb28-459" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-460"><a href="#cb28-460" aria-hidden="true" tabindex="-1"></a><span class="in">  # Precompute</span></span>
<span id="cb28-461"><a href="#cb28-461" aria-hidden="true" tabindex="-1"></a><span class="in">  sum_x2 &lt;- sum(x^2)</span></span>
<span id="cb28-462"><a href="#cb28-462" aria-hidden="true" tabindex="-1"></a><span class="in">  sum_xy &lt;- sum(x * y)</span></span>
<span id="cb28-463"><a href="#cb28-463" aria-hidden="true" tabindex="-1"></a><span class="in">  n &lt;- length(y)</span></span>
<span id="cb28-464"><a href="#cb28-464" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-465"><a href="#cb28-465" aria-hidden="true" tabindex="-1"></a><span class="in">  # Gibbs sampling</span></span>
<span id="cb28-466"><a href="#cb28-466" aria-hidden="true" tabindex="-1"></a><span class="in">  for (i in 1:n_iter) {</span></span>
<span id="cb28-467"><a href="#cb28-467" aria-hidden="true" tabindex="-1"></a><span class="in">    # Sample beta | tau, y</span></span>
<span id="cb28-468"><a href="#cb28-468" aria-hidden="true" tabindex="-1"></a><span class="in">    tau_n &lt;- tau * sum_x2 + tau0</span></span>
<span id="cb28-469"><a href="#cb28-469" aria-hidden="true" tabindex="-1"></a><span class="in">    mu_n &lt;- (tau * sum_xy + tau0 * mu0) / tau_n</span></span>
<span id="cb28-470"><a href="#cb28-470" aria-hidden="true" tabindex="-1"></a><span class="in">    beta &lt;- rnorm(1, mu_n, sqrt(1/tau_n))</span></span>
<span id="cb28-471"><a href="#cb28-471" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb28-472"><a href="#cb28-472" aria-hidden="true" tabindex="-1"></a><span class="in">    # Sample tau | beta, y</span></span>
<span id="cb28-473"><a href="#cb28-473" aria-hidden="true" tabindex="-1"></a><span class="in">    residuals &lt;- y - beta * x</span></span>
<span id="cb28-474"><a href="#cb28-474" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha_n &lt;- alpha0 + n/2</span></span>
<span id="cb28-475"><a href="#cb28-475" aria-hidden="true" tabindex="-1"></a><span class="in">    beta_n &lt;- beta0 + sum(residuals^2)/2</span></span>
<span id="cb28-476"><a href="#cb28-476" aria-hidden="true" tabindex="-1"></a><span class="in">    tau &lt;- rgamma(1, alpha_n, beta_n)</span></span>
<span id="cb28-477"><a href="#cb28-477" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb28-478"><a href="#cb28-478" aria-hidden="true" tabindex="-1"></a><span class="in">    # Store</span></span>
<span id="cb28-479"><a href="#cb28-479" aria-hidden="true" tabindex="-1"></a><span class="in">    beta_samples[i] &lt;- beta</span></span>
<span id="cb28-480"><a href="#cb28-480" aria-hidden="true" tabindex="-1"></a><span class="in">    tau_samples[i] &lt;- tau</span></span>
<span id="cb28-481"><a href="#cb28-481" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb28-482"><a href="#cb28-482" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-483"><a href="#cb28-483" aria-hidden="true" tabindex="-1"></a><span class="in">  # Remove burn-in</span></span>
<span id="cb28-484"><a href="#cb28-484" aria-hidden="true" tabindex="-1"></a><span class="in">  beta_samples &lt;- beta_samples[-(1:burn_in)]</span></span>
<span id="cb28-485"><a href="#cb28-485" aria-hidden="true" tabindex="-1"></a><span class="in">  tau_samples &lt;- tau_samples[-(1:burn_in)]</span></span>
<span id="cb28-486"><a href="#cb28-486" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-487"><a href="#cb28-487" aria-hidden="true" tabindex="-1"></a><span class="in">  list(beta = beta_samples, tau = tau_samples, sigma = 1/sqrt(tau_samples))</span></span>
<span id="cb28-488"><a href="#cb28-488" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb28-489"><a href="#cb28-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-490"><a href="#cb28-490" aria-hidden="true" tabindex="-1"></a><span class="in"># Run Gibbs sampler</span></span>
<span id="cb28-491"><a href="#cb28-491" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(123)</span></span>
<span id="cb28-492"><a href="#cb28-492" aria-hidden="true" tabindex="-1"></a><span class="in">gibbs_results &lt;- gibbs_sampler(y, x, n_iter = 11000, burn_in = 1000)</span></span>
<span id="cb28-493"><a href="#cb28-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-494"><a href="#cb28-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-495"><a href="#cb28-495" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Trace Plots</span></span>
<span id="cb28-496"><a href="#cb28-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-497"><a href="#cb28-497" aria-hidden="true" tabindex="-1"></a><span class="in">```{r trace_plots, fig.width=10, fig.height=6}</span></span>
<span id="cb28-498"><a href="#cb28-498" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(2, 2))</span></span>
<span id="cb28-499"><a href="#cb28-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-500"><a href="#cb28-500" aria-hidden="true" tabindex="-1"></a><span class="in"># Beta trace plot</span></span>
<span id="cb28-501"><a href="#cb28-501" aria-hidden="true" tabindex="-1"></a><span class="in">plot(gibbs_results$beta, type = 'l', main = 'Trace Plot for β',</span></span>
<span id="cb28-502"><a href="#cb28-502" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab = 'Iteration', ylab = 'β')</span></span>
<span id="cb28-503"><a href="#cb28-503" aria-hidden="true" tabindex="-1"></a><span class="in">abline(h = beta_hat, col = 'red', lty = 2)</span></span>
<span id="cb28-504"><a href="#cb28-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-505"><a href="#cb28-505" aria-hidden="true" tabindex="-1"></a><span class="in"># Beta density</span></span>
<span id="cb28-506"><a href="#cb28-506" aria-hidden="true" tabindex="-1"></a><span class="in">plot(density(gibbs_results$beta), main = 'Posterior Density for β',</span></span>
<span id="cb28-507"><a href="#cb28-507" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab = 'β', ylab = 'Density')</span></span>
<span id="cb28-508"><a href="#cb28-508" aria-hidden="true" tabindex="-1"></a><span class="in">abline(v = beta_hat, col = 'red', lty = 2)</span></span>
<span id="cb28-509"><a href="#cb28-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-510"><a href="#cb28-510" aria-hidden="true" tabindex="-1"></a><span class="in"># Tau trace plot</span></span>
<span id="cb28-511"><a href="#cb28-511" aria-hidden="true" tabindex="-1"></a><span class="in">plot(gibbs_results$tau, type = 'l', main = 'Trace Plot for τ',</span></span>
<span id="cb28-512"><a href="#cb28-512" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab = 'Iteration', ylab = 'τ')</span></span>
<span id="cb28-513"><a href="#cb28-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-514"><a href="#cb28-514" aria-hidden="true" tabindex="-1"></a><span class="in"># Sigma density (more interpretable than tau)</span></span>
<span id="cb28-515"><a href="#cb28-515" aria-hidden="true" tabindex="-1"></a><span class="in">plot(density(gibbs_results$sigma), main = 'Posterior Density for σ',</span></span>
<span id="cb28-516"><a href="#cb28-516" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab = 'σ', ylab = 'Density')</span></span>
<span id="cb28-517"><a href="#cb28-517" aria-hidden="true" tabindex="-1"></a><span class="in">abline(v = sigma_hat_unbiased, col = 'red', lty = 2)</span></span>
<span id="cb28-518"><a href="#cb28-518" aria-hidden="true" tabindex="-1"></a><span class="in">legend('topright', 'Unbiased estimate', col = 'red', lty = 2, cex = 0.8)</span></span>
<span id="cb28-519"><a href="#cb28-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-520"><a href="#cb28-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-521"><a href="#cb28-521" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Summary Statistics</span></span>
<span id="cb28-522"><a href="#cb28-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-523"><a href="#cb28-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gibbs_summary}</span></span>
<span id="cb28-524"><a href="#cb28-524" aria-hidden="true" tabindex="-1"></a><span class="in"># Create summary table for Gibbs results</span></span>
<span id="cb28-525"><a href="#cb28-525" aria-hidden="true" tabindex="-1"></a><span class="in">gibbs_summary &lt;- data.frame(</span></span>
<span id="cb28-526"><a href="#cb28-526" aria-hidden="true" tabindex="-1"></a><span class="in">  Parameter = rep(c("β", "σ"), each = 4),</span></span>
<span id="cb28-527"><a href="#cb28-527" aria-hidden="true" tabindex="-1"></a><span class="in">  Statistic = rep(c("Mean", "Median", "SD", "95% CI"), 2),</span></span>
<span id="cb28-528"><a href="#cb28-528" aria-hidden="true" tabindex="-1"></a><span class="in">  Value = c(</span></span>
<span id="cb28-529"><a href="#cb28-529" aria-hidden="true" tabindex="-1"></a><span class="in">    round(mean(gibbs_results$beta), 4),</span></span>
<span id="cb28-530"><a href="#cb28-530" aria-hidden="true" tabindex="-1"></a><span class="in">    round(median(gibbs_results$beta), 4),</span></span>
<span id="cb28-531"><a href="#cb28-531" aria-hidden="true" tabindex="-1"></a><span class="in">    round(sd(gibbs_results$beta), 4),</span></span>
<span id="cb28-532"><a href="#cb28-532" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("(", round(quantile(gibbs_results$beta, 0.025), 4), ", ", </span></span>
<span id="cb28-533"><a href="#cb28-533" aria-hidden="true" tabindex="-1"></a><span class="in">           round(quantile(gibbs_results$beta, 0.975), 4), ")"),</span></span>
<span id="cb28-534"><a href="#cb28-534" aria-hidden="true" tabindex="-1"></a><span class="in">    round(mean(gibbs_results$sigma), 4),</span></span>
<span id="cb28-535"><a href="#cb28-535" aria-hidden="true" tabindex="-1"></a><span class="in">    round(median(gibbs_results$sigma), 4),</span></span>
<span id="cb28-536"><a href="#cb28-536" aria-hidden="true" tabindex="-1"></a><span class="in">    round(sd(gibbs_results$sigma), 4),</span></span>
<span id="cb28-537"><a href="#cb28-537" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("(", round(quantile(gibbs_results$sigma, 0.025), 4), ", ", </span></span>
<span id="cb28-538"><a href="#cb28-538" aria-hidden="true" tabindex="-1"></a><span class="in">           round(quantile(gibbs_results$sigma, 0.975), 4), ")")</span></span>
<span id="cb28-539"><a href="#cb28-539" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb28-540"><a href="#cb28-540" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-541"><a href="#cb28-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-542"><a href="#cb28-542" aria-hidden="true" tabindex="-1"></a><span class="in">kable(gibbs_summary, caption = "Posterior Summary from Gibbs Sampling", align = 'llr') %&gt;%</span></span>
<span id="cb28-543"><a href="#cb28-543" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover")) %&gt;%</span></span>
<span id="cb28-544"><a href="#cb28-544" aria-hidden="true" tabindex="-1"></a><span class="in">  pack_rows("β", 1, 4) %&gt;%</span></span>
<span id="cb28-545"><a href="#cb28-545" aria-hidden="true" tabindex="-1"></a><span class="in">  pack_rows("σ", 5, 8)</span></span>
<span id="cb28-546"><a href="#cb28-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-547"><a href="#cb28-547" aria-hidden="true" tabindex="-1"></a><span class="in"># Comparison table</span></span>
<span id="cb28-548"><a href="#cb28-548" aria-hidden="true" tabindex="-1"></a><span class="in">comparison_freq_bayes &lt;- data.frame(</span></span>
<span id="cb28-549"><a href="#cb28-549" aria-hidden="true" tabindex="-1"></a><span class="in">  Parameter = c("β", "σ"),</span></span>
<span id="cb28-550"><a href="#cb28-550" aria-hidden="true" tabindex="-1"></a><span class="in">  `MLE (biased)` = c(round(beta_hat, 4), round(sigma_hat_mle, 4)),</span></span>
<span id="cb28-551"><a href="#cb28-551" aria-hidden="true" tabindex="-1"></a><span class="in">  `MLE (unbiased)` = c(round(beta_hat, 4), round(sigma_hat_unbiased, 4)),</span></span>
<span id="cb28-552"><a href="#cb28-552" aria-hidden="true" tabindex="-1"></a><span class="in">  `Posterior Mean` = c(round(mean(gibbs_results$beta), 4), round(mean(gibbs_results$sigma), 4)),</span></span>
<span id="cb28-553"><a href="#cb28-553" aria-hidden="true" tabindex="-1"></a><span class="in">  check.names = FALSE</span></span>
<span id="cb28-554"><a href="#cb28-554" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-555"><a href="#cb28-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-556"><a href="#cb28-556" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison_freq_bayes, caption = "Comparison: Frequentist vs Bayesian Estimates", align = 'lrrr') %&gt;%</span></span>
<span id="cb28-557"><a href="#cb28-557" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-558"><a href="#cb28-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-559"><a href="#cb28-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-560"><a href="#cb28-560" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparison with brms</span></span>
<span id="cb28-561"><a href="#cb28-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-562"><a href="#cb28-562" aria-hidden="true" tabindex="-1"></a><span class="in">```{r brms_comparison, results='hide', message=FALSE, warning=FALSE}</span></span>
<span id="cb28-563"><a href="#cb28-563" aria-hidden="true" tabindex="-1"></a><span class="in"># Fit model with brms (no intercept)</span></span>
<span id="cb28-564"><a href="#cb28-564" aria-hidden="true" tabindex="-1"></a><span class="in">brms_model &lt;- brm(dist ~ 0 + speed, </span></span>
<span id="cb28-565"><a href="#cb28-565" aria-hidden="true" tabindex="-1"></a><span class="in">                  data = cars,</span></span>
<span id="cb28-566"><a href="#cb28-566" aria-hidden="true" tabindex="-1"></a><span class="in">                  prior = c(prior(normal(0, 31.62), class = "b"),  # SD = sqrt(1000)</span></span>
<span id="cb28-567"><a href="#cb28-567" aria-hidden="true" tabindex="-1"></a><span class="in">                           prior(gamma(0.001, 0.001), class = "sigma")),</span></span>
<span id="cb28-568"><a href="#cb28-568" aria-hidden="true" tabindex="-1"></a><span class="in">                  chains = 4, </span></span>
<span id="cb28-569"><a href="#cb28-569" aria-hidden="true" tabindex="-1"></a><span class="in">                  iter = 2000,</span></span>
<span id="cb28-570"><a href="#cb28-570" aria-hidden="true" tabindex="-1"></a><span class="in">                  warmup = 1000,</span></span>
<span id="cb28-571"><a href="#cb28-571" aria-hidden="true" tabindex="-1"></a><span class="in">                  seed = 123,</span></span>
<span id="cb28-572"><a href="#cb28-572" aria-hidden="true" tabindex="-1"></a><span class="in">                  refresh = 0)</span></span>
<span id="cb28-573"><a href="#cb28-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-574"><a href="#cb28-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-575"><a href="#cb28-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r brms_summary}</span></span>
<span id="cb28-576"><a href="#cb28-576" aria-hidden="true" tabindex="-1"></a><span class="in">summary(brms_model)</span></span>
<span id="cb28-577"><a href="#cb28-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-578"><a href="#cb28-578" aria-hidden="true" tabindex="-1"></a><span class="in"># Create comparison table</span></span>
<span id="cb28-579"><a href="#cb28-579" aria-hidden="true" tabindex="-1"></a><span class="in">comparison_gibbs_brms &lt;- data.frame(</span></span>
<span id="cb28-580"><a href="#cb28-580" aria-hidden="true" tabindex="-1"></a><span class="in">  Method = c("Manual Gibbs", "brms"),</span></span>
<span id="cb28-581"><a href="#cb28-581" aria-hidden="true" tabindex="-1"></a><span class="in">  `β (Mean)` = c(round(mean(gibbs_results$beta), 4), round(fixef(brms_model)[1, 1], 4)),</span></span>
<span id="cb28-582"><a href="#cb28-582" aria-hidden="true" tabindex="-1"></a><span class="in">  `β (SD)` = c(round(sd(gibbs_results$beta), 4), round(fixef(brms_model)[1, 2], 4)),</span></span>
<span id="cb28-583"><a href="#cb28-583" aria-hidden="true" tabindex="-1"></a><span class="in">  check.names = FALSE</span></span>
<span id="cb28-584"><a href="#cb28-584" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-585"><a href="#cb28-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-586"><a href="#cb28-586" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison_gibbs_brms, caption = "Comparison: Manual Gibbs Sampling vs brms", align = 'lrr') %&gt;%</span></span>
<span id="cb28-587"><a href="#cb28-587" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-588"><a href="#cb28-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-589"><a href="#cb28-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-590"><a href="#cb28-590" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3D Posterior Distribution</span></span>
<span id="cb28-591"><a href="#cb28-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-592"><a href="#cb28-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r posterior_3d, fig.width=10, fig.height=8}</span></span>
<span id="cb28-593"><a href="#cb28-593" aria-hidden="true" tabindex="-1"></a><span class="in"># Sample for visualization</span></span>
<span id="cb28-594"><a href="#cb28-594" aria-hidden="true" tabindex="-1"></a><span class="in">sample_indices &lt;- sample(length(gibbs_results$beta), 2000)</span></span>
<span id="cb28-595"><a href="#cb28-595" aria-hidden="true" tabindex="-1"></a><span class="in">beta_sample &lt;- gibbs_results$beta[sample_indices]</span></span>
<span id="cb28-596"><a href="#cb28-596" aria-hidden="true" tabindex="-1"></a><span class="in">sigma_sample &lt;- gibbs_results$sigma[sample_indices]</span></span>
<span id="cb28-597"><a href="#cb28-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-598"><a href="#cb28-598" aria-hidden="true" tabindex="-1"></a><span class="in"># Create density estimate</span></span>
<span id="cb28-599"><a href="#cb28-599" aria-hidden="true" tabindex="-1"></a><span class="in">library(MASS)</span></span>
<span id="cb28-600"><a href="#cb28-600" aria-hidden="true" tabindex="-1"></a><span class="in">dens &lt;- kde2d(sigma_sample, beta_sample, n = 50)</span></span>
<span id="cb28-601"><a href="#cb28-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-602"><a href="#cb28-602" aria-hidden="true" tabindex="-1"></a><span class="in">plot_ly(x = dens$x, y = dens$y, z = dens$z) %&gt;%</span></span>
<span id="cb28-603"><a href="#cb28-603" aria-hidden="true" tabindex="-1"></a><span class="in">  add_surface() %&gt;%</span></span>
<span id="cb28-604"><a href="#cb28-604" aria-hidden="true" tabindex="-1"></a><span class="in">  add_markers(x = mean(sigma_sample), y = mean(beta_sample), z = max(dens$z),</span></span>
<span id="cb28-605"><a href="#cb28-605" aria-hidden="true" tabindex="-1"></a><span class="in">              marker = list(size = 5, color = 'red'),</span></span>
<span id="cb28-606"><a href="#cb28-606" aria-hidden="true" tabindex="-1"></a><span class="in">              name = 'Posterior Mean') %&gt;%</span></span>
<span id="cb28-607"><a href="#cb28-607" aria-hidden="true" tabindex="-1"></a><span class="in">  layout(scene = list(</span></span>
<span id="cb28-608"><a href="#cb28-608" aria-hidden="true" tabindex="-1"></a><span class="in">    xaxis = list(title = 'σ'),</span></span>
<span id="cb28-609"><a href="#cb28-609" aria-hidden="true" tabindex="-1"></a><span class="in">    yaxis = list(title = 'β'),</span></span>
<span id="cb28-610"><a href="#cb28-610" aria-hidden="true" tabindex="-1"></a><span class="in">    zaxis = list(title = 'Posterior Density'),</span></span>
<span id="cb28-611"><a href="#cb28-611" aria-hidden="true" tabindex="-1"></a><span class="in">    camera = list(eye = list(x = 1.5, y = 1.5, z = 1.3))</span></span>
<span id="cb28-612"><a href="#cb28-612" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb28-613"><a href="#cb28-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-614"><a href="#cb28-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-615"><a href="#cb28-615" aria-hidden="true" tabindex="-1"></a><span class="fu">### Joint Distribution Under Independent Priors</span></span>
<span id="cb28-616"><a href="#cb28-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-617"><a href="#cb28-617" aria-hidden="true" tabindex="-1"></a>Under certain prior specifications that maintain independence between $\beta$ and $\tau$, we can derive closed-form marginal posteriors. Specifically, with independent priors where $p(\beta, \tau) = p(\beta)p(\tau)$, we can integrate out one parameter to obtain marginal distributions.</span>
<span id="cb28-618"><a href="#cb28-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-619"><a href="#cb28-619" aria-hidden="true" tabindex="-1"></a>**Marginal for** $\beta$:</span>
<span id="cb28-620"><a href="#cb28-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-621"><a href="#cb28-621" aria-hidden="true" tabindex="-1"></a>If we use an improper uniform prior for $\beta$ and Jeffrey's prior for $\sigma^2$ (i.e., $p(\beta, \sigma^2) \propto 1/\sigma^2$), the marginal posterior for $\beta$ follows a t-distribution:</span>
<span id="cb28-622"><a href="#cb28-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-623"><a href="#cb28-623" aria-hidden="true" tabindex="-1"></a>$$\beta | \mathbf{y} \sim t_{n-1}\left(\hat{\beta}, \frac{\hat{\sigma}^2}{\sum x_i^2}\right)$$</span>
<span id="cb28-624"><a href="#cb28-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-625"><a href="#cb28-625" aria-hidden="true" tabindex="-1"></a>where $\hat{\beta} = \frac{\sum x_i y_i}{\sum x_i^2}$ and $\hat{\sigma}^2 = \frac{\sum(y_i - \hat{\beta}x_i)^2}{n-1}$.</span>
<span id="cb28-626"><a href="#cb28-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-627"><a href="#cb28-627" aria-hidden="true" tabindex="-1"></a>**Marginal for** $\tau$:</span>
<span id="cb28-628"><a href="#cb28-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-629"><a href="#cb28-629" aria-hidden="true" tabindex="-1"></a>With the same prior structure, after integrating out $\beta$, the marginal posterior for $\tau$ is:</span>
<span id="cb28-630"><a href="#cb28-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-631"><a href="#cb28-631" aria-hidden="true" tabindex="-1"></a>$$\tau | \mathbf{y} \sim \text{Gamma}\left(\frac{n-1}{2}, \frac{RSS}{2}\right)$$</span>
<span id="cb28-632"><a href="#cb28-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-633"><a href="#cb28-633" aria-hidden="true" tabindex="-1"></a>where $RSS = \sum(y_i - \hat{\beta}x_i)^2$.</span>
<span id="cb28-634"><a href="#cb28-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-635"><a href="#cb28-635" aria-hidden="true" tabindex="-1"></a>This special case provides closed-form posteriors but is limited to specific prior choices. The Gibbs sampling approach is more flexible and extends naturally to more complex models.</span>
<span id="cb28-636"><a href="#cb28-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-637"><a href="#cb28-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r analytical_posterior}</span></span>
<span id="cb28-638"><a href="#cb28-638" aria-hidden="true" tabindex="-1"></a><span class="in"># Analytical t-distribution for beta</span></span>
<span id="cb28-639"><a href="#cb28-639" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- length(y) - 1</span></span>
<span id="cb28-640"><a href="#cb28-640" aria-hidden="true" tabindex="-1"></a><span class="in">scale &lt;- sqrt(sigma_hat_unbiased^2 / sum(x^2))</span></span>
<span id="cb28-641"><a href="#cb28-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-642"><a href="#cb28-642" aria-hidden="true" tabindex="-1"></a><span class="in"># Create comparison table</span></span>
<span id="cb28-643"><a href="#cb28-643" aria-hidden="true" tabindex="-1"></a><span class="in">comparison_analytical &lt;- data.frame(</span></span>
<span id="cb28-644"><a href="#cb28-644" aria-hidden="true" tabindex="-1"></a><span class="in">  Method = c("Analytical (t-dist)", "Gibbs Sampling"),</span></span>
<span id="cb28-645"><a href="#cb28-645" aria-hidden="true" tabindex="-1"></a><span class="in">  Mean = c(round(beta_hat, 4), round(mean(gibbs_results$beta), 4)),</span></span>
<span id="cb28-646"><a href="#cb28-646" aria-hidden="true" tabindex="-1"></a><span class="in">  SD = c(round(scale * sqrt(df/(df-2)), 4), round(sd(gibbs_results$beta), 4)),</span></span>
<span id="cb28-647"><a href="#cb28-647" aria-hidden="true" tabindex="-1"></a><span class="in">  `95% CI Lower` = c(</span></span>
<span id="cb28-648"><a href="#cb28-648" aria-hidden="true" tabindex="-1"></a><span class="in">    round(beta_hat + qt(0.025, df) * scale, 4),</span></span>
<span id="cb28-649"><a href="#cb28-649" aria-hidden="true" tabindex="-1"></a><span class="in">    round(quantile(gibbs_results$beta, 0.025), 4)</span></span>
<span id="cb28-650"><a href="#cb28-650" aria-hidden="true" tabindex="-1"></a><span class="in">  ),</span></span>
<span id="cb28-651"><a href="#cb28-651" aria-hidden="true" tabindex="-1"></a><span class="in">  `95% CI Upper` = c(</span></span>
<span id="cb28-652"><a href="#cb28-652" aria-hidden="true" tabindex="-1"></a><span class="in">    round(beta_hat + qt(0.975, df) * scale, 4),</span></span>
<span id="cb28-653"><a href="#cb28-653" aria-hidden="true" tabindex="-1"></a><span class="in">    round(quantile(gibbs_results$beta, 0.975), 4)</span></span>
<span id="cb28-654"><a href="#cb28-654" aria-hidden="true" tabindex="-1"></a><span class="in">  ),</span></span>
<span id="cb28-655"><a href="#cb28-655" aria-hidden="true" tabindex="-1"></a><span class="in">  check.names = FALSE</span></span>
<span id="cb28-656"><a href="#cb28-656" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-657"><a href="#cb28-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-658"><a href="#cb28-658" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison_analytical, caption = "Comparison: Analytical vs Gibbs Sampling for β", align = 'lrrrr') %&gt;%</span></span>
<span id="cb28-659"><a href="#cb28-659" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-660"><a href="#cb28-660" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-661"><a href="#cb28-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-662"><a href="#cb28-662" aria-hidden="true" tabindex="-1"></a><span class="fu"># Logistic Regression</span></span>
<span id="cb28-663"><a href="#cb28-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-664"><a href="#cb28-664" aria-hidden="true" tabindex="-1"></a>We now consider logistic regression for binary outcomes. The model is:</span>
<span id="cb28-665"><a href="#cb28-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-666"><a href="#cb28-666" aria-hidden="true" tabindex="-1"></a>$$\log\left(\frac{P(Y_i = 1|X_i)}{1 - P(Y_i = 1|X_i)}\right) = \beta X_i$$</span>
<span id="cb28-667"><a href="#cb28-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-668"><a href="#cb28-668" aria-hidden="true" tabindex="-1"></a>or equivalently:</span>
<span id="cb28-669"><a href="#cb28-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-670"><a href="#cb28-670" aria-hidden="true" tabindex="-1"></a>$$P(Y_i = 1|X_i) = \frac{\exp(\beta X_i)}{1 + \exp(\beta X_i)} = \frac{1}{1 + \exp(-\beta X_i)}$$</span>
<span id="cb28-671"><a href="#cb28-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-672"><a href="#cb28-672" aria-hidden="true" tabindex="-1"></a>Again, we omit the intercept for simplicity, though this is rarely done in practice.</span>
<span id="cb28-673"><a href="#cb28-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-674"><a href="#cb28-674" aria-hidden="true" tabindex="-1"></a><span class="fu">## Frequentist Estimation</span></span>
<span id="cb28-675"><a href="#cb28-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-676"><a href="#cb28-676" aria-hidden="true" tabindex="-1"></a><span class="fu">### Maximum Likelihood Estimation</span></span>
<span id="cb28-677"><a href="#cb28-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-678"><a href="#cb28-678" aria-hidden="true" tabindex="-1"></a>The likelihood for logistic regression is based on the Bernoulli distribution:</span>
<span id="cb28-679"><a href="#cb28-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-680"><a href="#cb28-680" aria-hidden="true" tabindex="-1"></a>$$L(\beta | \mathbf{y}, \mathbf{x}) = \prod_{i=1}^n p_i^{y_i}(1-p_i)^{1-y_i}$$</span>
<span id="cb28-681"><a href="#cb28-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-682"><a href="#cb28-682" aria-hidden="true" tabindex="-1"></a>where $p_i = \frac{1}{1 + \exp(-\beta x_i)}$.</span>
<span id="cb28-683"><a href="#cb28-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-684"><a href="#cb28-684" aria-hidden="true" tabindex="-1"></a>The log-likelihood is:</span>
<span id="cb28-685"><a href="#cb28-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-686"><a href="#cb28-686" aria-hidden="true" tabindex="-1"></a>$$\ell(\beta) = \sum_{i=1}^n \left<span class="co">[</span><span class="ot">y_i \log(p_i) + (1-y_i)\log(1-p_i)\right</span><span class="co">]</span>$$</span>
<span id="cb28-687"><a href="#cb28-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-688"><a href="#cb28-688" aria-hidden="true" tabindex="-1"></a>$$= \sum_{i=1}^n \left<span class="co">[</span><span class="ot">y_i \log\left(\frac{p_i}{1-p_i}\right) + \log(1-p_i)\right</span><span class="co">]</span>$$</span>
<span id="cb28-689"><a href="#cb28-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-690"><a href="#cb28-690" aria-hidden="true" tabindex="-1"></a>$$= \sum_{i=1}^n \left<span class="co">[</span><span class="ot">y_i(\beta x_i) - \log(1 + \exp(\beta x_i))\right</span><span class="co">]</span>$$</span>
<span id="cb28-691"><a href="#cb28-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-692"><a href="#cb28-692" aria-hidden="true" tabindex="-1"></a>**Deriving the MLE:**</span>
<span id="cb28-693"><a href="#cb28-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-694"><a href="#cb28-694" aria-hidden="true" tabindex="-1"></a>The score function (first derivative) is:</span>
<span id="cb28-695"><a href="#cb28-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-696"><a href="#cb28-696" aria-hidden="true" tabindex="-1"></a>$$\frac{\partial \ell}{\partial \beta} = \sum_{i=1}^n \left<span class="co">[</span><span class="ot">y_i x_i - \frac{x_i \exp(\beta x_i)}{1 + \exp(\beta x_i)}\right</span><span class="co">]</span>$$</span>
<span id="cb28-697"><a href="#cb28-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-698"><a href="#cb28-698" aria-hidden="true" tabindex="-1"></a>$$= \sum_{i=1}^n x_i(y_i - p_i) = 0$$</span>
<span id="cb28-699"><a href="#cb28-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-700"><a href="#cb28-700" aria-hidden="true" tabindex="-1"></a>This equation does not have a closed-form solution and must be solved numerically using methods such as Newton-Raphson or iteratively reweighted least squares (IRLS).</span>
<span id="cb28-701"><a href="#cb28-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-702"><a href="#cb28-702" aria-hidden="true" tabindex="-1"></a>**Standard Error:**</span>
<span id="cb28-703"><a href="#cb28-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-704"><a href="#cb28-704" aria-hidden="true" tabindex="-1"></a>The observed information is:</span>
<span id="cb28-705"><a href="#cb28-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-706"><a href="#cb28-706" aria-hidden="true" tabindex="-1"></a>$$\mathcal{I}(\beta) = -\frac{\partial^2 \ell}{\partial \beta^2} = \sum_{i=1}^n x_i^2 p_i(1-p_i)$$</span>
<span id="cb28-707"><a href="#cb28-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-708"><a href="#cb28-708" aria-hidden="true" tabindex="-1"></a>The asymptotic variance of $\hat{\beta}$ is:</span>
<span id="cb28-709"><a href="#cb28-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-710"><a href="#cb28-710" aria-hidden="true" tabindex="-1"></a>$$\text{Var}(\hat{\beta}) = \frac{1}{\mathcal{I}(\hat{\beta})} = \frac{1}{\sum_{i=1}^n x_i^2 \hat{p}_i(1-\hat{p}_i)}$$</span>
<span id="cb28-711"><a href="#cb28-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-712"><a href="#cb28-712" aria-hidden="true" tabindex="-1"></a>where $\hat{p}_i = \frac{1}{1 + \exp(-\hat{\beta} x_i)}$.</span>
<span id="cb28-713"><a href="#cb28-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-714"><a href="#cb28-714" aria-hidden="true" tabindex="-1"></a><span class="fu">### Demonstration with Real Data</span></span>
<span id="cb28-715"><a href="#cb28-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-716"><a href="#cb28-716" aria-hidden="true" tabindex="-1"></a>We'll use a simple dataset to demonstrate logistic regression:</span>
<span id="cb28-717"><a href="#cb28-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-718"><a href="#cb28-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logistic_data}</span></span>
<span id="cb28-719"><a href="#cb28-719" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a simple dataset</span></span>
<span id="cb28-720"><a href="#cb28-720" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(456)</span></span>
<span id="cb28-721"><a href="#cb28-721" aria-hidden="true" tabindex="-1"></a><span class="in">n &lt;- 100</span></span>
<span id="cb28-722"><a href="#cb28-722" aria-hidden="true" tabindex="-1"></a><span class="in">x_log &lt;- rnorm(n, mean = 0, sd = 1)</span></span>
<span id="cb28-723"><a href="#cb28-723" aria-hidden="true" tabindex="-1"></a><span class="in">true_beta &lt;- 1.5</span></span>
<span id="cb28-724"><a href="#cb28-724" aria-hidden="true" tabindex="-1"></a><span class="in">p_true &lt;- 1 / (1 + exp(-true_beta * x_log))</span></span>
<span id="cb28-725"><a href="#cb28-725" aria-hidden="true" tabindex="-1"></a><span class="in">y_log &lt;- rbinom(n, 1, p_true)</span></span>
<span id="cb28-726"><a href="#cb28-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-727"><a href="#cb28-727" aria-hidden="true" tabindex="-1"></a><span class="in"># Store in dataframe</span></span>
<span id="cb28-728"><a href="#cb28-728" aria-hidden="true" tabindex="-1"></a><span class="in">logistic_data &lt;- data.frame(x = x_log, y = y_log)</span></span>
<span id="cb28-729"><a href="#cb28-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-730"><a href="#cb28-730" aria-hidden="true" tabindex="-1"></a><span class="in"># Manual maximum likelihood (using optim)</span></span>
<span id="cb28-731"><a href="#cb28-731" aria-hidden="true" tabindex="-1"></a><span class="in">log_lik_logistic &lt;- function(beta, y, x) {</span></span>
<span id="cb28-732"><a href="#cb28-732" aria-hidden="true" tabindex="-1"></a><span class="in">  p &lt;- 1 / (1 + exp(-beta * x))</span></span>
<span id="cb28-733"><a href="#cb28-733" aria-hidden="true" tabindex="-1"></a><span class="in">  -sum(y * log(p) + (1 - y) * log(1 - p))</span></span>
<span id="cb28-734"><a href="#cb28-734" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb28-735"><a href="#cb28-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-736"><a href="#cb28-736" aria-hidden="true" tabindex="-1"></a><span class="in"># Find MLE</span></span>
<span id="cb28-737"><a href="#cb28-737" aria-hidden="true" tabindex="-1"></a><span class="in">mle_result &lt;- optim(par = 0, fn = log_lik_logistic, y = y_log, x = x_log,</span></span>
<span id="cb28-738"><a href="#cb28-738" aria-hidden="true" tabindex="-1"></a><span class="in">                    method = "BFGS", hessian = TRUE)</span></span>
<span id="cb28-739"><a href="#cb28-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-740"><a href="#cb28-740" aria-hidden="true" tabindex="-1"></a><span class="in">beta_hat_log &lt;- mle_result$par</span></span>
<span id="cb28-741"><a href="#cb28-741" aria-hidden="true" tabindex="-1"></a><span class="in">se_beta_log &lt;- sqrt(solve(mle_result$hessian)[1,1])</span></span>
<span id="cb28-742"><a href="#cb28-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-743"><a href="#cb28-743" aria-hidden="true" tabindex="-1"></a><span class="in"># Verify with observed information</span></span>
<span id="cb28-744"><a href="#cb28-744" aria-hidden="true" tabindex="-1"></a><span class="in">p_hat &lt;- 1 / (1 + exp(-beta_hat_log * x_log))</span></span>
<span id="cb28-745"><a href="#cb28-745" aria-hidden="true" tabindex="-1"></a><span class="in">obs_info &lt;- sum(x_log^2 * p_hat * (1 - p_hat))</span></span>
<span id="cb28-746"><a href="#cb28-746" aria-hidden="true" tabindex="-1"></a><span class="in">se_beta_formula &lt;- sqrt(1 / obs_info)</span></span>
<span id="cb28-747"><a href="#cb28-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-748"><a href="#cb28-748" aria-hidden="true" tabindex="-1"></a><span class="in"># Create summary table</span></span>
<span id="cb28-749"><a href="#cb28-749" aria-hidden="true" tabindex="-1"></a><span class="in">logistic_manual &lt;- data.frame(</span></span>
<span id="cb28-750"><a href="#cb28-750" aria-hidden="true" tabindex="-1"></a><span class="in">  Estimate = c("β̂", "SE(β̂) from optim", "SE(β̂) from formula"),</span></span>
<span id="cb28-751"><a href="#cb28-751" aria-hidden="true" tabindex="-1"></a><span class="in">  Value = c(round(beta_hat_log, 4), round(se_beta_log, 4), round(se_beta_formula, 4))</span></span>
<span id="cb28-752"><a href="#cb28-752" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-753"><a href="#cb28-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-754"><a href="#cb28-754" aria-hidden="true" tabindex="-1"></a><span class="in">kable(logistic_manual, caption = "Manual MLE for Logistic Regression", align = 'lr') %&gt;%</span></span>
<span id="cb28-755"><a href="#cb28-755" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-756"><a href="#cb28-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-757"><a href="#cb28-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-758"><a href="#cb28-758" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Comparison with glm()</span></span>
<span id="cb28-759"><a href="#cb28-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-760"><a href="#cb28-760" aria-hidden="true" tabindex="-1"></a><span class="in">```{r glm_comparison}</span></span>
<span id="cb28-761"><a href="#cb28-761" aria-hidden="true" tabindex="-1"></a><span class="in"># Fit with glm</span></span>
<span id="cb28-762"><a href="#cb28-762" aria-hidden="true" tabindex="-1"></a><span class="in">logistic_glm &lt;- glm(y ~ x - 1, data = logistic_data, family = binomial(link = "logit"))</span></span>
<span id="cb28-763"><a href="#cb28-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-764"><a href="#cb28-764" aria-hidden="true" tabindex="-1"></a><span class="in"># Create comparison table</span></span>
<span id="cb28-765"><a href="#cb28-765" aria-hidden="true" tabindex="-1"></a><span class="in">comparison_glm &lt;- data.frame(</span></span>
<span id="cb28-766"><a href="#cb28-766" aria-hidden="true" tabindex="-1"></a><span class="in">  Estimate = c("β̂", "SE(β̂)"),</span></span>
<span id="cb28-767"><a href="#cb28-767" aria-hidden="true" tabindex="-1"></a><span class="in">  Manual = c(round(beta_hat_log, 4), round(se_beta_log, 4)),</span></span>
<span id="cb28-768"><a href="#cb28-768" aria-hidden="true" tabindex="-1"></a><span class="in">  `glm()` = c(round(coef(logistic_glm)[1], 4), round(summary(logistic_glm)$coefficients[1, 2], 4)),</span></span>
<span id="cb28-769"><a href="#cb28-769" aria-hidden="true" tabindex="-1"></a><span class="in">  check.names = FALSE</span></span>
<span id="cb28-770"><a href="#cb28-770" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-771"><a href="#cb28-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-772"><a href="#cb28-772" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison_glm, caption = "Comparison: Manual MLE vs glm()", align = 'lrr') %&gt;%</span></span>
<span id="cb28-773"><a href="#cb28-773" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-774"><a href="#cb28-774" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-775"><a href="#cb28-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-776"><a href="#cb28-776" aria-hidden="true" tabindex="-1"></a><span class="fu">## Bayesian Inference</span></span>
<span id="cb28-777"><a href="#cb28-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-778"><a href="#cb28-778" aria-hidden="true" tabindex="-1"></a>For logistic regression, we don't have conjugate priors in the traditional sense because the Bernoulli likelihood doesn't combine nicely with standard distributions. However, we can use flexible approaches.</span>
<span id="cb28-779"><a href="#cb28-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-780"><a href="#cb28-780" aria-hidden="true" tabindex="-1"></a><span class="fu">### Metropolis-Hastings Algorithm</span></span>
<span id="cb28-781"><a href="#cb28-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-782"><a href="#cb28-782" aria-hidden="true" tabindex="-1"></a>The Metropolis-Hastings (M-H) algorithm is a general MCMC method for sampling from distributions that don't have a simple form. Unlike Gibbs sampling, which requires known conditional distributions, M-H can sample from any posterior distribution.</span>
<span id="cb28-783"><a href="#cb28-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-784"><a href="#cb28-784" aria-hidden="true" tabindex="-1"></a>**Basic Idea:** M-H generates candidate values from a proposal distribution, then decides whether to accept or reject each candidate based on how well it fits the target posterior. This creates a Markov chain that eventually converges to samples from the posterior.</span>
<span id="cb28-785"><a href="#cb28-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-786"><a href="#cb28-786" aria-hidden="true" tabindex="-1"></a>**Algorithm Steps:**</span>
<span id="cb28-787"><a href="#cb28-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-788"><a href="#cb28-788" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Start with an initial value $\beta^{(0)}$</span>
<span id="cb28-789"><a href="#cb28-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-790"><a href="#cb28-790" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>For iteration $t = 1, 2, \ldots, T$:</span>
<span id="cb28-791"><a href="#cb28-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-792"><a href="#cb28-792" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Propose a new value: $\beta^* \sim q(\beta^* | \beta^{(t-1)})$ (proposal distribution)</span>
<span id="cb28-793"><a href="#cb28-793" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb28-794"><a href="#cb28-794" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Calculate acceptance ratio: $r = \frac{p(\beta^* | \mathbf{y}) \cdot q(\beta^{(t-1)} | \beta^*)}{p(\beta^{(t-1)} | \mathbf{y}) \cdot q(\beta^* | \beta^{(t-1)})}$</span>
<span id="cb28-795"><a href="#cb28-795" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb28-796"><a href="#cb28-796" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Accept $\beta^* $ with probability $\min(r, 1)$:</span>
<span id="cb28-797"><a href="#cb28-797" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb28-798"><a href="#cb28-798" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>If accepted: $\beta^{(t)} = \beta^*$</span>
<span id="cb28-799"><a href="#cb28-799" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb28-800"><a href="#cb28-800" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>If rejected: $\beta^{(t)} = \beta^{(t-1)}$ (stay at current value)</span>
<span id="cb28-801"><a href="#cb28-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-802"><a href="#cb28-802" aria-hidden="true" tabindex="-1"></a>The "random walk" proposal we use here is symmetric ($q(\beta^* | \beta) = q(\beta | \beta^*)$), so the proposal terms cancel and we only need the posterior ratio.</span>
<span id="cb28-803"><a href="#cb28-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-804"><a href="#cb28-804" aria-hidden="true" tabindex="-1"></a>**Important Notes:**</span>
<span id="cb28-805"><a href="#cb28-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-806"><a href="#cb28-806" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Proposal variance affects efficiency: too small = slow mixing, too large = low acceptance</span>
<span id="cb28-807"><a href="#cb28-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-808"><a href="#cb28-808" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Target acceptance rate is typically 20-40% for complex models</span>
<span id="cb28-809"><a href="#cb28-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-810"><a href="#cb28-810" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This goes beyond the scope of this course—see references for details</span>
<span id="cb28-811"><a href="#cb28-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-812"><a href="#cb28-812" aria-hidden="true" tabindex="-1"></a>For more pedagogical introductions to M-H, see Chib &amp; Greenberg (1995) and Robert &amp; Casella (2011).</span>
<span id="cb28-813"><a href="#cb28-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-814"><a href="#cb28-814" aria-hidden="true" tabindex="-1"></a><span class="fu">### Gibbs Sampling with Data Augmentation</span></span>
<span id="cb28-815"><a href="#cb28-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-816"><a href="#cb28-816" aria-hidden="true" tabindex="-1"></a>One approach is to place a normal prior on $\beta$:</span>
<span id="cb28-817"><a href="#cb28-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-818"><a href="#cb28-818" aria-hidden="true" tabindex="-1"></a>$$\beta \sim N(\mu_0, \sigma_0^2)$$</span>
<span id="cb28-819"><a href="#cb28-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-820"><a href="#cb28-820" aria-hidden="true" tabindex="-1"></a>The posterior is:</span>
<span id="cb28-821"><a href="#cb28-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-822"><a href="#cb28-822" aria-hidden="true" tabindex="-1"></a>$$p(\beta | \mathbf{y}) \propto p(\beta) \prod_{i=1}^n p_i^{y_i}(1-p_i)^{1-y_i}$$</span>
<span id="cb28-823"><a href="#cb28-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-824"><a href="#cb28-824" aria-hidden="true" tabindex="-1"></a>This doesn't have a closed form, so we use Metropolis-Hastings within Gibbs or other MCMC methods.</span>
<span id="cb28-825"><a href="#cb28-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-826"><a href="#cb28-826" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logistic_gibbs}</span></span>
<span id="cb28-827"><a href="#cb28-827" aria-hidden="true" tabindex="-1"></a><span class="in"># Metropolis-Hastings sampler for logistic regression</span></span>
<span id="cb28-828"><a href="#cb28-828" aria-hidden="true" tabindex="-1"></a><span class="in">mh_logistic &lt;- function(y, x, n_iter = 10000, burn_in = 1000,</span></span>
<span id="cb28-829"><a href="#cb28-829" aria-hidden="true" tabindex="-1"></a><span class="in">                        mu0 = 0, sigma0 = 10, proposal_sd = 0.1) {</span></span>
<span id="cb28-830"><a href="#cb28-830" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-831"><a href="#cb28-831" aria-hidden="true" tabindex="-1"></a><span class="in">  beta_samples &lt;- numeric(n_iter)</span></span>
<span id="cb28-832"><a href="#cb28-832" aria-hidden="true" tabindex="-1"></a><span class="in">  beta &lt;- 0  # Initialize</span></span>
<span id="cb28-833"><a href="#cb28-833" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-834"><a href="#cb28-834" aria-hidden="true" tabindex="-1"></a><span class="in">  # Log posterior (unnormalized)</span></span>
<span id="cb28-835"><a href="#cb28-835" aria-hidden="true" tabindex="-1"></a><span class="in">  log_posterior &lt;- function(beta, y, x, mu0, sigma0) {</span></span>
<span id="cb28-836"><a href="#cb28-836" aria-hidden="true" tabindex="-1"></a><span class="in">    p &lt;- 1 / (1 + exp(-beta * x))</span></span>
<span id="cb28-837"><a href="#cb28-837" aria-hidden="true" tabindex="-1"></a><span class="in">    log_lik &lt;- sum(y * log(p) + (1 - y) * log(1 - p))</span></span>
<span id="cb28-838"><a href="#cb28-838" aria-hidden="true" tabindex="-1"></a><span class="in">    log_prior &lt;- dnorm(beta, mu0, sigma0, log = TRUE)</span></span>
<span id="cb28-839"><a href="#cb28-839" aria-hidden="true" tabindex="-1"></a><span class="in">    log_lik + log_prior</span></span>
<span id="cb28-840"><a href="#cb28-840" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb28-841"><a href="#cb28-841" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-842"><a href="#cb28-842" aria-hidden="true" tabindex="-1"></a><span class="in">  accept_count &lt;- 0</span></span>
<span id="cb28-843"><a href="#cb28-843" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-844"><a href="#cb28-844" aria-hidden="true" tabindex="-1"></a><span class="in">  for (i in 1:n_iter) {</span></span>
<span id="cb28-845"><a href="#cb28-845" aria-hidden="true" tabindex="-1"></a><span class="in">    # Propose new beta</span></span>
<span id="cb28-846"><a href="#cb28-846" aria-hidden="true" tabindex="-1"></a><span class="in">    beta_prop &lt;- rnorm(1, beta, proposal_sd)</span></span>
<span id="cb28-847"><a href="#cb28-847" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb28-848"><a href="#cb28-848" aria-hidden="true" tabindex="-1"></a><span class="in">    # Calculate acceptance ratio</span></span>
<span id="cb28-849"><a href="#cb28-849" aria-hidden="true" tabindex="-1"></a><span class="in">    log_ratio &lt;- log_posterior(beta_prop, y, x, mu0, sigma0) -</span></span>
<span id="cb28-850"><a href="#cb28-850" aria-hidden="true" tabindex="-1"></a><span class="in">                 log_posterior(beta, y, x, mu0, sigma0)</span></span>
<span id="cb28-851"><a href="#cb28-851" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb28-852"><a href="#cb28-852" aria-hidden="true" tabindex="-1"></a><span class="in">    # Accept/reject</span></span>
<span id="cb28-853"><a href="#cb28-853" aria-hidden="true" tabindex="-1"></a><span class="in">    if (log(runif(1)) &lt; log_ratio) {</span></span>
<span id="cb28-854"><a href="#cb28-854" aria-hidden="true" tabindex="-1"></a><span class="in">      beta &lt;- beta_prop</span></span>
<span id="cb28-855"><a href="#cb28-855" aria-hidden="true" tabindex="-1"></a><span class="in">      if (i &gt; burn_in) accept_count &lt;- accept_count + 1</span></span>
<span id="cb28-856"><a href="#cb28-856" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb28-857"><a href="#cb28-857" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb28-858"><a href="#cb28-858" aria-hidden="true" tabindex="-1"></a><span class="in">    beta_samples[i] &lt;- beta</span></span>
<span id="cb28-859"><a href="#cb28-859" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb28-860"><a href="#cb28-860" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-861"><a href="#cb28-861" aria-hidden="true" tabindex="-1"></a><span class="in">  cat("Acceptance rate:", accept_count / (n_iter - burn_in), "\n")</span></span>
<span id="cb28-862"><a href="#cb28-862" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-863"><a href="#cb28-863" aria-hidden="true" tabindex="-1"></a><span class="in">  list(beta = beta_samples[-(1:burn_in)])</span></span>
<span id="cb28-864"><a href="#cb28-864" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb28-865"><a href="#cb28-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-866"><a href="#cb28-866" aria-hidden="true" tabindex="-1"></a><span class="in"># Run sampler</span></span>
<span id="cb28-867"><a href="#cb28-867" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(789)</span></span>
<span id="cb28-868"><a href="#cb28-868" aria-hidden="true" tabindex="-1"></a><span class="in">logistic_gibbs_results &lt;- mh_logistic(y_log, x_log, n_iter = 11000, burn_in = 1000)</span></span>
<span id="cb28-869"><a href="#cb28-869" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-870"><a href="#cb28-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-871"><a href="#cb28-871" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Trace Plot and Summary</span></span>
<span id="cb28-872"><a href="#cb28-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-873"><a href="#cb28-873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logistic_trace, fig.width=10, fig.height=4}</span></span>
<span id="cb28-874"><a href="#cb28-874" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 2))</span></span>
<span id="cb28-875"><a href="#cb28-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-876"><a href="#cb28-876" aria-hidden="true" tabindex="-1"></a><span class="in">plot(logistic_gibbs_results$beta, type = 'l', main = 'Trace Plot for β',</span></span>
<span id="cb28-877"><a href="#cb28-877" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab = 'Iteration', ylab = 'β')</span></span>
<span id="cb28-878"><a href="#cb28-878" aria-hidden="true" tabindex="-1"></a><span class="in">abline(h = beta_hat_log, col = 'red', lty = 2)</span></span>
<span id="cb28-879"><a href="#cb28-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-880"><a href="#cb28-880" aria-hidden="true" tabindex="-1"></a><span class="in">plot(density(logistic_gibbs_results$beta), main = 'Posterior Density for β',</span></span>
<span id="cb28-881"><a href="#cb28-881" aria-hidden="true" tabindex="-1"></a><span class="in">     xlab = 'β', ylab = 'Density', xlim = c(0, 3))</span></span>
<span id="cb28-882"><a href="#cb28-882" aria-hidden="true" tabindex="-1"></a><span class="in">abline(v = beta_hat_log, col = 'red', lty = 2)</span></span>
<span id="cb28-883"><a href="#cb28-883" aria-hidden="true" tabindex="-1"></a><span class="in">abline(v = true_beta, col = 'blue', lty = 2)</span></span>
<span id="cb28-884"><a href="#cb28-884" aria-hidden="true" tabindex="-1"></a><span class="in">legend('topright', c('MLE', 'True β'), col = c('red', 'blue'), lty = 2)</span></span>
<span id="cb28-885"><a href="#cb28-885" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-886"><a href="#cb28-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-887"><a href="#cb28-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logistic_summary}</span></span>
<span id="cb28-888"><a href="#cb28-888" aria-hidden="true" tabindex="-1"></a><span class="in"># Create summary table</span></span>
<span id="cb28-889"><a href="#cb28-889" aria-hidden="true" tabindex="-1"></a><span class="in">logistic_gibbs_summary &lt;- data.frame(</span></span>
<span id="cb28-890"><a href="#cb28-890" aria-hidden="true" tabindex="-1"></a><span class="in">  Statistic = c("Mean", "Median", "SD", "95% CI"),</span></span>
<span id="cb28-891"><a href="#cb28-891" aria-hidden="true" tabindex="-1"></a><span class="in">  Value = c(</span></span>
<span id="cb28-892"><a href="#cb28-892" aria-hidden="true" tabindex="-1"></a><span class="in">    round(mean(logistic_gibbs_results$beta), 4),</span></span>
<span id="cb28-893"><a href="#cb28-893" aria-hidden="true" tabindex="-1"></a><span class="in">    round(median(logistic_gibbs_results$beta), 4),</span></span>
<span id="cb28-894"><a href="#cb28-894" aria-hidden="true" tabindex="-1"></a><span class="in">    round(sd(logistic_gibbs_results$beta), 4),</span></span>
<span id="cb28-895"><a href="#cb28-895" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("(", round(quantile(logistic_gibbs_results$beta, 0.025), 4), ", ",</span></span>
<span id="cb28-896"><a href="#cb28-896" aria-hidden="true" tabindex="-1"></a><span class="in">           round(quantile(logistic_gibbs_results$beta, 0.975), 4), ")")</span></span>
<span id="cb28-897"><a href="#cb28-897" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb28-898"><a href="#cb28-898" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-899"><a href="#cb28-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-900"><a href="#cb28-900" aria-hidden="true" tabindex="-1"></a><span class="in">kable(logistic_gibbs_summary, caption = "Posterior Summary for β (Logistic Regression)", align = 'lr') %&gt;%</span></span>
<span id="cb28-901"><a href="#cb28-901" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-902"><a href="#cb28-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-903"><a href="#cb28-903" aria-hidden="true" tabindex="-1"></a><span class="in"># Comparison table</span></span>
<span id="cb28-904"><a href="#cb28-904" aria-hidden="true" tabindex="-1"></a><span class="in">comparison_log_methods &lt;- data.frame(</span></span>
<span id="cb28-905"><a href="#cb28-905" aria-hidden="true" tabindex="-1"></a><span class="in">  Method = c("True β", "MLE", "Posterior Mean"),</span></span>
<span id="cb28-906"><a href="#cb28-906" aria-hidden="true" tabindex="-1"></a><span class="in">  Value = c(round(true_beta, 4), round(beta_hat_log, 4), round(mean(logistic_gibbs_results$beta), 4))</span></span>
<span id="cb28-907"><a href="#cb28-907" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-908"><a href="#cb28-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-909"><a href="#cb28-909" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison_log_methods, caption = "Comparison: True vs Frequentist vs Bayesian", align = 'lr') %&gt;%</span></span>
<span id="cb28-910"><a href="#cb28-910" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-911"><a href="#cb28-911" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-912"><a href="#cb28-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-913"><a href="#cb28-913" aria-hidden="true" tabindex="-1"></a><span class="fu">### Comparison with brms</span></span>
<span id="cb28-914"><a href="#cb28-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-915"><a href="#cb28-915" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logistic_brms, results='hide', message=FALSE, warning=FALSE}</span></span>
<span id="cb28-916"><a href="#cb28-916" aria-hidden="true" tabindex="-1"></a><span class="in"># Fit with brms</span></span>
<span id="cb28-917"><a href="#cb28-917" aria-hidden="true" tabindex="-1"></a><span class="in">logistic_brms &lt;- brm(y ~ 0 + x, </span></span>
<span id="cb28-918"><a href="#cb28-918" aria-hidden="true" tabindex="-1"></a><span class="in">                     data = logistic_data,</span></span>
<span id="cb28-919"><a href="#cb28-919" aria-hidden="true" tabindex="-1"></a><span class="in">                     family = bernoulli(link = "logit"),</span></span>
<span id="cb28-920"><a href="#cb28-920" aria-hidden="true" tabindex="-1"></a><span class="in">                     prior = prior(normal(0, 10), class = "b"),</span></span>
<span id="cb28-921"><a href="#cb28-921" aria-hidden="true" tabindex="-1"></a><span class="in">                     chains = 4,</span></span>
<span id="cb28-922"><a href="#cb28-922" aria-hidden="true" tabindex="-1"></a><span class="in">                     iter = 2000,</span></span>
<span id="cb28-923"><a href="#cb28-923" aria-hidden="true" tabindex="-1"></a><span class="in">                     warmup = 1000,</span></span>
<span id="cb28-924"><a href="#cb28-924" aria-hidden="true" tabindex="-1"></a><span class="in">                     seed = 789,</span></span>
<span id="cb28-925"><a href="#cb28-925" aria-hidden="true" tabindex="-1"></a><span class="in">                     refresh = 0)</span></span>
<span id="cb28-926"><a href="#cb28-926" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-927"><a href="#cb28-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-928"><a href="#cb28-928" aria-hidden="true" tabindex="-1"></a><span class="in">```{r logistic_brms_summary}</span></span>
<span id="cb28-929"><a href="#cb28-929" aria-hidden="true" tabindex="-1"></a><span class="in">summary(logistic_brms)</span></span>
<span id="cb28-930"><a href="#cb28-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-931"><a href="#cb28-931" aria-hidden="true" tabindex="-1"></a><span class="in"># Create comparison table</span></span>
<span id="cb28-932"><a href="#cb28-932" aria-hidden="true" tabindex="-1"></a><span class="in">comparison_log_gibbs_brms &lt;- data.frame(</span></span>
<span id="cb28-933"><a href="#cb28-933" aria-hidden="true" tabindex="-1"></a><span class="in">  Method = c("Manual M-H", "brms"),</span></span>
<span id="cb28-934"><a href="#cb28-934" aria-hidden="true" tabindex="-1"></a><span class="in">  `β (Mean)` = c(round(mean(logistic_gibbs_results$beta), 4), round(fixef(logistic_brms)[1, 1], 4)),</span></span>
<span id="cb28-935"><a href="#cb28-935" aria-hidden="true" tabindex="-1"></a><span class="in">  `β (SD)` = c(round(sd(logistic_gibbs_results$beta), 4), round(fixef(logistic_brms)[1, 2], 4)),</span></span>
<span id="cb28-936"><a href="#cb28-936" aria-hidden="true" tabindex="-1"></a><span class="in">  check.names = FALSE</span></span>
<span id="cb28-937"><a href="#cb28-937" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-938"><a href="#cb28-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-939"><a href="#cb28-939" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison_log_gibbs_brms, caption = "Comparison: Manual Metropolis-Hastings vs brms", align = 'lrr') %&gt;%</span></span>
<span id="cb28-940"><a href="#cb28-940" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-941"><a href="#cb28-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-942"><a href="#cb28-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-943"><a href="#cb28-943" aria-hidden="true" tabindex="-1"></a><span class="fu">### Probit Regression via Auxiliary Variables</span></span>
<span id="cb28-944"><a href="#cb28-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-945"><a href="#cb28-945" aria-hidden="true" tabindex="-1"></a>An alternative to logistic regression is probit regression, which uses the cumulative normal distribution:</span>
<span id="cb28-946"><a href="#cb28-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-947"><a href="#cb28-947" aria-hidden="true" tabindex="-1"></a>$$P(Y_i = 1 | X_i) = \Phi(\beta X_i)$$</span>
<span id="cb28-948"><a href="#cb28-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-949"><a href="#cb28-949" aria-hidden="true" tabindex="-1"></a>where $\Phi$ is the standard normal CDF.</span>
<span id="cb28-950"><a href="#cb28-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-951"><a href="#cb28-951" aria-hidden="true" tabindex="-1"></a>The auxiliary variable approach, developed by Albert &amp; Chib (1993), introduces latent variables $Z_i \sim N(\beta X_i, 1)$ where:</span>
<span id="cb28-952"><a href="#cb28-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-953"><a href="#cb28-953" aria-hidden="true" tabindex="-1"></a>$$Y_i = \begin{cases} 1 &amp; \text{if } Z_i &gt; 0 <span class="sc">\\</span> 0 &amp; \text{if } Z_i \leq 0 \end{cases}$$</span>
<span id="cb28-954"><a href="#cb28-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-955"><a href="#cb28-955" aria-hidden="true" tabindex="-1"></a>This formulation allows for straightforward Gibbs sampling:</span>
<span id="cb28-956"><a href="#cb28-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-957"><a href="#cb28-957" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Sample $\beta | \mathbf{Z} \sim N(\mu_n, \sigma_n^2)$ (normal-normal conjugacy)</span>
<span id="cb28-958"><a href="#cb28-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-959"><a href="#cb28-959" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Sample $Z_i | \beta, Y_i$ from truncated normal:</span>
<span id="cb28-960"><a href="#cb28-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-961"><a href="#cb28-961" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>If $Y_i = 1$: $Z_i \sim N(\beta X_i, 1)$ truncated to $(0, \infty)$</span>
<span id="cb28-962"><a href="#cb28-962" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb28-963"><a href="#cb28-963" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>If $Y_i = 0$: $Z_i \sim N(\beta X_i, 1)$ truncated to $(-\infty, 0)$</span>
<span id="cb28-964"><a href="#cb28-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-965"><a href="#cb28-965" aria-hidden="true" tabindex="-1"></a>This method is particularly elegant because it converts a complex discrete outcome model into a straightforward continuous data model with truncation. The data augmentation strategy has been widely applied to other generalized linear models.</span>
<span id="cb28-966"><a href="#cb28-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-967"><a href="#cb28-967" aria-hidden="true" tabindex="-1"></a><span class="in">```{r probit_auxiliary}</span></span>
<span id="cb28-968"><a href="#cb28-968" aria-hidden="true" tabindex="-1"></a><span class="in"># Probit regression using auxiliary variables</span></span>
<span id="cb28-969"><a href="#cb28-969" aria-hidden="true" tabindex="-1"></a><span class="in">library(truncnorm)</span></span>
<span id="cb28-970"><a href="#cb28-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-971"><a href="#cb28-971" aria-hidden="true" tabindex="-1"></a><span class="in">probit_gibbs &lt;- function(y, x, n_iter = 10000, burn_in = 1000,</span></span>
<span id="cb28-972"><a href="#cb28-972" aria-hidden="true" tabindex="-1"></a><span class="in">                         mu0 = 0, tau0 = 0.01) {</span></span>
<span id="cb28-973"><a href="#cb28-973" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-974"><a href="#cb28-974" aria-hidden="true" tabindex="-1"></a><span class="in">  n &lt;- length(y)</span></span>
<span id="cb28-975"><a href="#cb28-975" aria-hidden="true" tabindex="-1"></a><span class="in">  beta_samples &lt;- numeric(n_iter)</span></span>
<span id="cb28-976"><a href="#cb28-976" aria-hidden="true" tabindex="-1"></a><span class="in">  z &lt;- rnorm(n)  # Initialize latent variables</span></span>
<span id="cb28-977"><a href="#cb28-977" aria-hidden="true" tabindex="-1"></a><span class="in">  beta &lt;- 0</span></span>
<span id="cb28-978"><a href="#cb28-978" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-979"><a href="#cb28-979" aria-hidden="true" tabindex="-1"></a><span class="in">  sum_x2 &lt;- sum(x^2)</span></span>
<span id="cb28-980"><a href="#cb28-980" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-981"><a href="#cb28-981" aria-hidden="true" tabindex="-1"></a><span class="in">  for (i in 1:n_iter) {</span></span>
<span id="cb28-982"><a href="#cb28-982" aria-hidden="true" tabindex="-1"></a><span class="in">    # Sample Z | beta, y</span></span>
<span id="cb28-983"><a href="#cb28-983" aria-hidden="true" tabindex="-1"></a><span class="in">    mu_z &lt;- beta * x</span></span>
<span id="cb28-984"><a href="#cb28-984" aria-hidden="true" tabindex="-1"></a><span class="in">    for (j in 1:n) {</span></span>
<span id="cb28-985"><a href="#cb28-985" aria-hidden="true" tabindex="-1"></a><span class="in">      if (y[j] == 1) {</span></span>
<span id="cb28-986"><a href="#cb28-986" aria-hidden="true" tabindex="-1"></a><span class="in">        z[j] &lt;- rtruncnorm(1, a = 0, b = Inf, mean = mu_z[j], sd = 1)</span></span>
<span id="cb28-987"><a href="#cb28-987" aria-hidden="true" tabindex="-1"></a><span class="in">      } else {</span></span>
<span id="cb28-988"><a href="#cb28-988" aria-hidden="true" tabindex="-1"></a><span class="in">        z[j] &lt;- rtruncnorm(1, a = -Inf, b = 0, mean = mu_z[j], sd = 1)</span></span>
<span id="cb28-989"><a href="#cb28-989" aria-hidden="true" tabindex="-1"></a><span class="in">      }</span></span>
<span id="cb28-990"><a href="#cb28-990" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb28-991"><a href="#cb28-991" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb28-992"><a href="#cb28-992" aria-hidden="true" tabindex="-1"></a><span class="in">    # Sample beta | Z (normal conjugate)</span></span>
<span id="cb28-993"><a href="#cb28-993" aria-hidden="true" tabindex="-1"></a><span class="in">    tau_n &lt;- sum_x2 + tau0</span></span>
<span id="cb28-994"><a href="#cb28-994" aria-hidden="true" tabindex="-1"></a><span class="in">    mu_n &lt;- (sum(x * z) + tau0 * mu0) / tau_n</span></span>
<span id="cb28-995"><a href="#cb28-995" aria-hidden="true" tabindex="-1"></a><span class="in">    beta &lt;- rnorm(1, mu_n, sqrt(1/tau_n))</span></span>
<span id="cb28-996"><a href="#cb28-996" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb28-997"><a href="#cb28-997" aria-hidden="true" tabindex="-1"></a><span class="in">    beta_samples[i] &lt;- beta</span></span>
<span id="cb28-998"><a href="#cb28-998" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb28-999"><a href="#cb28-999" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb28-1000"><a href="#cb28-1000" aria-hidden="true" tabindex="-1"></a><span class="in">  list(beta = beta_samples[-(1:burn_in)])</span></span>
<span id="cb28-1001"><a href="#cb28-1001" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb28-1002"><a href="#cb28-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1003"><a href="#cb28-1003" aria-hidden="true" tabindex="-1"></a><span class="in"># Run probit sampler</span></span>
<span id="cb28-1004"><a href="#cb28-1004" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(789)</span></span>
<span id="cb28-1005"><a href="#cb28-1005" aria-hidden="true" tabindex="-1"></a><span class="in">probit_results &lt;- probit_gibbs(y_log, x_log, n_iter = 11000, burn_in = 1000)</span></span>
<span id="cb28-1006"><a href="#cb28-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1007"><a href="#cb28-1007" aria-hidden="true" tabindex="-1"></a><span class="in"># Create summary table</span></span>
<span id="cb28-1008"><a href="#cb28-1008" aria-hidden="true" tabindex="-1"></a><span class="in">probit_summary &lt;- data.frame(</span></span>
<span id="cb28-1009"><a href="#cb28-1009" aria-hidden="true" tabindex="-1"></a><span class="in">  Statistic = c("Mean", "SD", "95% CI"),</span></span>
<span id="cb28-1010"><a href="#cb28-1010" aria-hidden="true" tabindex="-1"></a><span class="in">  Value = c(</span></span>
<span id="cb28-1011"><a href="#cb28-1011" aria-hidden="true" tabindex="-1"></a><span class="in">    round(mean(probit_results$beta), 4),</span></span>
<span id="cb28-1012"><a href="#cb28-1012" aria-hidden="true" tabindex="-1"></a><span class="in">    round(sd(probit_results$beta), 4),</span></span>
<span id="cb28-1013"><a href="#cb28-1013" aria-hidden="true" tabindex="-1"></a><span class="in">    paste0("(", round(quantile(probit_results$beta, 0.025), 4), ", ",</span></span>
<span id="cb28-1014"><a href="#cb28-1014" aria-hidden="true" tabindex="-1"></a><span class="in">           round(quantile(probit_results$beta, 0.975), 4), ")")</span></span>
<span id="cb28-1015"><a href="#cb28-1015" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb28-1016"><a href="#cb28-1016" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-1017"><a href="#cb28-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1018"><a href="#cb28-1018" aria-hidden="true" tabindex="-1"></a><span class="in">kable(probit_summary, caption = "Probit Posterior Summary for β", align = 'lr') %&gt;%</span></span>
<span id="cb28-1019"><a href="#cb28-1019" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-1020"><a href="#cb28-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1021"><a href="#cb28-1021" aria-hidden="true" tabindex="-1"></a><span class="in"># Note: Probit coefficients are on a different scale than logit</span></span>
<span id="cb28-1022"><a href="#cb28-1022" aria-hidden="true" tabindex="-1"></a><span class="in"># Approximately: beta_logit ≈ 1.6 * beta_probit</span></span>
<span id="cb28-1023"><a href="#cb28-1023" aria-hidden="true" tabindex="-1"></a><span class="in">comparison_scales &lt;- data.frame(</span></span>
<span id="cb28-1024"><a href="#cb28-1024" aria-hidden="true" tabindex="-1"></a><span class="in">  Model = c("Logit (MLE)", "Probit × 1.6"),</span></span>
<span id="cb28-1025"><a href="#cb28-1025" aria-hidden="true" tabindex="-1"></a><span class="in">  `β estimate` = c(round(beta_hat_log, 4), round(mean(probit_results$beta) * 1.6, 4)),</span></span>
<span id="cb28-1026"><a href="#cb28-1026" aria-hidden="true" tabindex="-1"></a><span class="in">  check.names = FALSE</span></span>
<span id="cb28-1027"><a href="#cb28-1027" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb28-1028"><a href="#cb28-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1029"><a href="#cb28-1029" aria-hidden="true" tabindex="-1"></a><span class="in">kable(comparison_scales, caption = "Scale Comparison: Logit vs Probit (approximately)", align = 'lr') %&gt;%</span></span>
<span id="cb28-1030"><a href="#cb28-1030" aria-hidden="true" tabindex="-1"></a><span class="in">  kable_styling(bootstrap_options = c("striped", "hover"))</span></span>
<span id="cb28-1031"><a href="#cb28-1031" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb28-1032"><a href="#cb28-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1033"><a href="#cb28-1033" aria-hidden="true" tabindex="-1"></a><span class="fu"># Summary</span></span>
<span id="cb28-1034"><a href="#cb28-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1035"><a href="#cb28-1035" aria-hidden="true" tabindex="-1"></a>This document has presented foundational concepts in both **Frequentist Estimation** and **Bayesian Inference** approaches to regression modeling:</span>
<span id="cb28-1036"><a href="#cb28-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1037"><a href="#cb28-1037" aria-hidden="true" tabindex="-1"></a>**Linear Regression:**</span>
<span id="cb28-1038"><a href="#cb28-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1039"><a href="#cb28-1039" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Frequentist: Maximum likelihood and least squares produce identical point estimates</span>
<span id="cb28-1040"><a href="#cb28-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1041"><a href="#cb28-1041" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Standard errors can be derived via Fisher information or variance principles</span>
<span id="cb28-1042"><a href="#cb28-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1043"><a href="#cb28-1043" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bayesian: Conditionally conjugate priors enable Gibbs sampling</span>
<span id="cb28-1044"><a href="#cb28-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1045"><a href="#cb28-1045" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>With appropriate priors, closed-form posteriors (t and gamma) are possible</span>
<span id="cb28-1046"><a href="#cb28-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1047"><a href="#cb28-1047" aria-hidden="true" tabindex="-1"></a>**Logistic Regression:**</span>
<span id="cb28-1048"><a href="#cb28-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1049"><a href="#cb28-1049" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Frequentist: Requires numerical optimization (no closed-form MLE)</span>
<span id="cb28-1050"><a href="#cb28-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1051"><a href="#cb28-1051" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bayesian: Metropolis-Hastings handles the non-conjugate posterior</span>
<span id="cb28-1052"><a href="#cb28-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1053"><a href="#cb28-1053" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Probit alternative: Auxiliary variables enable efficient Gibbs sampling</span>
<span id="cb28-1054"><a href="#cb28-1054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1055"><a href="#cb28-1055" aria-hidden="true" tabindex="-1"></a>These simplified models (no intercept) illustrate core principles that extend to more complex regression settings with multiple predictors, interactions, and hierarchical structures.</span>
<span id="cb28-1056"><a href="#cb28-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1057"><a href="#cb28-1057" aria-hidden="true" tabindex="-1"></a><span class="fu">## Why "Frequentist Estimation" vs "Bayesian Inference"?</span></span>
<span id="cb28-1058"><a href="#cb28-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1059"><a href="#cb28-1059" aria-hidden="true" tabindex="-1"></a>The terminology distinction reflects fundamental philosophical and methodological differences:</span>
<span id="cb28-1060"><a href="#cb28-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1061"><a href="#cb28-1061" aria-hidden="true" tabindex="-1"></a>**Frequentist Estimation:**</span>
<span id="cb28-1062"><a href="#cb28-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1063"><a href="#cb28-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**View of parameters:** Parameters are fixed, unknown constants</span>
<span id="cb28-1064"><a href="#cb28-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1065"><a href="#cb28-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Goal:** Estimate the true parameter value from the data</span>
<span id="cb28-1066"><a href="#cb28-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1067"><a href="#cb28-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Uncertainty:** Described through sampling distributions (e.g., "if we repeated this experiment many times and calculate many  confidence intervals, 95% would contain the true parameter")</span>
<span id="cb28-1068"><a href="#cb28-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1069"><a href="#cb28-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Output:** Point estimates with standard errors and confidence intervals</span>
<span id="cb28-1070"><a href="#cb28-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1071"><a href="#cb28-1071" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Interpretation:** "We estimate β = 2.7 with 95% CI (2.1, 3.3)" means the procedure would capture the true value 95% of the time across repeated samples</span>
<span id="cb28-1072"><a href="#cb28-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1073"><a href="#cb28-1073" aria-hidden="true" tabindex="-1"></a>**Bayesian Inference:**</span>
<span id="cb28-1074"><a href="#cb28-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1075"><a href="#cb28-1075" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**View of parameters:** Parameters are random variables with probability distributions</span>
<span id="cb28-1076"><a href="#cb28-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1077"><a href="#cb28-1077" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Goal:** Update our beliefs about parameters using data (prior → posterior)</span>
<span id="cb28-1078"><a href="#cb28-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1079"><a href="#cb28-1079" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Uncertainty:** Described through probability distributions directly on parameters</span>
<span id="cb28-1080"><a href="#cb28-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1081"><a href="#cb28-1081" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Output:** Full posterior distributions, summarized with credible intervals</span>
<span id="cb28-1082"><a href="#cb28-1082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1083"><a href="#cb28-1083" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Interpretation:** "P(2.1 &lt; β &lt; 3.3 | data) = 0.95" means there's a 95% probability that β lies in this interval given the observed data</span>
<span id="cb28-1084"><a href="#cb28-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1085"><a href="#cb28-1085" aria-hidden="true" tabindex="-1"></a>The distinction matters because:</span>
<span id="cb28-1086"><a href="#cb28-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1087"><a href="#cb28-1087" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Bayesians don't "estimate" a fixed value—they make probabilistic statements about parameters</span>
<span id="cb28-1088"><a href="#cb28-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1089"><a href="#cb28-1089" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The interpretation of uncertainty differs fundamentally between approaches</span>
<span id="cb28-1090"><a href="#cb28-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1091"><a href="#cb28-1091" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each framework has its own logic for inference, prediction, and decision-making</span>
<span id="cb28-1092"><a href="#cb28-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1093"><a href="#cb28-1093" aria-hidden="true" tabindex="-1"></a>Understanding both perspectives enriches your statistical toolkit and helps you communicate appropriately with different audiences.</span>
<span id="cb28-1094"><a href="#cb28-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1095"><a href="#cb28-1095" aria-hidden="true" tabindex="-1"></a><span class="fu"># References</span></span>
<span id="cb28-1096"><a href="#cb28-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1097"><a href="#cb28-1097" aria-hidden="true" tabindex="-1"></a>**Bayesian Inference and MCMC:**</span>
<span id="cb28-1098"><a href="#cb28-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1099"><a href="#cb28-1099" aria-hidden="true" tabindex="-1"></a>Albert, J. H., &amp; Chib, S. (1993). Bayesian analysis of binary and polychotomous response data. *Journal of the American Statistical Association*, 88(422), 669-679.</span>
<span id="cb28-1100"><a href="#cb28-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1101"><a href="#cb28-1101" aria-hidden="true" tabindex="-1"></a>Chib, S., &amp; Greenberg, E. (1995). Understanding the Metropolis-Hastings algorithm. *The American Statistician*, 49(4), 327-335.</span>
<span id="cb28-1102"><a href="#cb28-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1103"><a href="#cb28-1103" aria-hidden="true" tabindex="-1"></a>Gelman, A., Carlin, J. B., Stern, H. S., Dunson, D. B., Vehtari, A., &amp; Rubin, D. B. (2013). *Bayesian Data Analysis* (3rd ed.). Chapman and Hall/CRC.</span>
<span id="cb28-1104"><a href="#cb28-1104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1105"><a href="#cb28-1105" aria-hidden="true" tabindex="-1"></a>Robert, C. P., &amp; Casella, G. (2011). A short history of Markov Chain Monte Carlo: Subjective recollections from incomplete data. *Statistical Science*, 26(1), 102-115.</span>
<span id="cb28-1106"><a href="#cb28-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1107"><a href="#cb28-1107" aria-hidden="true" tabindex="-1"></a>**Software:**</span>
<span id="cb28-1108"><a href="#cb28-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1109"><a href="#cb28-1109" aria-hidden="true" tabindex="-1"></a>Bürkner, P. C. (2017). brms: An R package for Bayesian multilevel models using Stan. *Journal of Statistical Software*, 80(1), 1-28.</span>
<span id="cb28-1110"><a href="#cb28-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-1111"><a href="#cb28-1111" aria-hidden="true" tabindex="-1"></a>**Note:** A full course on Bayesian regression methods would allow deeper exploration of these topics, including more complex models, prior specification strategies, model comparison, and advanced MCMC diagnostics. The material presented here serves as an introduction.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024-2026, James C Slaughter</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chrissl789/modern-regression/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>