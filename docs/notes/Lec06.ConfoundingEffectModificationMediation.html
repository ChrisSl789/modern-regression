<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chris Slaughter">
<meta name="dcterms.date" content="2024-10-07">

<title>Confouding, Effect Modification, and Mediation – BIOS 6312 - Spring 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notes/Lec07.MultivariableModels.html" rel="next">
<link href="../notes/Lec05.Precision.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Confouding, Effect Modification, and Mediation – BIOS 6312 - Spring 2025">
<meta property="og:description" content="Lecture 06">
<meta property="og:site_name" content="BIOS 6312 - Spring 2025">
</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/Lec02.review.html">Course Notes</a></li><li class="breadcrumb-item"><a href="../notes/Lec06.ConfoundingEffectModificationMediation.html">Confouding, Effect Modification, and Mediation</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">BIOS 6312 - Spring 2025</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/Lec01.Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introductory Slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus BIOS 6312</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../officehours.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Office Hours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec02.review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Review of Key Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec03.SimpleLinearRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec04.Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec05.Precision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Precision of Statistical Intefence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec06.ConfoundingEffectModificationMediation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Confouding, Effect Modification, and Mediation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec07.MultivariableModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariable Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set2.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set6.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weighted Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec08.Survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec09.Poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec10.Modeling.Effect.Modification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Effect Modification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set8.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial and Ordinal Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec11.DoseResponse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flexible Modeling of Continuous Predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec12.ANOVA.Model.Choice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA and Model Choice</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec13.Prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Based Prediction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set13.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Missing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set14.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Bootstrap</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/quarto-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab1-linearregression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Linear regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab2-linearassumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2: Assumption in Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab3-logistic-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3: Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab4-precision-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Precision and adjustment for baseline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab5-multivariable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 5: Multivariable Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab6-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 6: Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab7-effectmodification-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 7: Poisson Regression and Effect Modification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab-DiscreteOutcomeRegression.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 8: Discrete Outcomes Lab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://vanderbilt.box.com/s/rpftvmc9vua2w3gz3jy16phlnsojs6on" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Box folder with .qmd files</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Supplemental notes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/slr-derivations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SLR derivations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/model-diagnostics-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/mlr-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MLR matrix notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/log-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Log transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/model-selection-criteria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model selection criteria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/ReviewMatrixAlgebra.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix algebra review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/Baseline_Change_MACH.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Change from baseline and precision</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Statcomp2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Main directory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/lectures/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lectures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/lectures/data" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#effect-modification" id="toc-effect-modification" class="nav-link" data-scroll-target="#effect-modification"><span class="header-section-number">2</span> Effect Modification</a>
  <ul>
  <li><a href="#effect-modification-depends-on-the-measure-of-effect-that-you-choose" id="toc-effect-modification-depends-on-the-measure-of-effect-that-you-choose" class="nav-link" data-scroll-target="#effect-modification-depends-on-the-measure-of-effect-that-you-choose"><span class="header-section-number">2.1</span> Effect modification depends on the measure of effect that you choose</a></li>
  <li><a href="#examples-of-effect-modification" id="toc-examples-of-effect-modification" class="nav-link" data-scroll-target="#examples-of-effect-modification"><span class="header-section-number">2.2</span> Examples of Effect Modification</a>
  <ul class="collapse">
  <li><a href="#example-1-is-serum-ldl-by-smoking-modified-by-gender" id="toc-example-1-is-serum-ldl-by-smoking-modified-by-gender" class="nav-link" data-scroll-target="#example-1-is-serum-ldl-by-smoking-modified-by-gender"><span class="header-section-number">2.2.1</span> Example 1: Is serum LDL by smoking modified by gender?</a></li>
  <li><a href="#example-2-creatinine-by-stroke-modified-by-gender" id="toc-example-2-creatinine-by-stroke-modified-by-gender" class="nav-link" data-scroll-target="#example-2-creatinine-by-stroke-modified-by-gender"><span class="header-section-number">2.2.2</span> Example 2: Creatinine by stroke (modified by gender?)</a></li>
  <li><a href="#example-3-stroke-by-smoking-modified-by-gender" id="toc-example-3-stroke-by-smoking-modified-by-gender" class="nav-link" data-scroll-target="#example-3-stroke-by-smoking-modified-by-gender"><span class="header-section-number">2.2.3</span> Example 3: Stroke by smoking (modified by gender?)</a></li>
  <li><a href="#example-4-stroke-by-smoking-modified-by-cvd" id="toc-example-4-stroke-by-smoking-modified-by-cvd" class="nav-link" data-scroll-target="#example-4-stroke-by-smoking-modified-by-cvd"><span class="header-section-number">2.2.4</span> Example 4: Stroke by smoking (modified by CVD?)</a></li>
  <li><a href="#example-5-chd-by-current-smoking-modified-by-gender" id="toc-example-5-chd-by-current-smoking-modified-by-gender" class="nav-link" data-scroll-target="#example-5-chd-by-current-smoking-modified-by-gender"><span class="header-section-number">2.2.5</span> Example 5: CHD by current smoking (modified by gender?)</a></li>
  <li><a href="#example-6-chd-by-ever-smoke-modified-by-gender" id="toc-example-6-chd-by-ever-smoke-modified-by-gender" class="nav-link" data-scroll-target="#example-6-chd-by-ever-smoke-modified-by-gender"><span class="header-section-number">2.2.6</span> Example 6: CHD by ever smoke (modified by gender?)</a></li>
  <li><a href="#summary-comments-on-examples" id="toc-summary-comments-on-examples" class="nav-link" data-scroll-target="#summary-comments-on-examples"><span class="header-section-number">2.2.7</span> Summary comments on examples</a></li>
  </ul></li>
  <li><a href="#analysis-of-effect-modification" id="toc-analysis-of-effect-modification" class="nav-link" data-scroll-target="#analysis-of-effect-modification"><span class="header-section-number">2.3</span> Analysis of Effect Modification</a></li>
  </ul></li>
  <li><a href="#confounding" id="toc-confounding" class="nav-link" data-scroll-target="#confounding"><span class="header-section-number">3</span> Confounding</a>
  <ul>
  <li><a href="#simpsons-paradox" id="toc-simpsons-paradox" class="nav-link" data-scroll-target="#simpsons-paradox"><span class="header-section-number">3.1</span> Simpson’s Paradox</a>
  <ul class="collapse">
  <li><a href="#example-probability-of-death-y-at-two-hospitals-x-stratified-by-poor-patient-condition-z" id="toc-example-probability-of-death-y-at-two-hospitals-x-stratified-by-poor-patient-condition-z" class="nav-link" data-scroll-target="#example-probability-of-death-y-at-two-hospitals-x-stratified-by-poor-patient-condition-z"><span class="header-section-number">3.1.1</span> Example: Probability of death (Y) at two hospitals (X) stratified by poor patient condition (Z)</a></li>
  </ul></li>
  <li><a href="#definition-of-confounding" id="toc-definition-of-confounding" class="nav-link" data-scroll-target="#definition-of-confounding"><span class="header-section-number">3.2</span> Definition of Confounding</a>
  <ul class="collapse">
  <li><a href="#directed-acyclyic-graph" id="toc-directed-acyclyic-graph" class="nav-link" data-scroll-target="#directed-acyclyic-graph"><span class="header-section-number">3.2.1</span> Directed Acyclyic Graph</a></li>
  <li><a href="#causal-pathways" id="toc-causal-pathways" class="nav-link" data-scroll-target="#causal-pathways"><span class="header-section-number">3.2.2</span> Causal pathways</a></li>
  </ul></li>
  <li><a href="#diagnosing-confounding" id="toc-diagnosing-confounding" class="nav-link" data-scroll-target="#diagnosing-confounding"><span class="header-section-number">3.3</span> Diagnosing Confounding</a></li>
  </ul></li>
  <li><a href="#mediating-variables" id="toc-mediating-variables" class="nav-link" data-scroll-target="#mediating-variables"><span class="header-section-number">4</span> Mediating variables</a></li>
  <li><a href="#precision-variables" id="toc-precision-variables" class="nav-link" data-scroll-target="#precision-variables"><span class="header-section-number">5</span> Precision Variables</a>
  <ul>
  <li><a href="#overview-1" id="toc-overview-1" class="nav-link" data-scroll-target="#overview-1"><span class="header-section-number">5.1</span> Overview</a></li>
  <li><a href="#adjusting-for-precision-variables" id="toc-adjusting-for-precision-variables" class="nav-link" data-scroll-target="#adjusting-for-precision-variables"><span class="header-section-number">5.2</span> Adjusting for Precision Variables</a>
  <ul class="collapse">
  <li><a href="#precision-for-difference-of-independent-means" id="toc-precision-for-difference-of-independent-means" class="nav-link" data-scroll-target="#precision-for-difference-of-independent-means"><span class="header-section-number">5.2.1</span> Precision for Difference of Independent Means</a></li>
  <li><a href="#precision-for-linear-regression" id="toc-precision-for-linear-regression" class="nav-link" data-scroll-target="#precision-for-linear-regression"><span class="header-section-number">5.2.2</span> Precision for Linear Regression</a></li>
  <li><a href="#precision-for-difference-of-proportions" id="toc-precision-for-difference-of-proportions" class="nav-link" data-scroll-target="#precision-for-difference-of-proportions"><span class="header-section-number">5.2.3</span> Precision for Difference of Proportions</a></li>
  <li><a href="#precision-for-odds" id="toc-precision-for-odds" class="nav-link" data-scroll-target="#precision-for-odds"><span class="header-section-number">5.2.4</span> Precision for Odds</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#diagnosing-confounding-1" id="toc-diagnosing-confounding-1" class="nav-link" data-scroll-target="#diagnosing-confounding-1"><span class="header-section-number">6</span> Diagnosing Confounding</a>
  <ul>
  <li><a href="#adjustment-for-covariates" id="toc-adjustment-for-covariates" class="nav-link" data-scroll-target="#adjustment-for-covariates"><span class="header-section-number">6.1</span> Adjustment for Covariates</a></li>
  <li><a href="#confounder-detection" id="toc-confounder-detection" class="nav-link" data-scroll-target="#confounder-detection"><span class="header-section-number">6.2</span> Confounder Detection</a></li>
  </ul></li>
  <li><a href="#graphical-methods-for-visualizing-effect-modification-confounding-and-precision" id="toc-graphical-methods-for-visualizing-effect-modification-confounding-and-precision" class="nav-link" data-scroll-target="#graphical-methods-for-visualizing-effect-modification-confounding-and-precision"><span class="header-section-number">7</span> Graphical Methods for Visualizing Effect Modification, Confounding, and Precision</a>
  <ul>
  <li><a href="#effect-modifiers" id="toc-effect-modifiers" class="nav-link" data-scroll-target="#effect-modifiers"><span class="header-section-number">7.1</span> Effect Modifiers</a></li>
  <li><a href="#confounders" id="toc-confounders" class="nav-link" data-scroll-target="#confounders"><span class="header-section-number">7.2</span> Confounders</a></li>
  <li><a href="#precision-variables-1" id="toc-precision-variables-1" class="nav-link" data-scroll-target="#precision-variables-1"><span class="header-section-number">7.3</span> Precision Variables</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chrissl789/modern-regression/edit/main/notes/Lec06.ConfoundingEffectModificationMediation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chrissl789/modern-regression/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header">

<div class="right">
<!--
<a href="https://github.com/chrissl789/modern-regression/raw/main/Lec06.ConfoundingEffectModificationMediation.qmd" target="_blank">View Code</a>
-->
<a href="https://statcomp2.app.vumc.org/modern-regression/lectures/Lec06.ConfoundingEffectModificationMediation.qmd" target="_blank">Download Code</a>

</div>

<div class="quarto-title-block d-none d-lg-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/Lec02.review.html">Course Notes</a></li><li class="breadcrumb-item"><a href="../notes/Lec06.ConfoundingEffectModificationMediation.html">Confouding, Effect Modification, and Mediation</a></li></ol></nav><div><h1 class="title">Confouding, Effect Modification, and Mediation</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Lecture 06</p>
<p class="author">Chris Slaughter</p>

<p class="date">October 7, 2024</p>

</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="fu">source</span>(<span class="st">'pander_registry.R'</span>), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">invisible</span>(e))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<ul>
<li><p>Most often scientific questions are translated into comparing the distribution of some response variable across groups of interest</p></li>
<li><p>Groups are defined by the predictor of interest (POI). Regression methods allow for either categorical or continuous predictors of interest</p>
<ul>
<li><p>Categorical predictors of interest: Treatment or control, knockout or</p>
<p>wild type, ethnic group</p></li>
<li><p>Continuous predictors of interest: Age, BMI, cholesterol, blood pressure</p></li>
</ul></li>
<li><p>Often we need to consider additional variables other than the predictor of interest to answer our scientific question</p></li>
<li><p>Covariates other than the predictor of of interest are included in the regression model as</p>
<ul>
<li><p>Effect modifiers</p></li>
<li><p>Confounders</p></li>
<li><p>Mediating variables</p></li>
<li><p>Precision variables</p></li>
<li><p>(Not necessarily mutually exclusive)</p></li>
</ul></li>
</ul>
</section>
<section id="effect-modification" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="effect-modification"><span class="header-section-number">2</span> Effect Modification</h2>
<ul>
<li><p>The association between the Response and the Predictor of Interest differs in strata defined by the effect modifier</p></li>
<li><p>Statistical term: “Interaction” between the effect modifier and the POI</p></li>
</ul>
<section id="effect-modification-depends-on-the-measure-of-effect-that-you-choose" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="effect-modification-depends-on-the-measure-of-effect-that-you-choose"><span class="header-section-number">2.1</span> Effect modification depends on the measure of effect that you choose</h3>
<ul>
<li><p>Choice of summary measure: mean, median, geometric mean, odds, hazard</p></li>
<li><p>Choice of comparisons across groups: differences, ratios</p></li>
</ul>
</section>
<section id="examples-of-effect-modification" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="examples-of-effect-modification"><span class="header-section-number">2.2</span> Examples of Effect Modification</h3>
<section id="example-1-is-serum-ldl-by-smoking-modified-by-gender" class="level4" data-number="2.2.1">
<h4 data-number="2.2.1" class="anchored" data-anchor-id="example-1-is-serum-ldl-by-smoking-modified-by-gender"><span class="header-section-number">2.2.1</span> Example 1: Is serum LDL by smoking modified by gender?</h4>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td>Mean</td>
<td>Mean</td>
<td>Median</td>
<td>Median</td>
</tr>
<tr class="even">
<td></td>
<td>Women</td>
<td>Men</td>
<td>Women</td>
<td>Men</td>
</tr>
<tr class="odd">
<td>No Smoke</td>
<td>120</td>
<td>122</td>
<td>120</td>
<td>115</td>
</tr>
<tr class="even">
<td>Smoke</td>
<td>133</td>
<td>122</td>
<td>133</td>
<td>124</td>
</tr>
<tr class="odd">
<td>Diff</td>
<td>-13</td>
<td>0</td>
<td>-13</td>
<td>-9</td>
</tr>
<tr class="even">
<td>Ratio</td>
<td>0.90</td>
<td>1</td>
<td>0.90</td>
<td>0.93</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Effect modification by gender exists if the effect of smoking in males is different from the effect of smoking in females</p>
<ul>
<li>Compare the diff (or ratio) for the mean (or median) in women to the diff (or ratio) for the mean (or median) in men</li>
</ul></li>
<li><p>Effect modification for mean, not as much for median</p>
<ul>
<li>Statement holds for both difference or ratio of mean/median</li>
</ul></li>
</ul>
</section>
<section id="example-2-creatinine-by-stroke-modified-by-gender" class="level4" data-number="2.2.2">
<h4 data-number="2.2.2" class="anchored" data-anchor-id="example-2-creatinine-by-stroke-modified-by-gender"><span class="header-section-number">2.2.2</span> Example 2: Creatinine by stroke (modified by gender?)</h4>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td>Mean</td>
<td>Mean</td>
<td>Median</td>
<td>Median</td>
</tr>
<tr class="even">
<td></td>
<td>Women</td>
<td>Men</td>
<td>Women</td>
<td>Men</td>
</tr>
<tr class="odd">
<td>No Stroke</td>
<td>0.72</td>
<td>1.08</td>
<td>0.7</td>
<td>1.1</td>
</tr>
<tr class="even">
<td>Stroke</td>
<td>1.01</td>
<td>1.51</td>
<td>1.0</td>
<td>1.5</td>
</tr>
<tr class="odd">
<td>Diff</td>
<td>-0.29</td>
<td>-0.43</td>
<td>-0.3</td>
<td>-0.4</td>
</tr>
<tr class="even">
<td>Ratio</td>
<td>0.71</td>
<td>0.72</td>
<td>0.70</td>
<td>0.73</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Effect modification for difference, not really for ratio</p>
<ul>
<li>True for Mean or median</li>
</ul></li>
</ul>
</section>
<section id="example-3-stroke-by-smoking-modified-by-gender" class="level4" data-number="2.2.3">
<h4 data-number="2.2.3" class="anchored" data-anchor-id="example-3-stroke-by-smoking-modified-by-gender"><span class="header-section-number">2.2.3</span> Example 3: Stroke by smoking (modified by gender?)</h4>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td>Proportion</td>
<td>Proportion</td>
<td>Odds</td>
<td>Odds</td>
</tr>
<tr class="even">
<td></td>
<td>Women</td>
<td>Men</td>
<td>Women</td>
<td>Men</td>
</tr>
<tr class="odd">
<td>No Smoke</td>
<td>0.10</td>
<td>0.16</td>
<td>0.03</td>
<td>0.19</td>
</tr>
<tr class="even">
<td>Smoke</td>
<td>0.16</td>
<td>0.26</td>
<td>0.19</td>
<td>0.35</td>
</tr>
<tr class="odd">
<td>Diff</td>
<td>-0.06</td>
<td>-0.10</td>
<td>-0.16</td>
<td>-0.16</td>
</tr>
<tr class="even">
<td>Ratio</td>
<td>0.62</td>
<td>0.62</td>
<td>0.16</td>
<td>0.54</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Proportion: No effect modification for ratio, small amount for difference</p></li>
<li><p>Odds: No effect modification for difference, yes for ratio</p></li>
</ul>
</section>
<section id="example-4-stroke-by-smoking-modified-by-cvd" class="level4" data-number="2.2.4">
<h4 data-number="2.2.4" class="anchored" data-anchor-id="example-4-stroke-by-smoking-modified-by-cvd"><span class="header-section-number">2.2.4</span> Example 4: Stroke by smoking (modified by CVD?)</h4>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td>Proportion</td>
<td>Proportion</td>
<td>Odds</td>
<td>Odds</td>
</tr>
<tr class="even">
<td></td>
<td>None</td>
<td>CVD</td>
<td>None</td>
<td>CVD</td>
</tr>
<tr class="odd">
<td>No Smoke</td>
<td>0.02</td>
<td>0.33</td>
<td>0.02</td>
<td>0.50</td>
</tr>
<tr class="even">
<td>Smoke</td>
<td>0.04</td>
<td>0.50</td>
<td>0.04</td>
<td>1.00</td>
</tr>
<tr class="odd">
<td>Diff</td>
<td>-0.02</td>
<td>-0.17</td>
<td>-0.02</td>
<td>-0.50</td>
</tr>
<tr class="even">
<td>Ratio</td>
<td>0.50</td>
<td>0.67</td>
<td>0.50</td>
<td>0.50</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Effect Modficiation?</p>
<ul>
<li><p>Proportion: Yes for ratio, yes for difference</p></li>
<li><p>Odds: Yes for difference, no for ratio</p></li>
</ul></li>
</ul>
</section>
<section id="example-5-chd-by-current-smoking-modified-by-gender" class="level4" data-number="2.2.5">
<h4 data-number="2.2.5" class="anchored" data-anchor-id="example-5-chd-by-current-smoking-modified-by-gender"><span class="header-section-number">2.2.5</span> Example 5: CHD by current smoking (modified by gender?)</h4>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td>Proportion</td>
<td>Proportion</td>
<td>Odds</td>
<td>Odds</td>
</tr>
<tr class="even">
<td></td>
<td>Women</td>
<td>Men</td>
<td>Women</td>
<td>Men</td>
</tr>
<tr class="odd">
<td>No Smoke</td>
<td>0.18</td>
<td>0.26</td>
<td>0.22</td>
<td>0.36</td>
</tr>
<tr class="even">
<td>Smoke</td>
<td>0.05</td>
<td>0.24</td>
<td>0.05</td>
<td>0.32</td>
</tr>
<tr class="odd">
<td>Diff</td>
<td>0.13</td>
<td>0.02</td>
<td>0.17</td>
<td>0.03</td>
</tr>
<tr class="even">
<td>Ratio</td>
<td>3.60</td>
<td>1.08</td>
<td>4.17</td>
<td>1.11</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Effect Modfication?</p>
<ul>
<li><p>Proportion: Yes for ratio, yes for difference</p></li>
<li><p>Odds: Yes for difference, yes for ratio</p></li>
</ul></li>
</ul>
</section>
<section id="example-6-chd-by-ever-smoke-modified-by-gender" class="level4" data-number="2.2.6">
<h4 data-number="2.2.6" class="anchored" data-anchor-id="example-6-chd-by-ever-smoke-modified-by-gender"><span class="header-section-number">2.2.6</span> Example 6: CHD by ever smoke (modified by gender?)</h4>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td>Proportion</td>
<td>Proportion</td>
<td>Odds</td>
<td>Odds</td>
</tr>
<tr class="even">
<td></td>
<td>Women</td>
<td>Men</td>
<td>Women</td>
<td>Men</td>
</tr>
<tr class="odd">
<td>Never Smoke</td>
<td>0.16</td>
<td>0.25</td>
<td>0.19</td>
<td>0.33</td>
</tr>
<tr class="even">
<td>Ever Smoke</td>
<td>0.16</td>
<td>0.26</td>
<td>0.19</td>
<td>0.35</td>
</tr>
<tr class="odd">
<td>Diff</td>
<td>0.00</td>
<td>-0.01</td>
<td>0.00</td>
<td>-0.02</td>
</tr>
<tr class="even">
<td>Ratio</td>
<td>1.00</td>
<td>0.96</td>
<td>1.00</td>
<td>0.95</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Effect Modfication?</p>
<ul>
<li><p>Proportion: No for ratio, no for difference</p></li>
<li><p>Odds: No for difference, no for ratio</p></li>
</ul></li>
</ul>
</section>
<section id="summary-comments-on-examples" class="level4" data-number="2.2.7">
<h4 data-number="2.2.7" class="anchored" data-anchor-id="summary-comments-on-examples"><span class="header-section-number">2.2.7</span> Summary comments on examples</h4>
<ul>
<li><p>If there is an effect, will see effect modification on at least one of the difference and ratio scale</p></li>
<li><p>If there is no effect (example 6), will see no effect modification on both difference and ratio scale</p></li>
<li><p>In real world, will usually see effect modification on both scales. The real question is “Is the effect modification scientifically meaningful?”</p>
<ul>
<li><p>If we find there is important effect modification, science will go forward estimating effects separately</p></li>
<li><p>Models with interaction terms are useful for testing if effect modification is present (statistically)</p></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li><p>Aside: Be careful when comparing two ratios</p>
<ul>
<li><p>How close are two ratios?</p>
<ul>
<li><p>0.20 and 0.25 VERSUS 5.0 and 4.0?</p></li>
<li><p>0.10 and 0.15 VERSUS 10.0 and 6.7?</p></li>
</ul></li>
<li><p>Compare the ratio of ratios, not the difference</p></li>
<li><p>We might consider ratios to be more different when both ratios are <span class="math inline">\(&gt;1\)</span> than when both are <span class="math inline">\(&lt;1\)</span>. But, that would be wrong.</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="analysis-of-effect-modification" class="level3" data-number="2.3">
<h3 data-number="2.3" class="anchored" data-anchor-id="analysis-of-effect-modification"><span class="header-section-number">2.3</span> Analysis of Effect Modification</h3>
<ul>
<li><p>When the scientific question involves effect modification</p>
<ul>
<li><p>Conduct analysis within each stratum separately</p></li>
<li><p>If we want to estimate the degree of effect modification or test its existence, use a regression model including</p>
<ul>
<li><p>Predictor of interest (main effect)</p></li>
<li><p>Effect modifying variable (main effect)</p></li>
<li><p>A covariate modeling the interaction (usually a product)</p></li>
</ul></li>
</ul>
<h4 id="impact-of-ignoring-effect-modification" data-number="2.3.1" class="anchored"><span class="header-section-number">2.3.1</span> Impact of ignoring effect modification</h4>
<ul>
<li><p>By design or mistake, we sometimes do not model effect modification</p></li>
<li><p>Might perform</p>
<ul>
<li><p>Unadjusted analysis: POI only</p></li>
<li><p>Adjusted analysis: POI and third variable, but no interaction term</p></li>
</ul></li>
<li><p>If effect modification exists, an unadjusted analysis will give different results according to the association between the POI and effect modifier in the sample</p></li>
</ul></li>
<li><p>If the POI and the effect modifier are not associated</p>
<ul>
<li><p>Unadjusted analysis tends toward an (approximate) weighted average of the stratum specific effects</p>
<ul>
<li><p>With means, exactly a weighted average</p></li>
<li><p>With odds and hazards, an approximate weighted average (because they are non-linear functions of the mean)</p></li>
</ul></li>
</ul></li>
<li><p>If the POI and the effect modifier are associated in the sample</p>
<ul>
<li>The “average” effect is confounded and thus unreliable (variables can be both effect modifiers and confounders)</li>
</ul></li>
<li><p>If effect modification exists, an analysis adjusting only for the third variable (but no interaction) will tend toward a weighted average of the stratum specific effects</p>
<ul>
<li>Hence, an association in one stratum and not the other will make an adjusted analysis look like an association (provide the sample size is large enough)</li>
</ul></li>
</ul>
</section>
</section>
<section id="confounding" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="confounding"><span class="header-section-number">3</span> Confounding</h2>
<section id="simpsons-paradox" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="simpsons-paradox"><span class="header-section-number">3.1</span> Simpson’s Paradox</h3>
<ul>
<li><p>Confounding has its roots in Simpson’s Paradox</p></li>
<li><p>Given binary variables <span class="math inline">\(Y\)</span> (response), <span class="math inline">\(X\)</span> (POI), and <span class="math inline">\(Z\)</span> (strata) it is possible to have …</p></li>
</ul>
<p><span class="math display">\[\textrm{Pr}(Y=1 | X=1, Z=1) &gt; \textrm{Pr}(Y=1 | X=0, Z=1)\]</span> <span class="math display">\[\textrm{Pr}(Y=1 | X=1, Z=0) &gt; \textrm{Pr}(Y=1 | X=0, Z=0)\]</span></p>
<p>… but to also have …</p>
<p><span class="math display">\[\textrm{Pr}(Y=1 | X=1) &lt; \textrm{Pr}(Y=1 | X=0)\]</span></p>
<section id="example-probability-of-death-y-at-two-hospitals-x-stratified-by-poor-patient-condition-z" class="level4" data-number="3.1.1">
<h4 data-number="3.1.1" class="anchored" data-anchor-id="example-probability-of-death-y-at-two-hospitals-x-stratified-by-poor-patient-condition-z"><span class="header-section-number">3.1.1</span> Example: Probability of death (Y) at two hospitals (X) stratified by poor patient condition (Z)</h4>
<ul>
<li>Question: Which hospital do you want to be treated at?
<ul>
<li>Consider the results overall (averaging over Z) and conditional on Z below</li>
</ul></li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Overall</th>
<th>Died</th>
<th>Survived</th>
<th>Death Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hospital A</td>
<td>16</td>
<td>784</td>
<td>2.0%</td>
</tr>
<tr class="even">
<td>Hospital B</td>
<td>63</td>
<td>2037</td>
<td>3.0%</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Good Condition</th>
<th>Died</th>
<th>Survived</th>
<th>Death Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hospital A</td>
<td>8</td>
<td>592</td>
<td>1.3%</td>
</tr>
<tr class="even">
<td>Hospital B</td>
<td>6</td>
<td>594</td>
<td>1.0%</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Poor Condition</th>
<th>Died</th>
<th>Survived</th>
<th>Death Rate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hospital A</td>
<td>8</td>
<td>192</td>
<td>4.0%</td>
</tr>
<tr class="even">
<td>Hospital B</td>
<td>57</td>
<td>1443</td>
<td>3.8%</td>
</tr>
</tbody>
</table>
<ul>
<li><p>Ignoring condition, Hospital B has a <strong>higher</strong> death rather. However, within both poor and good condition, Hospital B has a <strong>lower</strong> death rate.</p>
<ul>
<li>Poor condition is a confounder. Hospital B has more subjects with poor condition and subjects with poor condition have a higher death rate.</li>
</ul></li>
</ul>
</section>
</section>
<section id="definition-of-confounding" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="definition-of-confounding"><span class="header-section-number">3.2</span> Definition of Confounding</h3>
<ul>
<li><p>The association between a predictor of interest and the response is confounded by a third variable if</p>
<ul>
<li><p>The third variable is associated with the predictor of interest in the sample, AND</p></li>
<li><p>The third variable is associated with the response</p>
<ul>
<li><p>Causally (in truth)</p></li>
<li><p>In groups that are homogeneous with respect to the predictor of interest</p></li>
<li><p>Not in the causal pathway of interest</p></li>
</ul></li>
</ul></li>
<li><p>We must consider our belief about the causal relationships among the measured variables</p>
<ul>
<li><p>There is no statistical test for causality</p></li>
<li><p>Inference about causation comes only from the study design</p></li>
<li><p>BUT, consideration of the causal relationships helps us to decide which statistical questions to answer</p></li>
</ul></li>
<li><p>Classic confounder</p>
<ul>
<li>A clear case of confounding occurs when some third variable is a “cause” of both the POI and response</li>
<li>We generally adjust for such a confounder</li>
</ul></li>
</ul>
<section id="directed-acyclyic-graph" class="level4" data-number="3.2.1">
<h4 data-number="3.2.1" class="anchored" data-anchor-id="directed-acyclyic-graph"><span class="header-section-number">3.2.1</span> Directed Acyclyic Graph</h4>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  X[Predictor\nof interest] -- Causal? --&gt; Y[Outcome]
  X[Predictor\nof interest] &lt;-- Association --&gt; Z[Confounder]
  Z[Confounder] -- Causal --&gt; Y[Outcome]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<ul>
<li>Example: Ice cream (POI), murder rate (outcome), and temperature (confounder) in New York City during the summer</li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  X[Ice Cream] -- Causal? --&gt; Y[Murder Rate]
  X[Ice Cream] &lt;-- Association --&gt; Z[Air temperature]
  Z[Air temperature] -- Causal --&gt; Y[Murder Rate]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="causal-pathways" class="level4" data-number="3.2.2">
<h4 data-number="3.2.2" class="anchored" data-anchor-id="causal-pathways"><span class="header-section-number">3.2.2</span> Causal pathways</h4>
<section id="a-variable-in-the-causal-pathway-of-interest" class="level5">
<h5 class="anchored" data-anchor-id="a-variable-in-the-causal-pathway-of-interest">A variable in the causal pathway of interest</h5>
<ul>
<li><p>Not a confounder, so we would not adjust for such a variable</p></li>
<li><p>If we did adjust, we would lose ability to detect associations between the POI and the outcome</p></li>
<li><p>Example: Second hand smoke (POI), stunted growth (confounder), FEV1 (outcome)</p>
<ul>
<li><p>Scientific question is about the impact of smoking on lung function</p>
<ul>
<li>Stunted growth addresses lung anatomy, not lung function, which we don’t care about it</li>
</ul></li>
</ul></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  X[Second hand smoke] --&gt; Y[FEV1]
  X[Second hand smoke] --&gt; Z[Stuntend growth]
  Z[Stunted growth] --&gt; Y[FEV1]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="a-variable-in-the-causal-pathway-not-of-interest" class="level5">
<h5 class="anchored" data-anchor-id="a-variable-in-the-causal-pathway-not-of-interest">A variable in the causal pathway <em>not</em> of interest</h5>
<ul>
<li>However, we want to adjust for a variable in a causal pathway that is not of interest
<ul>
<li>Example: Work stress causing ulcers by hormonal effects versus alcoholism</li>
<li>Directed Acyclyic Graph
<ul>
<li>We can adjust for alcoholism to estimate the path through horomonal effects</li>
<li>Alternatively, we can adjust for hormonal effects to estimate the effect through alcoholism</li>
</ul></li>
</ul></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  X[Work stress] --&gt; W[Hormonal Effects]
  X[Work Stress] --&gt; Z[Alcholism]
  W[Hormonal Effects] --&gt; Y[Ulcers]
  Z[Alcholism] --&gt; Y[Ulcers]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="surrogate-for-response" class="level5">
<h5 class="anchored" data-anchor-id="surrogate-for-response">Surrogate for response</h5>
<ul>
<li><p>Adjustment for a surrogate is a bad idea</p></li>
<li><p>As the name implies, surrogates are a substitute for the response variable</p></li>
<li><p>Directed Acyclyic Graph where forced vital capacity (FVC) is a surrogate for forced exp</p></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  X[Second hand smoke] --&gt; Z[FVC]
  Z[FVC] --&gt; Y[FEV1]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="many-other-complicated-patterns-possible" class="level5">
<h5 class="anchored" data-anchor-id="many-other-complicated-patterns-possible">Many other (complicated) patterns possible</h5>
<ul>
<li>Greenland, Pearl, and Robins. Causal Diagrams for Epidemiologic Research. Epidemiology. (1999) <a href="http://www.jstor.org/stable/3702180" class="uri">http://www.jstor.org/stable/3702180</a></li>
<li><a href="https://www.dagitty.net/" class="uri">https://www.dagitty.net/</a></li>
</ul>
</section>
</section>
</section>
<section id="diagnosing-confounding" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="diagnosing-confounding"><span class="header-section-number">3.3</span> Diagnosing Confounding</h3>
<ul>
<li><p>Confounding typically produces a difference between unadjusted and adjusted analyses</p>
<ul>
<li><p>This symptom is not proof of confounding</p>
<ul>
<li><p>Such a difference can occur when there is no confounding</p></li>
<li><p>Symptom is more indicative of confounding when modeling means (linear regression) than when modeling odds (logistic regression) or hazards (Cox, proportional hazards regression)</p></li>
</ul></li>
</ul></li>
<li><p>Estimates of association from unadjusted analysis are markedly different from estimates of association from adjusted analysis</p>
<ul>
<li>Association within each stratum is similar to each other, but different from the association in the combined data</li>
</ul></li>
<li><p>In linear regression, differences between adjusted and unadjusted analyses are diagnostic of confounding</p>
<ul>
<li><p>Precision variables tend to change standard errors, but not slope estimates</p></li>
<li><p>Effect modification would show differences between adjusted analysis and unadjusted analysis, but would also show different associations in the strata</p></li>
</ul></li>
<li><p>More difficult to diagnosis confounding with non-linear functions of the mean</p>
<ul>
<li><p>Common non-linear functions: Odds (odds ratios), hazards (hazard ratios)</p></li>
<li><p>May show the symptoms of confounding when confounding is not present</p></li>
<li><p>Adjusting for precision variables can appear to be confounding</p></li>
<li><p>In logistic and PH regression, difference between adjusted and unadjusted analyses are more difficult to judge</p>
<ul>
<li>Comparison in more homogeneous groups (i.e.&nbsp;after adjustment for a precision variable) will drive slope estimates away from the null</li>
</ul></li>
</ul></li>
<li><p>Example: Suppose you have a sample where 50% of the subjects die</p>
<ul>
<li><p>What is the variability? <span class="math inline">\(p*(1-p)=0.25\)</span></p></li>
<li><p>We can reduce this variability by changing <span class="math inline">\(p\)</span>, the probability of death</p></li>
<li><p>Estimate <span class="math inline">\(p\)</span> in different stratum. One stratum may have a higher <span class="math inline">\(p\)</span>, another a lower <span class="math inline">\(p\)</span>.</p>
<ul>
<li>e.g.&nbsp;Stratum 1, 20% death rate and Stratum 2 an 80% death rate.</li>
</ul></li>
<li><p>By making the estimate more precise, we have also impacted the mean</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="mediating-variables" class="level2 page-columns page-full" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="mediating-variables"><span class="header-section-number">4</span> Mediating variables</h2>
<ul>
<li><p>A mediating variable is a predictor hypothesized to lie on the causal pathway between a predictor of interest and the outcome</p></li>
<li><p>Whether or not to adjust for a mediating variable depends on the scientific question of interest</p>
<ul>
<li><p>Without adjustment, we are estimating the <strong>total</strong> (causal) effect of the predictor of interest via all pathways on the outcome</p></li>
<li><p>If we adjust for a mediator, we are estimating the <strong>direct</strong> (causal) effect via other pathways that do not involve the mediator</p></li>
</ul></li>
<li><p>If a potential mediator is identified <em>a priori</em> on scientific grounds, we can estimate the <strong>direct</strong> effect via pathways other than the mediator, the <strong>indirect</strong> effect through the mediator, and the degree of mediation (e.g.&nbsp;<strong>proportion mediated</strong>).</p></li>
<li><p>Example: Depression (predictor) and Crohn’s Disease activitity (outcome) with possible mediators being physical activity, smoking, and sleep quality</p>
<ul>
<li><p>Mediation models were considered using baseline, 6-month, and 12-month follow-up data</p></li>
<li><p>Depression at baseline was the predictor of interest, mediators were assessed at 6 months, and disease activity at 12 months was the outcome.</p></li>
<li><p>To establish and estimate the mediation effect, we utilized the four steps originally outlined by Barron and Kenny <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<ul>
<li><p>First, we tested that there was a significant effect of depression at baseline with disease activity at 12 months to establish there was an effect to be mediated</p></li>
<li><p>Second, we estimated the correlation between depression at baseline and each of the potential mediators measured at 6 months</p></li>
<li><p>Third, we tested if each of the mediators at 6 months was associated with disease activity at 12 months while controlling for disease activity at baseline.</p></li>
<li><p>Fourth, the mediation package in R was used to estimate various quantities for causal mediation analysis, including average causal mediation effects (indirect effect), average direct effects, proportions mediated, and total effect. This step involves combining estimates from the mediator model (mediator at 6 months outcome, depression at baseline the predictor) and estimates from the outcome model (disease activity at 12 months outcome, mediator at 6 months and depression at baseline as predictors of interest, and controlling for disease activity at baseline) efficiently and with appropriate standard error estimates.</p></li>
</ul></li>
<li><p>Results</p></li>
</ul></li>
</ul>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;Baron RM, Kenny DA. The moderator-mediator variable distinction in social psychological research: conceptual, strategic, and statistical considerations. J Pers Soc Psychol. 1986 Dec;51(6):1173-82. doi: 10.1037//0022-3514.51.6.1173. PMID: 3806354.</p></div></div><div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figures/multiplemediation.png" class="img-fluid figure-img" style="width:150.0%"></p>
<figcaption class="margin-caption">Multiple mediation model path diagram and estimates from structural equations model. Part A shows the total effect of depression at baseline on disease activity at 12 months is that, per one unit increase in depression, disease activity increases by 2.90. Part B show the associations of depression at baseline, mediators at 6 months, and disease activity at 12 months. Individual mediation effects are found by multiplying a by b for each mediator. Of the 2.90 total effect, 0.005 went through sleep, 0.138 went through smoking and 0.107 went through activity. Summing these three value, a total of 0.250 (8.6% mediated) when through the three mediators.</figcaption>
</figure>
</div>
</section>
<section id="precision-variables" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="precision-variables"><span class="header-section-number">5</span> Precision Variables</h2>
<section id="overview-1" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="overview-1"><span class="header-section-number">5.1</span> Overview</h3>
<ul>
<li><p>Sometimes the scientific question to be answered is chosen based on which questions can be answered most precisely</p></li>
<li><p>In general, questions can be answered more precisely when the within group distribution is less variable</p></li>
<li><p>Comparing groups that are similar with respect to other important risk factors decreases variability</p></li>
<li><p>The precision variability is independent of the cause of the response</p></li>
<li><p>If we adjust for such a variable, we tend to gain precision</p></li>
<li><p>Directed Acyclyic Graph:</p></li>
</ul>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  X[Predictor] --&gt; Y[Outcome]
  Z[Precision] --&gt; Y[Outcome]
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="adjusting-for-precision-variables" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="adjusting-for-precision-variables"><span class="header-section-number">5.2</span> Adjusting for Precision Variables</h3>
<section id="precision-for-difference-of-independent-means" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="precision-for-difference-of-independent-means"><span class="header-section-number">5.2.1</span> Precision for Difference of Independent Means</h4>
<ul>
<li><p>Independent observations where group 1 has a different mean and variance than group 2</p>
<ul>
<li><p><span class="math inline">\(\textrm{ind } Y_{ij} \sim (\mu_j, \sigma_j^2), j = 1, 2; i = 1, \ldots, n_j\)</span></p></li>
<li><p><span class="math inline">\(n = n_1 + n_2\)</span>; <span class="math inline">\(r = n_1 / n_2\)</span></p></li>
<li><p><span class="math inline">\(\theta = \mu_1 - \mu_2\)</span>, <span class="math inline">\(\hat{\theta} = \overline{Y}_1 - \overline{Y}_2\)</span></p></li>
<li><p><span class="math inline">\(V = (r+1)(\frac{\sigma_1^2}{r} + \sigma_2^2)\)</span></p></li>
<li><p><span class="math inline">\(se(\hat{\theta}) = \sqrt{\frac{V}{n}} = \sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}\)</span></p></li>
</ul></li>
<li><p>Might control for some variable in order to decrease the within group variability</p>
<ul>
<li><p>Restrict population sampled</p></li>
<li><p>Standardize ancillary treatments</p></li>
<li><p>Standardize measurement procedure</p></li>
</ul></li>
</ul>
</section>
<section id="precision-for-linear-regression" class="level4" data-number="5.2.2">
<h4 data-number="5.2.2" class="anchored" data-anchor-id="precision-for-linear-regression"><span class="header-section-number">5.2.2</span> Precision for Linear Regression</h4>
<ul>
<li><p>Independent continuous outcome associated with covariate (<span class="math inline">\(X\)</span>)</p>
<ul>
<li><p><span class="math inline">\(\textrm{ind } Y_i | X_i ~ \sim(\beta_0 + \beta_1 X_i, \sigma^2_{Y|X}), i = 1, \ldots, n\)</span></p></li>
<li><p><span class="math inline">\(\theta = \beta_1, \hat{\theta} = \hat{\beta_1}\)</span> from LS regression</p></li>
<li><p><span class="math inline">\(V = \frac{\sigma^2_{Y|X}}{\textrm{Var}(X)}\)</span></p></li>
<li><p><span class="math inline">\(se(\hat{\theta}) = \sqrt{\frac{\hat{\sigma}^2_{Y|X}}{n \hat{\textrm{Var}}(X)}}\)</span></p></li>
</ul></li>
<li><p>Adjusting for covariates (<span class="math inline">\(W\)</span>) decreases the within group standard deviation</p>
<ul>
<li><span class="math inline">\(\textrm{Var}(Y | X)\)</span> versus <span class="math inline">\(\textrm{Var}(Y | X, W)\)</span></li>
</ul></li>
<li><p>Independent continuous outcome associated with covariate (<span class="math inline">\(X\)</span>) and precision variable (<span class="math inline">\(W\)</span>)</p>
<ul>
<li><p><span class="math inline">\(\textrm{ind } Y_i | X_i, W_i ~ \sim(\beta_0 + \beta_1 X_i + \beta_2 W_i, \sigma^2_{Y|X,W}), i = 1, \ldots, n\)</span></p></li>
<li><p><span class="math inline">\(\theta = \beta_1, \hat{\theta} = \hat{\beta_1}\)</span> from LS regression</p></li>
<li><p><span class="math inline">\(V = \frac{\sigma^2_{Y|X,W}}{\textrm{Var}(X)(1-r^2_{X,W})}\)</span></p></li>
<li><p><span class="math inline">\(se(\hat{\theta}) = \sqrt{\frac{\hat{\sigma}^2_{Y|X,W}}{n \hat{\textrm{Var}}(X)(1-r^2_{X,W})}}\)</span></p></li>
<li><p><span class="math inline">\(\sigma^2_{Y|X,W} = \sigma^2_{Y|X} - \beta_2^2 \textrm{Var}(W | X)\)</span></p></li>
</ul></li>
</ul>
</section>
<section id="precision-for-difference-of-proportions" class="level4" data-number="5.2.3">
<h4 data-number="5.2.3" class="anchored" data-anchor-id="precision-for-difference-of-proportions"><span class="header-section-number">5.2.3</span> Precision for Difference of Proportions</h4>
<ul>
<li><p>When analyzing proportions (means), the mean variance relationship is critical</p>
<ul>
<li><p>Precision is greatest when proportion is close to 0 or 1</p></li>
<li><p>Greater homogeneity of groups makes results more deterministic (this is the goal, at least)</p></li>
</ul></li>
<li><p>Independent binary outcomes</p>
<ul>
<li><p><span class="math inline">\(\textrm{ind } Y_{ij} \sim B(1, p_j), i = 1, \ldots, n_j; j = 1, 2\)</span></p></li>
<li><p><span class="math inline">\(n = n_1 + n_2; r = n_1 / n_2\)</span></p></li>
<li><p><span class="math inline">\(\theta = p_1 - p_2\)</span>, <span class="math inline">\(\hat{\theta} = \hat{p}_1 - \hat{p_2} = \overline{Y}_1 - \overline{Y}_2\)</span></p></li>
<li><p><span class="math inline">\(\sigma^2_j = p_j(1-p_j)\)</span></p></li>
<li><p><span class="math inline">\(V = (r+1)(\frac{\sigma_1^2}{r} + \sigma_2^2)\)</span></p></li>
<li><p><span class="math inline">\(se(\hat{\theta}) = \sqrt{\frac{V}{n}} = \sqrt{\frac{\sigma^2_1}{n_1} + \frac{\sigma^2_2}{n_2}}\)</span></p></li>
</ul></li>
</ul>
</section>
<section id="precision-for-odds" class="level4" data-number="5.2.4">
<h4 data-number="5.2.4" class="anchored" data-anchor-id="precision-for-odds"><span class="header-section-number">5.2.4</span> Precision for Odds</h4>
<ul>
<li><p>When analyzing odds (a nonlinear function of the mean), adjusting for precision variables results in more extreme estimates</p></li>
<li><p><span class="math inline">\(\textrm{Odds} = \frac{p}{1-p}\)</span></p></li>
<li><p>Odds using average of stratum specific <span class="math inline">\(p\)</span> is not the average of stratum specific odds</p></li>
<li><p>Example: Stroke by smoking (in CVD strata)</p>
<ul>
<li><p>No association between smoking and CVD in the sample: 10% smokers in subjects with and without CVD</p></li>
<li><p>CVD (precision variable) associated with stroke (outcome)</p>
<ul>
<li>CVD is not a confounder, but it is clearly a precision variable</li>
</ul></li>
<li><p>Within each CVD stratum, the (adjusted) odds ratio for stroke by smoking is 2.0.</p></li>
<li><p>Overall, the unadjusted odds ratio is 1.8. That is, the unadjusted odds ratio is attenuated toward the null compared to the adjusted odds ratios</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>No CVD</th>
<th>N</th>
<th>p</th>
<th>Odds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Smoke</td>
<td>1000</td>
<td>0.04</td>
<td>0.04</td>
</tr>
<tr class="even">
<td>Non-Smoke</td>
<td>10000</td>
<td>0.02</td>
<td>0.02</td>
</tr>
<tr class="odd">
<td>Ratio</td>
<td></td>
<td></td>
<td>2.0</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th>CVD</th>
<th>N</th>
<th>p</th>
<th>Odds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Smoke</td>
<td>100</td>
<td>0.50</td>
<td>1.00</td>
</tr>
<tr class="even">
<td>Non-Smoke</td>
<td>1000</td>
<td>0.33</td>
<td>0.50</td>
</tr>
<tr class="odd">
<td>Ratio</td>
<td></td>
<td></td>
<td>2.0</td>
</tr>
</tbody>
</table>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Overall</th>
<th>N</th>
<th>p</th>
<th>Odds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Smoke</td>
<td>1100</td>
<td>0.082</td>
<td>0.09</td>
</tr>
<tr class="even">
<td>Non-Smoke</td>
<td>11000</td>
<td>0.048</td>
<td>0.05</td>
</tr>
<tr class="odd">
<td>Ratio</td>
<td></td>
<td></td>
<td>1.8</td>
</tr>
</tbody>
</table></li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="diagnosing-confounding-1" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="diagnosing-confounding-1"><span class="header-section-number">6</span> Diagnosing Confounding</h2>
<section id="adjustment-for-covariates" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="adjustment-for-covariates"><span class="header-section-number">6.1</span> Adjustment for Covariates</h3>
<ul>
<li><p>We include predictors in an analysis for a number of reasons. In order of importance…</p>
<ol type="1">
<li><p>Scientific question</p>
<ul>
<li><p>Predictor of Interest</p></li>
<li><p>Effect Modifiers</p></li>
</ul></li>
<li><p>Adjust for confounding</p></li>
<li><p>Gain precision</p></li>
</ol></li>
<li><p>Adjustment for covariates changes the question being answered by the statistical analysis</p>
<ul>
<li><p>Adjustments can be made to isolate associations that are of particular interest</p></li>
<li><p>When consulting with a scientist, it is often difficult to decide whether the interest in an additional covariate is due to confounding, effect modification, or precision</p>
<ul>
<li>The distinction is important because I tend to treat these variable differently in the analysis</li>
</ul></li>
<li><p>Often the scientific question dictates inclusion of particular predictors</p>
<ul>
<li><p>Predictor of interest: The scientific parameter of interest can be modeled by multiple predictors (e.g.&nbsp;dummy variables, polynomials, splines)</p></li>
<li><p>Effect Modifiers: The scientific question relates to the detection of effect modification</p></li>
<li><p>Confounders: The scientific question may be state in terms of adjusting for known (or suspected) confounders</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="confounder-detection" class="level3" data-number="6.2">
<h3 data-number="6.2" class="anchored" data-anchor-id="confounder-detection"><span class="header-section-number">6.2</span> Confounder Detection</h3>
<ul>
<li><p>Unanticipated confounding</p>
<ul>
<li><p>Some times we must explore our data to assess whether our results were confounded by some variable</p></li>
<li><p>Goal is to assess the “independent effect” of the predictor of interest on the outcome</p></li>
</ul></li>
<li><p>Confounders</p>
<ul>
<li><p>Variables (causally) predictive of the outcome, but not in the causal pathway</p>
<ul>
<li><p>Best method: Think about the scientific problem beforehand (perhaps draw DAG)</p></li>
<li><p>Using data, often assessed in the control group</p></li>
</ul></li>
<li><p>Variables associated with the predictor of interest in the sample</p>
<ul>
<li>Note that statistical significance is not relevant because this tells us about associations in the population</li>
</ul></li>
<li><p>Detection of confounding ultimately must rely on our best knowledge about the possible scientific mechanisms</p></li>
</ul></li>
<li><p>Effect of confounding: A confounder can make the association between the predictor of interest and the response variable look…</p>
<ul>
<li><p>Stronger than the true association</p></li>
<li><p>Weaker than the true association</p></li>
<li><p>The complete reverse of the true association (“qualitative confounding”)</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="graphical-methods-for-visualizing-effect-modification-confounding-and-precision" class="level2 page-columns page-full" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="graphical-methods-for-visualizing-effect-modification-confounding-and-precision"><span class="header-section-number">7</span> Graphical Methods for Visualizing Effect Modification, Confounding, and Precision</h2>
<ul>
<li><p>Conduct stratified analysis to distinguish between</p>
<ul>
<li><p>Effect modifiers</p></li>
<li><p>Confounders</p></li>
<li><p>Precision variables</p></li>
</ul></li>
<li><p>Plots most illustrative for continuous outcomes</p></li>
</ul>
<section id="effect-modifiers" class="level3 page-columns page-full" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="effect-modifiers"><span class="header-section-number">7.1</span> Effect Modifiers</h3>
<ul>
<li><p>Estimates of treatment effect differ among strata</p>
<ul>
<li><p>When analyzing difference of means of continuous data, stratified smooth curves of the data are non-parallel</p></li>
<li><p>Graphical techniques difficult in other settings</p></li>
</ul></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1231</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">each=</span>n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>emplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">grp=</span>grp,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">X=</span>X,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Y=</span>.<span class="dv">1</span><span class="sc">*</span>grp <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">4</span><span class="sc">*</span>grp<span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>emplot<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(emplot<span class="sc">$</span>grp, <span class="at">levels=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Trt"</span>,<span class="st">"Ctrl"</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emplot, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="Lec06.ConfoundingEffectModificationMediation_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="margin-caption">Unadjusted association between outcome and predictor shows a flat slope.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emplot, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y, <span class="at">color=</span>group, <span class="at">grp=</span>group)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>,) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="Lec06.ConfoundingEffectModificationMediation_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="margin-caption">Adjusted association between outcome and predictor shows an increasing slope in one group and a decreasing slope in the other. This demonstrates effect modification of group.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="confounders" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="confounders"><span class="header-section-number">7.2</span> Confounders</h3>
<ul>
<li><p>Estimates of treatment effect the same across strata, AND</p>
<ul>
<li><p>Confounder is causally associated with the response, AND</p></li>
<li><p>Confounder associated with the POI in the sample</p></li>
</ul></li>
<li><p>When analyzing difference of means of continuous data</p>
<ul>
<li><p>Stratified smooth curve of data are parallel</p></li>
<li><p>Distribution of POI differs across strata</p></li>
<li><p>Unadjusted and adjusted analyses give different estimates</p></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1231</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">each=</span>n<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">4</span>, <span class="dv">0</span>,.<span class="dv">4</span>), <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">4</span>, <span class="fl">0.2</span>,.<span class="dv">6</span>), <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">4</span>, .<span class="dv">4</span>,.<span class="dv">8</span>), <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">4</span>, .<span class="dv">6</span>, <span class="dv">1</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X <span class="sc">-</span> grp <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">main=</span><span class="st">"Unadjusted"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(Y<span class="sc">~</span>X), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">pch=</span>(grp<span class="sc">+</span><span class="dv">1</span>), <span class="at">main=</span><span class="st">"Adjusted Confounding"</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X <span class="sc">+</span> grp)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="dv">0</span>  , <span class="at">x1=</span>.<span class="dv">4</span>, <span class="at">y0=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>],   <span class="at">y1=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.4</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>], <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="fl">0.2</span>, <span class="at">x1=</span>.<span class="dv">6</span>, <span class="at">y0=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.2</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>]<span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">y1=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="fl">0.4</span>, <span class="at">x1=</span>.<span class="dv">8</span>, <span class="at">y0=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.4</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>]<span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">y1=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="fl">0.6</span>, <span class="at">x1=</span> <span class="dv">1</span>, <span class="at">y0=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>]<span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">y1=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span>   <span class="dv">1</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">lty=</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lec06.ConfoundingEffectModificationMediation_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="precision-variables-1" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="precision-variables-1"><span class="header-section-number">7.3</span> Precision Variables</h3>
<ul>
<li><p>Estimates of treatment effect the same across strata, AND</p>
<ul>
<li><p>Variable is causally associated with the response, AND</p></li>
<li><p>Variable is not associated with the POI in the sample</p></li>
</ul></li>
<li><p>When analyzing difference of means of continuous data</p>
<ul>
<li><p>Stratified smooth curve of data are parallel</p></li>
<li><p>Distribution of POI same across strata</p></li>
<li><p>Unadjusted and adjusted analyses give similar estimates but with smaller standard errors</p></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1231</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">each=</span>n<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">*</span>X <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>grp <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">main=</span><span class="st">"Unadjusted Precision"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(Y<span class="sc">~</span>X), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">main=</span><span class="st">"Adjusted Precision"</span>, <span class="at">pch=</span>(grp<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X <span class="sc">+</span> grp)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">coef</span>(m2)[<span class="dv">1</span>], <span class="at">b=</span><span class="fu">coef</span>(m2)[<span class="dv">2</span>], <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">coef</span>(m2)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">coef</span>(m2)[<span class="dv">3</span>], <span class="at">b=</span>(<span class="fu">coef</span>(m2)[<span class="dv">2</span>]), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">coef</span>(m2)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">coef</span>(m2)[<span class="dv">3</span>], <span class="at">b=</span>(<span class="fu">coef</span>(m2)[<span class="dv">2</span>]), <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">coef</span>(m2)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">coef</span>(m2)[<span class="dv">3</span>], <span class="at">b=</span>(<span class="fu">coef</span>(m2)[<span class="dv">2</span>]), <span class="at">lty=</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lec06.ConfoundingEffectModificationMediation_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section>
</section>


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/chrissl789\.github\.io\/modern-regression\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/Lec05.Precision.html" class="pagination-link" aria-label="Precision of Statistical Intefence">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Precision of Statistical Intefence</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notes/Lec07.MultivariableModels.html" class="pagination-link" aria-label="Multivariable Models">
        <span class="nav-page-text">Multivariable Models</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb6" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Confouding, Effect Modification, and Mediation"</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Lecture 06"</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="an">name:</span><span class="co"> Lec06.ConfoundingEffectModificationMediation.qmd</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="fu">source</span>(<span class="st">'pander_registry.R'</span>), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">invisible</span>(e))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Most often scientific questions are translated into comparing the</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    distribution of some response variable across groups of interest</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Groups are defined by the predictor of interest (POI). Regression</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    methods allow for either categorical or continuous predictors of</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    interest</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Categorical predictors of interest: Treatment or control,</span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>        knockout or</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>        wild type, ethnic group</span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Continuous predictors of interest: Age, BMI, cholesterol, blood</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>        pressure</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Often we need to consider additional variables other than the</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>    predictor of interest to answer our scientific question</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Covariates other than the predictor of of interest are included in</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    the regression model as</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Effect modifiers</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Confounders</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mediating variables</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Precision variables</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>(Not necessarily mutually exclusive)</span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a><span class="fu">## Effect Modification</span></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The association between the Response and the Predictor of Interest</span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>    differs in strata defined by the effect modifier</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Statistical term: "Interaction" between the effect modifier and the</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>    POI</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effect modification depends on the measure of effect that you choose</span></span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Choice of summary measure: mean, median, geometric mean, odds,</span>
<span id="cb6-58"><a href="#cb6-58" aria-hidden="true" tabindex="-1"></a>    hazard</span>
<span id="cb6-59"><a href="#cb6-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-60"><a href="#cb6-60" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Choice of comparisons across groups: differences, ratios</span>
<span id="cb6-61"><a href="#cb6-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-62"><a href="#cb6-62" aria-hidden="true" tabindex="-1"></a><span class="fu">### Examples of Effect Modification</span></span>
<span id="cb6-63"><a href="#cb6-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-64"><a href="#cb6-64" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example 1: Is serum LDL by smoking modified by gender?</span></span>
<span id="cb6-65"><a href="#cb6-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-66"><a href="#cb6-66" aria-hidden="true" tabindex="-1"></a>|          |       |      |        |        |</span>
<span id="cb6-67"><a href="#cb6-67" aria-hidden="true" tabindex="-1"></a>|----------|-------|------|--------|--------|</span>
<span id="cb6-68"><a href="#cb6-68" aria-hidden="true" tabindex="-1"></a>|          | Mean  | Mean | Median | Median |</span>
<span id="cb6-69"><a href="#cb6-69" aria-hidden="true" tabindex="-1"></a>|          | Women | Men  | Women  | Men    |</span>
<span id="cb6-70"><a href="#cb6-70" aria-hidden="true" tabindex="-1"></a>| No Smoke | 120   | 122  | 120    | 115    |</span>
<span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a>| Smoke    | 133   | 122  | 133    | 124    |</span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>| Diff     | -13   | 0    | -13    | -9     |</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>| Ratio    | 0.90  | 1    | 0.90   | 0.93   |</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Effect modification by gender exists if the effect of smoking in</span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>    males is different from the effect of smoking in females</span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Compare the diff (or ratio) for the mean (or median) in women to</span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>        the diff (or ratio) for the mean (or median) in men</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Effect modification for mean, not as much for median</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Statement holds for both difference or ratio of mean/median</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example 2: Creatinine by stroke (modified by gender?)</span></span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>|           |       |       |        |        |</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>|-----------|-------|-------|--------|--------|</span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a>|           | Mean  | Mean  | Median | Median |</span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>|           | Women | Men   | Women  | Men    |</span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>| No Stroke | 0.72  | 1.08  | 0.7    | 1.1    |</span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>| Stroke    | 1.01  | 1.51  | 1.0    | 1.5    |</span>
<span id="cb6-93"><a href="#cb6-93" aria-hidden="true" tabindex="-1"></a>| Diff      | -0.29 | -0.43 | -0.3   | -0.4   |</span>
<span id="cb6-94"><a href="#cb6-94" aria-hidden="true" tabindex="-1"></a>| Ratio     | 0.71  | 0.72  | 0.70   | 0.73   |</span>
<span id="cb6-95"><a href="#cb6-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-96"><a href="#cb6-96" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Effect modification for difference, not really for ratio</span>
<span id="cb6-97"><a href="#cb6-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-98"><a href="#cb6-98" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>True for Mean or median</span>
<span id="cb6-99"><a href="#cb6-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-100"><a href="#cb6-100" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example 3: Stroke by smoking (modified by gender?)</span></span>
<span id="cb6-101"><a href="#cb6-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-102"><a href="#cb6-102" aria-hidden="true" tabindex="-1"></a>|          |            |            |       |       |</span>
<span id="cb6-103"><a href="#cb6-103" aria-hidden="true" tabindex="-1"></a>|----------|------------|------------|-------|-------|</span>
<span id="cb6-104"><a href="#cb6-104" aria-hidden="true" tabindex="-1"></a>|          | Proportion | Proportion | Odds  | Odds  |</span>
<span id="cb6-105"><a href="#cb6-105" aria-hidden="true" tabindex="-1"></a>|          | Women      | Men        | Women | Men   |</span>
<span id="cb6-106"><a href="#cb6-106" aria-hidden="true" tabindex="-1"></a>| No Smoke | 0.10       | 0.16       | 0.03  | 0.19  |</span>
<span id="cb6-107"><a href="#cb6-107" aria-hidden="true" tabindex="-1"></a>| Smoke    | 0.16       | 0.26       | 0.19  | 0.35  |</span>
<span id="cb6-108"><a href="#cb6-108" aria-hidden="true" tabindex="-1"></a>| Diff     | -0.06      | -0.10      | -0.16 | -0.16 |</span>
<span id="cb6-109"><a href="#cb6-109" aria-hidden="true" tabindex="-1"></a>| Ratio    | 0.62       | 0.62       | 0.16  | 0.54  |</span>
<span id="cb6-110"><a href="#cb6-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-111"><a href="#cb6-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Proportion: No effect modification for ratio, small amount for</span>
<span id="cb6-112"><a href="#cb6-112" aria-hidden="true" tabindex="-1"></a>    difference</span>
<span id="cb6-113"><a href="#cb6-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-114"><a href="#cb6-114" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Odds: No effect modification for difference, yes for ratio</span>
<span id="cb6-115"><a href="#cb6-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-116"><a href="#cb6-116" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example 4: Stroke by smoking (modified by CVD?)</span></span>
<span id="cb6-117"><a href="#cb6-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-118"><a href="#cb6-118" aria-hidden="true" tabindex="-1"></a>|          |            |            |       |       |</span>
<span id="cb6-119"><a href="#cb6-119" aria-hidden="true" tabindex="-1"></a>|----------|------------|------------|-------|-------|</span>
<span id="cb6-120"><a href="#cb6-120" aria-hidden="true" tabindex="-1"></a>|          | Proportion | Proportion | Odds  | Odds  |</span>
<span id="cb6-121"><a href="#cb6-121" aria-hidden="true" tabindex="-1"></a>|          | None       | CVD        | None  | CVD   |</span>
<span id="cb6-122"><a href="#cb6-122" aria-hidden="true" tabindex="-1"></a>| No Smoke | 0.02       | 0.33       | 0.02  | 0.50  |</span>
<span id="cb6-123"><a href="#cb6-123" aria-hidden="true" tabindex="-1"></a>| Smoke    | 0.04       | 0.50       | 0.04  | 1.00  |</span>
<span id="cb6-124"><a href="#cb6-124" aria-hidden="true" tabindex="-1"></a>| Diff     | -0.02      | -0.17      | -0.02 | -0.50 |</span>
<span id="cb6-125"><a href="#cb6-125" aria-hidden="true" tabindex="-1"></a>| Ratio    | 0.50       | 0.67       | 0.50  | 0.50  |</span>
<span id="cb6-126"><a href="#cb6-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-127"><a href="#cb6-127" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Effect Modficiation?</span>
<span id="cb6-128"><a href="#cb6-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-129"><a href="#cb6-129" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Proportion: Yes for ratio, yes for difference</span>
<span id="cb6-130"><a href="#cb6-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-131"><a href="#cb6-131" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Odds: Yes for difference, no for ratio</span>
<span id="cb6-132"><a href="#cb6-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-133"><a href="#cb6-133" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example 5: CHD by current smoking (modified by gender?)</span></span>
<span id="cb6-134"><a href="#cb6-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-135"><a href="#cb6-135" aria-hidden="true" tabindex="-1"></a>|          |            |            |       |      |</span>
<span id="cb6-136"><a href="#cb6-136" aria-hidden="true" tabindex="-1"></a>|----------|------------|------------|-------|------|</span>
<span id="cb6-137"><a href="#cb6-137" aria-hidden="true" tabindex="-1"></a>|          | Proportion | Proportion | Odds  | Odds |</span>
<span id="cb6-138"><a href="#cb6-138" aria-hidden="true" tabindex="-1"></a>|          | Women      | Men        | Women | Men  |</span>
<span id="cb6-139"><a href="#cb6-139" aria-hidden="true" tabindex="-1"></a>| No Smoke | 0.18       | 0.26       | 0.22  | 0.36 |</span>
<span id="cb6-140"><a href="#cb6-140" aria-hidden="true" tabindex="-1"></a>| Smoke    | 0.05       | 0.24       | 0.05  | 0.32 |</span>
<span id="cb6-141"><a href="#cb6-141" aria-hidden="true" tabindex="-1"></a>| Diff     | 0.13       | 0.02       | 0.17  | 0.03 |</span>
<span id="cb6-142"><a href="#cb6-142" aria-hidden="true" tabindex="-1"></a>| Ratio    | 3.60       | 1.08       | 4.17  | 1.11 |</span>
<span id="cb6-143"><a href="#cb6-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-144"><a href="#cb6-144" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Effect Modfication?</span>
<span id="cb6-145"><a href="#cb6-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-146"><a href="#cb6-146" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Proportion: Yes for ratio, yes for difference</span>
<span id="cb6-147"><a href="#cb6-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-148"><a href="#cb6-148" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Odds: Yes for difference, yes for ratio</span>
<span id="cb6-149"><a href="#cb6-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-150"><a href="#cb6-150" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example 6: CHD by ever smoke (modified by gender?)</span></span>
<span id="cb6-151"><a href="#cb6-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-152"><a href="#cb6-152" aria-hidden="true" tabindex="-1"></a>|             |            |            |       |       |</span>
<span id="cb6-153"><a href="#cb6-153" aria-hidden="true" tabindex="-1"></a>|-------------|------------|------------|-------|-------|</span>
<span id="cb6-154"><a href="#cb6-154" aria-hidden="true" tabindex="-1"></a>|             | Proportion | Proportion | Odds  | Odds  |</span>
<span id="cb6-155"><a href="#cb6-155" aria-hidden="true" tabindex="-1"></a>|             | Women      | Men        | Women | Men   |</span>
<span id="cb6-156"><a href="#cb6-156" aria-hidden="true" tabindex="-1"></a>| Never Smoke | 0.16       | 0.25       | 0.19  | 0.33  |</span>
<span id="cb6-157"><a href="#cb6-157" aria-hidden="true" tabindex="-1"></a>| Ever Smoke  | 0.16       | 0.26       | 0.19  | 0.35  |</span>
<span id="cb6-158"><a href="#cb6-158" aria-hidden="true" tabindex="-1"></a>| Diff        | 0.00       | -0.01      | 0.00  | -0.02 |</span>
<span id="cb6-159"><a href="#cb6-159" aria-hidden="true" tabindex="-1"></a>| Ratio       | 1.00       | 0.96       | 1.00  | 0.95  |</span>
<span id="cb6-160"><a href="#cb6-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-161"><a href="#cb6-161" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Effect Modfication?</span>
<span id="cb6-162"><a href="#cb6-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-163"><a href="#cb6-163" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Proportion: No for ratio, no for difference</span>
<span id="cb6-164"><a href="#cb6-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-165"><a href="#cb6-165" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Odds: No for difference, no for ratio</span>
<span id="cb6-166"><a href="#cb6-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-167"><a href="#cb6-167" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Summary comments on examples</span></span>
<span id="cb6-168"><a href="#cb6-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-169"><a href="#cb6-169" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If there is an effect, will see effect modification on at least one</span>
<span id="cb6-170"><a href="#cb6-170" aria-hidden="true" tabindex="-1"></a>    of the difference and ratio scale</span>
<span id="cb6-171"><a href="#cb6-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-172"><a href="#cb6-172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If there is no effect (example 6), will see no effect modification</span>
<span id="cb6-173"><a href="#cb6-173" aria-hidden="true" tabindex="-1"></a>    on both difference and ratio scale</span>
<span id="cb6-174"><a href="#cb6-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-175"><a href="#cb6-175" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In real world, will usually see effect modification on both scales.</span>
<span id="cb6-176"><a href="#cb6-176" aria-hidden="true" tabindex="-1"></a>    The real question is "Is the effect modification scientifically</span>
<span id="cb6-177"><a href="#cb6-177" aria-hidden="true" tabindex="-1"></a>    meaningful?"</span>
<span id="cb6-178"><a href="#cb6-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-179"><a href="#cb6-179" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If we find there is important effect modification, science will</span>
<span id="cb6-180"><a href="#cb6-180" aria-hidden="true" tabindex="-1"></a>        go forward estimating effects separately</span>
<span id="cb6-181"><a href="#cb6-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-182"><a href="#cb6-182" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Models with interaction terms are useful for testing if effect</span>
<span id="cb6-183"><a href="#cb6-183" aria-hidden="true" tabindex="-1"></a>        modification is present (statistically)</span>
<span id="cb6-184"><a href="#cb6-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-185"><a href="#cb6-185" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb6-186"><a href="#cb6-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-187"><a href="#cb6-187" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aside: Be careful when comparing two ratios</span>
<span id="cb6-188"><a href="#cb6-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-189"><a href="#cb6-189" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>How close are two ratios?</span>
<span id="cb6-190"><a href="#cb6-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-191"><a href="#cb6-191" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>0.20 and 0.25 VERSUS 5.0 and 4.0?</span>
<span id="cb6-192"><a href="#cb6-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-193"><a href="#cb6-193" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>0.10 and 0.15 VERSUS 10.0 and 6.7?</span>
<span id="cb6-194"><a href="#cb6-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-195"><a href="#cb6-195" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Compare the ratio of ratios, not the difference</span>
<span id="cb6-196"><a href="#cb6-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-197"><a href="#cb6-197" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We might consider ratios to be more different when both ratios</span>
<span id="cb6-198"><a href="#cb6-198" aria-hidden="true" tabindex="-1"></a>        are $&gt;1$ than when both are $&lt;1$. But, that would be wrong.</span>
<span id="cb6-199"><a href="#cb6-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-200"><a href="#cb6-200" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of Effect Modification</span></span>
<span id="cb6-201"><a href="#cb6-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-202"><a href="#cb6-202" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When the scientific question involves effect modification</span>
<span id="cb6-203"><a href="#cb6-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-204"><a href="#cb6-204" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Conduct analysis within each stratum separately</span>
<span id="cb6-205"><a href="#cb6-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-206"><a href="#cb6-206" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If we want to estimate the degree of effect modification or test</span>
<span id="cb6-207"><a href="#cb6-207" aria-hidden="true" tabindex="-1"></a>        its existence, use a regression model including</span>
<span id="cb6-208"><a href="#cb6-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-209"><a href="#cb6-209" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Predictor of interest (main effect)</span>
<span id="cb6-210"><a href="#cb6-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-211"><a href="#cb6-211" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Effect modifying variable (main effect)</span>
<span id="cb6-212"><a href="#cb6-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-213"><a href="#cb6-213" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>A covariate modeling the interaction (usually a product)</span>
<span id="cb6-214"><a href="#cb6-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-215"><a href="#cb6-215" aria-hidden="true" tabindex="-1"></a>    #### Impact of ignoring effect modification</span>
<span id="cb6-216"><a href="#cb6-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-217"><a href="#cb6-217" aria-hidden="true" tabindex="-1"></a><span class="in">    -   By design or mistake, we sometimes do not model effect</span></span>
<span id="cb6-218"><a href="#cb6-218" aria-hidden="true" tabindex="-1"></a><span class="in">        modification</span></span>
<span id="cb6-219"><a href="#cb6-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-220"><a href="#cb6-220" aria-hidden="true" tabindex="-1"></a><span class="in">    -   Might perform</span></span>
<span id="cb6-221"><a href="#cb6-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-222"><a href="#cb6-222" aria-hidden="true" tabindex="-1"></a><span class="in">        -   Unadjusted analysis: POI only</span></span>
<span id="cb6-223"><a href="#cb6-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-224"><a href="#cb6-224" aria-hidden="true" tabindex="-1"></a><span class="in">        -   Adjusted analysis: POI and third variable, but no</span></span>
<span id="cb6-225"><a href="#cb6-225" aria-hidden="true" tabindex="-1"></a><span class="in">            interaction term</span></span>
<span id="cb6-226"><a href="#cb6-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-227"><a href="#cb6-227" aria-hidden="true" tabindex="-1"></a><span class="in">    -   If effect modification exists, an unadjusted analysis will give</span></span>
<span id="cb6-228"><a href="#cb6-228" aria-hidden="true" tabindex="-1"></a><span class="in">        different results according to the association between the POI</span></span>
<span id="cb6-229"><a href="#cb6-229" aria-hidden="true" tabindex="-1"></a><span class="in">        and effect modifier in the sample</span></span>
<span id="cb6-230"><a href="#cb6-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-231"><a href="#cb6-231" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If the POI and the effect modifier are not associated</span>
<span id="cb6-232"><a href="#cb6-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-233"><a href="#cb6-233" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Unadjusted analysis tends toward an (approximate) weighted</span>
<span id="cb6-234"><a href="#cb6-234" aria-hidden="true" tabindex="-1"></a>        average of the stratum specific effects</span>
<span id="cb6-235"><a href="#cb6-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-236"><a href="#cb6-236" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>With means, exactly a weighted average</span>
<span id="cb6-237"><a href="#cb6-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-238"><a href="#cb6-238" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>With odds and hazards, an approximate weighted average</span>
<span id="cb6-239"><a href="#cb6-239" aria-hidden="true" tabindex="-1"></a>            (because they are non-linear functions of the mean)</span>
<span id="cb6-240"><a href="#cb6-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-241"><a href="#cb6-241" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If the POI and the effect modifier are associated in the sample</span>
<span id="cb6-242"><a href="#cb6-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-243"><a href="#cb6-243" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The "average" effect is confounded and thus unreliable</span>
<span id="cb6-244"><a href="#cb6-244" aria-hidden="true" tabindex="-1"></a>        (variables can be both effect modifiers and confounders)</span>
<span id="cb6-245"><a href="#cb6-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-246"><a href="#cb6-246" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If effect modification exists, an analysis adjusting only for the</span>
<span id="cb6-247"><a href="#cb6-247" aria-hidden="true" tabindex="-1"></a>    third variable (but no interaction) will tend toward a weighted</span>
<span id="cb6-248"><a href="#cb6-248" aria-hidden="true" tabindex="-1"></a>    average of the stratum specific effects</span>
<span id="cb6-249"><a href="#cb6-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-250"><a href="#cb6-250" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Hence, an association in one stratum and not the other will make</span>
<span id="cb6-251"><a href="#cb6-251" aria-hidden="true" tabindex="-1"></a>        an adjusted analysis look like an association (provide the</span>
<span id="cb6-252"><a href="#cb6-252" aria-hidden="true" tabindex="-1"></a>        sample size is large enough)</span>
<span id="cb6-253"><a href="#cb6-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-254"><a href="#cb6-254" aria-hidden="true" tabindex="-1"></a><span class="fu">## Confounding</span></span>
<span id="cb6-255"><a href="#cb6-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-256"><a href="#cb6-256" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simpson's Paradox</span></span>
<span id="cb6-257"><a href="#cb6-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-258"><a href="#cb6-258" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Confounding has its roots in Simpson's Paradox</span>
<span id="cb6-259"><a href="#cb6-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-260"><a href="#cb6-260" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Given binary variables $Y$ (response), $X$ (POI), and $Z$ (strata)</span>
<span id="cb6-261"><a href="#cb6-261" aria-hidden="true" tabindex="-1"></a>    it is possible to have ...</span>
<span id="cb6-262"><a href="#cb6-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-263"><a href="#cb6-263" aria-hidden="true" tabindex="-1"></a>$$\textrm{Pr}(Y=1 | X=1, Z=1) &gt; \textrm{Pr}(Y=1 | X=0, Z=1)$$</span>
<span id="cb6-264"><a href="#cb6-264" aria-hidden="true" tabindex="-1"></a>$$\textrm{Pr}(Y=1 | X=1, Z=0) &gt; \textrm{Pr}(Y=1 | X=0, Z=0)$$</span>
<span id="cb6-265"><a href="#cb6-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-266"><a href="#cb6-266" aria-hidden="true" tabindex="-1"></a>... but to also have ...</span>
<span id="cb6-267"><a href="#cb6-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-268"><a href="#cb6-268" aria-hidden="true" tabindex="-1"></a>$$\textrm{Pr}(Y=1 | X=1) &lt; \textrm{Pr}(Y=1 | X=0)$$</span>
<span id="cb6-269"><a href="#cb6-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-270"><a href="#cb6-270" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Example: Probability of death (Y) at two hospitals (X) stratified by poor patient condition (Z)</span></span>
<span id="cb6-271"><a href="#cb6-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-272"><a href="#cb6-272" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Question: Which hospital do you want to be treated at?</span>
<span id="cb6-273"><a href="#cb6-273" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Consider the results overall (averaging over Z) and conditional</span>
<span id="cb6-274"><a href="#cb6-274" aria-hidden="true" tabindex="-1"></a>        on Z below</span>
<span id="cb6-275"><a href="#cb6-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-276"><a href="#cb6-276" aria-hidden="true" tabindex="-1"></a>| Overall    | Died | Survived | Death Rate |</span>
<span id="cb6-277"><a href="#cb6-277" aria-hidden="true" tabindex="-1"></a>|------------|------|----------|------------|</span>
<span id="cb6-278"><a href="#cb6-278" aria-hidden="true" tabindex="-1"></a>| Hospital A | 16   | 784      | 2.0%       |</span>
<span id="cb6-279"><a href="#cb6-279" aria-hidden="true" tabindex="-1"></a>| Hospital B | 63   | 2037     | 3.0%       |</span>
<span id="cb6-280"><a href="#cb6-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-281"><a href="#cb6-281" aria-hidden="true" tabindex="-1"></a>| Good Condition | Died | Survived | Death Rate |</span>
<span id="cb6-282"><a href="#cb6-282" aria-hidden="true" tabindex="-1"></a>|----------------|------|----------|------------|</span>
<span id="cb6-283"><a href="#cb6-283" aria-hidden="true" tabindex="-1"></a>| Hospital A     | 8    | 592      | 1.3%       |</span>
<span id="cb6-284"><a href="#cb6-284" aria-hidden="true" tabindex="-1"></a>| Hospital B     | 6    | 594      | 1.0%       |</span>
<span id="cb6-285"><a href="#cb6-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-286"><a href="#cb6-286" aria-hidden="true" tabindex="-1"></a>| Poor Condition | Died | Survived | Death Rate |</span>
<span id="cb6-287"><a href="#cb6-287" aria-hidden="true" tabindex="-1"></a>|----------------|------|----------|------------|</span>
<span id="cb6-288"><a href="#cb6-288" aria-hidden="true" tabindex="-1"></a>| Hospital A     | 8    | 192      | 4.0%       |</span>
<span id="cb6-289"><a href="#cb6-289" aria-hidden="true" tabindex="-1"></a>| Hospital B     | 57   | 1443     | 3.8%       |</span>
<span id="cb6-290"><a href="#cb6-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-291"><a href="#cb6-291" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ignoring condition, Hospital B has a **higher** death rather.</span>
<span id="cb6-292"><a href="#cb6-292" aria-hidden="true" tabindex="-1"></a>    However, within both poor and good condition, Hospital B has a</span>
<span id="cb6-293"><a href="#cb6-293" aria-hidden="true" tabindex="-1"></a>    **lower** death rate.</span>
<span id="cb6-294"><a href="#cb6-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-295"><a href="#cb6-295" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Poor condition is a confounder. Hospital B has more subjects</span>
<span id="cb6-296"><a href="#cb6-296" aria-hidden="true" tabindex="-1"></a>        with poor condition and subjects with poor condition have a</span>
<span id="cb6-297"><a href="#cb6-297" aria-hidden="true" tabindex="-1"></a>        higher death rate.</span>
<span id="cb6-298"><a href="#cb6-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-299"><a href="#cb6-299" aria-hidden="true" tabindex="-1"></a><span class="fu">### Definition of Confounding</span></span>
<span id="cb6-300"><a href="#cb6-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-301"><a href="#cb6-301" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The association between a predictor of interest and the response is</span>
<span id="cb6-302"><a href="#cb6-302" aria-hidden="true" tabindex="-1"></a>    confounded by a third variable if</span>
<span id="cb6-303"><a href="#cb6-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-304"><a href="#cb6-304" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The third variable is associated with the predictor of interest</span>
<span id="cb6-305"><a href="#cb6-305" aria-hidden="true" tabindex="-1"></a>        in the sample, AND</span>
<span id="cb6-306"><a href="#cb6-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-307"><a href="#cb6-307" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The third variable is associated with the response</span>
<span id="cb6-308"><a href="#cb6-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-309"><a href="#cb6-309" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Causally (in truth)</span>
<span id="cb6-310"><a href="#cb6-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-311"><a href="#cb6-311" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>In groups that are homogeneous with respect to the predictor</span>
<span id="cb6-312"><a href="#cb6-312" aria-hidden="true" tabindex="-1"></a>            of interest</span>
<span id="cb6-313"><a href="#cb6-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-314"><a href="#cb6-314" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Not in the causal pathway of interest</span>
<span id="cb6-315"><a href="#cb6-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-316"><a href="#cb6-316" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We must consider our belief about the causal relationships among the</span>
<span id="cb6-317"><a href="#cb6-317" aria-hidden="true" tabindex="-1"></a>    measured variables</span>
<span id="cb6-318"><a href="#cb6-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-319"><a href="#cb6-319" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>There is no statistical test for causality</span>
<span id="cb6-320"><a href="#cb6-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-321"><a href="#cb6-321" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Inference about causation comes only from the study design</span>
<span id="cb6-322"><a href="#cb6-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-323"><a href="#cb6-323" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>BUT, consideration of the causal relationships helps us to</span>
<span id="cb6-324"><a href="#cb6-324" aria-hidden="true" tabindex="-1"></a>        decide which statistical questions to answer</span>
<span id="cb6-325"><a href="#cb6-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-326"><a href="#cb6-326" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Classic confounder</span>
<span id="cb6-327"><a href="#cb6-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-328"><a href="#cb6-328" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A clear case of confounding occurs when some third variable is a</span>
<span id="cb6-329"><a href="#cb6-329" aria-hidden="true" tabindex="-1"></a>        "cause" of both the POI and response</span>
<span id="cb6-330"><a href="#cb6-330" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We generally adjust for such a confounder</span>
<span id="cb6-331"><a href="#cb6-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-332"><a href="#cb6-332" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Directed Acyclyic Graph</span></span>
<span id="cb6-333"><a href="#cb6-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-336"><a href="#cb6-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb6-337"><a href="#cb6-337" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb6-338"><a href="#cb6-338" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Predictor\nof interest] -- Causal? --&gt; Y[Outcome]</span></span>
<span id="cb6-339"><a href="#cb6-339" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Predictor\nof interest] &lt;-- Association --&gt; Z[Confounder]</span></span>
<span id="cb6-340"><a href="#cb6-340" aria-hidden="true" tabindex="-1"></a><span class="in">  Z[Confounder] -- Causal --&gt; Y[Outcome]</span></span>
<span id="cb6-341"><a href="#cb6-341" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-342"><a href="#cb6-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-343"><a href="#cb6-343" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Example: Ice cream (POI), murder rate (outcome), and temperature</span>
<span id="cb6-344"><a href="#cb6-344" aria-hidden="true" tabindex="-1"></a>    (confounder) in New York City during the summer</span>
<span id="cb6-345"><a href="#cb6-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-348"><a href="#cb6-348" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb6-349"><a href="#cb6-349" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb6-350"><a href="#cb6-350" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Ice Cream] -- Causal? --&gt; Y[Murder Rate]</span></span>
<span id="cb6-351"><a href="#cb6-351" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Ice Cream] &lt;-- Association --&gt; Z[Air temperature]</span></span>
<span id="cb6-352"><a href="#cb6-352" aria-hidden="true" tabindex="-1"></a><span class="in">  Z[Air temperature] -- Causal --&gt; Y[Murder Rate]</span></span>
<span id="cb6-353"><a href="#cb6-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-354"><a href="#cb6-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-355"><a href="#cb6-355" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Causal pathways</span></span>
<span id="cb6-356"><a href="#cb6-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-357"><a href="#cb6-357" aria-hidden="true" tabindex="-1"></a><span class="fu">##### A variable in the causal pathway of interest</span></span>
<span id="cb6-358"><a href="#cb6-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-359"><a href="#cb6-359" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Not a confounder, so we would not adjust for such a variable</span>
<span id="cb6-360"><a href="#cb6-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-361"><a href="#cb6-361" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If we did adjust, we would lose ability to detect associations</span>
<span id="cb6-362"><a href="#cb6-362" aria-hidden="true" tabindex="-1"></a>    between the POI and the outcome</span>
<span id="cb6-363"><a href="#cb6-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-364"><a href="#cb6-364" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Example: Second hand smoke (POI), stunted growth (confounder), FEV1</span>
<span id="cb6-365"><a href="#cb6-365" aria-hidden="true" tabindex="-1"></a>    (outcome)</span>
<span id="cb6-366"><a href="#cb6-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-367"><a href="#cb6-367" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Scientific question is about the impact of smoking on lung</span>
<span id="cb6-368"><a href="#cb6-368" aria-hidden="true" tabindex="-1"></a>        function</span>
<span id="cb6-369"><a href="#cb6-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-370"><a href="#cb6-370" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Stunted growth addresses lung anatomy, not lung function,</span>
<span id="cb6-371"><a href="#cb6-371" aria-hidden="true" tabindex="-1"></a>            which we don't care about it</span>
<span id="cb6-372"><a href="#cb6-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-375"><a href="#cb6-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb6-376"><a href="#cb6-376" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb6-377"><a href="#cb6-377" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Second hand smoke] --&gt; Y[FEV1]</span></span>
<span id="cb6-378"><a href="#cb6-378" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Second hand smoke] --&gt; Z[Stuntend growth]</span></span>
<span id="cb6-379"><a href="#cb6-379" aria-hidden="true" tabindex="-1"></a><span class="in">  Z[Stunted growth] --&gt; Y[FEV1]</span></span>
<span id="cb6-380"><a href="#cb6-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-381"><a href="#cb6-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-382"><a href="#cb6-382" aria-hidden="true" tabindex="-1"></a><span class="fu">##### A variable in the causal pathway *not* of interest</span></span>
<span id="cb6-383"><a href="#cb6-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-384"><a href="#cb6-384" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>However, we want to adjust for a variable in a causal pathway that</span>
<span id="cb6-385"><a href="#cb6-385" aria-hidden="true" tabindex="-1"></a>    is not of interest</span>
<span id="cb6-386"><a href="#cb6-386" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Example: Work stress causing ulcers by hormonal effects versus</span>
<span id="cb6-387"><a href="#cb6-387" aria-hidden="true" tabindex="-1"></a>        alcoholism</span>
<span id="cb6-388"><a href="#cb6-388" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Directed Acyclyic Graph</span>
<span id="cb6-389"><a href="#cb6-389" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>We can adjust for alcoholism to estimate the path through</span>
<span id="cb6-390"><a href="#cb6-390" aria-hidden="true" tabindex="-1"></a>            horomonal effects</span>
<span id="cb6-391"><a href="#cb6-391" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Alternatively, we can adjust for hormonal effects to</span>
<span id="cb6-392"><a href="#cb6-392" aria-hidden="true" tabindex="-1"></a>            estimate the effect through alcoholism</span>
<span id="cb6-393"><a href="#cb6-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-396"><a href="#cb6-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb6-397"><a href="#cb6-397" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb6-398"><a href="#cb6-398" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Work stress] --&gt; W[Hormonal Effects]</span></span>
<span id="cb6-399"><a href="#cb6-399" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Work Stress] --&gt; Z[Alcholism]</span></span>
<span id="cb6-400"><a href="#cb6-400" aria-hidden="true" tabindex="-1"></a><span class="in">  W[Hormonal Effects] --&gt; Y[Ulcers]</span></span>
<span id="cb6-401"><a href="#cb6-401" aria-hidden="true" tabindex="-1"></a><span class="in">  Z[Alcholism] --&gt; Y[Ulcers]</span></span>
<span id="cb6-402"><a href="#cb6-402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-403"><a href="#cb6-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-404"><a href="#cb6-404" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Surrogate for response</span></span>
<span id="cb6-405"><a href="#cb6-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-406"><a href="#cb6-406" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjustment for a surrogate is a bad idea</span>
<span id="cb6-407"><a href="#cb6-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-408"><a href="#cb6-408" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As the name implies, surrogates are a substitute for the response</span>
<span id="cb6-409"><a href="#cb6-409" aria-hidden="true" tabindex="-1"></a>    variable</span>
<span id="cb6-410"><a href="#cb6-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-411"><a href="#cb6-411" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Directed Acyclyic Graph where forced vital capacity (FVC) is a</span>
<span id="cb6-412"><a href="#cb6-412" aria-hidden="true" tabindex="-1"></a>    surrogate for forced exp</span>
<span id="cb6-413"><a href="#cb6-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-416"><a href="#cb6-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb6-417"><a href="#cb6-417" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb6-418"><a href="#cb6-418" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Second hand smoke] --&gt; Z[FVC]</span></span>
<span id="cb6-419"><a href="#cb6-419" aria-hidden="true" tabindex="-1"></a><span class="in">  Z[FVC] --&gt; Y[FEV1]</span></span>
<span id="cb6-420"><a href="#cb6-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-421"><a href="#cb6-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-422"><a href="#cb6-422" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Many other (complicated) patterns possible</span></span>
<span id="cb6-423"><a href="#cb6-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-424"><a href="#cb6-424" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Greenland, Pearl, and Robins. Causal Diagrams for Epidemiologic</span>
<span id="cb6-425"><a href="#cb6-425" aria-hidden="true" tabindex="-1"></a>    Research. Epidemiology. (1999) <span class="ot">&lt;http://www.jstor.org/stable/3702180&gt;</span></span>
<span id="cb6-426"><a href="#cb6-426" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="ot">&lt;https://www.dagitty.net/&gt;</span></span>
<span id="cb6-427"><a href="#cb6-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-428"><a href="#cb6-428" aria-hidden="true" tabindex="-1"></a><span class="fu">### Diagnosing Confounding</span></span>
<span id="cb6-429"><a href="#cb6-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-430"><a href="#cb6-430" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Confounding typically produces a difference between unadjusted and</span>
<span id="cb6-431"><a href="#cb6-431" aria-hidden="true" tabindex="-1"></a>    adjusted analyses</span>
<span id="cb6-432"><a href="#cb6-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-433"><a href="#cb6-433" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>This symptom is not proof of confounding</span>
<span id="cb6-434"><a href="#cb6-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-435"><a href="#cb6-435" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Such a difference can occur when there is no confounding</span>
<span id="cb6-436"><a href="#cb6-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-437"><a href="#cb6-437" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Symptom is more indicative of confounding when modeling</span>
<span id="cb6-438"><a href="#cb6-438" aria-hidden="true" tabindex="-1"></a>            means (linear regression) than when modeling odds (logistic</span>
<span id="cb6-439"><a href="#cb6-439" aria-hidden="true" tabindex="-1"></a>            regression) or hazards (Cox, proportional hazards</span>
<span id="cb6-440"><a href="#cb6-440" aria-hidden="true" tabindex="-1"></a>            regression)</span>
<span id="cb6-441"><a href="#cb6-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-442"><a href="#cb6-442" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimates of association from unadjusted analysis are markedly</span>
<span id="cb6-443"><a href="#cb6-443" aria-hidden="true" tabindex="-1"></a>    different from estimates of association from adjusted analysis</span>
<span id="cb6-444"><a href="#cb6-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-445"><a href="#cb6-445" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Association within each stratum is similar to each other, but</span>
<span id="cb6-446"><a href="#cb6-446" aria-hidden="true" tabindex="-1"></a>        different from the association in the combined data</span>
<span id="cb6-447"><a href="#cb6-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-448"><a href="#cb6-448" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In linear regression, differences between adjusted and unadjusted</span>
<span id="cb6-449"><a href="#cb6-449" aria-hidden="true" tabindex="-1"></a>    analyses are diagnostic of confounding</span>
<span id="cb6-450"><a href="#cb6-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-451"><a href="#cb6-451" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Precision variables tend to change standard errors, but not</span>
<span id="cb6-452"><a href="#cb6-452" aria-hidden="true" tabindex="-1"></a>        slope estimates</span>
<span id="cb6-453"><a href="#cb6-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-454"><a href="#cb6-454" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Effect modification would show differences between adjusted</span>
<span id="cb6-455"><a href="#cb6-455" aria-hidden="true" tabindex="-1"></a>        analysis and unadjusted analysis, but would also show different</span>
<span id="cb6-456"><a href="#cb6-456" aria-hidden="true" tabindex="-1"></a>        associations in the strata</span>
<span id="cb6-457"><a href="#cb6-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-458"><a href="#cb6-458" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>More difficult to diagnosis confounding with non-linear functions of</span>
<span id="cb6-459"><a href="#cb6-459" aria-hidden="true" tabindex="-1"></a>    the mean</span>
<span id="cb6-460"><a href="#cb6-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-461"><a href="#cb6-461" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Common non-linear functions: Odds (odds ratios), hazards (hazard</span>
<span id="cb6-462"><a href="#cb6-462" aria-hidden="true" tabindex="-1"></a>        ratios)</span>
<span id="cb6-463"><a href="#cb6-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-464"><a href="#cb6-464" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>May show the symptoms of confounding when confounding is not</span>
<span id="cb6-465"><a href="#cb6-465" aria-hidden="true" tabindex="-1"></a>        present</span>
<span id="cb6-466"><a href="#cb6-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-467"><a href="#cb6-467" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Adjusting for precision variables can appear to be confounding</span>
<span id="cb6-468"><a href="#cb6-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-469"><a href="#cb6-469" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>In logistic and PH regression, difference between adjusted and</span>
<span id="cb6-470"><a href="#cb6-470" aria-hidden="true" tabindex="-1"></a>        unadjusted analyses are more difficult to judge</span>
<span id="cb6-471"><a href="#cb6-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-472"><a href="#cb6-472" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Comparison in more homogeneous groups (i.e. after adjustment</span>
<span id="cb6-473"><a href="#cb6-473" aria-hidden="true" tabindex="-1"></a>            for a precision variable) will drive slope estimates away</span>
<span id="cb6-474"><a href="#cb6-474" aria-hidden="true" tabindex="-1"></a>            from the null</span>
<span id="cb6-475"><a href="#cb6-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-476"><a href="#cb6-476" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Example: Suppose you have a sample where 50% of the subjects die</span>
<span id="cb6-477"><a href="#cb6-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-478"><a href="#cb6-478" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>What is the variability? $p*(1-p)=0.25$</span>
<span id="cb6-479"><a href="#cb6-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-480"><a href="#cb6-480" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We can reduce this variability by changing $p$, the probability</span>
<span id="cb6-481"><a href="#cb6-481" aria-hidden="true" tabindex="-1"></a>        of death</span>
<span id="cb6-482"><a href="#cb6-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-483"><a href="#cb6-483" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Estimate $p$ in different stratum. One stratum may have a higher</span>
<span id="cb6-484"><a href="#cb6-484" aria-hidden="true" tabindex="-1"></a>        $p$, another a lower $p$.</span>
<span id="cb6-485"><a href="#cb6-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-486"><a href="#cb6-486" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>e.g. Stratum 1, 20% death rate and Stratum 2 an 80% death</span>
<span id="cb6-487"><a href="#cb6-487" aria-hidden="true" tabindex="-1"></a>            rate.</span>
<span id="cb6-488"><a href="#cb6-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-489"><a href="#cb6-489" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>By making the estimate more precise, we have also impacted the</span>
<span id="cb6-490"><a href="#cb6-490" aria-hidden="true" tabindex="-1"></a>        mean</span>
<span id="cb6-491"><a href="#cb6-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-492"><a href="#cb6-492" aria-hidden="true" tabindex="-1"></a><span class="fu">## Mediating variables</span></span>
<span id="cb6-493"><a href="#cb6-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-494"><a href="#cb6-494" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>A mediating variable is a predictor hypothesized to lie on the</span>
<span id="cb6-495"><a href="#cb6-495" aria-hidden="true" tabindex="-1"></a>    causal pathway between a predictor of interest and the outcome</span>
<span id="cb6-496"><a href="#cb6-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-497"><a href="#cb6-497" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Whether or not to adjust for a mediating variable depends on the</span>
<span id="cb6-498"><a href="#cb6-498" aria-hidden="true" tabindex="-1"></a>    scientific question of interest</span>
<span id="cb6-499"><a href="#cb6-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-500"><a href="#cb6-500" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Without adjustment, we are estimating the **total** (causal)</span>
<span id="cb6-501"><a href="#cb6-501" aria-hidden="true" tabindex="-1"></a>        effect of the predictor of interest via all pathways on the</span>
<span id="cb6-502"><a href="#cb6-502" aria-hidden="true" tabindex="-1"></a>        outcome</span>
<span id="cb6-503"><a href="#cb6-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-504"><a href="#cb6-504" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If we adjust for a mediator, we are estimating the **direct**</span>
<span id="cb6-505"><a href="#cb6-505" aria-hidden="true" tabindex="-1"></a>        (causal) effect via other pathways that do not involve the</span>
<span id="cb6-506"><a href="#cb6-506" aria-hidden="true" tabindex="-1"></a>        mediator</span>
<span id="cb6-507"><a href="#cb6-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-508"><a href="#cb6-508" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If a potential mediator is identified *a priori* on scientific</span>
<span id="cb6-509"><a href="#cb6-509" aria-hidden="true" tabindex="-1"></a>    grounds, we can estimate the **direct** effect via pathways other</span>
<span id="cb6-510"><a href="#cb6-510" aria-hidden="true" tabindex="-1"></a>    than the mediator, the **indirect** effect through the mediator, and</span>
<span id="cb6-511"><a href="#cb6-511" aria-hidden="true" tabindex="-1"></a>    the degree of mediation (e.g. **proportion mediated**).</span>
<span id="cb6-512"><a href="#cb6-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-513"><a href="#cb6-513" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Example: Depression (predictor) and Crohn's Disease activitity</span>
<span id="cb6-514"><a href="#cb6-514" aria-hidden="true" tabindex="-1"></a>    (outcome) with possible mediators being physical activity, smoking,</span>
<span id="cb6-515"><a href="#cb6-515" aria-hidden="true" tabindex="-1"></a>    and sleep quality</span>
<span id="cb6-516"><a href="#cb6-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-517"><a href="#cb6-517" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Mediation models were considered using baseline, 6-month, and</span>
<span id="cb6-518"><a href="#cb6-518" aria-hidden="true" tabindex="-1"></a>        12-month follow-up data</span>
<span id="cb6-519"><a href="#cb6-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-520"><a href="#cb6-520" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Depression at baseline was the predictor of interest, mediators</span>
<span id="cb6-521"><a href="#cb6-521" aria-hidden="true" tabindex="-1"></a>        were assessed at 6 months, and disease activity at 12 months was</span>
<span id="cb6-522"><a href="#cb6-522" aria-hidden="true" tabindex="-1"></a>        the outcome.</span>
<span id="cb6-523"><a href="#cb6-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-524"><a href="#cb6-524" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>To establish and estimate the mediation effect, we utilized the</span>
<span id="cb6-525"><a href="#cb6-525" aria-hidden="true" tabindex="-1"></a>        four steps originally outlined by Barron and Kenny <span class="ot">[^1]</span></span>
<span id="cb6-526"><a href="#cb6-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-527"><a href="#cb6-527" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>First, we tested that there was a significant effect of</span>
<span id="cb6-528"><a href="#cb6-528" aria-hidden="true" tabindex="-1"></a>            depression at baseline with disease activity at 12 months to</span>
<span id="cb6-529"><a href="#cb6-529" aria-hidden="true" tabindex="-1"></a>            establish there was an effect to be mediated</span>
<span id="cb6-530"><a href="#cb6-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-531"><a href="#cb6-531" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Second, we estimated the correlation between depression at</span>
<span id="cb6-532"><a href="#cb6-532" aria-hidden="true" tabindex="-1"></a>            baseline and each of the potential mediators measured at 6</span>
<span id="cb6-533"><a href="#cb6-533" aria-hidden="true" tabindex="-1"></a>            months</span>
<span id="cb6-534"><a href="#cb6-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-535"><a href="#cb6-535" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Third, we tested if each of the mediators at 6 months was</span>
<span id="cb6-536"><a href="#cb6-536" aria-hidden="true" tabindex="-1"></a>            associated with disease activity at 12 months while</span>
<span id="cb6-537"><a href="#cb6-537" aria-hidden="true" tabindex="-1"></a>            controlling for disease activity at baseline.</span>
<span id="cb6-538"><a href="#cb6-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-539"><a href="#cb6-539" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Fourth, the mediation package in R was used to estimate</span>
<span id="cb6-540"><a href="#cb6-540" aria-hidden="true" tabindex="-1"></a>            various quantities for causal mediation analysis, including</span>
<span id="cb6-541"><a href="#cb6-541" aria-hidden="true" tabindex="-1"></a>            average causal mediation effects (indirect effect), average</span>
<span id="cb6-542"><a href="#cb6-542" aria-hidden="true" tabindex="-1"></a>            direct effects, proportions mediated, and total effect. This</span>
<span id="cb6-543"><a href="#cb6-543" aria-hidden="true" tabindex="-1"></a>            step involves combining estimates from the mediator model</span>
<span id="cb6-544"><a href="#cb6-544" aria-hidden="true" tabindex="-1"></a>            (mediator at 6 months outcome, depression at baseline the</span>
<span id="cb6-545"><a href="#cb6-545" aria-hidden="true" tabindex="-1"></a>            predictor) and estimates from the outcome model (disease</span>
<span id="cb6-546"><a href="#cb6-546" aria-hidden="true" tabindex="-1"></a>            activity at 12 months outcome, mediator at 6 months and</span>
<span id="cb6-547"><a href="#cb6-547" aria-hidden="true" tabindex="-1"></a>            depression at baseline as predictors of interest, and</span>
<span id="cb6-548"><a href="#cb6-548" aria-hidden="true" tabindex="-1"></a>            controlling for disease activity at baseline) efficiently</span>
<span id="cb6-549"><a href="#cb6-549" aria-hidden="true" tabindex="-1"></a>            and with appropriate standard error estimates.</span>
<span id="cb6-550"><a href="#cb6-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-551"><a href="#cb6-551" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Results</span>
<span id="cb6-552"><a href="#cb6-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-553"><a href="#cb6-553" aria-hidden="true" tabindex="-1"></a><span class="ot">[^1]: </span>Baron RM, Kenny DA. The moderator-mediator variable distinction in</span>
<span id="cb6-554"><a href="#cb6-554" aria-hidden="true" tabindex="-1"></a>    social psychological research: conceptual, strategic, and</span>
<span id="cb6-555"><a href="#cb6-555" aria-hidden="true" tabindex="-1"></a>    statistical considerations. J Pers Soc Psychol. 1986</span>
<span id="cb6-556"><a href="#cb6-556" aria-hidden="true" tabindex="-1"></a>    Dec;51(6):1173-82. doi: 10.1037//0022-3514.51.6.1173. PMID: 3806354.</span>
<span id="cb6-557"><a href="#cb6-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-558"><a href="#cb6-558" aria-hidden="true" tabindex="-1"></a>![Multiple mediation model path diagram and estimates from structural</span>
<span id="cb6-559"><a href="#cb6-559" aria-hidden="true" tabindex="-1"></a>equations model. Part A shows the total effect of depression at baseline</span>
<span id="cb6-560"><a href="#cb6-560" aria-hidden="true" tabindex="-1"></a>on disease activity at 12 months is that, per one unit increase in</span>
<span id="cb6-561"><a href="#cb6-561" aria-hidden="true" tabindex="-1"></a>depression, disease activity increases by 2.90. Part B show the</span>
<span id="cb6-562"><a href="#cb6-562" aria-hidden="true" tabindex="-1"></a>associations of depression at baseline, mediators at 6 months, and</span>
<span id="cb6-563"><a href="#cb6-563" aria-hidden="true" tabindex="-1"></a>disease activity at 12 months. Individual mediation effects are found by</span>
<span id="cb6-564"><a href="#cb6-564" aria-hidden="true" tabindex="-1"></a>multiplying a by b for each mediator. Of the 2.90 total effect, 0.005</span>
<span id="cb6-565"><a href="#cb6-565" aria-hidden="true" tabindex="-1"></a>went through sleep, 0.138 went through smoking and 0.107 went through</span>
<span id="cb6-566"><a href="#cb6-566" aria-hidden="true" tabindex="-1"></a>activity. Summing these three value, a total of 0.250 (8.6% mediated)</span>
<span id="cb6-567"><a href="#cb6-567" aria-hidden="true" tabindex="-1"></a>when through the three</span>
<span id="cb6-568"><a href="#cb6-568" aria-hidden="true" tabindex="-1"></a>mediators.](figures/multiplemediation.png){width="150%"}</span>
<span id="cb6-569"><a href="#cb6-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-570"><a href="#cb6-570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Precision Variables</span></span>
<span id="cb6-571"><a href="#cb6-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-572"><a href="#cb6-572" aria-hidden="true" tabindex="-1"></a><span class="fu">### Overview</span></span>
<span id="cb6-573"><a href="#cb6-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-574"><a href="#cb6-574" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sometimes the scientific question to be answered is chosen based on</span>
<span id="cb6-575"><a href="#cb6-575" aria-hidden="true" tabindex="-1"></a>    which questions can be answered most precisely</span>
<span id="cb6-576"><a href="#cb6-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-577"><a href="#cb6-577" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In general, questions can be answered more precisely when the within</span>
<span id="cb6-578"><a href="#cb6-578" aria-hidden="true" tabindex="-1"></a>    group distribution is less variable</span>
<span id="cb6-579"><a href="#cb6-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-580"><a href="#cb6-580" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Comparing groups that are similar with respect to other important</span>
<span id="cb6-581"><a href="#cb6-581" aria-hidden="true" tabindex="-1"></a>    risk factors decreases variability</span>
<span id="cb6-582"><a href="#cb6-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-583"><a href="#cb6-583" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The precision variability is independent of the cause of the</span>
<span id="cb6-584"><a href="#cb6-584" aria-hidden="true" tabindex="-1"></a>    response</span>
<span id="cb6-585"><a href="#cb6-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-586"><a href="#cb6-586" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If we adjust for such a variable, we tend to gain precision</span>
<span id="cb6-587"><a href="#cb6-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-588"><a href="#cb6-588" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Directed Acyclyic Graph:</span>
<span id="cb6-589"><a href="#cb6-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-592"><a href="#cb6-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb6-593"><a href="#cb6-593" aria-hidden="true" tabindex="-1"></a><span class="in">flowchart LR</span></span>
<span id="cb6-594"><a href="#cb6-594" aria-hidden="true" tabindex="-1"></a><span class="in">  X[Predictor] --&gt; Y[Outcome]</span></span>
<span id="cb6-595"><a href="#cb6-595" aria-hidden="true" tabindex="-1"></a><span class="in">  Z[Precision] --&gt; Y[Outcome]</span></span>
<span id="cb6-596"><a href="#cb6-596" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-597"><a href="#cb6-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-598"><a href="#cb6-598" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adjusting for Precision Variables</span></span>
<span id="cb6-599"><a href="#cb6-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-600"><a href="#cb6-600" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Precision for Difference of Independent Means</span></span>
<span id="cb6-601"><a href="#cb6-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-602"><a href="#cb6-602" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Independent observations where group 1 has a different mean and</span>
<span id="cb6-603"><a href="#cb6-603" aria-hidden="true" tabindex="-1"></a>    variance than group 2</span>
<span id="cb6-604"><a href="#cb6-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-605"><a href="#cb6-605" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\textrm{ind } Y_{ij} \sim (\mu_j, \sigma_j^2), j = 1, 2; i = 1, \ldots, n_j$</span>
<span id="cb6-606"><a href="#cb6-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-607"><a href="#cb6-607" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$n = n_1 + n_2$; $r = n_1 / n_2$</span>
<span id="cb6-608"><a href="#cb6-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-609"><a href="#cb6-609" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\theta = \mu_1 - \mu_2$,</span>
<span id="cb6-610"><a href="#cb6-610" aria-hidden="true" tabindex="-1"></a>        $\hat{\theta} = \overline{Y}_1 - \overline{Y}_2$</span>
<span id="cb6-611"><a href="#cb6-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-612"><a href="#cb6-612" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$V = (r+1)(\frac{\sigma_1^2}{r} + \sigma_2^2)$</span>
<span id="cb6-613"><a href="#cb6-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-614"><a href="#cb6-614" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$se(\hat{\theta}) = \sqrt{\frac{V}{n}} = \sqrt{\frac{\sigma_1^2}{n_1} + \frac{\sigma_2^2}{n_2}}$</span>
<span id="cb6-615"><a href="#cb6-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-616"><a href="#cb6-616" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Might control for some variable in order to decrease the within</span>
<span id="cb6-617"><a href="#cb6-617" aria-hidden="true" tabindex="-1"></a>    group variability</span>
<span id="cb6-618"><a href="#cb6-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-619"><a href="#cb6-619" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Restrict population sampled</span>
<span id="cb6-620"><a href="#cb6-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-621"><a href="#cb6-621" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Standardize ancillary treatments</span>
<span id="cb6-622"><a href="#cb6-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-623"><a href="#cb6-623" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Standardize measurement procedure</span>
<span id="cb6-624"><a href="#cb6-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-625"><a href="#cb6-625" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Precision for Linear Regression</span></span>
<span id="cb6-626"><a href="#cb6-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-627"><a href="#cb6-627" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Independent continuous outcome associated with covariate ($X$)</span>
<span id="cb6-628"><a href="#cb6-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-629"><a href="#cb6-629" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\textrm{ind } Y_i | X_i ~ \sim(\beta_0 + \beta_1 X_i, \sigma^2_{Y|X}), i = 1, \ldots, n$</span>
<span id="cb6-630"><a href="#cb6-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-631"><a href="#cb6-631" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\theta = \beta_1, \hat{\theta} = \hat{\beta_1}$ from LS</span>
<span id="cb6-632"><a href="#cb6-632" aria-hidden="true" tabindex="-1"></a>        regression</span>
<span id="cb6-633"><a href="#cb6-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-634"><a href="#cb6-634" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$V = \frac{\sigma^2_{Y|X}}{\textrm{Var}(X)}$</span>
<span id="cb6-635"><a href="#cb6-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-636"><a href="#cb6-636" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$se(\hat{\theta}) = \sqrt{\frac{\hat{\sigma}^2_{Y|X}}{n \hat{\textrm{Var}}(X)}}$</span>
<span id="cb6-637"><a href="#cb6-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-638"><a href="#cb6-638" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjusting for covariates ($W$) decreases the within group standard</span>
<span id="cb6-639"><a href="#cb6-639" aria-hidden="true" tabindex="-1"></a>    deviation</span>
<span id="cb6-640"><a href="#cb6-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-641"><a href="#cb6-641" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\textrm{Var}(Y | X)$ versus $\textrm{Var}(Y | X, W)$</span>
<span id="cb6-642"><a href="#cb6-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-643"><a href="#cb6-643" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Independent continuous outcome associated with covariate ($X$) and</span>
<span id="cb6-644"><a href="#cb6-644" aria-hidden="true" tabindex="-1"></a>    precision variable ($W$)</span>
<span id="cb6-645"><a href="#cb6-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-646"><a href="#cb6-646" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\textrm{ind } Y_i | X_i, W_i ~ \sim(\beta_0 + \beta_1 X_i + \beta_2 W_i, \sigma^2_{Y|X,W}), i = 1, \ldots, n$</span>
<span id="cb6-647"><a href="#cb6-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-648"><a href="#cb6-648" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\theta = \beta_1, \hat{\theta} = \hat{\beta_1}$ from LS</span>
<span id="cb6-649"><a href="#cb6-649" aria-hidden="true" tabindex="-1"></a>        regression</span>
<span id="cb6-650"><a href="#cb6-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-651"><a href="#cb6-651" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$V = \frac{\sigma^2_{Y|X,W}}{\textrm{Var}(X)(1-r^2_{X,W})}$</span>
<span id="cb6-652"><a href="#cb6-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-653"><a href="#cb6-653" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$se(\hat{\theta}) = \sqrt{\frac{\hat{\sigma}^2_{Y|X,W}}{n \hat{\textrm{Var}}(X)(1-r^2_{X,W})}}$</span>
<span id="cb6-654"><a href="#cb6-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-655"><a href="#cb6-655" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\sigma^2_{Y|X,W} = \sigma^2_{Y|X} - \beta_2^2 \textrm{Var}(W | X)$</span>
<span id="cb6-656"><a href="#cb6-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-657"><a href="#cb6-657" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Precision for Difference of Proportions</span></span>
<span id="cb6-658"><a href="#cb6-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-659"><a href="#cb6-659" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When analyzing proportions (means), the mean variance relationship</span>
<span id="cb6-660"><a href="#cb6-660" aria-hidden="true" tabindex="-1"></a>    is critical</span>
<span id="cb6-661"><a href="#cb6-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-662"><a href="#cb6-662" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Precision is greatest when proportion is close to 0 or 1</span>
<span id="cb6-663"><a href="#cb6-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-664"><a href="#cb6-664" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Greater homogeneity of groups makes results more deterministic</span>
<span id="cb6-665"><a href="#cb6-665" aria-hidden="true" tabindex="-1"></a>        (this is the goal, at least)</span>
<span id="cb6-666"><a href="#cb6-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-667"><a href="#cb6-667" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Independent binary outcomes</span>
<span id="cb6-668"><a href="#cb6-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-669"><a href="#cb6-669" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\textrm{ind } Y_{ij} \sim B(1, p_j), i = 1, \ldots, n_j; j = 1, 2$</span>
<span id="cb6-670"><a href="#cb6-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-671"><a href="#cb6-671" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$n = n_1 + n_2; r = n_1 / n_2$</span>
<span id="cb6-672"><a href="#cb6-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-673"><a href="#cb6-673" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\theta = p_1 - p_2$,</span>
<span id="cb6-674"><a href="#cb6-674" aria-hidden="true" tabindex="-1"></a>        $\hat{\theta} = \hat{p}_1 - \hat{p_2} = \overline{Y}_1 - \overline{Y}_2$</span>
<span id="cb6-675"><a href="#cb6-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-676"><a href="#cb6-676" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\sigma^2_j = p_j(1-p_j)$</span>
<span id="cb6-677"><a href="#cb6-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-678"><a href="#cb6-678" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$V = (r+1)(\frac{\sigma_1^2}{r} + \sigma_2^2)$</span>
<span id="cb6-679"><a href="#cb6-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-680"><a href="#cb6-680" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$se(\hat{\theta}) = \sqrt{\frac{V}{n}} = \sqrt{\frac{\sigma^2_1}{n_1} + \frac{\sigma^2_2}{n_2}}$</span>
<span id="cb6-681"><a href="#cb6-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-682"><a href="#cb6-682" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Precision for Odds</span></span>
<span id="cb6-683"><a href="#cb6-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-684"><a href="#cb6-684" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When analyzing odds (a nonlinear function of the mean), adjusting</span>
<span id="cb6-685"><a href="#cb6-685" aria-hidden="true" tabindex="-1"></a>    for precision variables results in more extreme estimates</span>
<span id="cb6-686"><a href="#cb6-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-687"><a href="#cb6-687" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$\textrm{Odds} = \frac{p}{1-p}$</span>
<span id="cb6-688"><a href="#cb6-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-689"><a href="#cb6-689" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Odds using average of stratum specific $p$ is not the average of</span>
<span id="cb6-690"><a href="#cb6-690" aria-hidden="true" tabindex="-1"></a>    stratum specific odds</span>
<span id="cb6-691"><a href="#cb6-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-692"><a href="#cb6-692" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Example: Stroke by smoking (in CVD strata)</span>
<span id="cb6-693"><a href="#cb6-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-694"><a href="#cb6-694" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>No association between smoking and CVD in the sample: 10%</span>
<span id="cb6-695"><a href="#cb6-695" aria-hidden="true" tabindex="-1"></a>        smokers in subjects with and without CVD</span>
<span id="cb6-696"><a href="#cb6-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-697"><a href="#cb6-697" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>CVD (precision variable) associated with stroke (outcome)</span>
<span id="cb6-698"><a href="#cb6-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-699"><a href="#cb6-699" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>CVD is not a confounder, but it is clearly a precision</span>
<span id="cb6-700"><a href="#cb6-700" aria-hidden="true" tabindex="-1"></a>            variable</span>
<span id="cb6-701"><a href="#cb6-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-702"><a href="#cb6-702" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Within each CVD stratum, the (adjusted) odds ratio for stroke by</span>
<span id="cb6-703"><a href="#cb6-703" aria-hidden="true" tabindex="-1"></a>        smoking is 2.0.</span>
<span id="cb6-704"><a href="#cb6-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-705"><a href="#cb6-705" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Overall, the unadjusted odds ratio is 1.8. That is, the</span>
<span id="cb6-706"><a href="#cb6-706" aria-hidden="true" tabindex="-1"></a>        unadjusted odds ratio is attenuated toward the null compared to</span>
<span id="cb6-707"><a href="#cb6-707" aria-hidden="true" tabindex="-1"></a>        the adjusted odds ratios</span>
<span id="cb6-708"><a href="#cb6-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-709"><a href="#cb6-709" aria-hidden="true" tabindex="-1"></a>        | No CVD    | N     | p    | Odds |</span>
<span id="cb6-710"><a href="#cb6-710" aria-hidden="true" tabindex="-1"></a>        |-----------|-------|------|------|</span>
<span id="cb6-711"><a href="#cb6-711" aria-hidden="true" tabindex="-1"></a>        | Smoke     | 1000  | 0.04 | 0.04 |</span>
<span id="cb6-712"><a href="#cb6-712" aria-hidden="true" tabindex="-1"></a>        | Non-Smoke | 10000 | 0.02 | 0.02 |</span>
<span id="cb6-713"><a href="#cb6-713" aria-hidden="true" tabindex="-1"></a>        | Ratio     |       |      | 2.0  |</span>
<span id="cb6-714"><a href="#cb6-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-715"><a href="#cb6-715" aria-hidden="true" tabindex="-1"></a>        | CVD       | N    | p    | Odds |</span>
<span id="cb6-716"><a href="#cb6-716" aria-hidden="true" tabindex="-1"></a>        |-----------|------|------|------|</span>
<span id="cb6-717"><a href="#cb6-717" aria-hidden="true" tabindex="-1"></a>        | Smoke     | 100  | 0.50 | 1.00 |</span>
<span id="cb6-718"><a href="#cb6-718" aria-hidden="true" tabindex="-1"></a>        | Non-Smoke | 1000 | 0.33 | 0.50 |</span>
<span id="cb6-719"><a href="#cb6-719" aria-hidden="true" tabindex="-1"></a>        | Ratio     |      |      | 2.0  |</span>
<span id="cb6-720"><a href="#cb6-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-721"><a href="#cb6-721" aria-hidden="true" tabindex="-1"></a>        | Overall   | N     | p     | Odds |</span>
<span id="cb6-722"><a href="#cb6-722" aria-hidden="true" tabindex="-1"></a>        |-----------|-------|-------|------|</span>
<span id="cb6-723"><a href="#cb6-723" aria-hidden="true" tabindex="-1"></a>        | Smoke     | 1100  | 0.082 | 0.09 |</span>
<span id="cb6-724"><a href="#cb6-724" aria-hidden="true" tabindex="-1"></a>        | Non-Smoke | 11000 | 0.048 | 0.05 |</span>
<span id="cb6-725"><a href="#cb6-725" aria-hidden="true" tabindex="-1"></a>        | Ratio     |       |       | 1.8  |</span>
<span id="cb6-726"><a href="#cb6-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-727"><a href="#cb6-727" aria-hidden="true" tabindex="-1"></a><span class="fu">## Diagnosing Confounding</span></span>
<span id="cb6-728"><a href="#cb6-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-729"><a href="#cb6-729" aria-hidden="true" tabindex="-1"></a><span class="fu">### Adjustment for Covariates</span></span>
<span id="cb6-730"><a href="#cb6-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-731"><a href="#cb6-731" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We include predictors in an analysis for a number of reasons. In</span>
<span id="cb6-732"><a href="#cb6-732" aria-hidden="true" tabindex="-1"></a>    order of importance...</span>
<span id="cb6-733"><a href="#cb6-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-734"><a href="#cb6-734" aria-hidden="true" tabindex="-1"></a><span class="ss">    1.  </span>Scientific question</span>
<span id="cb6-735"><a href="#cb6-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-736"><a href="#cb6-736" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Predictor of Interest</span>
<span id="cb6-737"><a href="#cb6-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-738"><a href="#cb6-738" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Effect Modifiers</span>
<span id="cb6-739"><a href="#cb6-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-740"><a href="#cb6-740" aria-hidden="true" tabindex="-1"></a><span class="ss">    2.  </span>Adjust for confounding</span>
<span id="cb6-741"><a href="#cb6-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-742"><a href="#cb6-742" aria-hidden="true" tabindex="-1"></a><span class="ss">    3.  </span>Gain precision</span>
<span id="cb6-743"><a href="#cb6-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-744"><a href="#cb6-744" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Adjustment for covariates changes the question being answered by the</span>
<span id="cb6-745"><a href="#cb6-745" aria-hidden="true" tabindex="-1"></a>    statistical analysis</span>
<span id="cb6-746"><a href="#cb6-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-747"><a href="#cb6-747" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Adjustments can be made to isolate associations that are of</span>
<span id="cb6-748"><a href="#cb6-748" aria-hidden="true" tabindex="-1"></a>        particular interest</span>
<span id="cb6-749"><a href="#cb6-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-750"><a href="#cb6-750" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When consulting with a scientist, it is often difficult to</span>
<span id="cb6-751"><a href="#cb6-751" aria-hidden="true" tabindex="-1"></a>        decide whether the interest in an additional covariate is due to</span>
<span id="cb6-752"><a href="#cb6-752" aria-hidden="true" tabindex="-1"></a>        confounding, effect modification, or precision</span>
<span id="cb6-753"><a href="#cb6-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-754"><a href="#cb6-754" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>The distinction is important because I tend to treat these</span>
<span id="cb6-755"><a href="#cb6-755" aria-hidden="true" tabindex="-1"></a>            variable differently in the analysis</span>
<span id="cb6-756"><a href="#cb6-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-757"><a href="#cb6-757" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Often the scientific question dictates inclusion of particular</span>
<span id="cb6-758"><a href="#cb6-758" aria-hidden="true" tabindex="-1"></a>        predictors</span>
<span id="cb6-759"><a href="#cb6-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-760"><a href="#cb6-760" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Predictor of interest: The scientific parameter of interest</span>
<span id="cb6-761"><a href="#cb6-761" aria-hidden="true" tabindex="-1"></a>            can be modeled by multiple predictors (e.g. dummy variables,</span>
<span id="cb6-762"><a href="#cb6-762" aria-hidden="true" tabindex="-1"></a>            polynomials, splines)</span>
<span id="cb6-763"><a href="#cb6-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-764"><a href="#cb6-764" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Effect Modifiers: The scientific question relates to the</span>
<span id="cb6-765"><a href="#cb6-765" aria-hidden="true" tabindex="-1"></a>            detection of effect modification</span>
<span id="cb6-766"><a href="#cb6-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-767"><a href="#cb6-767" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Confounders: The scientific question may be state in terms</span>
<span id="cb6-768"><a href="#cb6-768" aria-hidden="true" tabindex="-1"></a>            of adjusting for known (or suspected) confounders</span>
<span id="cb6-769"><a href="#cb6-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-770"><a href="#cb6-770" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confounder Detection</span></span>
<span id="cb6-771"><a href="#cb6-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-772"><a href="#cb6-772" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Unanticipated confounding</span>
<span id="cb6-773"><a href="#cb6-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-774"><a href="#cb6-774" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Some times we must explore our data to assess whether our</span>
<span id="cb6-775"><a href="#cb6-775" aria-hidden="true" tabindex="-1"></a>        results were confounded by some variable</span>
<span id="cb6-776"><a href="#cb6-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-777"><a href="#cb6-777" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Goal is to assess the "independent effect" of the predictor of</span>
<span id="cb6-778"><a href="#cb6-778" aria-hidden="true" tabindex="-1"></a>        interest on the outcome</span>
<span id="cb6-779"><a href="#cb6-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-780"><a href="#cb6-780" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Confounders</span>
<span id="cb6-781"><a href="#cb6-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-782"><a href="#cb6-782" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Variables (causally) predictive of the outcome, but not in the</span>
<span id="cb6-783"><a href="#cb6-783" aria-hidden="true" tabindex="-1"></a>        causal pathway</span>
<span id="cb6-784"><a href="#cb6-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-785"><a href="#cb6-785" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Best method: Think about the scientific problem beforehand</span>
<span id="cb6-786"><a href="#cb6-786" aria-hidden="true" tabindex="-1"></a>            (perhaps draw DAG)</span>
<span id="cb6-787"><a href="#cb6-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-788"><a href="#cb6-788" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Using data, often assessed in the control group</span>
<span id="cb6-789"><a href="#cb6-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-790"><a href="#cb6-790" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Variables associated with the predictor of interest in the</span>
<span id="cb6-791"><a href="#cb6-791" aria-hidden="true" tabindex="-1"></a>        sample</span>
<span id="cb6-792"><a href="#cb6-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-793"><a href="#cb6-793" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Note that statistical significance is not relevant because</span>
<span id="cb6-794"><a href="#cb6-794" aria-hidden="true" tabindex="-1"></a>            this tells us about associations in the population</span>
<span id="cb6-795"><a href="#cb6-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-796"><a href="#cb6-796" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Detection of confounding ultimately must rely on our best</span>
<span id="cb6-797"><a href="#cb6-797" aria-hidden="true" tabindex="-1"></a>        knowledge about the possible scientific mechanisms</span>
<span id="cb6-798"><a href="#cb6-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-799"><a href="#cb6-799" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Effect of confounding: A confounder can make the association between</span>
<span id="cb6-800"><a href="#cb6-800" aria-hidden="true" tabindex="-1"></a>    the predictor of interest and the response variable look...</span>
<span id="cb6-801"><a href="#cb6-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-802"><a href="#cb6-802" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Stronger than the true association</span>
<span id="cb6-803"><a href="#cb6-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-804"><a href="#cb6-804" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Weaker than the true association</span>
<span id="cb6-805"><a href="#cb6-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-806"><a href="#cb6-806" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The complete reverse of the true association ("qualitative</span>
<span id="cb6-807"><a href="#cb6-807" aria-hidden="true" tabindex="-1"></a>        confounding")</span>
<span id="cb6-808"><a href="#cb6-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-809"><a href="#cb6-809" aria-hidden="true" tabindex="-1"></a><span class="fu">## Graphical Methods for Visualizing Effect Modification, Confounding, and Precision</span></span>
<span id="cb6-810"><a href="#cb6-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-811"><a href="#cb6-811" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Conduct stratified analysis to distinguish between</span>
<span id="cb6-812"><a href="#cb6-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-813"><a href="#cb6-813" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Effect modifiers</span>
<span id="cb6-814"><a href="#cb6-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-815"><a href="#cb6-815" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Confounders</span>
<span id="cb6-816"><a href="#cb6-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-817"><a href="#cb6-817" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Precision variables</span>
<span id="cb6-818"><a href="#cb6-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-819"><a href="#cb6-819" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Plots most illustrative for continuous outcomes</span>
<span id="cb6-820"><a href="#cb6-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-821"><a href="#cb6-821" aria-hidden="true" tabindex="-1"></a><span class="fu">### Effect Modifiers</span></span>
<span id="cb6-822"><a href="#cb6-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-823"><a href="#cb6-823" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimates of treatment effect differ among strata</span>
<span id="cb6-824"><a href="#cb6-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-825"><a href="#cb6-825" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When analyzing difference of means of continuous data,</span>
<span id="cb6-826"><a href="#cb6-826" aria-hidden="true" tabindex="-1"></a>        stratified smooth curves of the data are non-parallel</span>
<span id="cb6-827"><a href="#cb6-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-828"><a href="#cb6-828" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Graphical techniques difficult in other settings</span>
<span id="cb6-829"><a href="#cb6-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-832"><a href="#cb6-832" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-833"><a href="#cb6-833" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Unadjusted association between outcome and predictor shows a flat slope.</span></span>
<span id="cb6-834"><a href="#cb6-834" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1231</span>)</span>
<span id="cb6-835"><a href="#cb6-835" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb6-836"><a href="#cb6-836" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">each=</span>n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb6-837"><a href="#cb6-837" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb6-838"><a href="#cb6-838" aria-hidden="true" tabindex="-1"></a>emplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">grp=</span>grp,</span>
<span id="cb6-839"><a href="#cb6-839" aria-hidden="true" tabindex="-1"></a>                     <span class="at">X=</span>X,</span>
<span id="cb6-840"><a href="#cb6-840" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Y=</span>.<span class="dv">1</span><span class="sc">*</span>grp <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">4</span><span class="sc">*</span>grp<span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb6-841"><a href="#cb6-841" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-842"><a href="#cb6-842" aria-hidden="true" tabindex="-1"></a>emplot<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(emplot<span class="sc">$</span>grp, <span class="at">levels=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Trt"</span>,<span class="st">"Ctrl"</span>))</span>
<span id="cb6-843"><a href="#cb6-843" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emplot, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb6-844"><a href="#cb6-844" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-845"><a href="#cb6-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-848"><a href="#cb6-848" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-849"><a href="#cb6-849" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Adjusted association between outcome and predictor shows an increasing slope in one group and a decreasing slope in the other.  This demonstrates effect modification of group.</span></span>
<span id="cb6-850"><a href="#cb6-850" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emplot, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y, <span class="at">color=</span>group, <span class="at">grp=</span>group)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>,) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb6-851"><a href="#cb6-851" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-852"><a href="#cb6-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-853"><a href="#cb6-853" aria-hidden="true" tabindex="-1"></a><span class="fu">### Confounders</span></span>
<span id="cb6-854"><a href="#cb6-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-855"><a href="#cb6-855" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimates of treatment effect the same across strata, AND</span>
<span id="cb6-856"><a href="#cb6-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-857"><a href="#cb6-857" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Confounder is causally associated with the response, AND</span>
<span id="cb6-858"><a href="#cb6-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-859"><a href="#cb6-859" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Confounder associated with the POI in the sample</span>
<span id="cb6-860"><a href="#cb6-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-861"><a href="#cb6-861" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When analyzing difference of means of continuous data</span>
<span id="cb6-862"><a href="#cb6-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-863"><a href="#cb6-863" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Stratified smooth curve of data are parallel</span>
<span id="cb6-864"><a href="#cb6-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-865"><a href="#cb6-865" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Distribution of POI differs across strata</span>
<span id="cb6-866"><a href="#cb6-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-867"><a href="#cb6-867" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Unadjusted and adjusted analyses give different estimates</span>
<span id="cb6-868"><a href="#cb6-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-871"><a href="#cb6-871" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-872"><a href="#cb6-872" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1231</span>)</span>
<span id="cb6-873"><a href="#cb6-873" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb6-874"><a href="#cb6-874" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">each=</span>n<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb6-875"><a href="#cb6-875" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">4</span>, <span class="dv">0</span>,.<span class="dv">4</span>), <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">4</span>, <span class="fl">0.2</span>,.<span class="dv">6</span>), <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">4</span>, .<span class="dv">4</span>,.<span class="dv">8</span>), <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">4</span>, .<span class="dv">6</span>, <span class="dv">1</span>))</span>
<span id="cb6-876"><a href="#cb6-876" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X <span class="sc">-</span> grp <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb6-877"><a href="#cb6-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-878"><a href="#cb6-878" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb6-879"><a href="#cb6-879" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">main=</span><span class="st">"Unadjusted"</span>)</span>
<span id="cb6-880"><a href="#cb6-880" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(Y<span class="sc">~</span>X), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-881"><a href="#cb6-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-882"><a href="#cb6-882" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">pch=</span>(grp<span class="sc">+</span><span class="dv">1</span>), <span class="at">main=</span><span class="st">"Adjusted Confounding"</span>)</span>
<span id="cb6-883"><a href="#cb6-883" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X <span class="sc">+</span> grp)</span>
<span id="cb6-884"><a href="#cb6-884" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="dv">0</span>  , <span class="at">x1=</span>.<span class="dv">4</span>, <span class="at">y0=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">0</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>],   <span class="at">y1=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.4</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>], <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-885"><a href="#cb6-885" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="fl">0.2</span>, <span class="at">x1=</span>.<span class="dv">6</span>, <span class="at">y0=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.2</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>]<span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">y1=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-886"><a href="#cb6-886" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="fl">0.4</span>, <span class="at">x1=</span>.<span class="dv">8</span>, <span class="at">y0=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.4</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>]<span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">y1=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.8</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-887"><a href="#cb6-887" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="fl">0.6</span>, <span class="at">x1=</span> <span class="dv">1</span>, <span class="at">y0=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.6</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>]<span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">y1=</span><span class="fu">coef</span>(m1)[<span class="dv">1</span>] <span class="sc">+</span>   <span class="dv">1</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">coef</span>(m1)[<span class="dv">3</span>], <span class="at">lty=</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-888"><a href="#cb6-888" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb6-889"><a href="#cb6-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-890"><a href="#cb6-890" aria-hidden="true" tabindex="-1"></a><span class="fu">### Precision Variables</span></span>
<span id="cb6-891"><a href="#cb6-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-892"><a href="#cb6-892" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimates of treatment effect the same across strata, AND</span>
<span id="cb6-893"><a href="#cb6-893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-894"><a href="#cb6-894" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Variable is causally associated with the response, AND</span>
<span id="cb6-895"><a href="#cb6-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-896"><a href="#cb6-896" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Variable is not associated with the POI in the sample</span>
<span id="cb6-897"><a href="#cb6-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-898"><a href="#cb6-898" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When analyzing difference of means of continuous data</span>
<span id="cb6-899"><a href="#cb6-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-900"><a href="#cb6-900" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Stratified smooth curve of data are parallel</span>
<span id="cb6-901"><a href="#cb6-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-902"><a href="#cb6-902" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Distribution of POI same across strata</span>
<span id="cb6-903"><a href="#cb6-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-904"><a href="#cb6-904" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Unadjusted and adjusted analyses give similar estimates but with</span>
<span id="cb6-905"><a href="#cb6-905" aria-hidden="true" tabindex="-1"></a>        smaller standard errors</span>
<span id="cb6-906"><a href="#cb6-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-909"><a href="#cb6-909" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb6-910"><a href="#cb6-910" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1231</span>)</span>
<span id="cb6-911"><a href="#cb6-911" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb6-912"><a href="#cb6-912" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">each=</span>n<span class="sc">/</span><span class="dv">4</span>)</span>
<span id="cb6-913"><a href="#cb6-913" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb6-914"><a href="#cb6-914" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">*</span>X <span class="sc">+</span> <span class="dv">5</span><span class="sc">*</span>grp <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb6-915"><a href="#cb6-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-916"><a href="#cb6-916" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb6-917"><a href="#cb6-917" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">main=</span><span class="st">"Unadjusted Precision"</span>)</span>
<span id="cb6-918"><a href="#cb6-918" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">lowess</span>(Y<span class="sc">~</span>X), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-919"><a href="#cb6-919" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X,Y, <span class="at">main=</span><span class="st">"Adjusted Precision"</span>, <span class="at">pch=</span>(grp<span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb6-920"><a href="#cb6-920" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>X <span class="sc">+</span> grp)</span>
<span id="cb6-921"><a href="#cb6-921" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">coef</span>(m2)[<span class="dv">1</span>], <span class="at">b=</span><span class="fu">coef</span>(m2)[<span class="dv">2</span>], <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-922"><a href="#cb6-922" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">coef</span>(m2)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span><span class="sc">*</span><span class="fu">coef</span>(m2)[<span class="dv">3</span>], <span class="at">b=</span>(<span class="fu">coef</span>(m2)[<span class="dv">2</span>]), <span class="at">lty=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-923"><a href="#cb6-923" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">coef</span>(m2)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">coef</span>(m2)[<span class="dv">3</span>], <span class="at">b=</span>(<span class="fu">coef</span>(m2)[<span class="dv">2</span>]), <span class="at">lty=</span><span class="dv">3</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-924"><a href="#cb6-924" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="fu">coef</span>(m2)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">coef</span>(m2)[<span class="dv">3</span>], <span class="at">b=</span>(<span class="fu">coef</span>(m2)[<span class="dv">2</span>]), <span class="at">lty=</span><span class="dv">4</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-925"><a href="#cb6-925" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024-2025, James C Slaughter</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chrissl789/modern-regression/edit/main/notes/Lec06.ConfoundingEffectModificationMediation.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chrissl789/modern-regression/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>