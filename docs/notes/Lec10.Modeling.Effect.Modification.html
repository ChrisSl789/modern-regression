<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chris Slaughter">
<meta name="dcterms.date" content="2025-10-30">

<title>Modeling Effect Modification – BIOS 6312 - Spring 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notes/Set8.pdf" rel="next">
<link href="../notes/Lec09.Poisson.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-c437abfaa50d34d00910df3552cd5d13.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-1965ed886599d4b20805420ccffa35d1.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-c437abfaa50d34d00910df3552cd5d13.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Modeling Effect Modification – BIOS 6312 - Spring 2025">
<meta property="og:description" content="Lecture 10">
<meta property="og:image" content="https://chrissl789.github.io/modern-regression/notes/Lec10.Modeling.Effect.Modification_files/figure-html/unnamed-chunk-2-1.png">
<meta property="og:site_name" content="BIOS 6312 - Spring 2025">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
</head>

<body class="nav-sidebar docked slimcontent quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/Lec02.review.html">Course Notes</a></li><li class="breadcrumb-item"><a href="../notes/Lec10.Modeling.Effect.Modification.html">Modeling Effect Modification</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">BIOS 6312 - Spring 2025</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/Lec01.Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introductory Slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus BIOS 6312</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../officehours.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Office Hours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec02.review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Review of Key Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec03.SimpleLinearRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec04.Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec05.Precision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Precision of Statistical Intefence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec06.ConfoundingEffectModificationMediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confouding, Effect Modification, and Mediation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec07.MultivariableModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariable Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set2.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set6.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weighted Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec08.Survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec09.Poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec10.Modeling.Effect.Modification.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Modeling Effect Modification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set8.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial and Ordinal Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec11.DoseResponse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flexible Modeling of Continuous Predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec12.ANOVA.Model.Choice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA and Model Choice</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec13.Prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regression Based Prediction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/BayesDiagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Model Diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set13.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Missing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set14.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Bootstrap</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/quarto-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab1-linearregression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Linear regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab2-linearassumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2: Assumption in Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab3-logistic-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3: Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab4-precision-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Precision and adjustment for baseline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab-weighted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(Mini) Lab: Weighted Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab5-multivariable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 5: Multivariable Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab6-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 6: Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab7-effectmodification-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 7: Poisson Regression and Effect Modification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab-DiscreteOutcomeRegression.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 8: Discrete Outcomes Lab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://vanderbilt.box.com/s/rpftvmc9vua2w3gz3jy16phlnsojs6on" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Box folder with .qmd files</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Supplemental notes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/slr-derivations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SLR derivations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/model-diagnostics-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/mlr-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MLR matrix notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/log-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Log transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/model-selection-criteria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model selection criteria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/ReviewMatrixAlgebra.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix algebra review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/Baseline_Change_MACH.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Change from baseline and precision</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Statcomp2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Main directory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/lectures/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lectures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/lectures/data" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#analysis-of-effect-modification" id="toc-analysis-of-effect-modification" class="nav-link" data-scroll-target="#analysis-of-effect-modification"><span class="header-section-number">2</span> Analysis of Effect Modification</a>
  <ul>
  <li><a href="#example-is-blood-pressure-by-gender-modified-by-smoking" id="toc-example-is-blood-pressure-by-gender-modified-by-smoking" class="nav-link" data-scroll-target="#example-is-blood-pressure-by-gender-modified-by-smoking"><span class="header-section-number">2.1</span> Example: Is blood pressure by gender modified by smoking?</a>
  <ul class="collapse">
  <li><a href="#model-for-the-mean" id="toc-model-for-the-mean" class="nav-link" data-scroll-target="#model-for-the-mean"><span class="header-section-number">2.1.1</span> Model for the Mean</a></li>
  <li><a href="#model-for-the-geometric-mean" id="toc-model-for-the-geometric-mean" class="nav-link" data-scroll-target="#model-for-the-geometric-mean"><span class="header-section-number">2.1.2</span> Model for the Geometric Mean</a></li>
  <li><a href="#r-output" id="toc-r-output" class="nav-link" data-scroll-target="#r-output"><span class="header-section-number">2.1.3</span> R Output</a></li>
  <li><a href="#stata-output" id="toc-stata-output" class="nav-link" data-scroll-target="#stata-output"><span class="header-section-number">2.1.4</span> Stata Output</a></li>
  </ul></li>
  <li><a href="#ignoring-effect-modification" id="toc-ignoring-effect-modification" class="nav-link" data-scroll-target="#ignoring-effect-modification"><span class="header-section-number">2.2</span> Ignoring effect modification</a></li>
  </ul></li>
  <li><a href="#general-model-for-effect-modification" id="toc-general-model-for-effect-modification" class="nav-link" data-scroll-target="#general-model-for-effect-modification"><span class="header-section-number">3</span> General Model for Effect Modification</a>
  <ul>
  <li><a href="#interpretation-of-slope-parameter-for-the-interaction" id="toc-interpretation-of-slope-parameter-for-the-interaction" class="nav-link" data-scroll-target="#interpretation-of-slope-parameter-for-the-interaction"><span class="header-section-number">3.1</span> Interpretation of slope parameter for the interaction</a></li>
  <li><a href="#inference-for-effect-modification" id="toc-inference-for-effect-modification" class="nav-link" data-scroll-target="#inference-for-effect-modification"><span class="header-section-number">3.2</span> Inference for Effect Modification</a></li>
  <li><a href="#salary-by-sex-and-administration" id="toc-salary-by-sex-and-administration" class="nav-link" data-scroll-target="#salary-by-sex-and-administration"><span class="header-section-number">3.3</span> Salary by sex and administration</a>
  <ul class="collapse">
  <li><a href="#stata-regression-output" id="toc-stata-regression-output" class="nav-link" data-scroll-target="#stata-regression-output"><span class="header-section-number">3.3.1</span> Stata Regression Output</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics"><span class="header-section-number">3.3.2</span> Descriptive statistics</a></li>
  <li><a href="#inference-about-effect-modification" id="toc-inference-about-effect-modification" class="nav-link" data-scroll-target="#inference-about-effect-modification"><span class="header-section-number">3.3.3</span> Inference about effect modification</a></li>
  <li><a href="#inference-about-sex-association" id="toc-inference-about-sex-association" class="nav-link" data-scroll-target="#inference-about-sex-association"><span class="header-section-number">3.3.4</span> Inference about sex association</a></li>
  <li><a href="#inference-about-admin-association" id="toc-inference-about-admin-association" class="nav-link" data-scroll-target="#inference-about-admin-association"><span class="header-section-number">3.3.5</span> Inference about admin association</a></li>
  <li><a href="#inference-about-admin-association-using-r" id="toc-inference-about-admin-association-using-r" class="nav-link" data-scroll-target="#inference-about-admin-association-using-r"><span class="header-section-number">3.3.6</span> Inference about admin association using R</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#continuous-effect-modification" id="toc-continuous-effect-modification" class="nav-link" data-scroll-target="#continuous-effect-modification"><span class="header-section-number">4</span> Continuous Effect Modification</a>
  <ul>
  <li><a href="#example-normal-ranges-for-sep" id="toc-example-normal-ranges-for-sep" class="nav-link" data-scroll-target="#example-normal-ranges-for-sep"><span class="header-section-number">4.1</span> Example: Normal ranges for SEP</a></li>
  <li><a href="#sep-regression-model" id="toc-sep-regression-model" class="nav-link" data-scroll-target="#sep-regression-model"><span class="header-section-number">4.2</span> SEP regression model</a></li>
  <li><a href="#regression-output" id="toc-regression-output" class="nav-link" data-scroll-target="#regression-output"><span class="header-section-number">4.3</span> Regression Output</a>
  <ul class="collapse">
  <li><a href="#r-code-to-generate-plot" id="toc-r-code-to-generate-plot" class="nav-link" data-scroll-target="#r-code-to-generate-plot"><span class="header-section-number">4.3.1</span> R Code to generate plot</a></li>
  </ul></li>
  <li><a href="#influence-diagnostics" id="toc-influence-diagnostics" class="nav-link" data-scroll-target="#influence-diagnostics"><span class="header-section-number">4.4</span> Influence diagnostics</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chrissl789/modern-regression/edit/main/notes/Lec10.Modeling.Effect.Modification.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chrissl789/modern-regression/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/Lec02.review.html">Course Notes</a></li><li class="breadcrumb-item"><a href="../notes/Lec10.Modeling.Effect.Modification.html">Modeling Effect Modification</a></li></ol></nav><h1 class="title display-7">Modeling Effect Modification</h1></header>


<header id="title-block-header">

<div class="right">
<!--
<a href="https://github.com/chrissl789/modern-regression/raw/main/Lec10.Modeling.Effect.Modification.qmd" target="_blank">View Code</a>
-->
<a href="https://statcomp2.app.vumc.org/modern-regression/lectures/Lec10.Modeling.Effect.Modification.qmd" target="_blank">Download Code</a>

</div>

<div class="quarto-title-block d-none d-lg-block"><div><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Lecture 10</p>
<p class="author">Chris Slaughter</p>

<p class="date">October 30, 2025</p>

</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biostat3)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="fu">source</span>(<span class="st">'pander_registry.R'</span>), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">invisible</span>(e))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overview" class="level2 page-columns page-full" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<ul>
<li><p>Scientific questions</p>
<ul>
<li><p>Most often scientific questions are translated into comparing the distribution of some response variable across groups of interest</p></li>
<li><p>Groups are defined by the predictor of interest (POI)</p></li>
<li><p>Effect modification evaluates if the association between the outcome and POI is modified by strata defined by a third, modifying variable</p></li>
<li><p>Examples of effect modification</p>
<ul>
<li><p>Binary effect modification: If we stratify by gender, we may get different answers to our scientific question in men and women</p></li>
<li><p>Continuous effect modification: If we stratify by age, we way get different answers to our scientific question in young and old</p></li>
</ul></li>
</ul></li>
<li><p>The association between the Response and the Predictor of Interest differs in strata defined by the effect modifier</p>
<ul>
<li><p>Will get different answers to the scientific question within different strata defined by the effect modifier</p></li>
<li><p>Statistical term: “Interaction” between the effect modifier and the POI</p></li>
<li><p>Effect modification depends on the measure of effect that you choose</p>
<ul>
<li><p>Choice of summary measure: mean, median, geometric mean, odds, hazard</p></li>
<li><p>Choice of comparisons across groups: differences, ratios</p></li>
</ul></li>
</ul></li>
<li><p>We will also do some model diagnostics through examples</p>
<ul>
<li><p>When looking at effect modification, I am also worried that one point may be driving the interaction</p></li>
<li><p>Will go over case diagnostics in an example analysis of somatosensory evoked potential (SEP)</p></li>
</ul></li>
<li><p>Graphical displays for effect modification</p>
<ul>
<li><p>When analyzing difference of means of continuous data, stratified smooth curves of the data are non-parallel</p></li>
<li><p>Graphical techniques more difficult for odds and hazards</p></li>
</ul></li>
</ul>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1231</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">each=</span>n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>emplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">grp=</span>grp,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">X=</span>X,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Y=</span>.<span class="dv">1</span><span class="sc">*</span>grp <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">4</span><span class="sc">*</span>grp<span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>emplot<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(emplot<span class="sc">$</span>grp, <span class="at">levels=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Trt"</span>,<span class="st">"Ctrl"</span>))</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emplot, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="Lec10.Modeling.Effect.Modification_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="margin-caption">Unadjusted association between outcome and predictor shows a flat slope.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell page-columns page-full">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emplot, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y, <span class="at">color=</span>group, <span class="at">grp=</span>group)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>,) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="Lec10.Modeling.Effect.Modification_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="margin-caption">Adjusted association between outcome and predictor shows an increasing slope in one group and a decreasing slope in the other. This demonstrates effect modification of group.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="analysis-of-effect-modification" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="analysis-of-effect-modification"><span class="header-section-number">2</span> Analysis of Effect Modification</h2>
<ul>
<li><p>When the scientific question involves effect modification, analyses must be performed within each stratum separately</p></li>
<li><p>If we want to test the degree of effect modification or test statistically, the regression model will typically include</p>
<ul>
<li><p>Predictor of interest</p></li>
<li><p>Effect modifier</p></li>
<li><p>A covariate modeling the interaction (usually a product)</p></li>
</ul></li>
</ul>
<section id="example-is-blood-pressure-by-gender-modified-by-smoking" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="example-is-blood-pressure-by-gender-modified-by-smoking"><span class="header-section-number">2.1</span> Example: Is blood pressure by gender modified by smoking?</h3>
<table class="caption-top table">
<tbody>
<tr class="odd">
<td></td>
<td>Non-Smoke</td>
<td>Smoke</td>
<td>Non-smoke</td>
<td>Smoke</td>
</tr>
<tr class="even">
<td>Women</td>
<td>107.4</td>
<td>135.2</td>
<td>105.6</td>
<td>134.7</td>
</tr>
<tr class="odd">
<td>Men</td>
<td>122.7</td>
<td>174.7</td>
<td>121.1</td>
<td>174.1</td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Diff</td>
<td><strong>15.3</strong></td>
<td><strong>39.5</strong></td>
<td>15.5</td>
<td>39.4</td>
</tr>
<tr class="even">
<td>Ratio</td>
<td>1.14</td>
<td>1.28</td>
<td><strong>1.15</strong></td>
<td><strong>1.29</strong></td>
</tr>
</tbody>
</table>
<section id="model-for-the-mean" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="model-for-the-mean"><span class="header-section-number">2.1.1</span> Model for the Mean</h4>
<ul>
<li><p>Model: <span class="math inline">\(Y = \beta_0 + \beta_M * \textrm{Male} + \beta_S * \textrm{Smoke} + \beta_{MS} * \textrm{Male} * \textrm{Smoke} + \epsilon\)</span></p>
<ul>
<li><p>Male and Smoke are modeled using indicator variables</p>
<ul>
<li><p>Male is 1 for males, 0 for females</p></li>
<li><p>Smoke is 1 for smokers, 0 for non-smokers</p></li>
</ul></li>
<li><p>Estimates of the mean from the regression model are given in the following table</p></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>Non-smoker (smoke=0)</td>
<td>Smoker (smoke=1)</td>
</tr>
<tr class="even">
<td>Women (male=0)</td>
<td><span class="math inline">\(\beta_0\)</span></td>
<td><span class="math inline">\(\beta_0 + \beta_S\)</span></td>
</tr>
<tr class="odd">
<td>Men (male=1)</td>
<td><span class="math inline">\(\beta_0 + \beta_M\)</span></td>
<td><span class="math inline">\(\beta_0 + \beta_S + \beta_M + \beta_{MS}\)</span></td>
</tr>
<tr class="even">
<td>Difference</td>
<td><span class="math inline">\(\beta_M\)</span></td>
<td><span class="math inline">\(\beta_M + \beta_{MS}\)</span></td>
</tr>
</tbody>
</table></li>
<li><p>What is the scientific interpretation of <span class="math inline">\(\beta_{MS} = 0\)</span>?</p>
<ul>
<li><p>If true, the Male to Female difference in smokers <span class="math inline">\(= \beta_M\)</span></p></li>
<li><p>And, the Male to Female difference in non-smokers <span class="math inline">\(= \beta_M\)</span></p></li>
<li><p>In other words, the effect of gender is <em>the same</em> in smoker and non-smokers</p>
<ul>
<li>A test of <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\beta_{MS} = 0\)</span> is a test of effect modification (for means, differences)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="model-for-the-geometric-mean" class="level4" data-number="2.1.2">
<h4 data-number="2.1.2" class="anchored" data-anchor-id="model-for-the-geometric-mean"><span class="header-section-number">2.1.2</span> Model for the Geometric Mean</h4>
<ul>
<li><p>Model: <span class="math inline">\(\textrm{log}(Y) = \beta_0 + \beta_M * \textrm{Male} + \beta_S * \textrm{Smoke} + \beta_{MS} * \textrm{Male} * \textrm{Smoke} + \epsilon\)</span></p>
<ul>
<li><p>Male and Smoke are modeled using indicator variables</p>
<ul>
<li><p>Male is 1 for males, 0 for females</p></li>
<li><p>Smoke is 1 for smokers, 0 for non-smokers</p></li>
</ul></li>
<li><p>Estimates of the geometric mean from the regression model are given in the following table</p></li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 26%">
<col style="width: 47%">
</colgroup>
<tbody>
<tr class="odd">
<td></td>
<td>Non-smoker (smoke=0)</td>
<td>Smoker (smoke=1)</td>
</tr>
<tr class="even">
<td>Women (male=0)</td>
<td><span class="math inline">\(e^{\beta_0}\)</span></td>
<td><span class="math inline">\(e^{\beta_0 + \beta_S}\)</span></td>
</tr>
<tr class="odd">
<td>Men (male=1)</td>
<td><span class="math inline">\(e^{\beta_0 + \beta_M}\)</span></td>
<td><span class="math inline">\(e^{\beta_0 + \beta_S + \beta_M + \beta_{MS}}\)</span></td>
</tr>
<tr class="even">
<td>Ratio</td>
<td><span class="math inline">\(e^{\beta_M}\)</span></td>
<td><span class="math inline">\(e^{\beta_M + \beta_{MS}}\)</span></td>
</tr>
</tbody>
</table></li>
<li><p>What is the scientific interpretation of <span class="math inline">\(\beta_{MS} = 0\)</span>?</p>
<ul>
<li><p>If true, the Male to Female ratio in smokers <span class="math inline">\(= e^{\beta_M}\)</span></p></li>
<li><p>And, the Male to Female ratio in non-smokers <span class="math inline">\(= e^{\beta_M}\)</span></p></li>
<li><p>In other words, the effect of gender is <em>the same</em> in smoker and non-smokers</p>
<ul>
<li>A test of <span class="math inline">\(H_0\)</span>: <span class="math inline">\(\beta_{MS} = 0\)</span> is a test of effect modification (for geometric means, ratios)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="r-output" class="level4" data-number="2.1.3">
<h4 data-number="2.1.3" class="anchored" data-anchor-id="r-output"><span class="header-section-number">2.1.3</span> R Output</h4>
<section id="means" class="level5">
<h5 class="anchored" data-anchor-id="means">Means</h5>
<p>We can obtain the means by male and smoking using summary statistics or from regression ouput</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/bp.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>bp<span class="sc">$</span>logbp <span class="ot">&lt;-</span> <span class="fu">log</span>(bp<span class="sc">$</span>bp)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>bp<span class="sc">$</span>malesmoke <span class="ot">&lt;-</span> bp<span class="sc">$</span>male <span class="sc">*</span> bp<span class="sc">$</span>smoke</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>bp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(smoke, male) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">meanbp=</span><span class="fu">mean</span>(bp))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">smoke</th>
<th style="text-align: center;">male</th>
<th style="text-align: center;">meanbp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">107.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">122.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">135.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">174.7</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> male <span class="sc">+</span> smoke <span class="sc">+</span> male<span class="sc">*</span>smoke, <span class="at">data=</span>bp)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">male=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">smoke=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted means from the regression model.  Matches above table</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(newdata, <span class="fu">predict</span>(m1, newdata))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 31%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">male</th>
<th style="text-align: center;">smoke</th>
<th style="text-align: center;">predict(m1, newdata)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">107.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">122.7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">135.2</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">174.7</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Four linear combinations using biostat3 function lincom and robust standard error</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  to obtain the 4 means</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="fu">c</span>(<span class="st">"(Intercept)"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + male"</span>,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + smoke"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + male + smoke + male:smoke"</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>(Intercept)</strong></td>
<td style="text-align: center;">107.4</td>
<td style="text-align: center;">94.534</td>
<td style="text-align: center;">120.27</td>
<td style="text-align: center;">267.68</td>
<td style="text-align: center;">2.9961e-18</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>(Intercept) + male</strong></td>
<td style="text-align: center;">122.7</td>
<td style="text-align: center;">109.34</td>
<td style="text-align: center;">136.06</td>
<td style="text-align: center;">323.98</td>
<td style="text-align: center;">1.3897e-19</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>(Intercept) + smoke</strong></td>
<td style="text-align: center;">135.2</td>
<td style="text-align: center;">126.5</td>
<td style="text-align: center;">143.9</td>
<td style="text-align: center;">926.77</td>
<td style="text-align: center;">2.7458e-27</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>(Intercept) + male + smoke + male:smoke</strong></td>
<td style="text-align: center;">174.7</td>
<td style="text-align: center;">164.4</td>
<td style="text-align: center;">185</td>
<td style="text-align: center;">1104.6</td>
<td style="text-align: center;">1.2961e-28</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="difference-in-mean-bp-males-versus-females-in-non-smokers" class="level6">
<h6 class="anchored" data-anchor-id="difference-in-mean-bp-males-versus-females-in-non-smokers">Difference in mean bp, males versus females, in non-smokers</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Male effect in non-smokers</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"male"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>male</strong></td>
<td style="text-align: center;">15.3</td>
<td style="text-align: center;">-3.2485</td>
<td style="text-align: center;">33.849</td>
<td style="text-align: center;">2.6137</td>
<td style="text-align: center;">0.11467</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="difference-in-mean-bp-males-versus-females-in-smokers" class="level6">
<h6 class="anchored" data-anchor-id="difference-in-mean-bp-males-versus-females-in-smokers">Difference in mean bp, males versus females, in smokers</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Male effect in smokers</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"male + male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>male + male:smoke</strong></td>
<td style="text-align: center;">39.5</td>
<td style="text-align: center;">26.013</td>
<td style="text-align: center;">52.987</td>
<td style="text-align: center;">32.948</td>
<td style="text-align: center;">1.5466e-06</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="difference-in-mean-bp-smokers-versus-non-smokers-in-females" class="level6">
<h6 class="anchored" data-anchor-id="difference-in-mean-bp-smokers-versus-non-smokers-in-females">Difference in mean bp, smokers versus non-smokers, in females</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking effect in females</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>smoke</strong></td>
<td style="text-align: center;">27.8</td>
<td style="text-align: center;">12.266</td>
<td style="text-align: center;">43.334</td>
<td style="text-align: center;">12.303</td>
<td style="text-align: center;">0.0012324</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="difference-in-mean-bp-smokers-versus-non-smokers-in-males" class="level6">
<h6 class="anchored" data-anchor-id="difference-in-mean-bp-smokers-versus-non-smokers-in-males">Difference in mean bp, smokers versus non-smokers, in males</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking effect in males</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"smoke + male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>smoke + male:smoke</strong></td>
<td style="text-align: center;">52</td>
<td style="text-align: center;">35.128</td>
<td style="text-align: center;">68.872</td>
<td style="text-align: center;">36.491</td>
<td style="text-align: center;">6.131e-07</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="test-for-effect-modification" class="level6">
<h6 class="anchored" data-anchor-id="test-for-effect-modification">Test for effect modification</h6>
<p>Is the effect of smoking on mean bp modified by male? Is the effect of male on mean bp modified by smoking? Effect modification is symmetric. The answer to these two questions is answered by testing for the significance of the interaction term between male and smoking. The following answers both questions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect modification</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>male:smoke</strong></td>
<td style="text-align: center;">24.2</td>
<td style="text-align: center;">1.2662</td>
<td style="text-align: center;">47.134</td>
<td style="text-align: center;">4.2774</td>
<td style="text-align: center;">0.045865</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="geometric-means" class="level5">
<h5 class="anchored" data-anchor-id="geometric-means">Geometric Means</h5>
<p>We can obtain the geometric means by male and smoking using summary statistics or from regression ouput</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>bp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(smoke, male) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">geomeanbp=</span><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(bp))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">smoke</th>
<th style="text-align: center;">male</th>
<th style="text-align: center;">geomeanbp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">105.56</td>
</tr>
<tr class="even">
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">121.07</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">134.65</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">174.08</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logbp <span class="sc">~</span> male <span class="sc">+</span> smoke <span class="sc">+</span> male<span class="sc">*</span>smoke, <span class="at">data=</span>bp)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">male=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">smoke=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted means from the regression model.  Matches above table</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(newdata, <span class="fu">exp</span>(<span class="fu">predict</span>(m2, newdata)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 9%">
<col style="width: 11%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">male</th>
<th style="text-align: center;">smoke</th>
<th style="text-align: center;">exp(predict(m2, newdata))</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">105.56</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">121.07</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">134.65</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">174.08</td>
</tr>
</tbody>
</table>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Four linear combinations using biostat3 function lincom and robust standard error</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  to obtain the 4 means</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="fu">c</span>(<span class="st">"(Intercept)"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + male"</span>,</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + smoke"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + male + smoke + male:smoke"</span>),</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>),</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">eform=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 31%">
<col style="width: 14%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>(Intercept)</strong></td>
<td style="text-align: center;">105.56</td>
<td style="text-align: center;">92.428</td>
<td style="text-align: center;">120.55</td>
<td style="text-align: center;">4727.3</td>
<td style="text-align: center;">8.5796e-40</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>(Intercept) + male</strong></td>
<td style="text-align: center;">121.07</td>
<td style="text-align: center;">107.92</td>
<td style="text-align: center;">135.83</td>
<td style="text-align: center;">6681.2</td>
<td style="text-align: center;">1.7619e-42</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>(Intercept) + smoke</strong></td>
<td style="text-align: center;">134.65</td>
<td style="text-align: center;">126.71</td>
<td style="text-align: center;">143.1</td>
<td style="text-align: center;">24947</td>
<td style="text-align: center;">9.4824e-53</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>(Intercept) + male + smoke + male:smoke</strong></td>
<td style="text-align: center;">174.08</td>
<td style="text-align: center;">164.32</td>
<td style="text-align: center;">184.41</td>
<td style="text-align: center;">30743</td>
<td style="text-align: center;">2.2174e-54</td>
</tr>
</tbody>
</table>
</div>
</div>
<section id="ratio-of-geometric-mean-bp-males-versus-females-in-non-smokers" class="level6">
<h6 class="anchored" data-anchor-id="ratio-of-geometric-mean-bp-males-versus-females-in-non-smokers">Ratio of geometric mean bp, males versus females, in non-smokers</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Male effect in non-smokers</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"male"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>male</strong></td>
<td style="text-align: center;">1.147</td>
<td style="text-align: center;">0.96215</td>
<td style="text-align: center;">1.3672</td>
<td style="text-align: center;">2.3394</td>
<td style="text-align: center;">0.13488</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ratio-of-geometric-mean-bp-males-versus-females-in-smokers" class="level6">
<h6 class="anchored" data-anchor-id="ratio-of-geometric-mean-bp-males-versus-females-in-smokers">Ratio of geometric mean bp, males versus females, in smokers</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Male effect in smokers</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"male + male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>male + male:smoke</strong></td>
<td style="text-align: center;">1.2928</td>
<td style="text-align: center;">1.1888</td>
<td style="text-align: center;">1.4058</td>
<td style="text-align: center;">36.049</td>
<td style="text-align: center;">6.863e-07</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ratio-of-geometric-mean-bp-smokers-versus-non-smokers-in-females" class="level6">
<h6 class="anchored" data-anchor-id="ratio-of-geometric-mean-bp-smokers-versus-non-smokers-in-females">Ratio of geometric mean bp, smokers versus non-smokers, in females</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking effect in females</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>smoke</strong></td>
<td style="text-align: center;">1.2756</td>
<td style="text-align: center;">1.1023</td>
<td style="text-align: center;">1.4763</td>
<td style="text-align: center;">10.668</td>
<td style="text-align: center;">0.002397</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ratio-of-geometric-mean-bp-smokers-versus-non-smokers-in-males" class="level6">
<h6 class="anchored" data-anchor-id="ratio-of-geometric-mean-bp-smokers-versus-non-smokers-in-males">Ratio of geometric mean bp, smokers versus non-smokers, in males</h6>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking effect in males</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"smoke + male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 20%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>smoke + male:smoke</strong></td>
<td style="text-align: center;">1.4379</td>
<td style="text-align: center;">1.2643</td>
<td style="text-align: center;">1.6353</td>
<td style="text-align: center;">30.604</td>
<td style="text-align: center;">2.9341e-06</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="test-for-effect-modification-1" class="level6">
<h6 class="anchored" data-anchor-id="test-for-effect-modification-1">Test for effect modification</h6>
<p>Is the effect of smoking on geometric mean bp modified by male? Is the effect of male on geometric mean bp modified by smoking? Effect modification is symmetric. The answer to these two questions is answered by testing for the significance of the interaction term between male and smoking. The following answers both questions.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect modification</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">2.5 %</th>
<th style="text-align: center;">97.5 %</th>
<th style="text-align: center;">F</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>male:smoke</strong></td>
<td style="text-align: center;">1.1272</td>
<td style="text-align: center;">0.92777</td>
<td style="text-align: center;">1.3694</td>
<td style="text-align: center;">1.4524</td>
<td style="text-align: center;">0.23601</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>
<section id="stata-output" class="level4" data-number="2.1.4">
<h4 data-number="2.1.4" class="anchored" data-anchor-id="stata-output"><span class="header-section-number">2.1.4</span> Stata Output</h4>
<p>Similar Stata output to obtain the results.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>.  <span class="kw">insheet</span> <span class="kw">using</span> <span class="st">"/home/slaughjc/docs/teaching/b312/doc/effectmod/bp.csv"</span>, <span class="kw">clear</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>(3 vars, 40 <span class="kw">obs</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> logbp = <span class="fu">log</span>(bp)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>. <span class="kw">tabulate</span> male smoke, <span class="kw">summarize</span>(bp) nostandard nofreq <span class="kw">noobs</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                                Means <span class="kw">of</span> bp</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>           |        smoke</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>      male |         0          1 |     Total</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>-----------+----------------------+----------</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>         0 |     107.4      135.2 |     121.3</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>         1 |     122.7      174.7 |     148.7</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>-----------+----------------------+----------</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>     Total |    115.05     154.95 |       135</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> 122.7 - 107.4</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>15.3</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> 122.7 / 107.4</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>1.1424581</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> 174.7 - 135.2</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>39.5</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> 174.7 / 135.2</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>1.2921598</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> malesmoke = male*smoke</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>. ************************************************</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>. * Linear Regression: Inference about <span class="kw">means</span> *</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>. ************************************************</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>. <span class="kw">regress</span> bp male smoke malesmoke, <span class="kw">robust</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>Linear regression                                      Number <span class="kw">of</span> <span class="kw">obs</span> =      40</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">F</span>(  3,    36) =   28.05</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>                                                       Prob &gt; <span class="fu">F</span>      =  0.0000</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>                                                       R-squared     =  0.6918</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>                                                       Root MSE      =  17.552</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>             |               Robust</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>        male |       15.3    8.97806     1.70   0.097    -2.908349    33.50835</span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>       smoke |       27.8   7.518865     3.70   0.001     12.55103    43.04897</span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>   malesmoke |       24.2   11.10065     2.18   0.036     1.686837    46.71316</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |      107.4   6.227537    17.25   0.000     94.76997      120.03</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>. * Get the <span class="kw">means</span> presented <span class="kw">in</span> the Table </span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>. *   Method 1: The <span class="kw">adjust</span> command         </span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>. *   Method 2: Four linear combos            </span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>. <span class="kw">adjust</span>, <span class="kw">by</span>(male smoke)</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>---------------------------------------------------------------------------------------</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>     Dependent <span class="kw">variable</span>: bp     Command: <span class="kw">regress</span></span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>    Variable left <span class="kw">as</span> is: malesmoke</span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>---------------------------------------------------------------------------------------</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>------------------------</span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>          |    smoke    </span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>     male |     0      1</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>----------+-------------</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>        0 | 107.4  135.2</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>        1 | 122.7  174.7</span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>------------------------</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>     Key:  Linear Prediction</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> <span class="dt">_cons</span></span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a> ( 1)  <span class="dt">_cons</span> = 0</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>         (1) |      107.4   6.227537    17.25   0.000     94.76997      120.03</span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> <span class="dt">_cons</span> + male</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a> ( 1)  male + <span class="dt">_cons</span> = 0</span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>         (1) |      122.7   6.467096    18.97   0.000     109.5841    135.8159</span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> <span class="dt">_cons</span> + smoke</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a> ( 1)  smoke + <span class="dt">_cons</span> = 0</span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>         (1) |      135.2   4.213207    32.09   0.000     126.6552    143.7448</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> <span class="dt">_cons</span> + male + smoke + malesmoke</span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a> ( 1)  male + smoke + malesmoke + <span class="dt">_cons</span> = 0</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>         (1) |      174.7    4.98676    35.03   0.000     164.5864    184.8136</span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a>. * Now, look <span class="fu">at</span> the important differences</span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> male</span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a> ( 1)  male = 0</span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-120"><a href="#cb20-120" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-121"><a href="#cb20-121" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-122"><a href="#cb20-122" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-123"><a href="#cb20-123" aria-hidden="true" tabindex="-1"></a>         (1) |       15.3    8.97806     1.70   0.097    -2.908349    33.50835</span>
<span id="cb20-124"><a href="#cb20-124" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-125"><a href="#cb20-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-126"><a href="#cb20-126" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> male + malesmoke</span>
<span id="cb20-127"><a href="#cb20-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-128"><a href="#cb20-128" aria-hidden="true" tabindex="-1"></a> ( 1)  male + malesmoke = 0</span>
<span id="cb20-129"><a href="#cb20-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-130"><a href="#cb20-130" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-131"><a href="#cb20-131" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-132"><a href="#cb20-132" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-133"><a href="#cb20-133" aria-hidden="true" tabindex="-1"></a>         (1) |       39.5   6.528314     6.05   0.000     26.25996    52.74004</span>
<span id="cb20-134"><a href="#cb20-134" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-135"><a href="#cb20-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-136"><a href="#cb20-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-137"><a href="#cb20-137" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> smoke</span>
<span id="cb20-138"><a href="#cb20-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-139"><a href="#cb20-139" aria-hidden="true" tabindex="-1"></a> ( 1)  smoke = 0</span>
<span id="cb20-140"><a href="#cb20-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-141"><a href="#cb20-141" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-142"><a href="#cb20-142" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-143"><a href="#cb20-143" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-144"><a href="#cb20-144" aria-hidden="true" tabindex="-1"></a>         (1) |       27.8   7.518865     3.70   0.001     12.55103    43.04897</span>
<span id="cb20-145"><a href="#cb20-145" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-146"><a href="#cb20-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-147"><a href="#cb20-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-148"><a href="#cb20-148" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> smoke + malesmoke</span>
<span id="cb20-149"><a href="#cb20-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-150"><a href="#cb20-150" aria-hidden="true" tabindex="-1"></a> ( 1)  smoke + malesmoke = 0</span>
<span id="cb20-151"><a href="#cb20-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-152"><a href="#cb20-152" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-153"><a href="#cb20-153" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-154"><a href="#cb20-154" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-155"><a href="#cb20-155" aria-hidden="true" tabindex="-1"></a>         (1) |         52   8.166463     6.37   0.000     35.43765    68.56235</span>
<span id="cb20-156"><a href="#cb20-156" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-157"><a href="#cb20-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-158"><a href="#cb20-158" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> malesmoke</span>
<span id="cb20-159"><a href="#cb20-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-160"><a href="#cb20-160" aria-hidden="true" tabindex="-1"></a> ( 1)  malesmoke = 0</span>
<span id="cb20-161"><a href="#cb20-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-162"><a href="#cb20-162" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-163"><a href="#cb20-163" aria-hidden="true" tabindex="-1"></a>          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-164"><a href="#cb20-164" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-165"><a href="#cb20-165" aria-hidden="true" tabindex="-1"></a>         (1) |       24.2   11.10065     2.18   0.036     1.686837    46.71316</span>
<span id="cb20-166"><a href="#cb20-166" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-167"><a href="#cb20-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-168"><a href="#cb20-168" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-169"><a href="#cb20-169" aria-hidden="true" tabindex="-1"></a>. . <span class="kw">tabulate</span> male smoke, <span class="kw">summarize</span>(logbp) nostandard nofreq <span class="kw">noobs</span></span>
<span id="cb20-170"><a href="#cb20-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-171"><a href="#cb20-171" aria-hidden="true" tabindex="-1"></a>                              Means <span class="kw">of</span> logbp</span>
<span id="cb20-172"><a href="#cb20-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-173"><a href="#cb20-173" aria-hidden="true" tabindex="-1"></a>           |        smoke</span>
<span id="cb20-174"><a href="#cb20-174" aria-hidden="true" tabindex="-1"></a>      male |         0          1 |     Total</span>
<span id="cb20-175"><a href="#cb20-175" aria-hidden="true" tabindex="-1"></a>-----------+----------------------+----------</span>
<span id="cb20-176"><a href="#cb20-176" aria-hidden="true" tabindex="-1"></a>         0 | 4.6592534  4.9027077 | 4.7809805</span>
<span id="cb20-177"><a href="#cb20-177" aria-hidden="true" tabindex="-1"></a>         1 | 4.7963605  5.1595116 | 4.9779361</span>
<span id="cb20-178"><a href="#cb20-178" aria-hidden="true" tabindex="-1"></a>-----------+----------------------+----------</span>
<span id="cb20-179"><a href="#cb20-179" aria-hidden="true" tabindex="-1"></a>     Total | 4.7278069  5.0311096 | 4.8794583</span>
<span id="cb20-180"><a href="#cb20-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-181"><a href="#cb20-181" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-182"><a href="#cb20-182" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> <span class="fu">exp</span>(4.6592534)</span>
<span id="cb20-183"><a href="#cb20-183" aria-hidden="true" tabindex="-1"></a>105.55724</span>
<span id="cb20-184"><a href="#cb20-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-185"><a href="#cb20-185" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> <span class="fu">exp</span>(4.7963605)</span>
<span id="cb20-186"><a href="#cb20-186" aria-hidden="true" tabindex="-1"></a>121.06898</span>
<span id="cb20-187"><a href="#cb20-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-188"><a href="#cb20-188" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> <span class="fu">exp</span>(4.9027077)</span>
<span id="cb20-189"><a href="#cb20-189" aria-hidden="true" tabindex="-1"></a>134.65389</span>
<span id="cb20-190"><a href="#cb20-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-191"><a href="#cb20-191" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> <span class="fu">exp</span>(5.1595116)</span>
<span id="cb20-192"><a href="#cb20-192" aria-hidden="true" tabindex="-1"></a>174.07941</span>
<span id="cb20-193"><a href="#cb20-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-194"><a href="#cb20-194" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-195"><a href="#cb20-195" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> <span class="fu">exp</span>(4.7963605) - <span class="fu">exp</span>(4.6592534)</span>
<span id="cb20-196"><a href="#cb20-196" aria-hidden="true" tabindex="-1"></a>15.51174</span>
<span id="cb20-197"><a href="#cb20-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-198"><a href="#cb20-198" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> <span class="fu">exp</span>(4.7963605) / <span class="fu">exp</span>(4.6592534)</span>
<span id="cb20-199"><a href="#cb20-199" aria-hidden="true" tabindex="-1"></a>1.146951</span>
<span id="cb20-200"><a href="#cb20-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-201"><a href="#cb20-201" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-202"><a href="#cb20-202" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> <span class="fu">exp</span>(5.1595116) - <span class="fu">exp</span>(4.9027077)</span>
<span id="cb20-203"><a href="#cb20-203" aria-hidden="true" tabindex="-1"></a>39.425526</span>
<span id="cb20-204"><a href="#cb20-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-205"><a href="#cb20-205" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> <span class="fu">exp</span>(5.1595116) / <span class="fu">exp</span>(4.9027077)</span>
<span id="cb20-206"><a href="#cb20-206" aria-hidden="true" tabindex="-1"></a>1.2927916</span>
<span id="cb20-207"><a href="#cb20-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-208"><a href="#cb20-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-209"><a href="#cb20-209" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-210"><a href="#cb20-210" aria-hidden="true" tabindex="-1"></a>. ***********************************************************</span>
<span id="cb20-211"><a href="#cb20-211" aria-hidden="true" tabindex="-1"></a>. * Linear Regression: Inference about geometric <span class="kw">means</span> *</span>
<span id="cb20-212"><a href="#cb20-212" aria-hidden="true" tabindex="-1"></a>. ***********************************************************</span>
<span id="cb20-213"><a href="#cb20-213" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-214"><a href="#cb20-214" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-215"><a href="#cb20-215" aria-hidden="true" tabindex="-1"></a>. * Get the <span class="fu">log</span> geometric <span class="kw">means</span> presented <span class="kw">in</span> the Table </span>
<span id="cb20-216"><a href="#cb20-216" aria-hidden="true" tabindex="-1"></a>. *   Method 1: The <span class="kw">adjust</span> command                                </span>
<span id="cb20-217"><a href="#cb20-217" aria-hidden="true" tabindex="-1"></a>. *   Method 2: Four linear combos                                   </span>
<span id="cb20-218"><a href="#cb20-218" aria-hidden="true" tabindex="-1"></a>. *   After either method, take <span class="fu">exp</span>(x) to <span class="fu">get</span> geometric <span class="kw">mean</span></span>
<span id="cb20-219"><a href="#cb20-219" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-220"><a href="#cb20-220" aria-hidden="true" tabindex="-1"></a>. <span class="kw">regress</span> logbp male smoke malesmoke, <span class="kw">robust</span></span>
<span id="cb20-221"><a href="#cb20-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-222"><a href="#cb20-222" aria-hidden="true" tabindex="-1"></a>Linear regression                                      Number <span class="kw">of</span> <span class="kw">obs</span> =      40</span>
<span id="cb20-223"><a href="#cb20-223" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">F</span>(  3,    36) =   28.00</span>
<span id="cb20-224"><a href="#cb20-224" aria-hidden="true" tabindex="-1"></a>                                                       Prob &gt; <span class="fu">F</span>      =  0.0000</span>
<span id="cb20-225"><a href="#cb20-225" aria-hidden="true" tabindex="-1"></a>                                                       R-squared     =  0.6271</span>
<span id="cb20-226"><a href="#cb20-226" aria-hidden="true" tabindex="-1"></a>                                                       Root MSE      =  .14898</span>
<span id="cb20-227"><a href="#cb20-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-228"><a href="#cb20-228" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-229"><a href="#cb20-229" aria-hidden="true" tabindex="-1"></a>             |               Robust</span>
<span id="cb20-230"><a href="#cb20-230" aria-hidden="true" tabindex="-1"></a>       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-231"><a href="#cb20-231" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-232"><a href="#cb20-232" aria-hidden="true" tabindex="-1"></a>        male |   .1371071   .0850408     1.61   0.116    -.0353636    .3095778</span>
<span id="cb20-233"><a href="#cb20-233" aria-hidden="true" tabindex="-1"></a>       smoke |   .2434543   .0707116     3.44   0.001     .1000444    .3868641</span>
<span id="cb20-234"><a href="#cb20-234" aria-hidden="true" tabindex="-1"></a>   malesmoke |   .1196969   .0942253     1.27   0.212    -.0714009    .3107946</span>
<span id="cb20-235"><a href="#cb20-235" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   4.659253   .0642883    72.47   0.000     4.528871    4.789636</span>
<span id="cb20-236"><a href="#cb20-236" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-237"><a href="#cb20-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-238"><a href="#cb20-238" aria-hidden="true" tabindex="-1"></a>. <span class="kw">adjust</span>, <span class="kw">by</span>(male smoke)</span>
<span id="cb20-239"><a href="#cb20-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-240"><a href="#cb20-240" aria-hidden="true" tabindex="-1"></a>---------------------------------------------------------------------------------------</span>
<span id="cb20-241"><a href="#cb20-241" aria-hidden="true" tabindex="-1"></a>     Dependent <span class="kw">variable</span>: logbp     Command: <span class="kw">regress</span></span>
<span id="cb20-242"><a href="#cb20-242" aria-hidden="true" tabindex="-1"></a>    Variable left <span class="kw">as</span> is: malesmoke</span>
<span id="cb20-243"><a href="#cb20-243" aria-hidden="true" tabindex="-1"></a>---------------------------------------------------------------------------------------</span>
<span id="cb20-244"><a href="#cb20-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-245"><a href="#cb20-245" aria-hidden="true" tabindex="-1"></a>----------------------------</span>
<span id="cb20-246"><a href="#cb20-246" aria-hidden="true" tabindex="-1"></a>          |      smoke      </span>
<span id="cb20-247"><a href="#cb20-247" aria-hidden="true" tabindex="-1"></a>     male |       0        1</span>
<span id="cb20-248"><a href="#cb20-248" aria-hidden="true" tabindex="-1"></a>----------+-----------------</span>
<span id="cb20-249"><a href="#cb20-249" aria-hidden="true" tabindex="-1"></a>        0 | 4.65925  4.90271</span>
<span id="cb20-250"><a href="#cb20-250" aria-hidden="true" tabindex="-1"></a>        1 | 4.79636  5.15951</span>
<span id="cb20-251"><a href="#cb20-251" aria-hidden="true" tabindex="-1"></a>----------------------------</span>
<span id="cb20-252"><a href="#cb20-252" aria-hidden="true" tabindex="-1"></a>     Key:  Linear Prediction</span>
<span id="cb20-253"><a href="#cb20-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-254"><a href="#cb20-254" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> <span class="dt">_cons</span></span>
<span id="cb20-255"><a href="#cb20-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-256"><a href="#cb20-256" aria-hidden="true" tabindex="-1"></a> ( 1)  <span class="dt">_cons</span> = 0</span>
<span id="cb20-257"><a href="#cb20-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-258"><a href="#cb20-258" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-259"><a href="#cb20-259" aria-hidden="true" tabindex="-1"></a>       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-260"><a href="#cb20-260" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-261"><a href="#cb20-261" aria-hidden="true" tabindex="-1"></a>         (1) |   4.659253   .0642883    72.47   0.000     4.528871    4.789636</span>
<span id="cb20-262"><a href="#cb20-262" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-263"><a href="#cb20-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-264"><a href="#cb20-264" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> <span class="dt">_cons</span> + male</span>
<span id="cb20-265"><a href="#cb20-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-266"><a href="#cb20-266" aria-hidden="true" tabindex="-1"></a> ( 1)  male + <span class="dt">_cons</span> = 0</span>
<span id="cb20-267"><a href="#cb20-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-268"><a href="#cb20-268" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-269"><a href="#cb20-269" aria-hidden="true" tabindex="-1"></a>       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-270"><a href="#cb20-270" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-271"><a href="#cb20-271" aria-hidden="true" tabindex="-1"></a>         (1) |    4.79636   .0556682    86.16   0.000      4.68346    4.909261</span>
<span id="cb20-272"><a href="#cb20-272" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-273"><a href="#cb20-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-274"><a href="#cb20-274" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> <span class="dt">_cons</span> + smoke</span>
<span id="cb20-275"><a href="#cb20-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-276"><a href="#cb20-276" aria-hidden="true" tabindex="-1"></a> ( 1)  smoke + <span class="dt">_cons</span> = 0</span>
<span id="cb20-277"><a href="#cb20-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-278"><a href="#cb20-278" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-279"><a href="#cb20-279" aria-hidden="true" tabindex="-1"></a>       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-280"><a href="#cb20-280" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-281"><a href="#cb20-281" aria-hidden="true" tabindex="-1"></a>         (1) |   4.902708   .0294475   166.49   0.000     4.842985     4.96243</span>
<span id="cb20-282"><a href="#cb20-282" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-283"><a href="#cb20-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-284"><a href="#cb20-284" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> <span class="dt">_cons</span> + male + smoke + malesmoke</span>
<span id="cb20-285"><a href="#cb20-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-286"><a href="#cb20-286" aria-hidden="true" tabindex="-1"></a> ( 1)  male + smoke + malesmoke + <span class="dt">_cons</span> = 0</span>
<span id="cb20-287"><a href="#cb20-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-288"><a href="#cb20-288" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-289"><a href="#cb20-289" aria-hidden="true" tabindex="-1"></a>       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-290"><a href="#cb20-290" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-291"><a href="#cb20-291" aria-hidden="true" tabindex="-1"></a>         (1) |   5.159512   .0279162   184.82   0.000     5.102895    5.216128</span>
<span id="cb20-292"><a href="#cb20-292" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-293"><a href="#cb20-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-294"><a href="#cb20-294" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-295"><a href="#cb20-295" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-296"><a href="#cb20-296" aria-hidden="true" tabindex="-1"></a>. * Now, look <span class="fu">at</span> the important ratios</span>
<span id="cb20-297"><a href="#cb20-297" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb20-298"><a href="#cb20-298" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> male, <span class="kw">eform</span></span>
<span id="cb20-299"><a href="#cb20-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-300"><a href="#cb20-300" aria-hidden="true" tabindex="-1"></a> ( 1)  male = 0</span>
<span id="cb20-301"><a href="#cb20-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-302"><a href="#cb20-302" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-303"><a href="#cb20-303" aria-hidden="true" tabindex="-1"></a>       logbp |     <span class="fu">exp</span>(b)   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-304"><a href="#cb20-304" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-305"><a href="#cb20-305" aria-hidden="true" tabindex="-1"></a>         (1) |   1.146951   .0975376     1.61   0.116     .9652544     1.36285</span>
<span id="cb20-306"><a href="#cb20-306" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-307"><a href="#cb20-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-308"><a href="#cb20-308" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> male + malesmoke, <span class="kw">eform</span></span>
<span id="cb20-309"><a href="#cb20-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-310"><a href="#cb20-310" aria-hidden="true" tabindex="-1"></a> ( 1)  male + malesmoke = 0</span>
<span id="cb20-311"><a href="#cb20-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-312"><a href="#cb20-312" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-313"><a href="#cb20-313" aria-hidden="true" tabindex="-1"></a>       logbp |     <span class="fu">exp</span>(b)   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-314"><a href="#cb20-314" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-315"><a href="#cb20-315" aria-hidden="true" tabindex="-1"></a>         (1) |   1.292792   .0524572     6.33   0.000     1.190663     1.40368</span>
<span id="cb20-316"><a href="#cb20-316" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-317"><a href="#cb20-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-318"><a href="#cb20-318" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> smoke, <span class="kw">eform</span></span>
<span id="cb20-319"><a href="#cb20-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-320"><a href="#cb20-320" aria-hidden="true" tabindex="-1"></a> ( 1)  smoke = 0</span>
<span id="cb20-321"><a href="#cb20-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-322"><a href="#cb20-322" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-323"><a href="#cb20-323" aria-hidden="true" tabindex="-1"></a>       logbp |     <span class="fu">exp</span>(b)   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-324"><a href="#cb20-324" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-325"><a href="#cb20-325" aria-hidden="true" tabindex="-1"></a>         (1) |   1.275648   .0902032     3.44   0.001      1.10522    1.472356</span>
<span id="cb20-326"><a href="#cb20-326" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-327"><a href="#cb20-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-328"><a href="#cb20-328" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lincom</span> malesmoke, <span class="kw">eform</span></span>
<span id="cb20-329"><a href="#cb20-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-330"><a href="#cb20-330" aria-hidden="true" tabindex="-1"></a> ( 1)  malesmoke = 0</span>
<span id="cb20-331"><a href="#cb20-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-332"><a href="#cb20-332" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb20-333"><a href="#cb20-333" aria-hidden="true" tabindex="-1"></a>       logbp |     <span class="fu">exp</span>(b)   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb20-334"><a href="#cb20-334" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb20-335"><a href="#cb20-335" aria-hidden="true" tabindex="-1"></a>         (1) |   1.127155   .1062065     1.27   0.212     .9310886    1.364509</span>
<span id="cb20-336"><a href="#cb20-336" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="ignoring-effect-modification" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="ignoring-effect-modification"><span class="header-section-number">2.2</span> Ignoring effect modification</h3>
<ul>
<li><p>By design or mistake, we sometimes do not model effect modification</p></li>
<li><p>Might perform</p>
<ul>
<li><p>Unadjusted analysis: POI only</p></li>
<li><p>Adjusted analysis: POI and third variable, but no interaction term</p></li>
</ul></li>
<li><p>If effect modification exists, an unadjusted analysis will give different results according to the association between the POI and effect modifier in the sample</p>
<ul>
<li><p>If the POI and the effect modifier are not associated</p>
<ul>
<li><p>Unadjusted analysis tends toward an (approximate) weighted average of the stratum specific effects</p></li>
<li><p>With means, exactly a weighted average</p></li>
<li><p>With odds and hazards, an approximate weighted average (because they are non-linear functions of the mean)</p></li>
</ul></li>
<li><p>If the POI and the effect modifier are associated in the sample</p>
<ul>
<li><p>The “average” effect is confounded and thus unreliable</p></li>
<li><p>(variables can be both effect modifiers and confounders)</p></li>
</ul></li>
</ul></li>
<li><p>If effect modification exists, an analysis adjusting only for the third variable (but no interaction) will tend toward a weight average of the stratum specific effects</p>
<ul>
<li>Hence, an association in one stratum and not the other will make an adjusted analysis look like an association (provide the sample size is large enough)</li>
</ul></li>
</ul>
</section>
</section>
<section id="general-model-for-effect-modification" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="general-model-for-effect-modification"><span class="header-section-number">3</span> General Model for Effect Modification</h2>
<ul>
<li><p>Typical model for effect modification will include</p>
<ul>
<li><p>Main effects</p>
<ul>
<li><p><span class="math inline">\(X\)</span>, or predictors involving only <span class="math inline">\(X\)</span></p></li>
<li><p><span class="math inline">\(W\)</span>, or predictors involving only <span class="math inline">\(W\)</span></p></li>
</ul></li>
<li><p>Interactions</p>
<ul>
<li>Predictors derived from both <span class="math inline">\(X\)</span> and <span class="math inline">\(W\)</span></li>
</ul></li>
</ul>
<p><span class="math display">\[\begin{aligned}
g(\theta | X_i , W_i) &amp; = &amp; \beta_0 + \beta_1 \times X_i + \beta_2 \times W_i + \beta_3 \times (XW)_i \\
g(\theta | X_i , W_i) &amp; = &amp; \beta_0 + \beta_1 \times X_i + \beta_2 \times W_i + \beta_3 \times X_i \times W_i\end{aligned}\]</span></p></li>
<li><p>Interpretation of parameters more difficult</p>
<ul>
<li><p>Can try the usual approach of making comparisons of <span class="math inline">\(\theta\)</span> “across groups differing by 1 unit in corresponding predictor but agreeing in other modeled predictors.”</p></li>
<li><p>However, terms involving two scientific variables makes this approach difficult</p></li>
<li><p>Intercept</p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span>: corresponds to <span class="math inline">\(X=0\)</span>, <span class="math inline">\(W=0\)</span></p></li>
<li><p>May lack scientific meaning</p></li>
</ul></li>
<li><p>Slopes for main effects</p>
<ul>
<li><p><span class="math inline">\(\beta_1\)</span>: corresponds to 1 unit difference in <span class="math inline">\(X\)</span>, holding <span class="math inline">\(W\)</span> and <span class="math inline">\((X \times W)\)</span> constant</p>
<ul>
<li><p>So, a 1 unit difference in <span class="math inline">\(X\)</span> when <span class="math inline">\(W=0\)</span></p></li>
<li><p>May lack scientific meaning</p></li>
</ul></li>
<li><p><span class="math inline">\(\beta_2\)</span>: corresponds to 1 unit difference in <span class="math inline">\(W\)</span>, holding <span class="math inline">\(X\)</span> and <span class="math inline">\((X \times W)\)</span> constant</p>
<ul>
<li><p>So, a 1 unit difference in <span class="math inline">\(W\)</span> when <span class="math inline">\(X=0\)</span></p></li>
<li><p>May lack scientific meaning</p></li>
</ul></li>
</ul></li>
<li><p>Slope for interaction (difficult)</p>
<ul>
<li><p><span class="math inline">\(\beta_3\)</span>: corresponds to 1 unit difference in <span class="math inline">\((X \times W)\)</span>, holding <span class="math inline">\(X\)</span> and <span class="math inline">\(W\)</span> constant</p>
<ul>
<li>Impossible, so we need another way to interpret this slope parameter for the interaction</li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<section id="interpretation-of-slope-parameter-for-the-interaction" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="interpretation-of-slope-parameter-for-the-interaction"><span class="header-section-number">3.1</span> Interpretation of slope parameter for the interaction</h3>
<ul>
<li><p>Consider fixing stratum <span class="math inline">\(W_i = w\)</span>. Then, <span class="math display">\[\begin{aligned}
  g(\theta | X_i , W_i = w) &amp; = &amp; \beta_0 + \beta_1 \times X_i + \beta_2 \times w + \beta_3 \times X_i \times w \\
&amp; = &amp; (\beta_0 + \beta_2 \times w) + (\beta_1 + \beta_3 \times w) \times X_i\end{aligned}\]</span></p>
<ul>
<li><p>Intercept: <span class="math inline">\((\beta_0 + \beta_2 \times w)\)</span> corresponds to <span class="math inline">\(X_i = 0\)</span></p></li>
<li><p>Slope: <span class="math inline">\((\beta_1 + \beta_3 \times w)\)</span> compares groups differing by 1 unit in <span class="math inline">\(X\)</span></p></li>
<li><p><span class="math inline">\(\beta_3\)</span>: Difference in <span class="math inline">\(X\)</span> slope per 1 unit difference in <span class="math inline">\(W\)</span></p></li>
<li><p>Example: <span class="math inline">\(Y\)</span> is height, <span class="math inline">\(X\)</span> is age, <span class="math inline">\(W\)</span> is gender</p>
<ul>
<li><span class="math inline">\(\beta_3\)</span>: Difference in growth curves, males compared to females</li>
</ul></li>
</ul></li>
<li><p>Consider fixing stratum <span class="math inline">\(X_i = x\)</span>. Then, <span class="math display">\[\begin{aligned}
  g(\theta | X_i = x , W_i) &amp; = &amp; \beta_0 + \beta_1 \times x + \beta_2 \times W_i + \beta_3 \times x \times W_i \\
&amp; = &amp; (\beta_0 + \beta_1 \times x) + (\beta_2 + \beta_3 \times x) \times W_i\end{aligned}\]</span></p>
<ul>
<li><p>Intercept: <span class="math inline">\((\beta_0 + \beta_1 \times x)\)</span> corresponds to <span class="math inline">\(W_i = 0\)</span></p></li>
<li><p>Slope: <span class="math inline">\((\beta_2 + \beta_3 \times x)\)</span> compares groups differing by 1 unit in <span class="math inline">\(W\)</span></p></li>
<li><p><span class="math inline">\(\beta_3\)</span>: Difference in <span class="math inline">\(W\)</span> slope per 1 unit difference in <span class="math inline">\(X\)</span></p></li>
</ul></li>
<li><p>Note the implied symmetry</p>
<ul>
<li><p>If <span class="math inline">\(W\)</span> modifies the association between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, then <span class="math inline">\(X\)</span> modifies the association between <span class="math inline">\(W\)</span> and <span class="math inline">\(Y\)</span></p></li>
<li><p>Statistically, there is no distinction between which variable you call your “effect modifier” and your “POI”</p>
<ul>
<li>There often is a scientific distinction that should be considered</li>
</ul></li>
</ul></li>
<li><p>Aside: Does confounding have to be symmetric?</p>
<ul>
<li>If <span class="math inline">\(W\)</span> confounds the association between <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span>, must it also be true that <span class="math inline">\(X\)</span> confounds the association between <span class="math inline">\(W\)</span> and <span class="math inline">\(Y\)</span>?</li>
</ul></li>
</ul>
</section>
<section id="inference-for-effect-modification" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="inference-for-effect-modification"><span class="header-section-number">3.2</span> Inference for Effect Modification</h3>
<p><span class="math inline">\(g(\theta | X_i , W_i) = \beta_0 + \beta_1 \times X_i + \beta_2 \times W_i + \beta_3 \times X_i \times W_i\)</span></p>
<ul>
<li><p>Inference for effect modification</p>
<ul>
<li><p>No effect modification if <span class="math inline">\(\beta_3 = 0\)</span></p></li>
<li><p>Hence, to test for existence of effect modification we consider <span class="math inline">\(H_0: \beta_3 = 0\)</span></p>
<ul>
<li>We can perform such inference using standard regression output for the corresponding slope parameter</li>
</ul></li>
</ul></li>
<li><p>Inference for main effect slope</p>
<ul>
<li><p>Interpretation of <span class="math inline">\(\beta_1 = 0\)</span></p>
<ul>
<li><p>Same intercept in strata defined by <span class="math inline">\(W\)</span></p></li>
<li><p>Generally a very uninteresting question</p></li>
<li><p>We rarely make inference on main effects slopes by themselves</p></li>
</ul></li>
</ul></li>
<li><p>Inference about effect of <span class="math inline">\(X\)</span></p>
<ul>
<li><p>Response parameter not associated with <span class="math inline">\(X\)</span> if <span class="math inline">\(\beta_1 = 0\)</span> AND <span class="math inline">\(\beta_3 = 0\)</span></p></li>
<li><p>We will need to construct special tests that both parameters are simultaneously <span class="math inline">\(0\)</span></p>
<ul>
<li><p><span class="math inline">\(H_0: \beta_1 = 0, \beta_3 = 0\)</span></p></li>
<li><p>Note that the Wald tests given in regression output only consider one slope at a time</p></li>
</ul></li>
</ul></li>
<li><p>Testing multiple slopes in Stata</p>
<ul>
<li><p>Stata has an easy method for performing a test that multiple parameters are simultaneously <span class="math inline">\(0\)</span></p>
<ul>
<li><p>First, perform any regression command</p></li>
<li><p>Then, use <code>test var1 var2 ...</code></p></li>
<li><p>Provides P value of the hypothesis test based on most recently executed regression command</p></li>
<li><p>Will work on any type of regression</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="salary-by-sex-and-administration" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="salary-by-sex-and-administration"><span class="header-section-number">3.3</span> Salary by sex and administration</h3>
<ul>
<li><p>Question: Does sex modify the association between mean salary and administrative duties?</p></li>
<li><p>With two binary variables (sex, admin), modeling the interaction using a product is the obvious choice</p></li>
<li><p><span class="math inline">\(E[Salary | Male, Adm] = \beta_0 + \beta_1 \times Adm_i + \beta_2 \times Male_i + \beta_3 \times Adm_i \times Male_i\)</span></p></li>
</ul>
<section id="stata-regression-output" class="level4" data-number="3.3.1">
<h4 data-number="3.3.1" class="anchored" data-anchor-id="stata-regression-output"><span class="header-section-number">3.3.1</span> Stata Regression Output</h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> maleadmin = male*admin</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>. <span class="kw">regress</span> salary admin male maleadmin, <span class="kw">robust</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>Linear regression                                      Number <span class="kw">of</span> <span class="kw">obs</span> =    1597</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">F</span>(  3,  1593) =  125.26</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>                                                       Prob &gt; <span class="fu">F</span>      =  0.0000</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>                                                       R-squared     =  0.1615</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                                                       Root MSE      =  1866.9</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>             |               Robust</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>      salary |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>       admin |   1489.471    292.628     5.09   0.000     915.4946    2063.448</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        male |   1226.234   95.37051    12.86   0.000      1039.17    1413.299</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>   maleadmin |   461.9072   341.6782     1.35   0.177    -208.2789    1132.093</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   5280.373   72.61871    72.71   0.000     5137.934    5422.811</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="descriptive-statistics" class="level4" data-number="3.3.2">
<h4 data-number="3.3.2" class="anchored" data-anchor-id="descriptive-statistics"><span class="header-section-number">3.3.2</span> Descriptive statistics</h4>
<ul>
<li>Note that with two binary variables, the regression parameters agree exactly with the corresponding group means</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>------------------------------</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>          |        male       </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    admin |        0         1</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>----------+-------------------</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>        0 | 5280.373  6506.607</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        1 | 6769.844  8457.985</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="inference-about-effect-modification" class="level4" data-number="3.3.3">
<h4 data-number="3.3.3" class="anchored" data-anchor-id="inference-about-effect-modification"><span class="header-section-number">3.3.3</span> Inference about effect modification</h4>
<ul>
<li><p>Does sex modify the association between mean salary and administrative duties?</p></li>
<li><p>Model estimates that the administrative supplement is $462 per month more for men than women</p>
<ul>
<li><p>95% confident that the true difference is between $1132 more and $208 less</p></li>
<li><p>Not statistically significant (<span class="math inline">\(p = 0.177\)</span>)</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>             |               Robust</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>      salary |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>       admin |   1489.471    292.628     5.09   0.000     915.4946    2063.448</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>        male |   1226.234   95.37051    12.86   0.000      1039.17    1413.299</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>   maleadmin |   461.9072   341.6782     1.35   0.177    -208.2789    1132.093</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   5280.373   72.61871    72.71   0.000     5137.934    5422.811</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="inference-about-sex-association" class="level4" data-number="3.3.4">
<h4 data-number="3.3.4" class="anchored" data-anchor-id="inference-about-sex-association"><span class="header-section-number">3.3.4</span> Inference about sex association</h4>
<ul>
<li><p>Is sex associated with mean salary?</p></li>
<li><p>Need to test that the slope parameter for male and maleadmin are simultaneously <span class="math inline">\(0\)</span></p>
<ul>
<li><p><span class="math inline">\(H_0: \beta_2 = 0, \beta_3 = 0\)</span></p></li>
<li><p><span class="math inline">\(H_1:\)</span> At least one not equal</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">test</span> male maleadmin</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a> ( 1)  male = 0</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a> ( 2)  maleadmin = 0</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">F</span>(  2,  1593) =   95.90</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>            Prob &gt; <span class="fu">F</span> =    0.0000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="inference-about-admin-association" class="level4" data-number="3.3.5">
<h4 data-number="3.3.5" class="anchored" data-anchor-id="inference-about-admin-association"><span class="header-section-number">3.3.5</span> Inference about admin association</h4>
<ul>
<li><p>Are administrative duties associated with mean salary?</p></li>
<li><p>Need to test that the slope parameter for admin and maleadmin are simultaneously <span class="math inline">\(0\)</span></p>
<ul>
<li><p><span class="math inline">\(H_0: \beta_1 = 0, \beta_3 = 0\)</span></p></li>
<li><p><span class="math inline">\(H_1:\)</span> At least one not equal</p></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">test</span> admin maleadmin</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a> ( 1)  admin = 0</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a> ( 2)  maleadmin = 0</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>       <span class="fu">F</span>(  2,  1593) =   74.15</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>            Prob &gt; <span class="fu">F</span> =    0.0000</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="inference-about-admin-association-using-r" class="level4" data-number="3.3.6">
<h4 data-number="3.3.6" class="anchored" data-anchor-id="inference-about-admin-association-using-r"><span class="header-section-number">3.3.6</span> Inference about admin association using R</h4>
<ul>
<li>See the effect modification lab. We will go over this in detail in class.</li>
</ul>
</section>
</section>
</section>
<section id="continuous-effect-modification" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="continuous-effect-modification"><span class="header-section-number">4</span> Continuous Effect Modification</h2>
<ul>
<li><p>Modeling interactions with continuous predictors is conceptually more complicated</p></li>
<li><p>Is a multiplicative model at all a reasonable model for the data?</p></li>
<li><p>Nonetheless, this is the most common way we detect interactions</p>
<ul>
<li>Be cautious against using the model for prediction of means or individual observations</li>
</ul></li>
</ul>
<section id="example-normal-ranges-for-sep" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="example-normal-ranges-for-sep"><span class="header-section-number">4.1</span> Example: Normal ranges for SEP</h3>
<ul>
<li><p>We want to find normal ranges for somatosensory evoked potential (SEP)</p>
<ul>
<li>p60: Average time (in milliseconds) to detection of the second positive SEP following stimulation of the posterior right and left tibial nerve</li>
</ul></li>
<li><p>As a first step, we want to consider important predictors of nerve conduction times</p>
<ul>
<li><p>If any variables such as sex, age, height, race, etc. are important predictors of nerve conduction times, then it would make most sense to obtain normal ranges within such groups</p></li>
<li><p>Scientifically, we might expect that height, age, and sex are related to the nerve conduction time</p>
<ul>
<li><p>Nerve length should matter, and height is a surrogate for nerve length</p></li>
<li><p>Age might affect nerve conduction times (people slow down with age)</p></li>
<li><p>Sex: Males have worse nervous systems</p></li>
</ul></li>
</ul></li>
<li><p>Prior to looking at the data, we can also consider the possibility that interactions between these variables might be important</p>
<ul>
<li><p>Height and age interaction? Do we expect…</p>
<ul>
<li><p>Difference in conduction times comparing 6 foot tall and 5 foot tall 20 year old, to be the same as …</p></li>
<li><p>Difference in conduction times comparing 6 foot tall and 5 foot tall 50 year old, to be the same as …</p></li>
<li><p>Difference in conduction times comparing 6 foot tall and 5 foot tall 80 year old?</p></li>
</ul></li>
<li><p>We might suspect such an interaction due to the fact that height may not be as good a surrogate for nerve length in older people</p>
<ul>
<li>With age, some people tend to shrink due to osteoporosis and compression of intervertebral discs. It is not clear that nerve length would be altered in such a process.</li>
</ul></li>
<li><p>Thus, in young people, differences in height probably are a better measure of nerve length than in old people</p>
<ul>
<li><p>Tall old people probably have been tall always</p></li>
<li><p>Short old people will include some who were taller when they were young</p></li>
</ul></li>
</ul></li>
<li><p>We can also consider the possibility of three way interactions between height, age, and sex</p>
<ul>
<li><p>Osteoporosis affects women far more than men</p></li>
<li><p>We might expect the height-age interaction to be greatest in women and not so important in men</p></li>
<li><p>A two-way interaction between height and age that is different between men and women defines a three way interaction between height, age, and sex</p></li>
</ul></li>
</ul>
</section>
<section id="sep-regression-model" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="sep-regression-model"><span class="header-section-number">4.2</span> SEP regression model</h3>
<ul>
<li><p>To define a regression model with interactions, we must create variables to model the three way interaction term</p></li>
<li><p>Furthermore, it is a <strong>very good</strong> idea to include all main effects and lower order interactions in the model too</p>
<ul>
<li><p>Main effects: The individual variables which contribute to the interaction</p></li>
<li><p>Lower order terms: All interactions that involve some combination of the variables which contribute to the interaction</p></li>
</ul></li>
<li><p>Most often, we lack sufficient information to be able to guess what the true form of an interaction might be</p>
<ul>
<li><p>The most popular approach is thus to consider multiplicative interactions</p></li>
<li><p>Create a new variable by merely multiplying the two (or more) interacting predictors</p></li>
</ul></li>
<li><p>For the problem, we will create the variables</p>
<ul>
<li><p>HA = Height * Age</p></li>
<li><p>HM = Height * Male</p></li>
<li><p>AM = Age * Male</p></li>
<li><p>HAM = Height * Age * Male</p></li>
</ul></li>
<li><p>Interpretation: In the presence of higher order terms (powers, interactions) interpretation of parameters is not easy</p>
<ul>
<li><p>We can no longer use “the change associated with a 1-unit difference in predictor holding other variables constant”</p></li>
<li><p>It is generally impossible to hold other variables constant when changing a covariate involved in an interaction</p></li>
<li><p>When it is not impossible, it is often uninteresting scientifically</p></li>
</ul></li>
</ul>
<p><span class="math inline">\(E[p60 | Ht, Age, Male] = \beta_0 + \beta_H Ht + \beta_A Age + \beta_M Male + \beta_{HA} HA + \beta_{HM} HM + \beta_{AM} AM + \beta_{HAM} HAM\)</span></p>
<ul>
<li><p>p60 - Height relationship for Age = a:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 35%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Sex</th>
<th style="text-align: left;">Intercept</th>
<th style="text-align: left;">Slope</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">F</td>
<td style="text-align: left;"><span class="math inline">\((\beta_0 + \beta_A a)\)</span></td>
<td style="text-align: left;"><span class="math inline">\((\beta_H + \beta_{HA} a)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">M</td>
<td style="text-align: left;"><span class="math inline">\((\beta_0 + \beta_M + (\beta_A + \beta_{AM}) a)\)</span></td>
<td style="text-align: left;"><span class="math inline">\((\beta_H + \beta_{HM} + (\beta_{HA} + \beta_{HAM}) a)\)</span></td>
</tr>
</tbody>
</table></li>
<li><p>From the above, we see the importance of including the main effects and lower order terms</p>
<ul>
<li><p>E.g., leaving out the height-sex interaction is tantamount that claiming the p60 - height relationship among newborns is the same for the two sexes</p>
<ul>
<li>It might be true, but the chance that our lines would predict the truth is very slight– we are trying to approximate relationships in other age ranges</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="regression-output" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="regression-output"><span class="header-section-number">4.3</span> Regression Output</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">regress</span> p60 height age male ha hm am ham</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>         p60 |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>      height |   1.380275    .362647     3.81   0.000     .6659271    2.094622</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>         age |   1.129423   .4249166     2.66   0.008     .2924161     1.96643</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>        male |   74.95773   32.30708     2.32   0.021     11.31875    138.5967</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>          ha |  -.0149985   .0066386    -2.26   0.025    -.0280754   -.0019217</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>          hm |  -1.127006   .4825427    -2.34   0.020    -2.077526   -.1764858</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>          am |  -1.162866   .5817348    -2.00   0.047    -2.308776   -.0169558</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>         ham |   .0175005   .0087708     2.00   0.047     .0002236    .0347773</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |  -36.44286   23.48684    -1.55   0.122    -82.70758     9.82187</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>If we restrict analysis to just females</p>
<ul>
<li><p>Point estimates are the same as in the saturated model</p></li>
<li><p>Inference (CIs, p-values) can differ due to the estimate of the residual standard error</p></li>
<li><p>Note that restricting by age or height would give different estimates because we are still borrowing information across groups</p></li>
</ul>
<!-- -->
<div class="sourceCode" id="cb27"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">regress</span> p60 height age ha <span class="kw">if</span> male==0</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>         p60 |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>      height |   1.380275   .3614558     3.82   0.000     .6653291     2.09522</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>         age |   1.129423   .4235208     2.67   0.009     .2917155    1.967131</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>          ha |  -.0149985   .0066168    -2.27   0.025    -.0280863   -.0019108</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |  -36.44286   23.40969    -1.56   0.122    -82.74631    9.860598</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Interpreting all of the estimates can be difficult</p>
<ul>
<li><p>Can graph predicted values, which should be multiple linear for this model</p></li>
<li><p>Note that age is a continuous variable, so to understand how age modified the association between p60 and height, we will fix age at some values</p>
<ul>
<li>Using general notation, let <span class="math inline">\(Age = a\)</span></li>
</ul></li>
</ul></li>
<li><p>Estimated association between p60 and height for Females</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 36%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Age</th>
<th style="text-align: left;">Intercept</th>
<th style="text-align: left;">Slope</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: left;"><span class="math inline">\(\hat{\beta}_0 + \hat{\beta}_A \times a\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\hat{\beta}_H + \hat{\beta}_{HA} \times a\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: left;"><span class="math inline">\(-36.44 + 1.129 \times a\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1.38 - 0.01499 \times a\)</span></td>
</tr>
</tbody>
</table></li>
<li><p>Estimated association between p60 and height in Males</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 35%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Age</th>
<th style="text-align: left;">Intercept</th>
<th style="text-align: left;">Slope</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: left;"><span class="math inline">\(\hat{\beta}_0 + \hat{\beta}_M + (\hat{\beta}_A + \hat{\beta}_{AM}) a\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\hat{\beta}_H + \hat{\beta}_{HM} + (\hat{\beta}_{HA} + \hat{\beta}_{HAM}) a\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">a</td>
<td style="text-align: left;"><span class="math inline">\(-36.44 + 74.96 + (1.13 - 1.16) a\)</span></td>
<td style="text-align: left;"><span class="math inline">\(1.38 - 1.13 + (-0.015 + 0.0175) a\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">a</td>
<td style="text-align: left;"><span class="math inline">\(38.51 - 0.033 \times a\)</span></td>
<td style="text-align: left;"><span class="math inline">\(0.25 + 0.0025 \times a\)</span></td>
</tr>
</tbody>
</table></li>
<li><p>Which corresponds to a regression including just males</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">regress</span> p60 height age ha <span class="kw">if</span> male==1</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>         p60 |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>      height |   .2532689   .3196022     0.79   0.430    -.3801724    .8867101</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>         age |  -.0334425   .3989042    -0.08   0.933    -.8240577    .7571727</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>          ha |   .0025019   .0057549     0.43   0.665    -.0089041    .0139079</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |   38.51487   22.27228     1.73   0.087    -5.628068    82.65781</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ul>
<section id="r-code-to-generate-plot" class="level4" data-number="4.3.1">
<h4 data-number="4.3.1" class="anchored" data-anchor-id="r-code-to-generate-plot"><span class="header-section-number">4.3.1</span> R Code to generate plot</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">stata.get</span>(<span class="st">"http://biostat.app.vumc.org/wiki/pub/Main/CourseBios312/sep.dta"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>p60 <span class="ot">&lt;-</span> (d2<span class="sc">$</span>p60R <span class="sc">+</span> d2<span class="sc">$</span>p60L) <span class="sc">/</span><span class="dv">2</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>m.female <span class="ot">&lt;-</span> <span class="fu">lm</span>(p60 <span class="sc">~</span> height <span class="sc">+</span> age <span class="sc">+</span> height<span class="sc">:</span>age, <span class="at">data=</span>d2, <span class="at">subset=</span>sex<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>m.male <span class="ot">&lt;-</span> <span class="fu">lm</span>(p60 <span class="sc">~</span> height <span class="sc">+</span> age <span class="sc">+</span> height<span class="sc">:</span>age, <span class="at">data=</span>d2, <span class="at">subset=</span>sex<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>agecat <span class="ot">&lt;-</span> (d2<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">35</span>) <span class="sc">+</span> (d2<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">60</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d2, <span class="fu">plot</span>(height[sex<span class="sc">==</span><span class="dv">0</span>], p60[sex<span class="sc">==</span><span class="dv">0</span>], <span class="at">pch=</span>agecat[sex<span class="sc">==</span><span class="dv">0</span>], <span class="at">col=</span>agecat[sex<span class="sc">==</span><span class="dv">0</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">53</span>,<span class="dv">80</span>),</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">80</span>), <span class="at">ylab=</span><span class="st">"Avg P60"</span>, <span class="at">xlab=</span><span class="st">"Height"</span>, <span class="at">main=</span><span class="st">"Females"</span>))</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">70</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"30"</span>,<span class="st">"50"</span>,<span class="st">"70"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">title=</span><span class="st">"Age"</span>)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d2, <span class="fu">plot</span>(height[sex<span class="sc">==</span><span class="dv">1</span>], p60[sex<span class="sc">==</span><span class="dv">1</span>], <span class="at">pch=</span>agecat[sex<span class="sc">==</span><span class="dv">1</span>], <span class="at">col=</span>agecat[sex<span class="sc">==</span><span class="dv">1</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">53</span>,<span class="dv">80</span>),</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>   <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">80</span>), <span class="at">ylab=</span><span class="st">"Avg P60"</span>, <span class="at">xlab=</span><span class="st">"Height"</span>, <span class="at">main=</span><span class="st">"Males"</span>))</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">70</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"&lt;35"</span>,<span class="st">"35-60"</span>,<span class="st">"60+"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">bty=</span><span class="st">"n"</span>,<span class="at">title=</span><span class="st">"Age"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lec10.Modeling.Effect.Modification_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="influence-diagnostics" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="influence-diagnostics"><span class="header-section-number">4.4</span> Influence diagnostics</h3>
<ul>
<li><p>From the output, we find a statistically significant three way interaction (p = 0.047)</p></li>
<li><p>This would argue for making prediction based on a model that include the 3-way interaction</p></li>
<li><p>However, interactions might be significant only because of a single outlier</p>
<ul>
<li><p>If that were the case, I might choose not to include the interaction</p></li>
<li><p>But, I would include the influential data point</p></li>
<li><p>We will look at the results of a “diagnosis of influential observations now, and cover in more detail later</p></li>
</ul></li>
<li><p>In particular, I am interested in ensuring that the evidence for an interaction is not based solely on a single person’s observation</p>
<ul>
<li><p>Hence, I consider 250 different regression in which I leave out each subject in turn</p></li>
<li><p>I plot the slope estimates and p-values for each variable as a function of which case I left out</p></li>
<li><p>For comparison, case 0 corresponds to using the full dataset</p></li>
</ul></li>
<li><p>Changes in coefficients (<span class="math inline">\(\beta\)</span>s)</p></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate changes in p-values and coefficients</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some variables to store the results</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d2<span class="sc">$</span>p60)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>case <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">length</span>(d2<span class="sc">$</span>p60)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># p is number of predictors</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(case), <span class="at">ncol=</span>p)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(case), <span class="at">ncol=</span>p)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the regression model with 1 observation deleted, save the coeffs and p-vals</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="co">#  Note that case=0 corresponds to the full model (no observations deleted)</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> case) {</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">lm</span>(p60 <span class="sc">~</span> height<span class="sc">*</span>age<span class="sc">*</span>sex, <span class="at">data=</span>d2, <span class="at">subset=</span>(id<span class="sc">!=</span>i))</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>  coeffs[i<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">coef</span>(m)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  pvals[i<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coeff[,<span class="dv">4</span>]</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the regression coefficients by which subject was deleted; highlight the unusual subject</span></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(case, coeffs[,i], <span class="at">ylab=</span>(<span class="fu">names</span>(<span class="fu">coef</span>(m))[i]))</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="dv">140</span>, <span class="at">y=</span>coeffs[<span class="dv">141</span>,i], <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">"Red"</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lec10.Modeling.Effect.Modification_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Changes in p-values for <span class="math inline">\(\beta\)</span>s</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the p-values for the regression coefficients by which subject was deleted</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(case, pvals[,i], <span class="at">ylab=</span>(<span class="fu">names</span>(<span class="fu">coef</span>(m))[i]))</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="dv">140</span>, <span class="at">y=</span>coeffs[<span class="dv">141</span>,i], <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">"Red"</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lec10.Modeling.Effect.Modification_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>Contrary to my fear, the only influential observation actually lessened the evidence of an interaction</p>
<ul>
<li><p>When observation 140 is removed from the data, the evidence of an interaction is a larger estimate and lower p-value</p></li>
<li><p>We can examine the scatterplot to see why subject 140 might be so influential</p></li>
<li><p>Subject 140 is a 43 year old, 57 inch female with an average p60 of 66.6</p></li>
</ul></li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with subject 140 highlighted</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d2, <span class="fu">plot</span>(height, p60, <span class="at">xlab=</span><span class="st">"Height"</span>, <span class="at">ylab=</span><span class="st">"Avg p60"</span>, <span class="at">main=</span><span class="st">"Subject 140: 43 year old female"</span>))</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d2, <span class="fu">points</span>(height[<span class="dv">140</span>], p60[<span class="dv">140</span>], <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">"Red"</span>))</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"30 Female"</span>,<span class="st">"50 Female"</span>,<span class="st">"30 Male"</span>, <span class="st">"50 Male"</span>),</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">title=</span><span class="st">"Age, Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Lec10.Modeling.Effect.Modification_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p>So, what do I do with observation 140?</p>
<ul>
<li><p>From the influence diagnostics, I am still comfortable that the data suggest a 3-way interaction</p></li>
<li><p>Personally, I do not remove observation 140 when making prediction intervals</p>
<ul>
<li><p>I do not know why observation 140 is unusual</p></li>
<li><p>It is possible that people like 140 are actually more prevalent in the population than my sample would suggest</p></li>
<li><p>My best guess is observation 140 represents only <span class="math inline">\(0.4\%\)</span> of the population, but would still leave her in the analysis</p></li>
</ul></li>
<li><p>Removing subject 140 could bias parameter estimates, so I would rarely remove observations based on diagnostics</p></li>
</ul></li>
</ul>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/chrissl789\.github\.io\/modern-regression\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/Lec09.Poisson.html" class="pagination-link" aria-label="Poisson Regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Poisson Regression</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notes/Set8.pdf" class="pagination-link" aria-label="Multinomial and Ordinal Regression">
        <span class="nav-page-text">Multinomial and Ordinal Regression</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb33" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Modeling Effect Modification"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Lecture 10"</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="an">name:</span><span class="co"> Lec10.Modeling.Effect.Modification.qmd</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(biostat3)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="fu">source</span>(<span class="st">'pander_registry.R'</span>), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">invisible</span>(e))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Scientific questions</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Most often scientific questions are translated into comparing the distribution of some response variable across groups of interest</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Groups are defined by the predictor of interest (POI)</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Effect modification evaluates if the association between the outcome and POI is modified by strata defined by a third, modifying variable</span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Examples of effect modification</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Binary effect modification: If we stratify by gender, we may get different answers to our scientific question in men and women</span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Continuous effect modification: If we stratify by age, we way get different answers to our scientific question in young and old</span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The association between the Response and the Predictor of Interest differs in strata defined by the effect modifier</span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Will get different answers to the scientific question within different strata defined by the effect modifier</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Statistical term: "Interaction" between the effect modifier and the POI</span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Effect modification depends on the measure of effect that you choose</span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Choice of summary measure: mean, median, geometric mean, odds, hazard</span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Choice of comparisons across groups: differences, ratios</span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We will also do some model diagnostics through examples</span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When looking at effect modification, I am also worried that one point may be driving the interaction</span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Will go over case diagnostics in an example analysis of somatosensory evoked potential (SEP)</span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Graphical displays for effect modification</span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When analyzing difference of means of continuous data, stratified smooth curves of the data are non-parallel</span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Graphical techniques more difficult for odds and hazards</span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Unadjusted association between outcome and predictor shows a flat slope.</span></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1231</span>)</span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a>grp <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">each=</span>n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a>emplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">grp=</span>grp,</span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>                     <span class="at">X=</span>X,</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a>                     <span class="at">Y=</span>.<span class="dv">1</span><span class="sc">*</span>grp <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>X <span class="sc">-</span><span class="dv">4</span><span class="sc">*</span>grp<span class="sc">*</span>X <span class="sc">+</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a>emplot<span class="sc">$</span>group <span class="ot">&lt;-</span> <span class="fu">factor</span>(emplot<span class="sc">$</span>grp, <span class="at">levels=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Trt"</span>,<span class="st">"Ctrl"</span>))</span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emplot, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Adjusted association between outcome and predictor shows an increasing slope in one group and a decreasing slope in the other.  This demonstrates effect modification of group.</span></span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emplot, <span class="fu">aes</span>(<span class="at">x=</span>X, <span class="at">y=</span>Y, <span class="at">color=</span>group, <span class="at">grp=</span>group)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">se=</span><span class="cn">FALSE</span>,) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## Analysis of Effect Modification</span></span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>When the scientific question involves effect modification, analyses must be performed within each stratum separately</span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If we want to test the degree of effect modification or test statistically, the regression model will typically include</span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Predictor of interest</span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Effect modifier</span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A covariate modeling the interaction (usually a product)</span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Is blood pressure by gender modified by smoking?</span></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>       <span class="pp">|</span>           <span class="pp">|</span>          <span class="pp">|</span>           <span class="pp">|</span>          <span class="pp">|</span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a><span class="pp">|-------|-----------|----------|-----------|----------|</span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>       <span class="pp">|</span> Non-Smoke <span class="pp">|</span> Smoke    <span class="pp">|</span> Non-smoke <span class="pp">|</span> Smoke    <span class="pp">|</span></span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Women <span class="pp">|</span> 107.4     <span class="pp">|</span> 135.2    <span class="pp">|</span> 105.6     <span class="pp">|</span> 134.7    <span class="pp">|</span></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Men   <span class="pp">|</span> 122.7     <span class="pp">|</span> 174.7    <span class="pp">|</span> 121.1     <span class="pp">|</span> 174.1    <span class="pp">|</span></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span>       <span class="pp">|</span>           <span class="pp">|</span>          <span class="pp">|</span>           <span class="pp">|</span>          <span class="pp">|</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Diff  <span class="pp">|</span> **15.3**  | **39.5** <span class="pp">|</span> 15.5      <span class="pp">|</span> 39.4     <span class="pp">|</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Ratio <span class="pp">|</span> 1.14      <span class="pp">|</span> 1.28     <span class="pp">|</span> **1.15**  | **1.29** <span class="pp">|</span></span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model for the Mean</span></span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model: $Y = \beta_0 + \beta_M * \textrm{Male} + \beta_S * \textrm{Smoke} + \beta_{MS} * \textrm{Male} * \textrm{Smoke} + \epsilon$</span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Male and Smoke are modeled using indicator variables</span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Male is 1 for males, 0 for females</span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Smoke is 1 for smokers, 0 for non-smokers</span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Estimates of the mean from the regression model are given in the following table</span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span>                <span class="pp">|</span>                      <span class="pp">|</span>                                            <span class="pp">|</span></span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|-------------------|-------------------|----------------------------------|</span></span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span>                <span class="pp">|</span> Non-smoker (smoke=0) <span class="pp">|</span> Smoker (smoke=1)                           <span class="pp">|</span></span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span> Women (male=0) <span class="pp">|</span> $\beta_0$            <span class="pp">|</span> $\beta_0 + \beta_S$                        <span class="pp">|</span></span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span> Men (male=1)   <span class="pp">|</span> $\beta_0 + \beta_M$  <span class="pp">|</span> $\beta_0 + \beta_S + \beta_M + \beta_{MS}$ <span class="pp">|</span></span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span> Difference     <span class="pp">|</span> $\beta_M$            <span class="pp">|</span> $\beta_M + \beta_{MS}$                     <span class="pp">|</span></span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>What is the scientific interpretation of $\beta_{MS} = 0$?</span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If true, the Male to Female difference in smokers $= \beta_M$</span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>And, the Male to Female difference in non-smokers $= \beta_M$</span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>In other words, the effect of gender is *the same* in smoker and non-smokers</span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>A test of $H_0$: $\beta_{MS} = 0$ is a test of effect modification (for means, differences)</span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model for the Geometric Mean</span></span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model: $\textrm{log}(Y) = \beta_0 + \beta_M * \textrm{Male} + \beta_S * \textrm{Smoke} + \beta_{MS} * \textrm{Male} * \textrm{Smoke} + \epsilon$</span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Male and Smoke are modeled using indicator variables</span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Male is 1 for males, 0 for females</span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Smoke is 1 for smokers, 0 for non-smokers</span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Estimates of the geometric mean from the regression model are given in the following table</span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span>                <span class="pp">|</span>                         <span class="pp">|</span>                                                <span class="pp">|</span></span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|-------------------|-------------------|----------------------------------|</span></span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span>                <span class="pp">|</span> Non-smoker (smoke=0)    <span class="pp">|</span> Smoker (smoke=1)                               <span class="pp">|</span></span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span> Women (male=0) <span class="pp">|</span> $e^{\beta_0}$           <span class="pp">|</span> $e^{\beta_0 + \beta_S}$                        <span class="pp">|</span></span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span> Men (male=1)   <span class="pp">|</span> $e^{\beta_0 + \beta_M}$ <span class="pp">|</span> $e^{\beta_0 + \beta_S + \beta_M + \beta_{MS}}$ <span class="pp">|</span></span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a>    <span class="pp">|</span> Ratio          <span class="pp">|</span> $e^{\beta_M}$           <span class="pp">|</span> $e^{\beta_M + \beta_{MS}}$                     <span class="pp">|</span></span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>What is the scientific interpretation of $\beta_{MS} = 0$?</span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If true, the Male to Female ratio in smokers $= e^{\beta_M}$</span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>And, the Male to Female ratio in non-smokers $= e^{\beta_M}$</span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>In other words, the effect of gender is *the same* in smoker and non-smokers</span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>A test of $H_0$: $\beta_{MS} = 0$ is a test of effect modification (for geometric means, ratios)</span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R Output</span></span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Means</span></span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true" tabindex="-1"></a>We can obtain the means by male and smoking using summary statistics or from regression ouput</span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-170"><a href="#cb33-170" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/bp.csv"</span>)</span>
<span id="cb33-171"><a href="#cb33-171" aria-hidden="true" tabindex="-1"></a>bp<span class="sc">$</span>logbp <span class="ot">&lt;-</span> <span class="fu">log</span>(bp<span class="sc">$</span>bp)</span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true" tabindex="-1"></a>bp<span class="sc">$</span>malesmoke <span class="ot">&lt;-</span> bp<span class="sc">$</span>male <span class="sc">*</span> bp<span class="sc">$</span>smoke</span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb33-175"><a href="#cb33-175" aria-hidden="true" tabindex="-1"></a>bp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(smoke, male) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">meanbp=</span><span class="fu">mean</span>(bp))</span>
<span id="cb33-176"><a href="#cb33-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(bp <span class="sc">~</span> male <span class="sc">+</span> smoke <span class="sc">+</span> male<span class="sc">*</span>smoke, <span class="at">data=</span>bp)</span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-183"><a href="#cb33-183" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">male=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">smoke=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb33-184"><a href="#cb33-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-185"><a href="#cb33-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted means from the regression model.  Matches above table</span></span>
<span id="cb33-186"><a href="#cb33-186" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(newdata, <span class="fu">predict</span>(m1, newdata))</span>
<span id="cb33-187"><a href="#cb33-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-188"><a href="#cb33-188" aria-hidden="true" tabindex="-1"></a><span class="co"># Four linear combinations using biostat3 function lincom and robust standard error</span></span>
<span id="cb33-189"><a href="#cb33-189" aria-hidden="true" tabindex="-1"></a><span class="co">#  to obtain the 4 means</span></span>
<span id="cb33-190"><a href="#cb33-190" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="fu">c</span>(<span class="st">"(Intercept)"</span>,</span>
<span id="cb33-191"><a href="#cb33-191" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + male"</span>,</span>
<span id="cb33-192"><a href="#cb33-192" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + smoke"</span>,</span>
<span id="cb33-193"><a href="#cb33-193" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + male + smoke + male:smoke"</span>),</span>
<span id="cb33-194"><a href="#cb33-194" aria-hidden="true" tabindex="-1"></a>       <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span>
<span id="cb33-195"><a href="#cb33-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-196"><a href="#cb33-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-197"><a href="#cb33-197" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Difference in mean bp, males versus females, in non-smokers</span></span>
<span id="cb33-198"><a href="#cb33-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-201"><a href="#cb33-201" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-202"><a href="#cb33-202" aria-hidden="true" tabindex="-1"></a><span class="co"># Male effect in non-smokers</span></span>
<span id="cb33-203"><a href="#cb33-203" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"male"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span>
<span id="cb33-204"><a href="#cb33-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-205"><a href="#cb33-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-206"><a href="#cb33-206" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Difference in mean bp, males versus females, in smokers</span></span>
<span id="cb33-207"><a href="#cb33-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-210"><a href="#cb33-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-211"><a href="#cb33-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Male effect in smokers</span></span>
<span id="cb33-212"><a href="#cb33-212" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"male + male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span>
<span id="cb33-213"><a href="#cb33-213" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-214"><a href="#cb33-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-215"><a href="#cb33-215" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Difference in mean bp, smokers versus non-smokers, in females</span></span>
<span id="cb33-216"><a href="#cb33-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-219"><a href="#cb33-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-220"><a href="#cb33-220" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking effect in females</span></span>
<span id="cb33-221"><a href="#cb33-221" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span>
<span id="cb33-222"><a href="#cb33-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-223"><a href="#cb33-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-224"><a href="#cb33-224" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Difference in mean bp, smokers versus non-smokers, in males</span></span>
<span id="cb33-225"><a href="#cb33-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-228"><a href="#cb33-228" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-229"><a href="#cb33-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking effect in males</span></span>
<span id="cb33-230"><a href="#cb33-230" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"smoke + male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span>
<span id="cb33-231"><a href="#cb33-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-232"><a href="#cb33-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-233"><a href="#cb33-233" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Test for effect modification</span></span>
<span id="cb33-234"><a href="#cb33-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-235"><a href="#cb33-235" aria-hidden="true" tabindex="-1"></a>Is the effect of smoking on mean bp modified by male? Is the effect of male on mean bp modified by smoking? Effect modification is symmetric. The answer to these two questions is answered by testing for the significance of the interaction term between male and smoking. The following answers both questions.</span>
<span id="cb33-236"><a href="#cb33-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-239"><a href="#cb33-239" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-240"><a href="#cb33-240" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect modification</span></span>
<span id="cb33-241"><a href="#cb33-241" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m1, <span class="st">"male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m1, <span class="at">type =</span> <span class="st">"hc3"</span>))</span>
<span id="cb33-242"><a href="#cb33-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-243"><a href="#cb33-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-244"><a href="#cb33-244" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Geometric Means</span></span>
<span id="cb33-245"><a href="#cb33-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-246"><a href="#cb33-246" aria-hidden="true" tabindex="-1"></a>We can obtain the geometric means by male and smoking using summary statistics or from regression ouput</span>
<span id="cb33-247"><a href="#cb33-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-250"><a href="#cb33-250" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-251"><a href="#cb33-251" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb33-252"><a href="#cb33-252" aria-hidden="true" tabindex="-1"></a>bp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(smoke, male) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">geomeanbp=</span><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(bp))))</span>
<span id="cb33-253"><a href="#cb33-253" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-254"><a href="#cb33-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-257"><a href="#cb33-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-258"><a href="#cb33-258" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(logbp <span class="sc">~</span> male <span class="sc">+</span> smoke <span class="sc">+</span> male<span class="sc">*</span>smoke, <span class="at">data=</span>bp)</span>
<span id="cb33-259"><a href="#cb33-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-260"><a href="#cb33-260" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">male=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="at">smoke=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb33-261"><a href="#cb33-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-262"><a href="#cb33-262" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicted means from the regression model.  Matches above table</span></span>
<span id="cb33-263"><a href="#cb33-263" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(newdata, <span class="fu">exp</span>(<span class="fu">predict</span>(m2, newdata)))</span>
<span id="cb33-264"><a href="#cb33-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-265"><a href="#cb33-265" aria-hidden="true" tabindex="-1"></a><span class="co"># Four linear combinations using biostat3 function lincom and robust standard error</span></span>
<span id="cb33-266"><a href="#cb33-266" aria-hidden="true" tabindex="-1"></a><span class="co">#  to obtain the 4 means</span></span>
<span id="cb33-267"><a href="#cb33-267" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="fu">c</span>(<span class="st">"(Intercept)"</span>,</span>
<span id="cb33-268"><a href="#cb33-268" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + male"</span>,</span>
<span id="cb33-269"><a href="#cb33-269" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + smoke"</span>,</span>
<span id="cb33-270"><a href="#cb33-270" aria-hidden="true" tabindex="-1"></a>             <span class="st">"(Intercept) + male + smoke + male:smoke"</span>),</span>
<span id="cb33-271"><a href="#cb33-271" aria-hidden="true" tabindex="-1"></a>       <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>),</span>
<span id="cb33-272"><a href="#cb33-272" aria-hidden="true" tabindex="-1"></a>       <span class="at">eform=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-273"><a href="#cb33-273" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-274"><a href="#cb33-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-275"><a href="#cb33-275" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Ratio of geometric mean bp, males versus females, in non-smokers</span></span>
<span id="cb33-276"><a href="#cb33-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-279"><a href="#cb33-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-280"><a href="#cb33-280" aria-hidden="true" tabindex="-1"></a><span class="co"># Male effect in non-smokers</span></span>
<span id="cb33-281"><a href="#cb33-281" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"male"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-282"><a href="#cb33-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-283"><a href="#cb33-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-284"><a href="#cb33-284" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Ratio of geometric mean bp, males versus females, in smokers</span></span>
<span id="cb33-285"><a href="#cb33-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-288"><a href="#cb33-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-289"><a href="#cb33-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Male effect in smokers</span></span>
<span id="cb33-290"><a href="#cb33-290" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"male + male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-291"><a href="#cb33-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-292"><a href="#cb33-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-293"><a href="#cb33-293" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Ratio of geometric mean bp, smokers versus non-smokers, in females</span></span>
<span id="cb33-294"><a href="#cb33-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-297"><a href="#cb33-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-298"><a href="#cb33-298" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking effect in females</span></span>
<span id="cb33-299"><a href="#cb33-299" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-300"><a href="#cb33-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-301"><a href="#cb33-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-302"><a href="#cb33-302" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Ratio of geometric mean bp, smokers versus non-smokers, in males</span></span>
<span id="cb33-303"><a href="#cb33-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-306"><a href="#cb33-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-307"><a href="#cb33-307" aria-hidden="true" tabindex="-1"></a><span class="co"># Smoking effect in males</span></span>
<span id="cb33-308"><a href="#cb33-308" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"smoke + male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-309"><a href="#cb33-309" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-310"><a href="#cb33-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-311"><a href="#cb33-311" aria-hidden="true" tabindex="-1"></a><span class="fu">###### Test for effect modification</span></span>
<span id="cb33-312"><a href="#cb33-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-313"><a href="#cb33-313" aria-hidden="true" tabindex="-1"></a>Is the effect of smoking on geometric mean bp modified by male? Is the effect of male on geometric mean bp modified by smoking? Effect modification is symmetric. The answer to these two questions is answered by testing for the significance of the interaction term between male and smoking. The following answers both questions.</span>
<span id="cb33-314"><a href="#cb33-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-317"><a href="#cb33-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-318"><a href="#cb33-318" aria-hidden="true" tabindex="-1"></a><span class="co"># Effect modification</span></span>
<span id="cb33-319"><a href="#cb33-319" aria-hidden="true" tabindex="-1"></a><span class="fu">lincom</span>(m2, <span class="st">"male:smoke"</span>, <span class="at">vcov=</span><span class="fu">hccm</span>(m2, <span class="at">type =</span> <span class="st">"hc3"</span>), <span class="at">eform=</span><span class="cn">TRUE</span>)</span>
<span id="cb33-320"><a href="#cb33-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-321"><a href="#cb33-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-322"><a href="#cb33-322" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Stata Output</span></span>
<span id="cb33-323"><a href="#cb33-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-324"><a href="#cb33-324" aria-hidden="true" tabindex="-1"></a>Similar Stata output to obtain the results.</span>
<span id="cb33-325"><a href="#cb33-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-326"><a href="#cb33-326" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb33-327"><a href="#cb33-327" aria-hidden="true" tabindex="-1"></a><span class="in">.  insheet using "/home/slaughjc/docs/teaching/b312/doc/effectmod/bp.csv", clear</span></span>
<span id="cb33-328"><a href="#cb33-328" aria-hidden="true" tabindex="-1"></a><span class="in">(3 vars, 40 obs)</span></span>
<span id="cb33-329"><a href="#cb33-329" aria-hidden="true" tabindex="-1"></a><span class="in">. gen logbp = log(bp)</span></span>
<span id="cb33-330"><a href="#cb33-330" aria-hidden="true" tabindex="-1"></a><span class="in">. tabulate male smoke, summarize(bp) nostandard nofreq noobs</span></span>
<span id="cb33-331"><a href="#cb33-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-332"><a href="#cb33-332" aria-hidden="true" tabindex="-1"></a><span class="in">                                Means of bp</span></span>
<span id="cb33-333"><a href="#cb33-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-334"><a href="#cb33-334" aria-hidden="true" tabindex="-1"></a><span class="in">           |        smoke</span></span>
<span id="cb33-335"><a href="#cb33-335" aria-hidden="true" tabindex="-1"></a><span class="in">      male |         0          1 |     Total</span></span>
<span id="cb33-336"><a href="#cb33-336" aria-hidden="true" tabindex="-1"></a><span class="in">-----------+----------------------+----------</span></span>
<span id="cb33-337"><a href="#cb33-337" aria-hidden="true" tabindex="-1"></a><span class="in">         0 |     107.4      135.2 |     121.3</span></span>
<span id="cb33-338"><a href="#cb33-338" aria-hidden="true" tabindex="-1"></a><span class="in">         1 |     122.7      174.7 |     148.7</span></span>
<span id="cb33-339"><a href="#cb33-339" aria-hidden="true" tabindex="-1"></a><span class="in">-----------+----------------------+----------</span></span>
<span id="cb33-340"><a href="#cb33-340" aria-hidden="true" tabindex="-1"></a><span class="in">     Total |    115.05     154.95 |       135</span></span>
<span id="cb33-341"><a href="#cb33-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-342"><a href="#cb33-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-343"><a href="#cb33-343" aria-hidden="true" tabindex="-1"></a><span class="in">. di 122.7 - 107.4</span></span>
<span id="cb33-344"><a href="#cb33-344" aria-hidden="true" tabindex="-1"></a><span class="in">15.3</span></span>
<span id="cb33-345"><a href="#cb33-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-346"><a href="#cb33-346" aria-hidden="true" tabindex="-1"></a><span class="in">. di 122.7 / 107.4</span></span>
<span id="cb33-347"><a href="#cb33-347" aria-hidden="true" tabindex="-1"></a><span class="in">1.1424581</span></span>
<span id="cb33-348"><a href="#cb33-348" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-349"><a href="#cb33-349" aria-hidden="true" tabindex="-1"></a><span class="in">. di 174.7 - 135.2</span></span>
<span id="cb33-350"><a href="#cb33-350" aria-hidden="true" tabindex="-1"></a><span class="in">39.5</span></span>
<span id="cb33-351"><a href="#cb33-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-352"><a href="#cb33-352" aria-hidden="true" tabindex="-1"></a><span class="in">. di 174.7 / 135.2</span></span>
<span id="cb33-353"><a href="#cb33-353" aria-hidden="true" tabindex="-1"></a><span class="in">1.2921598</span></span>
<span id="cb33-354"><a href="#cb33-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-355"><a href="#cb33-355" aria-hidden="true" tabindex="-1"></a><span class="in">. gen malesmoke = male*smoke</span></span>
<span id="cb33-356"><a href="#cb33-356" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-357"><a href="#cb33-357" aria-hidden="true" tabindex="-1"></a><span class="in">. ************************************************</span></span>
<span id="cb33-358"><a href="#cb33-358" aria-hidden="true" tabindex="-1"></a><span class="in">. * Linear Regression: Inference about means *</span></span>
<span id="cb33-359"><a href="#cb33-359" aria-hidden="true" tabindex="-1"></a><span class="in">. ************************************************</span></span>
<span id="cb33-360"><a href="#cb33-360" aria-hidden="true" tabindex="-1"></a><span class="in">. regress bp male smoke malesmoke, robust</span></span>
<span id="cb33-361"><a href="#cb33-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-362"><a href="#cb33-362" aria-hidden="true" tabindex="-1"></a><span class="in">Linear regression                                      Number of obs =      40</span></span>
<span id="cb33-363"><a href="#cb33-363" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       F(  3,    36) =   28.05</span></span>
<span id="cb33-364"><a href="#cb33-364" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       Prob &gt; F      =  0.0000</span></span>
<span id="cb33-365"><a href="#cb33-365" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       R-squared     =  0.6918</span></span>
<span id="cb33-366"><a href="#cb33-366" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       Root MSE      =  17.552</span></span>
<span id="cb33-367"><a href="#cb33-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-368"><a href="#cb33-368" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-369"><a href="#cb33-369" aria-hidden="true" tabindex="-1"></a><span class="in">             |               Robust</span></span>
<span id="cb33-370"><a href="#cb33-370" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-371"><a href="#cb33-371" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-372"><a href="#cb33-372" aria-hidden="true" tabindex="-1"></a><span class="in">        male |       15.3    8.97806     1.70   0.097    -2.908349    33.50835</span></span>
<span id="cb33-373"><a href="#cb33-373" aria-hidden="true" tabindex="-1"></a><span class="in">       smoke |       27.8   7.518865     3.70   0.001     12.55103    43.04897</span></span>
<span id="cb33-374"><a href="#cb33-374" aria-hidden="true" tabindex="-1"></a><span class="in">   malesmoke |       24.2   11.10065     2.18   0.036     1.686837    46.71316</span></span>
<span id="cb33-375"><a href="#cb33-375" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |      107.4   6.227537    17.25   0.000     94.76997      120.03</span></span>
<span id="cb33-376"><a href="#cb33-376" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-377"><a href="#cb33-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-378"><a href="#cb33-378" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-379"><a href="#cb33-379" aria-hidden="true" tabindex="-1"></a><span class="in">. * Get the means presented in the Table </span></span>
<span id="cb33-380"><a href="#cb33-380" aria-hidden="true" tabindex="-1"></a><span class="in">. *   Method 1: The adjust command         </span></span>
<span id="cb33-381"><a href="#cb33-381" aria-hidden="true" tabindex="-1"></a><span class="in">. *   Method 2: Four linear combos            </span></span>
<span id="cb33-382"><a href="#cb33-382" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-383"><a href="#cb33-383" aria-hidden="true" tabindex="-1"></a><span class="in">. adjust, by(male smoke)</span></span>
<span id="cb33-384"><a href="#cb33-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-385"><a href="#cb33-385" aria-hidden="true" tabindex="-1"></a><span class="in">---------------------------------------------------------------------------------------</span></span>
<span id="cb33-386"><a href="#cb33-386" aria-hidden="true" tabindex="-1"></a><span class="in">     Dependent variable: bp     Command: regress</span></span>
<span id="cb33-387"><a href="#cb33-387" aria-hidden="true" tabindex="-1"></a><span class="in">    Variable left as is: malesmoke</span></span>
<span id="cb33-388"><a href="#cb33-388" aria-hidden="true" tabindex="-1"></a><span class="in">---------------------------------------------------------------------------------------</span></span>
<span id="cb33-389"><a href="#cb33-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-390"><a href="#cb33-390" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------</span></span>
<span id="cb33-391"><a href="#cb33-391" aria-hidden="true" tabindex="-1"></a><span class="in">          |    smoke    </span></span>
<span id="cb33-392"><a href="#cb33-392" aria-hidden="true" tabindex="-1"></a><span class="in">     male |     0      1</span></span>
<span id="cb33-393"><a href="#cb33-393" aria-hidden="true" tabindex="-1"></a><span class="in">----------+-------------</span></span>
<span id="cb33-394"><a href="#cb33-394" aria-hidden="true" tabindex="-1"></a><span class="in">        0 | 107.4  135.2</span></span>
<span id="cb33-395"><a href="#cb33-395" aria-hidden="true" tabindex="-1"></a><span class="in">        1 | 122.7  174.7</span></span>
<span id="cb33-396"><a href="#cb33-396" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------</span></span>
<span id="cb33-397"><a href="#cb33-397" aria-hidden="true" tabindex="-1"></a><span class="in">     Key:  Linear Prediction</span></span>
<span id="cb33-398"><a href="#cb33-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-399"><a href="#cb33-399" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom _cons</span></span>
<span id="cb33-400"><a href="#cb33-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-401"><a href="#cb33-401" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  _cons = 0</span></span>
<span id="cb33-402"><a href="#cb33-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-403"><a href="#cb33-403" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-404"><a href="#cb33-404" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-405"><a href="#cb33-405" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-406"><a href="#cb33-406" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |      107.4   6.227537    17.25   0.000     94.76997      120.03</span></span>
<span id="cb33-407"><a href="#cb33-407" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-408"><a href="#cb33-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-409"><a href="#cb33-409" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom _cons + male</span></span>
<span id="cb33-410"><a href="#cb33-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-411"><a href="#cb33-411" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  male + _cons = 0</span></span>
<span id="cb33-412"><a href="#cb33-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-413"><a href="#cb33-413" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-414"><a href="#cb33-414" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-415"><a href="#cb33-415" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-416"><a href="#cb33-416" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |      122.7   6.467096    18.97   0.000     109.5841    135.8159</span></span>
<span id="cb33-417"><a href="#cb33-417" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-418"><a href="#cb33-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-419"><a href="#cb33-419" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom _cons + smoke</span></span>
<span id="cb33-420"><a href="#cb33-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-421"><a href="#cb33-421" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  smoke + _cons = 0</span></span>
<span id="cb33-422"><a href="#cb33-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-423"><a href="#cb33-423" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-424"><a href="#cb33-424" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-425"><a href="#cb33-425" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-426"><a href="#cb33-426" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |      135.2   4.213207    32.09   0.000     126.6552    143.7448</span></span>
<span id="cb33-427"><a href="#cb33-427" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-428"><a href="#cb33-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-429"><a href="#cb33-429" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom _cons + male + smoke + malesmoke</span></span>
<span id="cb33-430"><a href="#cb33-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-431"><a href="#cb33-431" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  male + smoke + malesmoke + _cons = 0</span></span>
<span id="cb33-432"><a href="#cb33-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-433"><a href="#cb33-433" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-434"><a href="#cb33-434" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-435"><a href="#cb33-435" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-436"><a href="#cb33-436" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |      174.7    4.98676    35.03   0.000     164.5864    184.8136</span></span>
<span id="cb33-437"><a href="#cb33-437" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-438"><a href="#cb33-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-439"><a href="#cb33-439" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-440"><a href="#cb33-440" aria-hidden="true" tabindex="-1"></a><span class="in">. * Now, look at the important differences</span></span>
<span id="cb33-441"><a href="#cb33-441" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-442"><a href="#cb33-442" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom male</span></span>
<span id="cb33-443"><a href="#cb33-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-444"><a href="#cb33-444" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  male = 0</span></span>
<span id="cb33-445"><a href="#cb33-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-446"><a href="#cb33-446" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-447"><a href="#cb33-447" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-448"><a href="#cb33-448" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-449"><a href="#cb33-449" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |       15.3    8.97806     1.70   0.097    -2.908349    33.50835</span></span>
<span id="cb33-450"><a href="#cb33-450" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-451"><a href="#cb33-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-452"><a href="#cb33-452" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom male + malesmoke</span></span>
<span id="cb33-453"><a href="#cb33-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-454"><a href="#cb33-454" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  male + malesmoke = 0</span></span>
<span id="cb33-455"><a href="#cb33-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-456"><a href="#cb33-456" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-457"><a href="#cb33-457" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-458"><a href="#cb33-458" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-459"><a href="#cb33-459" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |       39.5   6.528314     6.05   0.000     26.25996    52.74004</span></span>
<span id="cb33-460"><a href="#cb33-460" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-461"><a href="#cb33-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-462"><a href="#cb33-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-463"><a href="#cb33-463" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom smoke</span></span>
<span id="cb33-464"><a href="#cb33-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-465"><a href="#cb33-465" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  smoke = 0</span></span>
<span id="cb33-466"><a href="#cb33-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-467"><a href="#cb33-467" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-468"><a href="#cb33-468" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-469"><a href="#cb33-469" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-470"><a href="#cb33-470" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |       27.8   7.518865     3.70   0.001     12.55103    43.04897</span></span>
<span id="cb33-471"><a href="#cb33-471" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-472"><a href="#cb33-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-473"><a href="#cb33-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-474"><a href="#cb33-474" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom smoke + malesmoke</span></span>
<span id="cb33-475"><a href="#cb33-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-476"><a href="#cb33-476" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  smoke + malesmoke = 0</span></span>
<span id="cb33-477"><a href="#cb33-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-478"><a href="#cb33-478" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-479"><a href="#cb33-479" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-480"><a href="#cb33-480" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-481"><a href="#cb33-481" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |         52   8.166463     6.37   0.000     35.43765    68.56235</span></span>
<span id="cb33-482"><a href="#cb33-482" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-483"><a href="#cb33-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-484"><a href="#cb33-484" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom malesmoke</span></span>
<span id="cb33-485"><a href="#cb33-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-486"><a href="#cb33-486" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  malesmoke = 0</span></span>
<span id="cb33-487"><a href="#cb33-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-488"><a href="#cb33-488" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-489"><a href="#cb33-489" aria-hidden="true" tabindex="-1"></a><span class="in">          bp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-490"><a href="#cb33-490" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-491"><a href="#cb33-491" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |       24.2   11.10065     2.18   0.036     1.686837    46.71316</span></span>
<span id="cb33-492"><a href="#cb33-492" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-493"><a href="#cb33-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-494"><a href="#cb33-494" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-495"><a href="#cb33-495" aria-hidden="true" tabindex="-1"></a><span class="in">. . tabulate male smoke, summarize(logbp) nostandard nofreq noobs</span></span>
<span id="cb33-496"><a href="#cb33-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-497"><a href="#cb33-497" aria-hidden="true" tabindex="-1"></a><span class="in">                              Means of logbp</span></span>
<span id="cb33-498"><a href="#cb33-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-499"><a href="#cb33-499" aria-hidden="true" tabindex="-1"></a><span class="in">           |        smoke</span></span>
<span id="cb33-500"><a href="#cb33-500" aria-hidden="true" tabindex="-1"></a><span class="in">      male |         0          1 |     Total</span></span>
<span id="cb33-501"><a href="#cb33-501" aria-hidden="true" tabindex="-1"></a><span class="in">-----------+----------------------+----------</span></span>
<span id="cb33-502"><a href="#cb33-502" aria-hidden="true" tabindex="-1"></a><span class="in">         0 | 4.6592534  4.9027077 | 4.7809805</span></span>
<span id="cb33-503"><a href="#cb33-503" aria-hidden="true" tabindex="-1"></a><span class="in">         1 | 4.7963605  5.1595116 | 4.9779361</span></span>
<span id="cb33-504"><a href="#cb33-504" aria-hidden="true" tabindex="-1"></a><span class="in">-----------+----------------------+----------</span></span>
<span id="cb33-505"><a href="#cb33-505" aria-hidden="true" tabindex="-1"></a><span class="in">     Total | 4.7278069  5.0311096 | 4.8794583</span></span>
<span id="cb33-506"><a href="#cb33-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-507"><a href="#cb33-507" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-508"><a href="#cb33-508" aria-hidden="true" tabindex="-1"></a><span class="in">. di exp(4.6592534)</span></span>
<span id="cb33-509"><a href="#cb33-509" aria-hidden="true" tabindex="-1"></a><span class="in">105.55724</span></span>
<span id="cb33-510"><a href="#cb33-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-511"><a href="#cb33-511" aria-hidden="true" tabindex="-1"></a><span class="in">. di exp(4.7963605)</span></span>
<span id="cb33-512"><a href="#cb33-512" aria-hidden="true" tabindex="-1"></a><span class="in">121.06898</span></span>
<span id="cb33-513"><a href="#cb33-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-514"><a href="#cb33-514" aria-hidden="true" tabindex="-1"></a><span class="in">. di exp(4.9027077)</span></span>
<span id="cb33-515"><a href="#cb33-515" aria-hidden="true" tabindex="-1"></a><span class="in">134.65389</span></span>
<span id="cb33-516"><a href="#cb33-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-517"><a href="#cb33-517" aria-hidden="true" tabindex="-1"></a><span class="in">. di exp(5.1595116)</span></span>
<span id="cb33-518"><a href="#cb33-518" aria-hidden="true" tabindex="-1"></a><span class="in">174.07941</span></span>
<span id="cb33-519"><a href="#cb33-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-520"><a href="#cb33-520" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-521"><a href="#cb33-521" aria-hidden="true" tabindex="-1"></a><span class="in">. di exp(4.7963605) - exp(4.6592534)</span></span>
<span id="cb33-522"><a href="#cb33-522" aria-hidden="true" tabindex="-1"></a><span class="in">15.51174</span></span>
<span id="cb33-523"><a href="#cb33-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-524"><a href="#cb33-524" aria-hidden="true" tabindex="-1"></a><span class="in">. di exp(4.7963605) / exp(4.6592534)</span></span>
<span id="cb33-525"><a href="#cb33-525" aria-hidden="true" tabindex="-1"></a><span class="in">1.146951</span></span>
<span id="cb33-526"><a href="#cb33-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-527"><a href="#cb33-527" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-528"><a href="#cb33-528" aria-hidden="true" tabindex="-1"></a><span class="in">. di exp(5.1595116) - exp(4.9027077)</span></span>
<span id="cb33-529"><a href="#cb33-529" aria-hidden="true" tabindex="-1"></a><span class="in">39.425526</span></span>
<span id="cb33-530"><a href="#cb33-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-531"><a href="#cb33-531" aria-hidden="true" tabindex="-1"></a><span class="in">. di exp(5.1595116) / exp(4.9027077)</span></span>
<span id="cb33-532"><a href="#cb33-532" aria-hidden="true" tabindex="-1"></a><span class="in">1.2927916</span></span>
<span id="cb33-533"><a href="#cb33-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-534"><a href="#cb33-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-535"><a href="#cb33-535" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-536"><a href="#cb33-536" aria-hidden="true" tabindex="-1"></a><span class="in">. ***********************************************************</span></span>
<span id="cb33-537"><a href="#cb33-537" aria-hidden="true" tabindex="-1"></a><span class="in">. * Linear Regression: Inference about geometric means *</span></span>
<span id="cb33-538"><a href="#cb33-538" aria-hidden="true" tabindex="-1"></a><span class="in">. ***********************************************************</span></span>
<span id="cb33-539"><a href="#cb33-539" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-540"><a href="#cb33-540" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-541"><a href="#cb33-541" aria-hidden="true" tabindex="-1"></a><span class="in">. * Get the log geometric means presented in the Table </span></span>
<span id="cb33-542"><a href="#cb33-542" aria-hidden="true" tabindex="-1"></a><span class="in">. *   Method 1: The adjust command                                </span></span>
<span id="cb33-543"><a href="#cb33-543" aria-hidden="true" tabindex="-1"></a><span class="in">. *   Method 2: Four linear combos                                   </span></span>
<span id="cb33-544"><a href="#cb33-544" aria-hidden="true" tabindex="-1"></a><span class="in">. *   After either method, take exp(x) to get geometric mean</span></span>
<span id="cb33-545"><a href="#cb33-545" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-546"><a href="#cb33-546" aria-hidden="true" tabindex="-1"></a><span class="in">. regress logbp male smoke malesmoke, robust</span></span>
<span id="cb33-547"><a href="#cb33-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-548"><a href="#cb33-548" aria-hidden="true" tabindex="-1"></a><span class="in">Linear regression                                      Number of obs =      40</span></span>
<span id="cb33-549"><a href="#cb33-549" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       F(  3,    36) =   28.00</span></span>
<span id="cb33-550"><a href="#cb33-550" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       Prob &gt; F      =  0.0000</span></span>
<span id="cb33-551"><a href="#cb33-551" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       R-squared     =  0.6271</span></span>
<span id="cb33-552"><a href="#cb33-552" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       Root MSE      =  .14898</span></span>
<span id="cb33-553"><a href="#cb33-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-554"><a href="#cb33-554" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-555"><a href="#cb33-555" aria-hidden="true" tabindex="-1"></a><span class="in">             |               Robust</span></span>
<span id="cb33-556"><a href="#cb33-556" aria-hidden="true" tabindex="-1"></a><span class="in">       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-557"><a href="#cb33-557" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-558"><a href="#cb33-558" aria-hidden="true" tabindex="-1"></a><span class="in">        male |   .1371071   .0850408     1.61   0.116    -.0353636    .3095778</span></span>
<span id="cb33-559"><a href="#cb33-559" aria-hidden="true" tabindex="-1"></a><span class="in">       smoke |   .2434543   .0707116     3.44   0.001     .1000444    .3868641</span></span>
<span id="cb33-560"><a href="#cb33-560" aria-hidden="true" tabindex="-1"></a><span class="in">   malesmoke |   .1196969   .0942253     1.27   0.212    -.0714009    .3107946</span></span>
<span id="cb33-561"><a href="#cb33-561" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |   4.659253   .0642883    72.47   0.000     4.528871    4.789636</span></span>
<span id="cb33-562"><a href="#cb33-562" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-563"><a href="#cb33-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-564"><a href="#cb33-564" aria-hidden="true" tabindex="-1"></a><span class="in">. adjust, by(male smoke)</span></span>
<span id="cb33-565"><a href="#cb33-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-566"><a href="#cb33-566" aria-hidden="true" tabindex="-1"></a><span class="in">---------------------------------------------------------------------------------------</span></span>
<span id="cb33-567"><a href="#cb33-567" aria-hidden="true" tabindex="-1"></a><span class="in">     Dependent variable: logbp     Command: regress</span></span>
<span id="cb33-568"><a href="#cb33-568" aria-hidden="true" tabindex="-1"></a><span class="in">    Variable left as is: malesmoke</span></span>
<span id="cb33-569"><a href="#cb33-569" aria-hidden="true" tabindex="-1"></a><span class="in">---------------------------------------------------------------------------------------</span></span>
<span id="cb33-570"><a href="#cb33-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-571"><a href="#cb33-571" aria-hidden="true" tabindex="-1"></a><span class="in">----------------------------</span></span>
<span id="cb33-572"><a href="#cb33-572" aria-hidden="true" tabindex="-1"></a><span class="in">          |      smoke      </span></span>
<span id="cb33-573"><a href="#cb33-573" aria-hidden="true" tabindex="-1"></a><span class="in">     male |       0        1</span></span>
<span id="cb33-574"><a href="#cb33-574" aria-hidden="true" tabindex="-1"></a><span class="in">----------+-----------------</span></span>
<span id="cb33-575"><a href="#cb33-575" aria-hidden="true" tabindex="-1"></a><span class="in">        0 | 4.65925  4.90271</span></span>
<span id="cb33-576"><a href="#cb33-576" aria-hidden="true" tabindex="-1"></a><span class="in">        1 | 4.79636  5.15951</span></span>
<span id="cb33-577"><a href="#cb33-577" aria-hidden="true" tabindex="-1"></a><span class="in">----------------------------</span></span>
<span id="cb33-578"><a href="#cb33-578" aria-hidden="true" tabindex="-1"></a><span class="in">     Key:  Linear Prediction</span></span>
<span id="cb33-579"><a href="#cb33-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-580"><a href="#cb33-580" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom _cons</span></span>
<span id="cb33-581"><a href="#cb33-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-582"><a href="#cb33-582" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  _cons = 0</span></span>
<span id="cb33-583"><a href="#cb33-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-584"><a href="#cb33-584" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-585"><a href="#cb33-585" aria-hidden="true" tabindex="-1"></a><span class="in">       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-586"><a href="#cb33-586" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-587"><a href="#cb33-587" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |   4.659253   .0642883    72.47   0.000     4.528871    4.789636</span></span>
<span id="cb33-588"><a href="#cb33-588" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-589"><a href="#cb33-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-590"><a href="#cb33-590" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom _cons + male</span></span>
<span id="cb33-591"><a href="#cb33-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-592"><a href="#cb33-592" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  male + _cons = 0</span></span>
<span id="cb33-593"><a href="#cb33-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-594"><a href="#cb33-594" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-595"><a href="#cb33-595" aria-hidden="true" tabindex="-1"></a><span class="in">       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-596"><a href="#cb33-596" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-597"><a href="#cb33-597" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |    4.79636   .0556682    86.16   0.000      4.68346    4.909261</span></span>
<span id="cb33-598"><a href="#cb33-598" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-599"><a href="#cb33-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-600"><a href="#cb33-600" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom _cons + smoke</span></span>
<span id="cb33-601"><a href="#cb33-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-602"><a href="#cb33-602" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  smoke + _cons = 0</span></span>
<span id="cb33-603"><a href="#cb33-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-604"><a href="#cb33-604" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-605"><a href="#cb33-605" aria-hidden="true" tabindex="-1"></a><span class="in">       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-606"><a href="#cb33-606" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-607"><a href="#cb33-607" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |   4.902708   .0294475   166.49   0.000     4.842985     4.96243</span></span>
<span id="cb33-608"><a href="#cb33-608" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-609"><a href="#cb33-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-610"><a href="#cb33-610" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom _cons + male + smoke + malesmoke</span></span>
<span id="cb33-611"><a href="#cb33-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-612"><a href="#cb33-612" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  male + smoke + malesmoke + _cons = 0</span></span>
<span id="cb33-613"><a href="#cb33-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-614"><a href="#cb33-614" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-615"><a href="#cb33-615" aria-hidden="true" tabindex="-1"></a><span class="in">       logbp |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-616"><a href="#cb33-616" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-617"><a href="#cb33-617" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |   5.159512   .0279162   184.82   0.000     5.102895    5.216128</span></span>
<span id="cb33-618"><a href="#cb33-618" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-619"><a href="#cb33-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-620"><a href="#cb33-620" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-621"><a href="#cb33-621" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-622"><a href="#cb33-622" aria-hidden="true" tabindex="-1"></a><span class="in">. * Now, look at the important ratios</span></span>
<span id="cb33-623"><a href="#cb33-623" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb33-624"><a href="#cb33-624" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom male, eform</span></span>
<span id="cb33-625"><a href="#cb33-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-626"><a href="#cb33-626" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  male = 0</span></span>
<span id="cb33-627"><a href="#cb33-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-628"><a href="#cb33-628" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-629"><a href="#cb33-629" aria-hidden="true" tabindex="-1"></a><span class="in">       logbp |     exp(b)   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-630"><a href="#cb33-630" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-631"><a href="#cb33-631" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |   1.146951   .0975376     1.61   0.116     .9652544     1.36285</span></span>
<span id="cb33-632"><a href="#cb33-632" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-633"><a href="#cb33-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-634"><a href="#cb33-634" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom male + malesmoke, eform</span></span>
<span id="cb33-635"><a href="#cb33-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-636"><a href="#cb33-636" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  male + malesmoke = 0</span></span>
<span id="cb33-637"><a href="#cb33-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-638"><a href="#cb33-638" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-639"><a href="#cb33-639" aria-hidden="true" tabindex="-1"></a><span class="in">       logbp |     exp(b)   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-640"><a href="#cb33-640" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-641"><a href="#cb33-641" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |   1.292792   .0524572     6.33   0.000     1.190663     1.40368</span></span>
<span id="cb33-642"><a href="#cb33-642" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-643"><a href="#cb33-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-644"><a href="#cb33-644" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom smoke, eform</span></span>
<span id="cb33-645"><a href="#cb33-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-646"><a href="#cb33-646" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  smoke = 0</span></span>
<span id="cb33-647"><a href="#cb33-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-648"><a href="#cb33-648" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-649"><a href="#cb33-649" aria-hidden="true" tabindex="-1"></a><span class="in">       logbp |     exp(b)   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-650"><a href="#cb33-650" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-651"><a href="#cb33-651" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |   1.275648   .0902032     3.44   0.001      1.10522    1.472356</span></span>
<span id="cb33-652"><a href="#cb33-652" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-653"><a href="#cb33-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-654"><a href="#cb33-654" aria-hidden="true" tabindex="-1"></a><span class="in">. lincom malesmoke, eform</span></span>
<span id="cb33-655"><a href="#cb33-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-656"><a href="#cb33-656" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  malesmoke = 0</span></span>
<span id="cb33-657"><a href="#cb33-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-658"><a href="#cb33-658" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-659"><a href="#cb33-659" aria-hidden="true" tabindex="-1"></a><span class="in">       logbp |     exp(b)   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-660"><a href="#cb33-660" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-661"><a href="#cb33-661" aria-hidden="true" tabindex="-1"></a><span class="in">         (1) |   1.127155   .1062065     1.27   0.212     .9310886    1.364509</span></span>
<span id="cb33-662"><a href="#cb33-662" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-663"><a href="#cb33-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-664"><a href="#cb33-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-665"><a href="#cb33-665" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ignoring effect modification</span></span>
<span id="cb33-666"><a href="#cb33-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-667"><a href="#cb33-667" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>By design or mistake, we sometimes do not model effect modification</span>
<span id="cb33-668"><a href="#cb33-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-669"><a href="#cb33-669" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Might perform</span>
<span id="cb33-670"><a href="#cb33-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-671"><a href="#cb33-671" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Unadjusted analysis: POI only</span>
<span id="cb33-672"><a href="#cb33-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-673"><a href="#cb33-673" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Adjusted analysis: POI and third variable, but no interaction term</span>
<span id="cb33-674"><a href="#cb33-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-675"><a href="#cb33-675" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If effect modification exists, an unadjusted analysis will give different results according to the association between the POI and effect modifier in the sample</span>
<span id="cb33-676"><a href="#cb33-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-677"><a href="#cb33-677" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If the POI and the effect modifier are not associated</span>
<span id="cb33-678"><a href="#cb33-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-679"><a href="#cb33-679" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Unadjusted analysis tends toward an (approximate) weighted average of the stratum specific effects</span>
<span id="cb33-680"><a href="#cb33-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-681"><a href="#cb33-681" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>With means, exactly a weighted average</span>
<span id="cb33-682"><a href="#cb33-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-683"><a href="#cb33-683" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>With odds and hazards, an approximate weighted average (because they are non-linear functions of the mean)</span>
<span id="cb33-684"><a href="#cb33-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-685"><a href="#cb33-685" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If the POI and the effect modifier are associated in the sample</span>
<span id="cb33-686"><a href="#cb33-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-687"><a href="#cb33-687" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>The "average" effect is confounded and thus unreliable</span>
<span id="cb33-688"><a href="#cb33-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-689"><a href="#cb33-689" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>(variables can be both effect modifiers and confounders)</span>
<span id="cb33-690"><a href="#cb33-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-691"><a href="#cb33-691" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If effect modification exists, an analysis adjusting only for the third variable (but no interaction) will tend toward a weight average of the stratum specific effects</span>
<span id="cb33-692"><a href="#cb33-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-693"><a href="#cb33-693" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Hence, an association in one stratum and not the other will make an adjusted analysis look like an association (provide the sample size is large enough)</span>
<span id="cb33-694"><a href="#cb33-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-695"><a href="#cb33-695" aria-hidden="true" tabindex="-1"></a><span class="fu">## General Model for Effect Modification</span></span>
<span id="cb33-696"><a href="#cb33-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-697"><a href="#cb33-697" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Typical model for effect modification will include</span>
<span id="cb33-698"><a href="#cb33-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-699"><a href="#cb33-699" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Main effects</span>
<span id="cb33-700"><a href="#cb33-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-701"><a href="#cb33-701" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$X$, or predictors involving only $X$</span>
<span id="cb33-702"><a href="#cb33-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-703"><a href="#cb33-703" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$W$, or predictors involving only $W$</span>
<span id="cb33-704"><a href="#cb33-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-705"><a href="#cb33-705" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Interactions</span>
<span id="cb33-706"><a href="#cb33-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-707"><a href="#cb33-707" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Predictors derived from both $X$ and $W$</span>
<span id="cb33-708"><a href="#cb33-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-709"><a href="#cb33-709" aria-hidden="true" tabindex="-1"></a>    $$\begin{aligned}</span>
<span id="cb33-710"><a href="#cb33-710" aria-hidden="true" tabindex="-1"></a>     g(\theta | X_i , W_i) &amp; = &amp; \beta_0 + \beta_1 \times X_i + \beta_2 \times W_i + \beta_3 \times (XW)_i <span class="sc">\\</span></span>
<span id="cb33-711"><a href="#cb33-711" aria-hidden="true" tabindex="-1"></a>     g(\theta | X_i , W_i) &amp; = &amp; \beta_0 + \beta_1 \times X_i + \beta_2 \times W_i + \beta_3 \times X_i \times W_i\end{aligned}$$</span>
<span id="cb33-712"><a href="#cb33-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-713"><a href="#cb33-713" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation of parameters more difficult</span>
<span id="cb33-714"><a href="#cb33-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-715"><a href="#cb33-715" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Can try the usual approach of making comparisons of $\theta$ "across groups differing by 1 unit in corresponding predictor but agreeing in other modeled predictors."</span>
<span id="cb33-716"><a href="#cb33-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-717"><a href="#cb33-717" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>However, terms involving two scientific variables makes this approach difficult</span>
<span id="cb33-718"><a href="#cb33-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-719"><a href="#cb33-719" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Intercept</span>
<span id="cb33-720"><a href="#cb33-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-721"><a href="#cb33-721" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$\beta_0$: corresponds to $X=0$, $W=0$</span>
<span id="cb33-722"><a href="#cb33-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-723"><a href="#cb33-723" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>May lack scientific meaning</span>
<span id="cb33-724"><a href="#cb33-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-725"><a href="#cb33-725" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Slopes for main effects</span>
<span id="cb33-726"><a href="#cb33-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-727"><a href="#cb33-727" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$\beta_1$: corresponds to 1 unit difference in $X$, holding $W$ and $(X \times W)$ constant</span>
<span id="cb33-728"><a href="#cb33-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-729"><a href="#cb33-729" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>So, a 1 unit difference in $X$ when $W=0$</span>
<span id="cb33-730"><a href="#cb33-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-731"><a href="#cb33-731" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>May lack scientific meaning</span>
<span id="cb33-732"><a href="#cb33-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-733"><a href="#cb33-733" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$\beta_2$: corresponds to 1 unit difference in $W$, holding $X$ and $(X \times W)$ constant</span>
<span id="cb33-734"><a href="#cb33-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-735"><a href="#cb33-735" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>So, a 1 unit difference in $W$ when $X=0$</span>
<span id="cb33-736"><a href="#cb33-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-737"><a href="#cb33-737" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>May lack scientific meaning</span>
<span id="cb33-738"><a href="#cb33-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-739"><a href="#cb33-739" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Slope for interaction (difficult)</span>
<span id="cb33-740"><a href="#cb33-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-741"><a href="#cb33-741" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$\beta_3$: corresponds to 1 unit difference in $(X \times W)$, holding $X$ and $W$ constant</span>
<span id="cb33-742"><a href="#cb33-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-743"><a href="#cb33-743" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Impossible, so we need another way to interpret this slope parameter for the interaction</span>
<span id="cb33-744"><a href="#cb33-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-745"><a href="#cb33-745" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpretation of slope parameter for the interaction</span></span>
<span id="cb33-746"><a href="#cb33-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-747"><a href="#cb33-747" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Consider fixing stratum $W_i = w$. Then, $$\begin{aligned}</span>
<span id="cb33-748"><a href="#cb33-748" aria-hidden="true" tabindex="-1"></a>      g(\theta | X_i , W_i = w) &amp; = &amp; \beta_0 + \beta_1 \times X_i + \beta_2 \times w + \beta_3 \times X_i \times w <span class="sc">\\</span></span>
<span id="cb33-749"><a href="#cb33-749" aria-hidden="true" tabindex="-1"></a>     &amp; = &amp; (\beta_0 + \beta_2 \times w) + (\beta_1 + \beta_3 \times w) \times X_i\end{aligned}$$</span>
<span id="cb33-750"><a href="#cb33-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-751"><a href="#cb33-751" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Intercept: $(\beta_0 + \beta_2 \times w)$ corresponds to $X_i = 0$</span>
<span id="cb33-752"><a href="#cb33-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-753"><a href="#cb33-753" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Slope: $(\beta_1 + \beta_3 \times w)$ compares groups differing by 1 unit in $X$</span>
<span id="cb33-754"><a href="#cb33-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-755"><a href="#cb33-755" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_3$: Difference in $X$ slope per 1 unit difference in $W$</span>
<span id="cb33-756"><a href="#cb33-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-757"><a href="#cb33-757" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Example: $Y$ is height, $X$ is age, $W$ is gender</span>
<span id="cb33-758"><a href="#cb33-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-759"><a href="#cb33-759" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$\beta_3$: Difference in growth curves, males compared to females</span>
<span id="cb33-760"><a href="#cb33-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-761"><a href="#cb33-761" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Consider fixing stratum $X_i = x$. Then, $$\begin{aligned}</span>
<span id="cb33-762"><a href="#cb33-762" aria-hidden="true" tabindex="-1"></a>      g(\theta | X_i = x , W_i) &amp; = &amp; \beta_0 + \beta_1 \times x + \beta_2 \times W_i + \beta_3 \times x \times W_i <span class="sc">\\</span></span>
<span id="cb33-763"><a href="#cb33-763" aria-hidden="true" tabindex="-1"></a>     &amp; = &amp; (\beta_0 + \beta_1 \times x) + (\beta_2 + \beta_3 \times x) \times W_i\end{aligned}$$</span>
<span id="cb33-764"><a href="#cb33-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-765"><a href="#cb33-765" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Intercept: $(\beta_0 + \beta_1 \times x)$ corresponds to $W_i = 0$</span>
<span id="cb33-766"><a href="#cb33-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-767"><a href="#cb33-767" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Slope: $(\beta_2 + \beta_3 \times x)$ compares groups differing by 1 unit in $W$</span>
<span id="cb33-768"><a href="#cb33-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-769"><a href="#cb33-769" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\beta_3$: Difference in $W$ slope per 1 unit difference in $X$</span>
<span id="cb33-770"><a href="#cb33-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-771"><a href="#cb33-771" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note the implied symmetry</span>
<span id="cb33-772"><a href="#cb33-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-773"><a href="#cb33-773" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If $W$ modifies the association between $X$ and $Y$, then $X$ modifies the association between $W$ and $Y$</span>
<span id="cb33-774"><a href="#cb33-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-775"><a href="#cb33-775" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Statistically, there is no distinction between which variable you call your "effect modifier" and your "POI"</span>
<span id="cb33-776"><a href="#cb33-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-777"><a href="#cb33-777" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>There often is a scientific distinction that should be considered</span>
<span id="cb33-778"><a href="#cb33-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-779"><a href="#cb33-779" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Aside: Does confounding have to be symmetric?</span>
<span id="cb33-780"><a href="#cb33-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-781"><a href="#cb33-781" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If $W$ confounds the association between $Y$ and $X$, must it also be true that $X$ confounds the association between $W$ and $Y$?</span>
<span id="cb33-782"><a href="#cb33-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-783"><a href="#cb33-783" aria-hidden="true" tabindex="-1"></a><span class="fu">### Inference for Effect Modification</span></span>
<span id="cb33-784"><a href="#cb33-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-785"><a href="#cb33-785" aria-hidden="true" tabindex="-1"></a>$g(\theta | X_i , W_i) = \beta_0 + \beta_1 \times X_i + \beta_2 \times W_i + \beta_3 \times X_i \times W_i$</span>
<span id="cb33-786"><a href="#cb33-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-787"><a href="#cb33-787" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Inference for effect modification</span>
<span id="cb33-788"><a href="#cb33-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-789"><a href="#cb33-789" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>No effect modification if $\beta_3 = 0$</span>
<span id="cb33-790"><a href="#cb33-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-791"><a href="#cb33-791" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Hence, to test for existence of effect modification we consider $H_0: \beta_3 = 0$</span>
<span id="cb33-792"><a href="#cb33-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-793"><a href="#cb33-793" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>We can perform such inference using standard regression output for the corresponding slope parameter</span>
<span id="cb33-794"><a href="#cb33-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-795"><a href="#cb33-795" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Inference for main effect slope</span>
<span id="cb33-796"><a href="#cb33-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-797"><a href="#cb33-797" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Interpretation of $\beta_1 = 0$</span>
<span id="cb33-798"><a href="#cb33-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-799"><a href="#cb33-799" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Same intercept in strata defined by $W$</span>
<span id="cb33-800"><a href="#cb33-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-801"><a href="#cb33-801" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Generally a very uninteresting question</span>
<span id="cb33-802"><a href="#cb33-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-803"><a href="#cb33-803" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>We rarely make inference on main effects slopes by themselves</span>
<span id="cb33-804"><a href="#cb33-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-805"><a href="#cb33-805" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Inference about effect of $X$</span>
<span id="cb33-806"><a href="#cb33-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-807"><a href="#cb33-807" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Response parameter not associated with $X$ if $\beta_1 = 0$ AND $\beta_3 = 0$</span>
<span id="cb33-808"><a href="#cb33-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-809"><a href="#cb33-809" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We will need to construct special tests that both parameters are simultaneously $0$</span>
<span id="cb33-810"><a href="#cb33-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-811"><a href="#cb33-811" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$H_0: \beta_1 = 0, \beta_3 = 0$</span>
<span id="cb33-812"><a href="#cb33-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-813"><a href="#cb33-813" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Note that the Wald tests given in regression output only consider one slope at a time</span>
<span id="cb33-814"><a href="#cb33-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-815"><a href="#cb33-815" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Testing multiple slopes in Stata</span>
<span id="cb33-816"><a href="#cb33-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-817"><a href="#cb33-817" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Stata has an easy method for performing a test that multiple parameters are simultaneously $0$</span>
<span id="cb33-818"><a href="#cb33-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-819"><a href="#cb33-819" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>First, perform any regression command</span>
<span id="cb33-820"><a href="#cb33-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-821"><a href="#cb33-821" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Then, use <span class="in">`test var1 var2 ...`</span></span>
<span id="cb33-822"><a href="#cb33-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-823"><a href="#cb33-823" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Provides P value of the hypothesis test based on most recently executed regression command</span>
<span id="cb33-824"><a href="#cb33-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-825"><a href="#cb33-825" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Will work on any type of regression</span>
<span id="cb33-826"><a href="#cb33-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-827"><a href="#cb33-827" aria-hidden="true" tabindex="-1"></a><span class="fu">### Salary by sex and administration</span></span>
<span id="cb33-828"><a href="#cb33-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-829"><a href="#cb33-829" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Question: Does sex modify the association between mean salary and administrative duties?</span>
<span id="cb33-830"><a href="#cb33-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-831"><a href="#cb33-831" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>With two binary variables (sex, admin), modeling the interaction using a product is the obvious choice</span>
<span id="cb33-832"><a href="#cb33-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-833"><a href="#cb33-833" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$E<span class="co">[</span><span class="ot">Salary | Male, Adm</span><span class="co">]</span> = \beta_0 + \beta_1 \times Adm_i + \beta_2 \times Male_i + \beta_3 \times Adm_i \times Male_i$</span>
<span id="cb33-834"><a href="#cb33-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-835"><a href="#cb33-835" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Stata Regression Output</span></span>
<span id="cb33-836"><a href="#cb33-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-837"><a href="#cb33-837" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb33-838"><a href="#cb33-838" aria-hidden="true" tabindex="-1"></a><span class="in">. gen maleadmin = male*admin</span></span>
<span id="cb33-839"><a href="#cb33-839" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb33-840"><a href="#cb33-840" aria-hidden="true" tabindex="-1"></a><span class="in">. regress salary admin male maleadmin, robust</span></span>
<span id="cb33-841"><a href="#cb33-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-842"><a href="#cb33-842" aria-hidden="true" tabindex="-1"></a><span class="in">Linear regression                                      Number of obs =    1597</span></span>
<span id="cb33-843"><a href="#cb33-843" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       F(  3,  1593) =  125.26</span></span>
<span id="cb33-844"><a href="#cb33-844" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       Prob &gt; F      =  0.0000</span></span>
<span id="cb33-845"><a href="#cb33-845" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       R-squared     =  0.1615</span></span>
<span id="cb33-846"><a href="#cb33-846" aria-hidden="true" tabindex="-1"></a><span class="in">                                                       Root MSE      =  1866.9</span></span>
<span id="cb33-847"><a href="#cb33-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-848"><a href="#cb33-848" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-849"><a href="#cb33-849" aria-hidden="true" tabindex="-1"></a><span class="in">             |               Robust</span></span>
<span id="cb33-850"><a href="#cb33-850" aria-hidden="true" tabindex="-1"></a><span class="in">      salary |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-851"><a href="#cb33-851" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-852"><a href="#cb33-852" aria-hidden="true" tabindex="-1"></a><span class="in">       admin |   1489.471    292.628     5.09   0.000     915.4946    2063.448</span></span>
<span id="cb33-853"><a href="#cb33-853" aria-hidden="true" tabindex="-1"></a><span class="in">        male |   1226.234   95.37051    12.86   0.000      1039.17    1413.299</span></span>
<span id="cb33-854"><a href="#cb33-854" aria-hidden="true" tabindex="-1"></a><span class="in">   maleadmin |   461.9072   341.6782     1.35   0.177    -208.2789    1132.093</span></span>
<span id="cb33-855"><a href="#cb33-855" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |   5280.373   72.61871    72.71   0.000     5137.934    5422.811</span></span>
<span id="cb33-856"><a href="#cb33-856" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-857"><a href="#cb33-857" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-858"><a href="#cb33-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-859"><a href="#cb33-859" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Descriptive statistics</span></span>
<span id="cb33-860"><a href="#cb33-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-861"><a href="#cb33-861" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Note that with two binary variables, the regression parameters agree exactly with the corresponding group means</span>
<span id="cb33-862"><a href="#cb33-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-863"><a href="#cb33-863" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb33-864"><a href="#cb33-864" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------</span></span>
<span id="cb33-865"><a href="#cb33-865" aria-hidden="true" tabindex="-1"></a><span class="in">          |        male       </span></span>
<span id="cb33-866"><a href="#cb33-866" aria-hidden="true" tabindex="-1"></a><span class="in">    admin |        0         1</span></span>
<span id="cb33-867"><a href="#cb33-867" aria-hidden="true" tabindex="-1"></a><span class="in">----------+-------------------</span></span>
<span id="cb33-868"><a href="#cb33-868" aria-hidden="true" tabindex="-1"></a><span class="in">        0 | 5280.373  6506.607</span></span>
<span id="cb33-869"><a href="#cb33-869" aria-hidden="true" tabindex="-1"></a><span class="in">        1 | 6769.844  8457.985</span></span>
<span id="cb33-870"><a href="#cb33-870" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------</span></span>
<span id="cb33-871"><a href="#cb33-871" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-872"><a href="#cb33-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-873"><a href="#cb33-873" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference about effect modification</span></span>
<span id="cb33-874"><a href="#cb33-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-875"><a href="#cb33-875" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Does sex modify the association between mean salary and administrative duties?</span>
<span id="cb33-876"><a href="#cb33-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-877"><a href="#cb33-877" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model estimates that the administrative supplement is \$462 per month more for men than women</span>
<span id="cb33-878"><a href="#cb33-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-879"><a href="#cb33-879" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>95% confident that the true difference is between \$1132 more and \$208 less</span>
<span id="cb33-880"><a href="#cb33-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-881"><a href="#cb33-881" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Not statistically significant ($p = 0.177$)</span>
<span id="cb33-882"><a href="#cb33-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-883"><a href="#cb33-883" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb33-884"><a href="#cb33-884" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-885"><a href="#cb33-885" aria-hidden="true" tabindex="-1"></a><span class="in">             |               Robust</span></span>
<span id="cb33-886"><a href="#cb33-886" aria-hidden="true" tabindex="-1"></a><span class="in">      salary |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-887"><a href="#cb33-887" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-888"><a href="#cb33-888" aria-hidden="true" tabindex="-1"></a><span class="in">       admin |   1489.471    292.628     5.09   0.000     915.4946    2063.448</span></span>
<span id="cb33-889"><a href="#cb33-889" aria-hidden="true" tabindex="-1"></a><span class="in">        male |   1226.234   95.37051    12.86   0.000      1039.17    1413.299</span></span>
<span id="cb33-890"><a href="#cb33-890" aria-hidden="true" tabindex="-1"></a><span class="in">   maleadmin |   461.9072   341.6782     1.35   0.177    -208.2789    1132.093</span></span>
<span id="cb33-891"><a href="#cb33-891" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |   5280.373   72.61871    72.71   0.000     5137.934    5422.811</span></span>
<span id="cb33-892"><a href="#cb33-892" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-893"><a href="#cb33-893" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-894"><a href="#cb33-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-895"><a href="#cb33-895" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference about sex association</span></span>
<span id="cb33-896"><a href="#cb33-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-897"><a href="#cb33-897" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Is sex associated with mean salary?</span>
<span id="cb33-898"><a href="#cb33-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-899"><a href="#cb33-899" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Need to test that the slope parameter for male and maleadmin are simultaneously $0$</span>
<span id="cb33-900"><a href="#cb33-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-901"><a href="#cb33-901" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$H_0: \beta_2 = 0, \beta_3 = 0$</span>
<span id="cb33-902"><a href="#cb33-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-903"><a href="#cb33-903" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$H_1:$ At least one not equal</span>
<span id="cb33-904"><a href="#cb33-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-905"><a href="#cb33-905" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb33-906"><a href="#cb33-906" aria-hidden="true" tabindex="-1"></a><span class="in">. test male maleadmin</span></span>
<span id="cb33-907"><a href="#cb33-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-908"><a href="#cb33-908" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  male = 0</span></span>
<span id="cb33-909"><a href="#cb33-909" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 2)  maleadmin = 0</span></span>
<span id="cb33-910"><a href="#cb33-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-911"><a href="#cb33-911" aria-hidden="true" tabindex="-1"></a><span class="in">       F(  2,  1593) =   95.90</span></span>
<span id="cb33-912"><a href="#cb33-912" aria-hidden="true" tabindex="-1"></a><span class="in">            Prob &gt; F =    0.0000</span></span>
<span id="cb33-913"><a href="#cb33-913" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-914"><a href="#cb33-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-915"><a href="#cb33-915" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference about admin association</span></span>
<span id="cb33-916"><a href="#cb33-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-917"><a href="#cb33-917" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Are administrative duties associated with mean salary?</span>
<span id="cb33-918"><a href="#cb33-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-919"><a href="#cb33-919" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Need to test that the slope parameter for admin and maleadmin are simultaneously $0$</span>
<span id="cb33-920"><a href="#cb33-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-921"><a href="#cb33-921" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$H_0: \beta_1 = 0, \beta_3 = 0$</span>
<span id="cb33-922"><a href="#cb33-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-923"><a href="#cb33-923" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$H_1:$ At least one not equal</span>
<span id="cb33-924"><a href="#cb33-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-925"><a href="#cb33-925" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb33-926"><a href="#cb33-926" aria-hidden="true" tabindex="-1"></a><span class="in">. test admin maleadmin</span></span>
<span id="cb33-927"><a href="#cb33-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-928"><a href="#cb33-928" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 1)  admin = 0</span></span>
<span id="cb33-929"><a href="#cb33-929" aria-hidden="true" tabindex="-1"></a><span class="in"> ( 2)  maleadmin = 0</span></span>
<span id="cb33-930"><a href="#cb33-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-931"><a href="#cb33-931" aria-hidden="true" tabindex="-1"></a><span class="in">       F(  2,  1593) =   74.15</span></span>
<span id="cb33-932"><a href="#cb33-932" aria-hidden="true" tabindex="-1"></a><span class="in">            Prob &gt; F =    0.0000</span></span>
<span id="cb33-933"><a href="#cb33-933" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-934"><a href="#cb33-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-935"><a href="#cb33-935" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference about admin association using R</span></span>
<span id="cb33-936"><a href="#cb33-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-937"><a href="#cb33-937" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>See the effect modification lab. We will go over this in detail in class.</span>
<span id="cb33-938"><a href="#cb33-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-939"><a href="#cb33-939" aria-hidden="true" tabindex="-1"></a><span class="fu">## Continuous Effect Modification</span></span>
<span id="cb33-940"><a href="#cb33-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-941"><a href="#cb33-941" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Modeling interactions with continuous predictors is conceptually more complicated</span>
<span id="cb33-942"><a href="#cb33-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-943"><a href="#cb33-943" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Is a multiplicative model at all a reasonable model for the data?</span>
<span id="cb33-944"><a href="#cb33-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-945"><a href="#cb33-945" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Nonetheless, this is the most common way we detect interactions</span>
<span id="cb33-946"><a href="#cb33-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-947"><a href="#cb33-947" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Be cautious against using the model for prediction of means or individual observations</span>
<span id="cb33-948"><a href="#cb33-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-949"><a href="#cb33-949" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: Normal ranges for SEP</span></span>
<span id="cb33-950"><a href="#cb33-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-951"><a href="#cb33-951" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We want to find normal ranges for somatosensory evoked potential (SEP)</span>
<span id="cb33-952"><a href="#cb33-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-953"><a href="#cb33-953" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>p60: Average time (in milliseconds) to detection of the second positive SEP following stimulation of the posterior right and left tibial nerve</span>
<span id="cb33-954"><a href="#cb33-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-955"><a href="#cb33-955" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>As a first step, we want to consider important predictors of nerve conduction times</span>
<span id="cb33-956"><a href="#cb33-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-957"><a href="#cb33-957" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If any variables such as sex, age, height, race, etc. are important predictors of nerve conduction times, then it would make most sense to obtain normal ranges within such groups</span>
<span id="cb33-958"><a href="#cb33-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-959"><a href="#cb33-959" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Scientifically, we might expect that height, age, and sex are related to the nerve conduction time</span>
<span id="cb33-960"><a href="#cb33-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-961"><a href="#cb33-961" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Nerve length should matter, and height is a surrogate for nerve length</span>
<span id="cb33-962"><a href="#cb33-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-963"><a href="#cb33-963" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Age might affect nerve conduction times (people slow down with age)</span>
<span id="cb33-964"><a href="#cb33-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-965"><a href="#cb33-965" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Sex: Males have worse nervous systems</span>
<span id="cb33-966"><a href="#cb33-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-967"><a href="#cb33-967" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Prior to looking at the data, we can also consider the possibility that interactions between these variables might be important</span>
<span id="cb33-968"><a href="#cb33-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-969"><a href="#cb33-969" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Height and age interaction? Do we expect...</span>
<span id="cb33-970"><a href="#cb33-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-971"><a href="#cb33-971" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Difference in conduction times comparing 6 foot tall and 5 foot tall 20 year old, to be the same as ...</span>
<span id="cb33-972"><a href="#cb33-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-973"><a href="#cb33-973" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Difference in conduction times comparing 6 foot tall and 5 foot tall 50 year old, to be the same as ...</span>
<span id="cb33-974"><a href="#cb33-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-975"><a href="#cb33-975" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Difference in conduction times comparing 6 foot tall and 5 foot tall 80 year old?</span>
<span id="cb33-976"><a href="#cb33-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-977"><a href="#cb33-977" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We might suspect such an interaction due to the fact that height may not be as good a surrogate for nerve length in older people</span>
<span id="cb33-978"><a href="#cb33-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-979"><a href="#cb33-979" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>With age, some people tend to shrink due to osteoporosis and compression of intervertebral discs. It is not clear that nerve length would be altered in such a process.</span>
<span id="cb33-980"><a href="#cb33-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-981"><a href="#cb33-981" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Thus, in young people, differences in height probably are a better measure of nerve length than in old people</span>
<span id="cb33-982"><a href="#cb33-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-983"><a href="#cb33-983" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Tall old people probably have been tall always</span>
<span id="cb33-984"><a href="#cb33-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-985"><a href="#cb33-985" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Short old people will include some who were taller when they were young</span>
<span id="cb33-986"><a href="#cb33-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-987"><a href="#cb33-987" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We can also consider the possibility of three way interactions between height, age, and sex</span>
<span id="cb33-988"><a href="#cb33-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-989"><a href="#cb33-989" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Osteoporosis affects women far more than men</span>
<span id="cb33-990"><a href="#cb33-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-991"><a href="#cb33-991" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We might expect the height-age interaction to be greatest in women and not so important in men</span>
<span id="cb33-992"><a href="#cb33-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-993"><a href="#cb33-993" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A two-way interaction between height and age that is different between men and women defines a three way interaction between height, age, and sex</span>
<span id="cb33-994"><a href="#cb33-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-995"><a href="#cb33-995" aria-hidden="true" tabindex="-1"></a><span class="fu">### SEP regression model</span></span>
<span id="cb33-996"><a href="#cb33-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-997"><a href="#cb33-997" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>To define a regression model with interactions, we must create variables to model the three way interaction term</span>
<span id="cb33-998"><a href="#cb33-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-999"><a href="#cb33-999" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Furthermore, it is a **very good** idea to include all main effects and lower order interactions in the model too</span>
<span id="cb33-1000"><a href="#cb33-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1001"><a href="#cb33-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Main effects: The individual variables which contribute to the interaction</span>
<span id="cb33-1002"><a href="#cb33-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1003"><a href="#cb33-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Lower order terms: All interactions that involve some combination of the variables which contribute to the interaction</span>
<span id="cb33-1004"><a href="#cb33-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1005"><a href="#cb33-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Most often, we lack sufficient information to be able to guess what the true form of an interaction might be</span>
<span id="cb33-1006"><a href="#cb33-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1007"><a href="#cb33-1007" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>The most popular approach is thus to consider multiplicative interactions</span>
<span id="cb33-1008"><a href="#cb33-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1009"><a href="#cb33-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Create a new variable by merely multiplying the two (or more) interacting predictors</span>
<span id="cb33-1010"><a href="#cb33-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1011"><a href="#cb33-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For the problem, we will create the variables</span>
<span id="cb33-1012"><a href="#cb33-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1013"><a href="#cb33-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>HA = Height <span class="sc">\*</span> Age</span>
<span id="cb33-1014"><a href="#cb33-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1015"><a href="#cb33-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>HM = Height <span class="sc">\*</span> Male</span>
<span id="cb33-1016"><a href="#cb33-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1017"><a href="#cb33-1017" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>AM = Age <span class="sc">\*</span> Male</span>
<span id="cb33-1018"><a href="#cb33-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1019"><a href="#cb33-1019" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>HAM = Height <span class="sc">\*</span> Age <span class="sc">\*</span> Male</span>
<span id="cb33-1020"><a href="#cb33-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1021"><a href="#cb33-1021" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpretation: In the presence of higher order terms (powers, interactions) interpretation of parameters is not easy</span>
<span id="cb33-1022"><a href="#cb33-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1023"><a href="#cb33-1023" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We can no longer use "the change associated with a 1-unit difference in predictor holding other variables constant"</span>
<span id="cb33-1024"><a href="#cb33-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1025"><a href="#cb33-1025" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>It is generally impossible to hold other variables constant when changing a covariate involved in an interaction</span>
<span id="cb33-1026"><a href="#cb33-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1027"><a href="#cb33-1027" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When it is not impossible, it is often uninteresting scientifically</span>
<span id="cb33-1028"><a href="#cb33-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1029"><a href="#cb33-1029" aria-hidden="true" tabindex="-1"></a>$E<span class="co">[</span><span class="ot">p60 | Ht, Age, Male</span><span class="co">]</span> = \beta_0 + \beta_H Ht + \beta_A Age + \beta_M Male + \beta_{HA} HA + \beta_{HM} HM + \beta_{AM} AM + \beta_{HAM} HAM$</span>
<span id="cb33-1030"><a href="#cb33-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1031"><a href="#cb33-1031" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>p60 - Height relationship for Age = a:</span>
<span id="cb33-1032"><a href="#cb33-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1033"><a href="#cb33-1033" aria-hidden="true" tabindex="-1"></a>    | Sex | Intercept                                        | Slope                                                   |</span>
<span id="cb33-1034"><a href="#cb33-1034" aria-hidden="true" tabindex="-1"></a>    |:------------------|:-------------------------|:---------------------------|</span>
<span id="cb33-1035"><a href="#cb33-1035" aria-hidden="true" tabindex="-1"></a>    | F   | $(\beta_0 + \beta_A a)$                          | $(\beta_H + \beta_{HA} a)$                              |</span>
<span id="cb33-1036"><a href="#cb33-1036" aria-hidden="true" tabindex="-1"></a>    | M   | $(\beta_0 + \beta_M + (\beta_A + \beta_{AM}) a)$ | $(\beta_H + \beta_{HM} + (\beta_{HA} + \beta_{HAM}) a)$ |</span>
<span id="cb33-1037"><a href="#cb33-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1038"><a href="#cb33-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>From the above, we see the importance of including the main effects and lower order terms</span>
<span id="cb33-1039"><a href="#cb33-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1040"><a href="#cb33-1040" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>E.g., leaving out the height-sex interaction is tantamount that claiming the p60 - height relationship among newborns is the same for the two sexes</span>
<span id="cb33-1041"><a href="#cb33-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1042"><a href="#cb33-1042" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>It might be true, but the chance that our lines would predict the truth is very slight-- we are trying to approximate relationships in other age ranges</span>
<span id="cb33-1043"><a href="#cb33-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1044"><a href="#cb33-1044" aria-hidden="true" tabindex="-1"></a><span class="fu">### Regression Output</span></span>
<span id="cb33-1045"><a href="#cb33-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1046"><a href="#cb33-1046" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb33-1047"><a href="#cb33-1047" aria-hidden="true" tabindex="-1"></a><span class="in">. regress p60 height age male ha hm am ham</span></span>
<span id="cb33-1048"><a href="#cb33-1048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1049"><a href="#cb33-1049" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-1050"><a href="#cb33-1050" aria-hidden="true" tabindex="-1"></a><span class="in">         p60 |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-1051"><a href="#cb33-1051" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb33-1052"><a href="#cb33-1052" aria-hidden="true" tabindex="-1"></a><span class="in">      height |   1.380275    .362647     3.81   0.000     .6659271    2.094622</span></span>
<span id="cb33-1053"><a href="#cb33-1053" aria-hidden="true" tabindex="-1"></a><span class="in">         age |   1.129423   .4249166     2.66   0.008     .2924161     1.96643</span></span>
<span id="cb33-1054"><a href="#cb33-1054" aria-hidden="true" tabindex="-1"></a><span class="in">        male |   74.95773   32.30708     2.32   0.021     11.31875    138.5967</span></span>
<span id="cb33-1055"><a href="#cb33-1055" aria-hidden="true" tabindex="-1"></a><span class="in">          ha |  -.0149985   .0066386    -2.26   0.025    -.0280754   -.0019217</span></span>
<span id="cb33-1056"><a href="#cb33-1056" aria-hidden="true" tabindex="-1"></a><span class="in">          hm |  -1.127006   .4825427    -2.34   0.020    -2.077526   -.1764858</span></span>
<span id="cb33-1057"><a href="#cb33-1057" aria-hidden="true" tabindex="-1"></a><span class="in">          am |  -1.162866   .5817348    -2.00   0.047    -2.308776   -.0169558</span></span>
<span id="cb33-1058"><a href="#cb33-1058" aria-hidden="true" tabindex="-1"></a><span class="in">         ham |   .0175005   .0087708     2.00   0.047     .0002236    .0347773</span></span>
<span id="cb33-1059"><a href="#cb33-1059" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |  -36.44286   23.48684    -1.55   0.122    -82.70758     9.82187</span></span>
<span id="cb33-1060"><a href="#cb33-1060" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb33-1061"><a href="#cb33-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1062"><a href="#cb33-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1063"><a href="#cb33-1063" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If we restrict analysis to just females</span>
<span id="cb33-1064"><a href="#cb33-1064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1065"><a href="#cb33-1065" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Point estimates are the same as in the saturated model</span>
<span id="cb33-1066"><a href="#cb33-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1067"><a href="#cb33-1067" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Inference (CIs, p-values) can differ due to the estimate of the residual standard error</span>
<span id="cb33-1068"><a href="#cb33-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1069"><a href="#cb33-1069" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Note that restricting by age or height would give different estimates because we are still borrowing information across groups</span>
<span id="cb33-1070"><a href="#cb33-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1071"><a href="#cb33-1071" aria-hidden="true" tabindex="-1"></a>    <span class="co">&lt;!-- --&gt;</span></span>
<span id="cb33-1072"><a href="#cb33-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1073"><a href="#cb33-1073" aria-hidden="true" tabindex="-1"></a><span class="in">    ```stata</span></span>
<span id="cb33-1074"><a href="#cb33-1074" aria-hidden="true" tabindex="-1"></a><span class="in">    . regress p60 height age ha if male==0</span></span>
<span id="cb33-1075"><a href="#cb33-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1076"><a href="#cb33-1076" aria-hidden="true" tabindex="-1"></a><span class="in">    ------------------------------------------------------------------------------</span></span>
<span id="cb33-1077"><a href="#cb33-1077" aria-hidden="true" tabindex="-1"></a><span class="in">             p60 |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-1078"><a href="#cb33-1078" aria-hidden="true" tabindex="-1"></a><span class="in">    -------------+----------------------------------------------------------------</span></span>
<span id="cb33-1079"><a href="#cb33-1079" aria-hidden="true" tabindex="-1"></a><span class="in">          height |   1.380275   .3614558     3.82   0.000     .6653291     2.09522</span></span>
<span id="cb33-1080"><a href="#cb33-1080" aria-hidden="true" tabindex="-1"></a><span class="in">             age |   1.129423   .4235208     2.67   0.009     .2917155    1.967131</span></span>
<span id="cb33-1081"><a href="#cb33-1081" aria-hidden="true" tabindex="-1"></a><span class="in">              ha |  -.0149985   .0066168    -2.27   0.025    -.0280863   -.0019108</span></span>
<span id="cb33-1082"><a href="#cb33-1082" aria-hidden="true" tabindex="-1"></a><span class="in">           _cons |  -36.44286   23.40969    -1.56   0.122    -82.74631    9.860598</span></span>
<span id="cb33-1083"><a href="#cb33-1083" aria-hidden="true" tabindex="-1"></a><span class="in">    ------------------------------------------------------------------------------</span></span>
<span id="cb33-1084"><a href="#cb33-1084" aria-hidden="true" tabindex="-1"></a><span class="in">    ```</span></span>
<span id="cb33-1085"><a href="#cb33-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1086"><a href="#cb33-1086" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interpreting all of the estimates can be difficult</span>
<span id="cb33-1087"><a href="#cb33-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1088"><a href="#cb33-1088" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Can graph predicted values, which should be multiple linear for this model</span>
<span id="cb33-1089"><a href="#cb33-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1090"><a href="#cb33-1090" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Note that age is a continuous variable, so to understand how age modified the association between p60 and height, we will fix age at some values</span>
<span id="cb33-1091"><a href="#cb33-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1092"><a href="#cb33-1092" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Using general notation, let $Age = a$</span>
<span id="cb33-1093"><a href="#cb33-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1094"><a href="#cb33-1094" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimated association between p60 and height for Females</span>
<span id="cb33-1095"><a href="#cb33-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1096"><a href="#cb33-1096" aria-hidden="true" tabindex="-1"></a>    | Age | Intercept                                | Slope                                       |</span>
<span id="cb33-1097"><a href="#cb33-1097" aria-hidden="true" tabindex="-1"></a>    |:------------------|:--------------------------|:--------------------------|</span>
<span id="cb33-1098"><a href="#cb33-1098" aria-hidden="true" tabindex="-1"></a>    | a   | $\hat{\beta}_0 + \hat{\beta}_A \times a$ | $\hat{\beta}_H + \hat{\beta}_{HA} \times a$ |</span>
<span id="cb33-1099"><a href="#cb33-1099" aria-hidden="true" tabindex="-1"></a>    | a   | $-36.44 + 1.129 \times a$                | $1.38 - 0.01499 \times a$                   |</span>
<span id="cb33-1100"><a href="#cb33-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1101"><a href="#cb33-1101" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimated association between p60 and height in Males</span>
<span id="cb33-1102"><a href="#cb33-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1103"><a href="#cb33-1103" aria-hidden="true" tabindex="-1"></a>    | Age | Intercept                                                              | Slope                                                                         |</span>
<span id="cb33-1104"><a href="#cb33-1104" aria-hidden="true" tabindex="-1"></a>    |:------------------|:-------------------------|:---------------------------|</span>
<span id="cb33-1105"><a href="#cb33-1105" aria-hidden="true" tabindex="-1"></a>    | a   | $\hat{\beta}_0 + \hat{\beta}_M + (\hat{\beta}_A + \hat{\beta}_{AM}) a$ | $\hat{\beta}_H + \hat{\beta}_{HM} + (\hat{\beta}_{HA} + \hat{\beta}_{HAM}) a$ |</span>
<span id="cb33-1106"><a href="#cb33-1106" aria-hidden="true" tabindex="-1"></a>    | a   | $-36.44 + 74.96 + (1.13 - 1.16) a$                                     | $1.38 - 1.13 + (-0.015 + 0.0175) a$                                           |</span>
<span id="cb33-1107"><a href="#cb33-1107" aria-hidden="true" tabindex="-1"></a>    | a   | $38.51 - 0.033 \times a$                                               | $0.25 + 0.0025 \times a$                                                      |</span>
<span id="cb33-1108"><a href="#cb33-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1109"><a href="#cb33-1109" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Which corresponds to a regression including just males</span>
<span id="cb33-1110"><a href="#cb33-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1111"><a href="#cb33-1111" aria-hidden="true" tabindex="-1"></a>    <span class="in">```stata</span></span>
<span id="cb33-1112"><a href="#cb33-1112" aria-hidden="true" tabindex="-1"></a><span class="in">    . regress p60 height age ha if male==1</span></span>
<span id="cb33-1113"><a href="#cb33-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1114"><a href="#cb33-1114" aria-hidden="true" tabindex="-1"></a><span class="in">    ------------------------------------------------------------------------------</span></span>
<span id="cb33-1115"><a href="#cb33-1115" aria-hidden="true" tabindex="-1"></a><span class="in">             p60 |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb33-1116"><a href="#cb33-1116" aria-hidden="true" tabindex="-1"></a><span class="in">    -------------+----------------------------------------------------------------</span></span>
<span id="cb33-1117"><a href="#cb33-1117" aria-hidden="true" tabindex="-1"></a><span class="in">          height |   .2532689   .3196022     0.79   0.430    -.3801724    .8867101</span></span>
<span id="cb33-1118"><a href="#cb33-1118" aria-hidden="true" tabindex="-1"></a><span class="in">             age |  -.0334425   .3989042    -0.08   0.933    -.8240577    .7571727</span></span>
<span id="cb33-1119"><a href="#cb33-1119" aria-hidden="true" tabindex="-1"></a><span class="in">              ha |   .0025019   .0057549     0.43   0.665    -.0089041    .0139079</span></span>
<span id="cb33-1120"><a href="#cb33-1120" aria-hidden="true" tabindex="-1"></a><span class="in">           _cons |   38.51487   22.27228     1.73   0.087    -5.628068    82.65781</span></span>
<span id="cb33-1121"><a href="#cb33-1121" aria-hidden="true" tabindex="-1"></a><span class="in">    ------------------------------------------------------------------------------</span></span>
<span id="cb33-1122"><a href="#cb33-1122" aria-hidden="true" tabindex="-1"></a><span class="in">    ```</span></span>
<span id="cb33-1123"><a href="#cb33-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1124"><a href="#cb33-1124" aria-hidden="true" tabindex="-1"></a><span class="fu">#### R Code to generate plot</span></span>
<span id="cb33-1125"><a href="#cb33-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1126"><a href="#cb33-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.height=12}</span></span>
<span id="cb33-1127"><a href="#cb33-1127" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb33-1128"><a href="#cb33-1128" aria-hidden="true" tabindex="-1"></a>d2 <span class="ot">&lt;-</span> <span class="fu">stata.get</span>(<span class="st">"http://biostat.app.vumc.org/wiki/pub/Main/CourseBios312/sep.dta"</span>)</span>
<span id="cb33-1129"><a href="#cb33-1129" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>p60 <span class="ot">&lt;-</span> (d2<span class="sc">$</span>p60R <span class="sc">+</span> d2<span class="sc">$</span>p60L) <span class="sc">/</span><span class="dv">2</span></span>
<span id="cb33-1130"><a href="#cb33-1130" aria-hidden="true" tabindex="-1"></a>m.female <span class="ot">&lt;-</span> <span class="fu">lm</span>(p60 <span class="sc">~</span> height <span class="sc">+</span> age <span class="sc">+</span> height<span class="sc">:</span>age, <span class="at">data=</span>d2, <span class="at">subset=</span>sex<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb33-1131"><a href="#cb33-1131" aria-hidden="true" tabindex="-1"></a>m.male <span class="ot">&lt;-</span> <span class="fu">lm</span>(p60 <span class="sc">~</span> height <span class="sc">+</span> age <span class="sc">+</span> height<span class="sc">:</span>age, <span class="at">data=</span>d2, <span class="at">subset=</span>sex<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb33-1132"><a href="#cb33-1132" aria-hidden="true" tabindex="-1"></a>d2<span class="sc">$</span>agecat <span class="ot">&lt;-</span> (d2<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">35</span>) <span class="sc">+</span> (d2<span class="sc">$</span>age <span class="sc">&lt;</span> <span class="dv">60</span>) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb33-1133"><a href="#cb33-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1134"><a href="#cb33-1134" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb33-1135"><a href="#cb33-1135" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d2, <span class="fu">plot</span>(height[sex<span class="sc">==</span><span class="dv">0</span>], p60[sex<span class="sc">==</span><span class="dv">0</span>], <span class="at">pch=</span>agecat[sex<span class="sc">==</span><span class="dv">0</span>], <span class="at">col=</span>agecat[sex<span class="sc">==</span><span class="dv">0</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">53</span>,<span class="dv">80</span>),</span>
<span id="cb33-1136"><a href="#cb33-1136" aria-hidden="true" tabindex="-1"></a>   <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">80</span>), <span class="at">ylab=</span><span class="st">"Avg P60"</span>, <span class="at">xlab=</span><span class="st">"Height"</span>, <span class="at">main=</span><span class="st">"Females"</span>))</span>
<span id="cb33-1137"><a href="#cb33-1137" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb33-1138"><a href="#cb33-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb33-1139"><a href="#cb33-1139" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">70</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb33-1140"><a href="#cb33-1140" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"30"</span>,<span class="st">"50"</span>,<span class="st">"70"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">title=</span><span class="st">"Age"</span>)</span>
<span id="cb33-1141"><a href="#cb33-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1142"><a href="#cb33-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d2, <span class="fu">plot</span>(height[sex<span class="sc">==</span><span class="dv">1</span>], p60[sex<span class="sc">==</span><span class="dv">1</span>], <span class="at">pch=</span>agecat[sex<span class="sc">==</span><span class="dv">1</span>], <span class="at">col=</span>agecat[sex<span class="sc">==</span><span class="dv">1</span>], <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">53</span>,<span class="dv">80</span>),</span>
<span id="cb33-1143"><a href="#cb33-1143" aria-hidden="true" tabindex="-1"></a>   <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">50</span>,<span class="dv">80</span>), <span class="at">ylab=</span><span class="st">"Avg P60"</span>, <span class="at">xlab=</span><span class="st">"Height"</span>, <span class="at">main=</span><span class="st">"Males"</span>))</span>
<span id="cb33-1144"><a href="#cb33-1144" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb33-1145"><a href="#cb33-1145" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb33-1146"><a href="#cb33-1146" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">70</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb33-1147"><a href="#cb33-1147" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"&lt;35"</span>,<span class="st">"35-60"</span>,<span class="st">"60+"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="at">bty=</span><span class="st">"n"</span>,<span class="at">title=</span><span class="st">"Age"</span>)</span>
<span id="cb33-1148"><a href="#cb33-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1149"><a href="#cb33-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1150"><a href="#cb33-1150" aria-hidden="true" tabindex="-1"></a><span class="fu">### Influence diagnostics</span></span>
<span id="cb33-1151"><a href="#cb33-1151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1152"><a href="#cb33-1152" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>From the output, we find a statistically significant three way interaction (p = 0.047)</span>
<span id="cb33-1153"><a href="#cb33-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1154"><a href="#cb33-1154" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This would argue for making prediction based on a model that include the 3-way interaction</span>
<span id="cb33-1155"><a href="#cb33-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1156"><a href="#cb33-1156" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>However, interactions might be significant only because of a single outlier</span>
<span id="cb33-1157"><a href="#cb33-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1158"><a href="#cb33-1158" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If that were the case, I might choose not to include the interaction</span>
<span id="cb33-1159"><a href="#cb33-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1160"><a href="#cb33-1160" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>But, I would include the influential data point</span>
<span id="cb33-1161"><a href="#cb33-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1162"><a href="#cb33-1162" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We will look at the results of a "diagnosis of influential observations now, and cover in more detail later</span>
<span id="cb33-1163"><a href="#cb33-1163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1164"><a href="#cb33-1164" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>In particular, I am interested in ensuring that the evidence for an interaction is not based solely on a single person's observation</span>
<span id="cb33-1165"><a href="#cb33-1165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1166"><a href="#cb33-1166" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Hence, I consider 250 different regression in which I leave out each subject in turn</span>
<span id="cb33-1167"><a href="#cb33-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1168"><a href="#cb33-1168" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>I plot the slope estimates and p-values for each variable as a function of which case I left out</span>
<span id="cb33-1169"><a href="#cb33-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1170"><a href="#cb33-1170" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>For comparison, case 0 corresponds to using the full dataset</span>
<span id="cb33-1171"><a href="#cb33-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1172"><a href="#cb33-1172" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Changes in coefficients ($\beta$s)</span>
<span id="cb33-1173"><a href="#cb33-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1176"><a href="#cb33-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-1177"><a href="#cb33-1177" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate changes in p-values and coefficients</span></span>
<span id="cb33-1178"><a href="#cb33-1178" aria-hidden="true" tabindex="-1"></a><span class="co"># Create some variables to store the results</span></span>
<span id="cb33-1179"><a href="#cb33-1179" aria-hidden="true" tabindex="-1"></a>id <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(d2<span class="sc">$</span>p60)</span>
<span id="cb33-1180"><a href="#cb33-1180" aria-hidden="true" tabindex="-1"></a>case <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">length</span>(d2<span class="sc">$</span>p60)</span>
<span id="cb33-1181"><a href="#cb33-1181" aria-hidden="true" tabindex="-1"></a><span class="co"># p is number of predictors</span></span>
<span id="cb33-1182"><a href="#cb33-1182" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb33-1183"><a href="#cb33-1183" aria-hidden="true" tabindex="-1"></a>coeffs <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(case), <span class="at">ncol=</span>p)</span>
<span id="cb33-1184"><a href="#cb33-1184" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span><span class="fu">length</span>(case), <span class="at">ncol=</span>p)</span>
<span id="cb33-1185"><a href="#cb33-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1186"><a href="#cb33-1186" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the regression model with 1 observation deleted, save the coeffs and p-vals</span></span>
<span id="cb33-1187"><a href="#cb33-1187" aria-hidden="true" tabindex="-1"></a><span class="co">#  Note that case=0 corresponds to the full model (no observations deleted)</span></span>
<span id="cb33-1188"><a href="#cb33-1188" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> case) {</span>
<span id="cb33-1189"><a href="#cb33-1189" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">lm</span>(p60 <span class="sc">~</span> height<span class="sc">*</span>age<span class="sc">*</span>sex, <span class="at">data=</span>d2, <span class="at">subset=</span>(id<span class="sc">!=</span>i))</span>
<span id="cb33-1190"><a href="#cb33-1190" aria-hidden="true" tabindex="-1"></a>  coeffs[i<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">coef</span>(m)</span>
<span id="cb33-1191"><a href="#cb33-1191" aria-hidden="true" tabindex="-1"></a>  pvals[i<span class="sc">+</span><span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">summary</span>(m)<span class="sc">$</span>coeff[,<span class="dv">4</span>]</span>
<span id="cb33-1192"><a href="#cb33-1192" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-1193"><a href="#cb33-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1194"><a href="#cb33-1194" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the regression coefficients by which subject was deleted; highlight the unusual subject</span></span>
<span id="cb33-1195"><a href="#cb33-1195" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb33-1196"><a href="#cb33-1196" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb33-1197"><a href="#cb33-1197" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(case, coeffs[,i], <span class="at">ylab=</span>(<span class="fu">names</span>(<span class="fu">coef</span>(m))[i]))</span>
<span id="cb33-1198"><a href="#cb33-1198" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="dv">140</span>, <span class="at">y=</span>coeffs[<span class="dv">141</span>,i], <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">"Red"</span>)</span>
<span id="cb33-1199"><a href="#cb33-1199" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-1200"><a href="#cb33-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1201"><a href="#cb33-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1202"><a href="#cb33-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1203"><a href="#cb33-1203" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Changes in p-values for $\beta$s</span>
<span id="cb33-1204"><a href="#cb33-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1207"><a href="#cb33-1207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-1208"><a href="#cb33-1208" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the p-values for the regression coefficients by which subject was deleted</span></span>
<span id="cb33-1209"><a href="#cb33-1209" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>))</span>
<span id="cb33-1210"><a href="#cb33-1210" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb33-1211"><a href="#cb33-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(case, pvals[,i], <span class="at">ylab=</span>(<span class="fu">names</span>(<span class="fu">coef</span>(m))[i]))</span>
<span id="cb33-1212"><a href="#cb33-1212" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="at">x=</span><span class="dv">140</span>, <span class="at">y=</span>coeffs[<span class="dv">141</span>,i], <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">"Red"</span>)</span>
<span id="cb33-1213"><a href="#cb33-1213" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-1214"><a href="#cb33-1214" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1215"><a href="#cb33-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1216"><a href="#cb33-1216" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Contrary to my fear, the only influential observation actually lessened the evidence of an interaction</span>
<span id="cb33-1217"><a href="#cb33-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1218"><a href="#cb33-1218" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When observation 140 is removed from the data, the evidence of an interaction is a larger estimate and lower p-value</span>
<span id="cb33-1219"><a href="#cb33-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1220"><a href="#cb33-1220" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We can examine the scatterplot to see why subject 140 might be so influential</span>
<span id="cb33-1221"><a href="#cb33-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1222"><a href="#cb33-1222" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Subject 140 is a 43 year old, 57 inch female with an average p60 of 66.6</span>
<span id="cb33-1223"><a href="#cb33-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1226"><a href="#cb33-1226" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb33-1227"><a href="#cb33-1227" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot with subject 140 highlighted</span></span>
<span id="cb33-1228"><a href="#cb33-1228" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d2, <span class="fu">plot</span>(height, p60, <span class="at">xlab=</span><span class="st">"Height"</span>, <span class="at">ylab=</span><span class="st">"Avg p60"</span>, <span class="at">main=</span><span class="st">"Subject 140: 43 year old female"</span>))</span>
<span id="cb33-1229"><a href="#cb33-1229" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(d2, <span class="fu">points</span>(height[<span class="dv">140</span>], p60[<span class="dv">140</span>], <span class="at">pch=</span><span class="dv">19</span>, <span class="at">col=</span><span class="st">"Red"</span>))</span>
<span id="cb33-1230"><a href="#cb33-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">1</span>)</span>
<span id="cb33-1231"><a href="#cb33-1231" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.female, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb33-1232"><a href="#cb33-1232" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">30</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb33-1233"><a href="#cb33-1233" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>, <span class="fu">predict</span>(m.male, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">age=</span><span class="dv">50</span>, <span class="at">height=</span><span class="dv">53</span><span class="sc">:</span><span class="dv">83</span>)), <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb33-1234"><a href="#cb33-1234" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="fu">c</span>(<span class="st">"30 Female"</span>,<span class="st">"50 Female"</span>,<span class="st">"30 Male"</span>, <span class="st">"50 Male"</span>),</span>
<span id="cb33-1235"><a href="#cb33-1235" aria-hidden="true" tabindex="-1"></a>  <span class="at">lty=</span><span class="dv">1</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">bty=</span><span class="st">"n"</span>, <span class="at">title=</span><span class="st">"Age, Gender"</span>)</span>
<span id="cb33-1236"><a href="#cb33-1236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1237"><a href="#cb33-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1238"><a href="#cb33-1238" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>So, what do I do with observation 140?</span>
<span id="cb33-1239"><a href="#cb33-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1240"><a href="#cb33-1240" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>From the influence diagnostics, I am still comfortable that the data suggest a 3-way interaction</span>
<span id="cb33-1241"><a href="#cb33-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1242"><a href="#cb33-1242" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Personally, I do not remove observation 140 when making prediction intervals</span>
<span id="cb33-1243"><a href="#cb33-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1244"><a href="#cb33-1244" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>I do not know why observation 140 is unusual</span>
<span id="cb33-1245"><a href="#cb33-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1246"><a href="#cb33-1246" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>It is possible that people like 140 are actually more prevalent in the population than my sample would suggest</span>
<span id="cb33-1247"><a href="#cb33-1247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1248"><a href="#cb33-1248" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>My best guess is observation 140 represents only $0.4\%$ of the population, but would still leave her in the analysis</span>
<span id="cb33-1249"><a href="#cb33-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1250"><a href="#cb33-1250" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Removing subject 140 could bias parameter estimates, so I would rarely remove observations based on diagnostics</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024-2025, James C Slaughter</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chrissl789/modern-regression/edit/main/notes/Lec10.Modeling.Effect.Modification.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chrissl789/modern-regression/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>