<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Chris Slaughter">
<meta name="dcterms.date" content="2024-10-07">

<title>Regression Based Prediction – BIOS 6312 - Spring 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../notes/BayesDiagnostics.html" rel="next">
<link href="../notes/Lec12.ANOVA.Model.Choice.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Regression Based Prediction – BIOS 6312 - Spring 2025">
<meta property="og:description" content="Lecture 13">
<meta property="og:site_name" content="BIOS 6312 - Spring 2025">
</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/Lec02.review.html">Course Notes</a></li><li class="breadcrumb-item"><a href="../notes/Lec13.Prediction.html">Regression Based Prediction</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">BIOS 6312 - Spring 2025</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Information</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../slides/Lec01.Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introductory Slides</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus BIOS 6312</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../computing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Computing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../officehours.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Office Hours</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Course Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec02.review.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Review of Key Concepts</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec03.SimpleLinearRegression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simple Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec04.Logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec05.Precision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Precision of Statistical Intefence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec06.ConfoundingEffectModificationMediation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Confouding, Effect Modification, and Mediation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec07.MultivariableModels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multivariable Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set2.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model Estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set6.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weighted Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec08.Survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec09.Poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Poisson Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec10.Modeling.Effect.Modification.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Modeling Effect Modification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set8.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Multinomial and Ordinal Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec11.DoseResponse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flexible Modeling of Continuous Predictors</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec12.ANOVA.Model.Choice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ANOVA and Model Choice</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Lec13.Prediction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Regression Based Prediction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/BayesDiagnostics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bayesian Model Diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set13.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Missing Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../notes/Set14.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Bootstrap</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/quarto-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quarto Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab1-linearregression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 1: Linear regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab2-linearassumptions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 2: Assumption in Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab3-logistic-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 3: Logistic Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab4-precision-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 4: Precision and adjustment for baseline</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab-weighted.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">(Mini) Lab: Weighted Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab5-multivariable.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 5: Multivariable Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab6-survival.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 6: Survival Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/lab7-effectmodification-questions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 7: Poisson Regression and Effect Modification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../labs/Lab-DiscreteOutcomeRegression.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 8: Discrete Outcomes Lab</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://vanderbilt.box.com/s/rpftvmc9vua2w3gz3jy16phlnsojs6on" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Box folder with .qmd files</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Supplemental notes</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/slr-derivations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SLR derivations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/model-diagnostics-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model diagnostics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/mlr-matrix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">MLR matrix notation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/log-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Log transformations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/model-selection-criteria.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Model selection criteria</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/ReviewMatrixAlgebra.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix algebra review</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../supplemental/Baseline_Change_MACH.pdf" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Change from baseline and precision</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Statcomp2</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Main directory</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/lectures/" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lectures</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="https://statcomp2.app.vumc.org/modern-regression/lectures/data" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a>
  <ul>
  <li><a href="#uses-of-regression" id="toc-uses-of-regression" class="nav-link" data-scroll-target="#uses-of-regression"><span class="header-section-number">1.1</span> Uses of Regression</a></li>
  <li><a href="#examples-of-prediction" id="toc-examples-of-prediction" class="nav-link" data-scroll-target="#examples-of-prediction"><span class="header-section-number">1.2</span> Examples of Prediction</a>
  <ul class="collapse">
  <li><a href="#continuous-prediction-creatinine-clearance" id="toc-continuous-prediction-creatinine-clearance" class="nav-link" data-scroll-target="#continuous-prediction-creatinine-clearance"><span class="header-section-number">1.2.1</span> Continuous prediction: Creatinine clearance</a></li>
  <li><a href="#discrimination-binary-prediction-low-birth-weight" id="toc-discrimination-binary-prediction-low-birth-weight" class="nav-link" data-scroll-target="#discrimination-binary-prediction-low-birth-weight"><span class="header-section-number">1.2.2</span> Discrimination (binary prediction): Low birth weight</a></li>
  <li><a href="#interval-prediction-normal-ranges-of-psa" id="toc-interval-prediction-normal-ranges-of-psa" class="nav-link" data-scroll-target="#interval-prediction-normal-ranges-of-psa"><span class="header-section-number">1.2.3</span> Interval prediction: Normal ranges of PSA</a></li>
  </ul></li>
  <li><a href="#assumptions-needed-for-inference" id="toc-assumptions-needed-for-inference" class="nav-link" data-scroll-target="#assumptions-needed-for-inference"><span class="header-section-number">1.3</span> Assumptions needed for inference</a>
  <ul class="collapse">
  <li><a href="#inference-for-associations" id="toc-inference-for-associations" class="nav-link" data-scroll-target="#inference-for-associations"><span class="header-section-number">1.3.1</span> Inference for associations</a></li>
  <li><a href="#inference-for-predictions" id="toc-inference-for-predictions" class="nav-link" data-scroll-target="#inference-for-predictions"><span class="header-section-number">1.3.2</span> Inference for predictions</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimation-prediction-of-summary-measures" id="toc-estimation-prediction-of-summary-measures" class="nav-link" data-scroll-target="#estimation-prediction-of-summary-measures"><span class="header-section-number">2</span> Estimation (prediction) of summary measures</a>
  <ul>
  <li><a href="#point-estimates" id="toc-point-estimates" class="nav-link" data-scroll-target="#point-estimates"><span class="header-section-number">2.1</span> Point estimates</a></li>
  <li><a href="#interval-estimates" id="toc-interval-estimates" class="nav-link" data-scroll-target="#interval-estimates"><span class="header-section-number">2.2</span> Interval estimates</a></li>
  </ul></li>
  <li><a href="#prediction-forecasting-of-individual-observations" id="toc-prediction-forecasting-of-individual-observations" class="nav-link" data-scroll-target="#prediction-forecasting-of-individual-observations"><span class="header-section-number">3</span> Prediction (forecasting) of individual observations</a>
  <ul>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions"><span class="header-section-number">3.1</span> Assumptions</a></li>
  <li><a href="#point-and-interval-estimates-for-normal-data" id="toc-point-and-interval-estimates-for-normal-data" class="nav-link" data-scroll-target="#point-and-interval-estimates-for-normal-data"><span class="header-section-number">3.2</span> Point and interval estimates for Normal data</a></li>
  <li><a href="#example-fev-by-age-and-height" id="toc-example-fev-by-age-and-height" class="nav-link" data-scroll-target="#example-fev-by-age-and-height"><span class="header-section-number">3.3</span> Example: FEV by age and height</a></li>
  <li><a href="#mathematics-of-prediction-intervals" id="toc-mathematics-of-prediction-intervals" class="nav-link" data-scroll-target="#mathematics-of-prediction-intervals"><span class="header-section-number">3.4</span> Mathematics of Prediction Intervals</a></li>
  </ul></li>
  <li><a href="#prediction-of-binary-measurements" id="toc-prediction-of-binary-measurements" class="nav-link" data-scroll-target="#prediction-of-binary-measurements"><span class="header-section-number">4</span> Prediction of Binary Measurements</a>
  <ul>
  <li><a href="#classification-discrimination" id="toc-classification-discrimination" class="nav-link" data-scroll-target="#classification-discrimination"><span class="header-section-number">4.1</span> Classification (discrimination)</a></li>
  <li><a href="#stepwise-model-building" id="toc-stepwise-model-building" class="nav-link" data-scroll-target="#stepwise-model-building"><span class="header-section-number">4.2</span> Stepwise model building</a></li>
  <li><a href="#roc-curves" id="toc-roc-curves" class="nav-link" data-scroll-target="#roc-curves"><span class="header-section-number">4.3</span> ROC Curves</a></li>
  <li><a href="#example-1-age-or-height-to-predict-smoking" id="toc-example-1-age-or-height-to-predict-smoking" class="nav-link" data-scroll-target="#example-1-age-or-height-to-predict-smoking"><span class="header-section-number">4.4</span> Example 1: Age or height to predict smoking</a></li>
  <li><a href="#example-2-multiple-predictors-of-smoking" id="toc-example-2-multiple-predictors-of-smoking" class="nav-link" data-scroll-target="#example-2-multiple-predictors-of-smoking"><span class="header-section-number">4.5</span> Example 2: Multiple predictors of smoking</a></li>
  <li><a href="#analysis-of-roc-curves-in-r" id="toc-analysis-of-roc-curves-in-r" class="nav-link" data-scroll-target="#analysis-of-roc-curves-in-r"><span class="header-section-number">4.6</span> Analysis of ROC curves in R</a></li>
  <li><a href="#multivariable-prognostic-models" id="toc-multivariable-prognostic-models" class="nav-link" data-scroll-target="#multivariable-prognostic-models"><span class="header-section-number">4.7</span> Multivariable prognostic models</a>
  <ul class="collapse">
  <li><a href="#case-study-using-lrm-in-r" id="toc-case-study-using-lrm-in-r" class="nav-link" data-scroll-target="#case-study-using-lrm-in-r"><span class="header-section-number">4.7.1</span> Case Study using lrm() in R</a></li>
  </ul></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/chrissl789/modern-regression/edit/main/notes/Lec13.Prediction.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chrissl789/modern-regression/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header">

<div class="right">
<!--
<a href="https://github.com/chrissl789/modern-regression/raw/main/Lec13.Prediction.qmd" target="_blank">View Code</a>
-->
<a href="https://statcomp2.app.vumc.org/modern-regression/lectures/Lec13.Prediction.qmd" target="_blank">Download Code</a>

</div>

<div class="quarto-title-block d-none d-lg-block"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../notes/Lec02.review.html">Course Notes</a></li><li class="breadcrumb-item"><a href="../notes/Lec13.Prediction.html">Regression Based Prediction</a></li></ol></nav><div><h1 class="title">Regression Based Prediction</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Lecture 13</p>
<p class="author">Chris Slaughter</p>

<p class="date">October 7, 2024</p>

</header>


<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="fu">source</span>(<span class="st">'pander_registry.R'</span>), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">invisible</span>(e))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<section id="uses-of-regression" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="uses-of-regression"><span class="header-section-number">1.1</span> Uses of Regression</h3>
<ul>
<li><p>Cluster Analysis</p>
<ul>
<li><p>Focuses on identifying observations (covariates) with similar characteristics</p>
<ul>
<li>Interest lies in finding clusters that are more (or less) likely to have some outcome of interest</li>
</ul></li>
<li><p>Divide a population into subgroups based on patterns of similar measurement</p>
<ul>
<li><p>Clustering can be done by considering one variable (univariable) or multiple variables (multivariable)</p></li>
<li><p>Number of clusters can be known or unknown</p></li>
</ul></li>
<li><p>Examples</p>
<ul>
<li><p>Microarrays</p></li>
<li><p>fMRI</p></li>
<li><p>“Small <span class="math inline">\(n\)</span>, large <span class="math inline">\(p\)</span>” (few subjects, many predictors)</p></li>
</ul></li>
<li><p>Statistical techniques</p>
<ul>
<li><p>Stepwise regression</p></li>
<li><p>Regression trees</p></li>
<li><p>Other data-driven model building approaches</p></li>
<li><p>Getting valid inference (i.e.&nbsp;reliable p-values, unbiased parameter estimates) particularly challenging</p>
<ul>
<li>Area of active research in Biostatistics</li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Quantifying and comparing distributions</p>
<ul>
<li><p>Compare distribution of the outcome variable across levels of the grouping variable or variables</p>
<ul>
<li><p>Compare salary in males and females, across professors of the same rank, degree, experience, and field</p></li>
<li><p>Compare FEV in smokers and non-smokers, across teenagers of the same age and height</p></li>
</ul></li>
<li><p>Need to decide which summary measure is appropriate for describing the distribution</p>
<ul>
<li><p>Common summary measures: Means, median, geometric mean, odds, rates, hazards</p></li>
<li><p>Other measures: Variance, skewness, kurtosis, likelihood of extreme values, quantiles, etc.</p></li>
</ul></li>
<li><p>May desire estimates within specific subgroups</p>
<ul>
<li><p>Estimates of the association within gender, race, or age groups</p></li>
<li><p>(This is effect modification)</p></li>
</ul></li>
</ul></li>
<li><p>Regression based prediction</p>
<ul>
<li><p>Prediction of summary measures</p>
<ul>
<li><p>Point prediction</p>
<ul>
<li>Best single estimate for the measurement that would be obtained, on average, for many individuals with given covariates</li>
</ul></li>
<li><p>Interval prediction</p>
<ul>
<li><p>Quantify the uncertainty of the average</p></li>
<li><p>Range of summary measure that might be reasonable to observe</p></li>
</ul></li>
</ul></li>
<li><p>Prediction of individual measurements</p>
<ul>
<li><p>Point prediction</p>
<ul>
<li>Best single estimate for the measurement that would be obtained on a single individual with given covariates</li>
</ul></li>
<li><p>Interval prediction</p>
<ul>
<li><p>Quantify the uncertainty of the individual prediction</p></li>
<li><p>Range of measurements that might reasonably be observed in a future individual with given covariates</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="examples-of-prediction" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="examples-of-prediction"><span class="header-section-number">1.2</span> Examples of Prediction</h3>
<section id="continuous-prediction-creatinine-clearance" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="continuous-prediction-creatinine-clearance"><span class="header-section-number">1.2.1</span> Continuous prediction: Creatinine clearance</h4>
<ul>
<li><p>Creatinine is a continuously produced breakdown product in muscles</p></li>
<li><p>Removed by the kidney through filtration</p></li>
<li><p>Amount of creatinine cleared by the kidneys in 24 hours is a measure of renal function</p>
<ul>
<li><p>Gold standard is to collect urine output for 24 hours, measure creatinine</p></li>
<li><p>Would prefer to find a combination of blood and urine measures that can be obtained at one time point, yet still provides accurate prediction of a patient’s creatinine clearance</p></li>
</ul></li>
<li><p>Statistical approach</p>
<ul>
<li><p>Collect a training dataset to build a regression model for prediction</p>
<ul>
<li><p>Measure true creatinine clearance</p></li>
<li><p>Measure age, gender, weight, height, blood makers, urinary markers, etc.</p></li>
<li><p>Fit a (data driven?) regression model to predict true creatinine clearance</p></li>
</ul></li>
<li><p>Collect a validation dataset</p>
<ul>
<li><p>Use the regression estimates (the <span class="math inline">\(\beta\)</span>s) from the training dataset to see how well your model predict creatinine clearance</p></li>
<li><p>Quantify the accuracy of the predictive model (e.g.&nbsp;mean squared error)</p></li>
<li><p>Cross validation</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="discrimination-binary-prediction-low-birth-weight" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="discrimination-binary-prediction-low-birth-weight"><span class="header-section-number">1.2.2</span> Discrimination (binary prediction): Low birth weight</h4>
<ul>
<li><p>Want to predict which infants are more likely to be less than 2500 grams at birth</p></li>
<li><p>Possible predictors: Age, race, blood biomarkers collected during pregnancy</p></li>
<li><p>Statistical Approach</p>
<ul>
<li><p>Collect a training dataset to build a regression model for prediction</p>
<ul>
<li><p>Measure birth weight</p></li>
<li><p>Measure age, race, blood biomarkers</p></li>
<li><p>Fit a (data driven?) regression model to predict low birth weight</p></li>
</ul></li>
<li><p>Collect a validation dataset</p>
<ul>
<li><p>Use the regression estimates (the <span class="math inline">\(\beta\)</span>s) from the training dataset to see how well your model predict low birth weight</p></li>
<li><p>Quantify the accuracy of the predictive model</p>
<ul>
<li><p>Sensitivity, specificity (ROC curves)</p></li>
<li><p>Predictive value positive, predictive value negative</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="interval-prediction-normal-ranges-of-psa" class="level4" data-number="1.2.3">
<h4 data-number="1.2.3" class="anchored" data-anchor-id="interval-prediction-normal-ranges-of-psa"><span class="header-section-number">1.2.3</span> Interval prediction: Normal ranges of PSA</h4>
<ul>
<li><p>Identify the range of PSA values that would be expected in 95% of most healthy adult males</p></li>
<li><p>Possibly stratify by age, race</p></li>
<li><p>Statistical Approach</p>
<ul>
<li><p>Collect a training dataset to build a regression model for prediction</p>
<ul>
<li><p>Measure PSA and variable to predict PSA</p></li>
<li><p>Need to estimate the quantiles</p>
<ul>
<li><p>Mean plus/minus 2 standard deviations (makes strong Normality assumption)</p></li>
<li><p>Estimate the quantiles, provide CIs around the quantiles (likely low precision)</p></li>
</ul></li>
</ul></li>
<li><p>Collect a validation dataset</p>
<ul>
<li>Quantify the accuracy of the predictive model (e.g.&nbsp;coverage probabilities)</li>
</ul></li>
</ul></li>
</ul>
</section>
</section>
<section id="assumptions-needed-for-inference" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="assumptions-needed-for-inference"><span class="header-section-number">1.3</span> Assumptions needed for inference</h3>
<section id="inference-for-associations" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="inference-for-associations"><span class="header-section-number">1.3.1</span> Inference for associations</h4>
<ul>
<li><p>Necessary assumptions for classical regression (no robust standard errors)</p>
<ul>
<li><p>Independence of response measurements within identified clusters</p></li>
<li><p>Have appropriately modeled the within group variance</p>
<ul>
<li><p>Linear regression: Equal variance across groups</p></li>
<li><p>Other regressions: Appropriate mean-variance relationship</p>
<ul>
<li>Lack of model fit may lead to poor estimate of the variance</li>
</ul></li>
</ul></li>
<li><p>Sample size is large enough so that parameter estimates approximately follow a Normal distribution</p></li>
</ul></li>
<li><p>Necessary assumptions for first order trends using robust standard errors</p>
<ul>
<li><p>Independence of response measurements within identified clusters</p></li>
<li><p>(Robust standard errors accounts for heteroscedasticity in large samples)</p>
<ul>
<li>Lack of model fit leads to conservative inference due to mixing systematic and random error</li>
</ul></li>
<li><p>Sample size is large enough so that parameter estimates approximately follow a Normal distribution</p></li>
</ul></li>
</ul>
</section>
<section id="inference-for-predictions" class="level4" data-number="1.3.2">
<h4 data-number="1.3.2" class="anchored" data-anchor-id="inference-for-predictions"><span class="header-section-number">1.3.2</span> Inference for predictions</h4>
<ul>
<li><p>Additional assumptions for predictions of means</p>
<ul>
<li><p>Our regression model has accurately described the relationship between summary measures across groups</p></li>
<li><p>For continuous covariates, often involves flexible models that allow for departures from linearity</p></li>
</ul></li>
<li><p>Additional assumptions for predictions of individual observations</p>
<ul>
<li><p>Also need to know the shape of the distribution within each group</p></li>
<li><p>Methods implemented in software often rely on strong assumptions like Normality</p></li>
</ul></li>
</ul>
</section>
</section>
</section>
<section id="estimation-prediction-of-summary-measures" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="estimation-prediction-of-summary-measures"><span class="header-section-number">2</span> Estimation (prediction) of summary measures</h2>
<ul>
<li><p>Given age, height, and sex, estimate the mean (or geometric mean) FEV</p>
<ul>
<li>Use linear regression to obtain estimates and CI</li>
</ul></li>
<li><p>Given age and PSA, estimate the probability (or odds) of remaining in remission for 24 months</p>
<ul>
<li>Use logistic regression to obtain estimates and CI</li>
</ul></li>
<li><p>Assumptions</p>
<ul>
<li><p>Independence (between clusters for robust SE)</p></li>
<li><p>Variance approximated by the model (relaxed for robust SE)</p></li>
<li><p>Regression model accurately describes the relationship of summary measures across groups</p></li>
<li><p>Sufficient sample sizes for asymptotic distributions of parameters to be a good approximation</p></li>
</ul></li>
</ul>
<section id="point-estimates" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="point-estimates"><span class="header-section-number">2.1</span> Point estimates</h3>
<ul>
<li><p>Point estimates obtained by substitution of predictor values into the estimated regression equation</p>
<ul>
<li><p><span class="math inline">\(E[\textrm{Chol} | \textrm{Age}] = 200 + 0.33 \times \textrm{Age}\)</span></p>
<ul>
<li>Expected cholesterol for 50 year old is <span class="math inline">\(200 + 0.33 \times 50 = 216.5\)</span></li>
</ul></li>
<li><p><span class="math inline">\(\textrm{logodds}(\textrm{Survival} | \textrm{Age}) = -0.1365 - 0.007899 \times \textrm{Age}\)</span></p>
<ul>
<li><p>Expected log-odds of Survival for a 50 year old is <span class="math inline">\(-0.1365 - 0.007899 \times 50 = -0.53\)</span></p></li>
<li><p>Expected odds <span class="math inline">\(= e^{-.53} = 0.59\)</span></p></li>
<li><p>Expected probability <span class="math inline">\(= 0.37\)</span></p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="interval-estimates" class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="interval-estimates"><span class="header-section-number">2.2</span> Interval estimates</h3>
<ul>
<li><p>If assumptions hold, interval estimates can be obtained</p>
<ul>
<li><p>We generally find a confidence interval for the transformed quantity, and then back transform to the desired quantity</p>
<ul>
<li>For logistic regression, calculate the CI for the log odds, the transform to odds or probability</li>
</ul></li>
</ul></li>
<li><p>Statistical criteria for determining the “best” estimate</p>
<ul>
<li><p>Consistent: Correct estimate (with infinite sample size)</p></li>
<li><p>Precise: Minimum variance among (unbiased) estimators</p></li>
<li><p>Common regression methods provide the best estimate in a wide variety of settings</p></li>
</ul></li>
<li><p>Necessary assumptions</p>
<ul>
<li><p>Independence</p></li>
<li><p>Variance approximated by the model (relaxed for robust SE)</p></li>
<li><p><strong>Regression model accurately describes the relationship among summary measures across groups</strong></p></li>
<li><p>Sufficient sample size so that asymptotic Normality of the parameter estimates holds</p></li>
</ul></li>
<li><p>Interval estimates</p>
<ul>
<li><p>When we substitute in the predictor values, it provides an estimate of the model transformation of the summary measure</p></li>
<li><p>Model transformation of the summary measure varies by regression setting</p>
<ul>
<li><p>Linear regression: Mean</p></li>
<li><p>Linear regression on log transformed outcome: Log geometric mean</p></li>
<li><p>Logistic regression: Log odds</p></li>
<li><p>Poisson regression: Log rate</p></li>
</ul></li>
<li><p>Formulas for the confidence interval</p>
<ul>
<li><p>In general: <span class="math inline">\(\textrm{(estimate)} \pm \textrm{(crit value)} \times \textrm{(std error)}\)</span></p></li>
<li><p>In linear regression, the <span class="math inline">\(t\)</span> distribution is usually used to obtain the confidence interval</p>
<ul>
<li><p>Stata: <span class="math inline">\(\textrm{(crit value)} = \texttt{invttail}(df, \alpha/2)\)</span></p></li>
<li><p>R: <span class="math inline">\(\textrm{(crit value)} = \texttt{qt}(1-\alpha/2, df)\)</span></p></li>
<li><p>Degrees of freedom <span class="math inline">\(df = n - \textrm{number of predictors in model}\)</span></p></li>
</ul></li>
<li><p>In other regressions, we use the standard Normal distribution</p>
<ul>
<li><p>Stata: <span class="math inline">\(\textrm{(crit value)} = \texttt{invnorm}(1 - \alpha/2) = 1.96\)</span></p></li>
<li><p>R: <span class="math inline">\(\textrm{(crit value)} = \texttt{qnorm}(1-\alpha/2) = 1.96\)</span></p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Interval estimates in Stata</p>
<ul>
<li><p>After any regression command, the Stata command <code>predict</code> will give compute estimates and standard errors</p></li>
<li><p><code>predict varname, [what]</code></p>
<ul>
<li><p><code>varname</code> is that name of the new variable to be created</p></li>
<li><p><code>what</code> is one of</p>
<ul>
<li><p>xb: The linear predictor (works for all regression)</p></li>
<li><p>stdp: Standard error of the linear prediction</p></li>
<li><p>p: For logistic regression, to predicted probability</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Interval estimates in R</p>
<ul>
<li><p>After storing a model, the R function <code>predict</code> will give compute estimates and standard errors</p></li>
<li><p><code>predict(object, se.fit=FALSE, ...)</code></p>
<ul>
<li><p><code>object</code> is the stored fitted model</p></li>
<li><p><code>se.fit</code> will provide the standard error of the fit (defaults to <code>FALSE</code>)</p></li>
<li><p>See <code>help(predict)</code> for more details and options</p></li>
</ul></li>
</ul></li>
</ul>
<!-- -->
<div class="sourceCode" id="cb2"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> logfev = <span class="fu">log</span>(fev)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>. <span class="kw">regress</span> logfev height age</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>      Source |       SS       df       MS              Number <span class="kw">of</span> <span class="kw">obs</span> =     654</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>-------------+------------------------------           <span class="fu">F</span>(  2,   651) = 1361.98</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>       Model |  58.5363336     2  29.2681668           Prob &gt; <span class="fu">F</span>      =  0.0000</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    Residual |  13.9895809   651  .021489372           R-squared     =  0.8071</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>-------------+------------------------------           Adj R-squared =  0.8065</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>       Total |  72.5259145   653  .111065719           Root MSE      =  .14659</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>      logfev |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>      height |   .0439913   .0016473    26.71   0.000     .0407567    .0472259</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>         age |   .0198162   .0031805     6.23   0.000     .0135709    .0260616</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |  -1.971147   .0783322   -25.16   0.000    -2.124961   -1.817332</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> fitlogfev</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>(option <span class="kw">xb</span> assumed; <span class="kw">fitted</span> <span class="kw">values</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> sefit, stdp</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> gmfev= <span class="fu">exp</span>(fitlogfev)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> gmlofev = <span class="fu">exp</span>(fitlogfev - <span class="fu">invttail</span>(651, .025) * sefit)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> gmhifev = <span class="fu">exp</span>(fitlogfev + <span class="fu">invttail</span>(651, .025) * sefit)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>. <span class="ot">list</span> gmfev gmlofev gmhifev <span class="kw">if</span> age==10 &amp; height==66</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>     +--------------------------------+</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>     |    gmfev    gmlofev    gmhifev |</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>     |--------------------------------|</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>330. | 3.097021   3.038578   3.156588 |</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>547. | 3.097021   3.038578   3.156588 |</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>     +--------------------------------+</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>. <span class="kw">logit</span> smoker height age</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>Logistic regression                               Number <span class="kw">of</span> <span class="kw">obs</span>   =        654</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>                                                  LR <span class="fu">chi2</span>(2)      =     106.39</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>                                                  Prob &gt; <span class="fu">chi2</span>     =     0.0000</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>Log likelihood = -158.52851                       Pseudo R2       =     0.2512</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>      smoker |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>      height |   .0505297   .0410562     1.23   0.218     -.029939    .1309984</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>         age |   .4377213   .0661923     6.61   0.000     .3079868    .5674557</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |  -10.45429   2.351283    -4.45   0.000    -15.06272   -5.845856</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> logodds, <span class="kw">xb</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> selogodds, stdp</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> odds= <span class="fu">exp</span>(logodds)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> oddslo= <span class="fu">exp</span>(logodds - 1.96 * selogodds)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> oddshi= <span class="fu">exp</span>(logodds + 1.96 * selogodds)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>. <span class="ot">list</span> odds oddslo oddshi <span class="kw">if</span> age==10 &amp; height==66</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>     +--------------------------------+</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>     |     odds     oddslo     oddshi |</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>     |--------------------------------|</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>330. | .0644342   .0400909   .1035588 |</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>547. | .0644342   .0400909   .1035588 |</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>     +--------------------------------+</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="prediction-forecasting-of-individual-observations" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="prediction-forecasting-of-individual-observations"><span class="header-section-number">3</span> Prediction (forecasting) of individual observations</h2>
<ul>
<li><p>Methods are for continuous outcomes</p>
<ul>
<li>Will deal with discrimination of binary outcomes in next section</li>
</ul></li>
<li><p>Given age, height, and sex, predict a new subject’s FEV</p>
<ul>
<li>Use linear regression to obtain estimates and CI</li>
</ul></li>
</ul>
<section id="assumptions" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="assumptions"><span class="header-section-number">3.1</span> Assumptions</h3>
<ul>
<li><p>Necessary assumptions to predict individual observations</p>
<ul>
<li><p>Independence (between clusters for robust SE)</p></li>
<li><p>Variance approximated by the model (NOT relaxed for robust SE)</p></li>
<li><p>Regression model accurately describes the relationship of summary measures across groups</p></li>
<li><p>Shape of the distribution the same in each group</p>
<ul>
<li>Transformation of the outcome may be very useful</li>
</ul></li>
<li><p>Sufficient sample sizes for asymptotic distributions of parameters to be a good approximation</p></li>
</ul></li>
<li><p>Assumptions are very strong</p>
<ul>
<li><p>Consequently, we do not have many methods that provide robust inference</p>
<ul>
<li><p>In general, I prefer methods that make as few assumptions as possible</p></li>
<li><p>Robust standard errors will not help in this situation</p></li>
</ul></li>
<li><p>Proper transformation of outcomes and predictors may be necessary so that underlying assumptions of classical linear regression model hold</p>
<ul>
<li><p>Models, estimates, will need to be appropriately penalized for valid inference</p></li>
<li><p>Topic of more advanced regression courses (Regression Modeling Strategies)</p></li>
</ul></li>
<li><p>Precise methods have been developed for</p>
<ul>
<li><p>Binary variables (the mean specifies the variances)</p></li>
<li><p>Continuous data that follow a Normal distribution</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="point-and-interval-estimates-for-normal-data" class="level3" data-number="3.2">
<h3 data-number="3.2" class="anchored" data-anchor-id="point-and-interval-estimates-for-normal-data"><span class="header-section-number">3.2</span> Point and interval estimates for Normal data</h3>
<ul>
<li><p>Point estimates obtained by substitution into the estimated regression equation</p>
<ul>
<li><p><span class="math inline">\(E[\textrm{Chol} | \textrm{Age}] = 200 + 0.33 \times \textrm{Age}\)</span></p>
<ul>
<li>Expected cholesterol for 50 year old is <span class="math inline">\(200 + 0.33 \times 50 = 216.5\)</span></li>
</ul></li>
<li><p>When we substitute in age values, it provides an estimate of the forecast cholesterol</p></li>
</ul></li>
<li><p>Interval estimates</p>
<ul>
<li><p>Under appropriate assumptions, we can obtain standard errors for such predictions</p></li>
<li><p>Standard errors must account for two sources of variability</p>
<ul>
<li><p>Variability in estimating the regression parameters (same as in predictions of summary measures)</p></li>
<li><p>Variability due to subject</p>
<ul>
<li><p>Additional variability about the sample mean; “within group standard deviation”</p></li>
<li><p>Estimating this sources of variability is where the additional Normality assumption is key</p></li>
</ul></li>
</ul></li>
<li><p>Formulas for the prediction interval</p>
<ul>
<li><p>In general: <span class="math inline">\(\textrm{(prediction)} \pm \textrm{(crit value)} \times \textrm{(std error)}\)</span></p></li>
<li><p>In linear regression, the <span class="math inline">\(t\)</span> distribution is usually used to obtain the prediction interval</p>
<ul>
<li><p>Stata: <span class="math inline">\(\textrm{(crit value)} = \texttt{invttail}(df, \alpha/2)\)</span></p></li>
<li><p>R: <span class="math inline">\(\textrm{(crit value)} = \texttt{qt}(1-\alpha/2, df)\)</span></p></li>
<li><p>Degrees of freedom <span class="math inline">\(df = n - \textrm{number of predictors in model}\)</span></p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Interval estimates in Stata</p>
<ul>
<li><p>After any regression command, the Stata command <code>predict</code> will give compute estimates and standard errors</p></li>
<li><p><code>predict varname, [what]</code></p>
<ul>
<li><p><code>varname</code> is that name of the new variable to be created</p></li>
<li><p><code>what</code> is one of</p>
<ul>
<li><p>xb: The linear predictor (works for all regression)</p></li>
<li><p>stdf: Standard error of the forecast prediction</p></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>Interval estimates in R</p>
<ul>
<li><p>After storing a model, the R function <code>predict</code> will give compute estimates and standard errors</p></li>
<li><p><code>predict(object, se.fit=FALSE, ...)</code></p>
<ul>
<li><p><code>object</code> is the stored fitted model</p></li>
<li><p><code>se.fit</code> will provide the standard error of the fit (defaults to <code>FALSE</code>)</p></li>
<li><p>For the standard error of the forecast, need to include the root mean squared error</p>
<ul>
<li><span class="math inline">\(\textrm{se}_\textrm{pred}^2 = \textrm{se}_\textrm{fit}^2 + \textrm{RMSE}^2\)</span></li>
</ul></li>
</ul></li>
</ul></li>
<li><p>General comment about software</p>
<ul>
<li><p>Commercial software only implements prediction intervals by assuming Normal data</p></li>
<li><p>If using R libraries (or Stata ado files) for prediction, carefully investigate and understand how they are making predictions</p>
<ul>
<li>Don’t trust the “black box” to be giving you results that are widely applicable to all situations</li>
</ul></li>
<li><p>Be careful that you understand exactly what is going on if you are interested in making predictions</p></li>
</ul></li>
</ul>
</section>
<section id="example-fev-by-age-and-height" class="level3" data-number="3.3">
<h3 data-number="3.3" class="anchored" data-anchor-id="example-fev-by-age-and-height"><span class="header-section-number">3.3</span> Example: FEV by age and height</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">regress</span> logfev height age</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>      Source |       SS       df       MS              Number <span class="kw">of</span> <span class="kw">obs</span> =     654</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>-------------+------------------------------           <span class="fu">F</span>(  2,   651) = 1361.98</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>       Model |  58.5363336     2  29.2681668           Prob &gt; <span class="fu">F</span>      =  0.0000</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    Residual |  13.9895809   651  .021489372           R-squared     =  0.8071</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>-------------+------------------------------           Adj R-squared =  0.8065</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>       Total |  72.5259145   653  .111065719           Root MSE      =  .14659</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      logfev |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>      height |   .0439913   .0016473    26.71   0.000     .0407567    .0472259</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>         age |   .0198162   .0031805     6.23   0.000     .0135709    .0260616</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |  -1.971147   .0783322   -25.16   0.000    -2.124961   -1.817332</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> fitlogfev</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>(option <span class="kw">xb</span> assumed; <span class="kw">fitted</span> <span class="kw">values</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> sepredict, stdf</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> predfev= <span class="fu">exp</span>(fitlogfev)</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> predlofev = <span class="fu">exp</span>(fitlogfev - <span class="fu">invttail</span>(651, .025) * sepredict)</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> predhifev = <span class="fu">exp</span>(fitlogfev + <span class="fu">invttail</span>(651, .025) * sepredict)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>. <span class="ot">list</span> predfev predlofev predhifev <span class="kw">if</span> age==10 &amp; height==66</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>     +--------------------------------+</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>     |  predfev   predlo~v   predhi~v |</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>     |--------------------------------|</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>330. | 3.097021   2.320911   4.132662 |</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>547. | 3.097021   2.320911   4.132662 |</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>     +--------------------------------+</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>The preceding output gave prediction for individual observations</p></li>
<li><p>We can compare these results to the prediction for summary measures done previously (see below)</p>
<pre><code>     +-----------------------------------------------------------------+
     |    gmfev    gmlofev    gmhifev    predfev   pre~ofev   predhi~v |
     |-----------------------------------------------------------------|
330. | 3.097021   3.038578   3.156588   3.097021   2.320911   4.132662 |
     +-----------------------------------------------------------------+</code></pre>
<ul>
<li><p>Point estimates identical</p></li>
<li><p>Confidence interval for individual predictions is wider</p></li>
<li><p>As <span class="math inline">\(n\)</span> increases, the width of the prediction interval (on the log scale) approaches <span class="math inline">\(\pm 1.96 \times \textrm{RMSE}\)</span></p></li>
<li><p>As <span class="math inline">\(n\)</span> increases, the width of the interval around the summary measure approaches <span class="math inline">\(0\)</span></p></li>
</ul></li>
</ul>
<!-- -->
<ul>
<li><p>We can also calculate the standard error of the prediction</p></li>
<li><p>Example: Age is 10 and Height is 66</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> sepredict2 = sepredict^2</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> sefit2 = sefit^2</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>. <span class="ot">list</span> sepredict sefit sepredict2 sefit2 <span class="kw">if</span> age==10 &amp; heigh==66</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>     +------------------------------------------+</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>     | sepred~t     sefit   sepred~2     sefit2 |</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>     |------------------------------------------|</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>330. | .1469132   .009702   .0215835   .0000941 |</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>     +------------------------------------------+</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>. <span class="kw">di</span> .14659^2 +.0000941</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>.02158273</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p><span class="math inline">\(\textrm{se}_\textrm{pred}^2 = \textrm{se}_\textrm{fit}^2 + \textrm{RMSE}^2\)</span></p>
<ul>
<li><p><span class="math inline">\(\textrm{se}_\textrm{pred} = 0.1469132\)</span></p></li>
<li><p><span class="math inline">\(\textrm{se}_\textrm{fit} = 0.0215835\)</span></p></li>
<li><p><span class="math inline">\(\textrm{RMSE} = 0.14659\)</span></p></li>
</ul></li>
<li><p>Note that discrepancy in hand calculation versus Stata output (0.215835 vs 0.2158273) is due to rounding error</p></li>
</ul></li>
<li><p>This is an academic exercise in Stata, but necessary in R (unless you can find a function to do it for you)</p></li>
</ul>
</section>
<section id="mathematics-of-prediction-intervals" class="level3" data-number="3.4">
<h3 data-number="3.4" class="anchored" data-anchor-id="mathematics-of-prediction-intervals"><span class="header-section-number">3.4</span> Mathematics of Prediction Intervals</h3>
<ul>
<li><p>Basic ideas behind prediction intervals</p></li>
<li><p>Model: <span class="math inline">\(Y_i | X_i \sim N(\beta_0 + \beta_1 X_i, \sigma^2)\)</span></p></li>
<li><p>Alternative specification: <span class="math inline">\(Y_i | X_i = \beta_0 + \beta_1 X_i + \epsilon_i\)</span></p>
<ul>
<li><span class="math inline">\(\epsilon_i \sim N(0, \sigma^2)\)</span></li>
</ul></li>
<li><p>Estimated mean: <span class="math inline">\(\hat{\beta}_0 + \hat{\beta}_1 X_i \sim N\left(\beta_0 + \beta_1 X_i, \sigma^2 V\right)\)</span></p></li>
<li><p>Predicted mean: <span class="math inline">\(\hat{\beta}_0 + \hat{\beta}_1 X_i + \epsilon_i \sim N\left(\beta_0 + \beta_1 X_i, \sigma^2 (1 + V)\right)\)</span></p>
<ul>
<li><p><span class="math inline">\(V = \frac{1}{n} + \frac{(X_h - \overline{X})^2}{\sum_{i=1}^n (X_i - \overline{X})^2}\)</span></p></li>
<li><p><span class="math inline">\(X_h\)</span> is the chosen value of the covariate (e.g.&nbsp;age==10)</p></li>
<li><p>Note: As <span class="math inline">\(n \rightarrow \infty, V \rightarrow 0\)</span></p></li>
</ul></li>
</ul>
</section>
</section>
<section id="prediction-of-binary-measurements" class="level2 page-columns page-full" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="prediction-of-binary-measurements"><span class="header-section-number">4</span> Prediction of Binary Measurements</h2>
<section id="classification-discrimination" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="classification-discrimination"><span class="header-section-number">4.1</span> Classification (discrimination)</h3>
<ul>
<li><p>Sometimes the scientific question is one of deriving a rule to classify subjects</p>
<ul>
<li><p>Diagnosis of prostate cancer: Based on age, race, and PSA, should we make a diagnosis of prostate cancer?</p></li>
<li><p>Prognosis of patients with primary biliary cirrhosis: Based on age, bilirubin, albumin, edema, protime, is the patient likely to die within the next year?</p></li>
</ul></li>
<li><p>Classification can be regarded as trying to predict the value of a binary variable</p>
<ul>
<li><p>Earlier, we were estimating the probability and odds of relapse within a particular group (a summary measure)</p></li>
<li><p>Now we want to decide whether a particular individual will relapse or not (an individual measure)</p></li>
<li><p>There is an obvious connection between the above two ideas</p>
<ul>
<li><p>The probability or odds tells us everything about the distribution of values</p></li>
<li><p>The only possible values are 0 or 1</p></li>
</ul></li>
</ul></li>
<li><p>Typical approach</p>
<ul>
<li><p>First, use regression model to estimate the probability of event in each group</p></li>
<li><p>Second, form a decision rule based on estimated probability of event</p>
<ul>
<li><p>If estimate <span class="math inline">\(\geq c\)</span> (or <span class="math inline">\(\leq c\)</span>), predict outcome is 1</p></li>
<li><p>If estimate <span class="math inline">\(&lt; c\)</span> (or <span class="math inline">\(&gt; c\)</span>), predict outcome is 0</p></li>
</ul></li>
<li><p>Quantify the accuracy of the decision rule</p></li>
<li><p>For disease <span class="math inline">\(D\)</span> and test <span class="math inline">\(T\)</span></p>
<ul>
<li><p>Sensitivity: <span class="math inline">\(\textrm{Pr}(T^+ | D^+)\)</span></p></li>
<li><p>Specificity: <span class="math inline">\(\textrm{Pr}(T^- | D^-)\)</span></p></li>
<li><p>Predicted Value Positive: <span class="math inline">\(\textrm{Pr}(D^+ | T^+)\)</span></p></li>
<li><p>Predicted Value Negative: <span class="math inline">\(\textrm{Pr}(D^- | T^-)\)</span></p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="stepwise-model-building" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="stepwise-model-building"><span class="header-section-number">4.2</span> Stepwise model building</h3>
<ul>
<li><p>Old method for considering a large number of covariates that might possibly be predictive of an outcome</p>
<ul>
<li>“If stepwise model building had been proposed today, it would not have passed peer review”</li>
</ul></li>
<li><p>Available in all software as an automated tool, but should not be used</p></li>
<li><p>Avoid recreating the stepwise approach when building your own models manually</p></li>
<li><p>Major caveats</p>
<ul>
<li><p>Overfits your dataset</p></li>
<li><p>P-values are not true p-values; they are very anti-conservative</p></li>
<li><p>You will often obtain different models if you use “forward” or “backward” stepwise regression</p></li>
<li><p>Ignores confounding effects (a variable could be an important confounder, but itself not be statistically significant in the model)</p></li>
<li><p>Without clustering certain predictors, may throw out covariates to make non-sensical model</p>
<ul>
<li><p>Suppose race/ethnicity is coded as White, Black, Hispanic, Other</p></li>
<li><p>Want to model as 3 dummy variables</p></li>
<li><p>Stepwise may throw out one of your dummy variables, keep the rest</p></li>
<li><p>Pairwise significance would also be highly dependent on reference group chosen by analyst</p></li>
</ul></li>
</ul></li>
<li><p>Two flavors of stepwide model building</p>
<ul>
<li><p>Start with no covariates: “Forward” stepwise regression</p></li>
<li><p>Start with all covariates: “Backward” stepwise regression</p></li>
</ul></li>
<li><p>Stepwise procedure proceeds by adding or removing covariates from the model base on the corresponding partial <span class="math inline">\(t\)</span> or <span class="math inline">\(Z\)</span> test</p>
<ul>
<li><p>Must pre-specify a “P to enter” and “P to remove”</p></li>
<li><p>To avoid infinite loops, P to enter must be less than P to remove</p></li>
<li><p>E.g. Add a variable to the model if <span class="math inline">\(p &lt; 0.05\)</span>, but only remove a variable from the model if <span class="math inline">\(p &gt; 0.10\)</span></p></li>
<li><p>Repeat the process until you arrive at a final model</p></li>
</ul></li>
</ul>
</section>
<section id="roc-curves" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="roc-curves"><span class="header-section-number">4.3</span> ROC Curves</h3>
<ul>
<li><p>Receiver operating characteristic (ROC) curves plot the sensitivity against the false positive rate (e.g.&nbsp;1 - specificity)</p></li>
<li><p>Ideal tests will have both high sensitivity and high specificity (low false positives)</p>
<ul>
<li><p>Graphically depicted as points in the upper left portion of the plot</p></li>
<li><p>1:1 line represents a test that is no better than the flip of a coin</p></li>
</ul></li>
<li><p>Test usually involves the classification of some binary outcome by a continuous predictor (or set of continuous predictors)</p>
<ul>
<li><p>When the continuous predictor is above some point <span class="math inline">\(c\)</span>, the test is said to be positive</p></li>
<li><p>ROC curves plots the sensitivity and false positive rate for all possible values of <span class="math inline">\(c\)</span></p></li>
</ul></li>
<li><p>Major drawbacks to ROC analysis</p>
<ul>
<li><p>Tempts analyst to find a cutoff point (<span class="math inline">\(c\)</span>) when none really exists</p></li>
<li><p>Better to treat your covariate or linear prediction as a continuous variable</p></li>
</ul></li>
</ul>
</section>
<section id="example-1-age-or-height-to-predict-smoking" class="level3 page-columns page-full" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="example-1-age-or-height-to-predict-smoking"><span class="header-section-number">4.4</span> Example 1: Age or height to predict smoking</h3>
<ul>
<li><p>Question: Is age or height a better predictor of smoking status?</p></li>
<li><p>Will compare the ROC curves</p>
<ul>
<li><p>Often done use the area under the curve (AUC)</p></li>
<li><p>Model with higher AUC is better</p></li>
<li><p>A null model (not predictive of outcome) will have area of 0.50</p></li>
<li><p>Maximum AUC is 1.0</p></li>
</ul></li>
<li><p>Stata</p>
<ul>
<li><p>Fit the logistic regression model</p></li>
<li><p><code>lroc</code> creates the ROC curve</p></li>
<li><p><code>predict</code> to save the fitted curves</p></li>
<li><p><code>roccomp</code> to compare the curves</p></li>
</ul></li>
</ul>
<!-- -->
<div class="sourceCode" id="cb6"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>. <span class="kw">logit</span> smoker height</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Logistic regression                               Number <span class="kw">of</span> <span class="kw">obs</span>   =        654</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                                                  LR <span class="fu">chi2</span>(1)      =      58.27</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                                                  Prob &gt; <span class="fu">chi2</span>     =     0.0000</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>Log likelihood = -182.58748                       Pseudo R2       =     0.1376</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>      smoker |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>      height |   .2067181   .0307986     6.71   0.000     .1463539    .2670824</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |  -15.32622   2.017127    -7.60   0.000    -19.27972   -11.37273</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lroc</span>, nograph</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>Logistic <span class="kw">model</span> <span class="kw">for</span> smoker</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>number <span class="kw">of</span> observations =      654</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>area under ROC curve   =   0.7882</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> xb1, <span class="kw">xb</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>. <span class="kw">logit</span> smoker age</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>Logistic regression                               Number <span class="kw">of</span> <span class="kw">obs</span>   =        654</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                                                  LR <span class="fu">chi2</span>(1)      =     104.88</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                                                  Prob &gt; <span class="fu">chi2</span>     =     0.0000</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>Log likelihood = -159.28248                       Pseudo R2       =     0.2477</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>      smoker |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]</span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>         age |   .4836394   .0551278     8.77   0.000      .375591    .5916878</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |  -7.743905   .7089008   -10.92   0.000    -9.133325   -6.354485</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>. <span class="kw">lroc</span>, nograph</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>Logistic <span class="kw">model</span> <span class="kw">for</span> smoker</span>
<span id="cb6-42"><a href="#cb6-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-43"><a href="#cb6-43" aria-hidden="true" tabindex="-1"></a>number <span class="kw">of</span> observations =      654</span>
<span id="cb6-44"><a href="#cb6-44" aria-hidden="true" tabindex="-1"></a>area under ROC curve   =   0.8677</span>
<span id="cb6-45"><a href="#cb6-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-46"><a href="#cb6-46" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> xb2, <span class="kw">xb</span></span>
<span id="cb6-47"><a href="#cb6-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-48"><a href="#cb6-48" aria-hidden="true" tabindex="-1"></a>. <span class="kw">roccomp</span> smoker xb1 xb2, <span class="kw">graph</span> summary</span>
<span id="cb6-49"><a href="#cb6-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-50"><a href="#cb6-50" aria-hidden="true" tabindex="-1"></a>                              ROC                    -Asymptotic Normal--</span>
<span id="cb6-51"><a href="#cb6-51" aria-hidden="true" tabindex="-1"></a>                   Obs       Area     Std. Err.      [95% Conf. Interval]</span>
<span id="cb6-52"><a href="#cb6-52" aria-hidden="true" tabindex="-1"></a>-------------------------------------------------------------------------</span>
<span id="cb6-53"><a href="#cb6-53" aria-hidden="true" tabindex="-1"></a>xb1                654     0.7882       0.0225        0.74414     0.83227</span>
<span id="cb6-54"><a href="#cb6-54" aria-hidden="true" tabindex="-1"></a>xb2                654     0.8677       0.0185        0.83152     0.90393</span>
<span id="cb6-55"><a href="#cb6-55" aria-hidden="true" tabindex="-1"></a>-------------------------------------------------------------------------</span>
<span id="cb6-56"><a href="#cb6-56" aria-hidden="true" tabindex="-1"></a>Ho: area(xb1) = area(xb2)</span>
<span id="cb6-57"><a href="#cb6-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">chi2</span>(1) =    11.20       Prob&gt;<span class="fu">chi2</span> =   0.0008</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="./figures/roc1.png" class="figure-img" style="height:4in"></p>
<figcaption class="margin-caption">image</figcaption>
</figure>
</div>
<ul>
<li><p>Age has a significantly larger AUC than Height (<span class="math inline">\(p &lt; 0.001\)</span>)</p></li>
<li><p>For any given false positive rate, the sensitivity is higher for age</p>
<ul>
<li>Predicted value positive would also always be higher</li>
</ul></li>
</ul>
</section>
<section id="example-2-multiple-predictors-of-smoking" class="level3 page-columns page-full" data-number="4.5">
<h3 data-number="4.5" class="anchored" data-anchor-id="example-2-multiple-predictors-of-smoking"><span class="header-section-number">4.5</span> Example 2: Multiple predictors of smoking</h3>
<ul>
<li><p>Will consider age, height, sex, and fev as predictors of smoking</p></li>
<li><p>Fit a multivariable logistic regression model using these covariates in a training sample</p>
<ul>
<li><p>Training sample will contain 60% of the observation in the current study</p></li>
<li><p>Develop a model on the training sample, see how well it fits in the validation sample (the remaining 40% of the data)</p></li>
</ul></li>
<li><p>Consider a rule that predicts a subject will smoke if their predicted probability is greater than 0.5</p>
<ul>
<li><p>Could choose other cutoffs than 0.5</p></li>
<li><p>Other cutoffs will be represented on the ROC curves</p></li>
<li><p>Sensitivity, specificity will vary by the cutoff chosen</p></li>
</ul></li>
</ul>
<!-- -->
<div class="sourceCode" id="cb7"><pre class="sourceCode stata code-with-copy"><code class="sourceCode stata"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>. <span class="kw">xi</span>: <span class="kw">logit</span> smoker age height i.sex fev <span class="kw">if</span> training &lt; .6</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>i.sex             _Isex_1-2           (_Isex_1 <span class="kw">for</span> sex==female omitted)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>Logistic regression                               Number <span class="kw">of</span> <span class="kw">obs</span>   =        385</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                                                  LR <span class="fu">chi2</span>(4)      =      80.02</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                                                  Prob &gt; <span class="fu">chi2</span>     =     0.0000</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>Log likelihood = -70.223945                       Pseudo R2       =     0.3629</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      smoker |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>-------------+----------------------------------------------------------------</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>         age |   .6611145   .1276124     5.18   0.000     .4109988    .9112302</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      height |   .1834778   .0960597     1.91   0.056    -.0047957    .3717514</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>     _Isex_2 |  -.7128769   .5392144    -1.32   0.186    -1.769718    .3439639</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>         fev |  -1.123659   .4514655    -2.49   0.013    -2.008515   -.2388024</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>       <span class="dt">_cons</span> |  -18.18847   5.100367    -3.57   0.000    -28.18501   -8.191936</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------------</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>. <span class="kw">predict</span> pfit</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>(option pr assumed; Pr(smoker))</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>. <span class="kw">gen</span> pfit50=pfit</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>. <span class="kw">recode</span> pfit50 0/0.5=0 0.5/1=1</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>(pfit50: 654 changes made)</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>. </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>. <span class="kw">tabulate</span> smoker pfit50 <span class="kw">if</span> training &gt; .6, <span class="ot">row</span> col </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>           |        pfit50</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    smoker |         0          1 |     Total</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>-----------+----------------------+----------</span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>         0 |       226         10 |       236 </span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>           |     95.76       4.24 |    100.00 </span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>           |     90.04      55.56 |     87.73 </span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>-----------+----------------------+----------</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>         1 |        25          8 |        33 </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>           |     75.76      24.24 |    100.00 </span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>           |      9.96      44.44 |     12.27 </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>-----------+----------------------+----------</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>     Total |       251         18 |       269 </span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>           |     93.31       6.69 |    100.00 </span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>           |    100.00     100.00 |    100.00 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>Using a cutoff of 0.50</p>
<ul>
<li><p>Sensitivity: <span class="math inline">\(8/33 = 24.24\)</span></p></li>
<li><p>Specificity: <span class="math inline">\(226/236 = 95.76\)</span></p></li>
<li><p>PVP: <span class="math inline">\(8/18 = 44.44\)</span></p></li>
<li><p>PVN: <span class="math inline">\(226/251 = 90.04\)</span></p></li>
</ul></li>
<li><p>Thresholds other than 0.50 give different values for sensitivity, specificity, PVP, PVN</p>
<ul>
<li>ROC curve displayed gives all possible thresholds</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="./figures/roc2.png" class="figure-img" style="height:4in"></p>
<figcaption class="margin-caption">image</figcaption>
</figure>
</div>
</section>
<section id="analysis-of-roc-curves-in-r" class="level3" data-number="4.6">
<h3 data-number="4.6" class="anchored" data-anchor-id="analysis-of-roc-curves-in-r"><span class="header-section-number">4.6</span> Analysis of ROC curves in R</h3>
<ul>
<li><p>There are a number of add on packages that will conduct ROC analysis in R</p></li>
<li><p><code>ROCR</code> is one popular package</p></li>
</ul>
</section>
<section id="multivariable-prognostic-models" class="level3" data-number="4.7">
<h3 data-number="4.7" class="anchored" data-anchor-id="multivariable-prognostic-models"><span class="header-section-number">4.7</span> Multivariable prognostic models</h3>
<ul>
<li><p>Reference</p>
<ul>
<li><p>Harrell FE Jr, Lee KL, Mark DB. Multivariable prognostic models: issues in developing models, evaluating assumptions and adequacy, and measuring and reducing errors. Statistics in Medicine. 15(4): 361-87, Feb 1996</p></li>
<li><p>A “Tutorial is Biostatistics” (frequently appears in Statistics in Medicine)</p></li>
</ul></li>
<li><p>From abstract of paper</p>
<ul>
<li><p>“Multivariable regression models are powerful tools that are frequently used in clinical outcomes… however uncritical application of modeling techniques can result in models that poorly fit the dataset at hand, or, even more likely, inaccurately predict outcomes on new subjects.”</p></li>
<li><p>“… predictive accuracy should be unbiasedly validated using bootstrapping or cross-validation before using predictions in new data series.”</p></li>
</ul></li>
<li><p>Common problem: Number of predictors being considered (<span class="math inline">\(p\)</span>) is larger than the number of events (<span class="math inline">\(m\)</span>)</p>
<ul>
<li><p>Recommendation: Consider no more than <span class="math inline">\(m/10\)</span> potential predictors in a model</p></li>
<li><p>e.g.&nbsp;if event rate is <span class="math inline">\(10\%\)</span> and <span class="math inline">\(n=200\)</span> then <span class="math inline">\(m=20\)</span>; only <span class="math inline">\(2\)</span> potential predictors</p></li>
</ul></li>
<li><p>Step 1: Consider your dataset</p>
<ul>
<li><p>Missing data (imputation?)</p></li>
<li><p>Interactions (scientific relevance?)</p></li>
<li><p>Transformation of predictors (scientific relevance?)</p></li>
</ul></li>
<li><p>Step 2: Data Reduction</p>
<ul>
<li><p>Reduce the number of predictors to a manageable amount</p></li>
<li><p>Utilize methods that do not consider the outcome (“unsupervised” learning)</p>
<ul>
<li><p>If you do not use the outcome at this stage, your statistical inference is preserved</p></li>
<li><p>Correlations among predictors: Variable clustering, principle components analysis</p></li>
<li><p>Scientifically meaningful summary measures</p></li>
</ul></li>
</ul></li>
<li><p>Step 3: Fit the model and …</p>
<ul>
<li><p>Evaluate modeling assumptions: Linearity, additivity, distributional assumptions</p></li>
<li><p>Use backwards stepwise selection to find a simpler model</p>
<ul>
<li>Harrell: Remove predictor if <span class="math inline">\(\chi^2 &gt; 2\)</span> (<span class="math inline">\(p &gt; 0.16\)</span>)</li>
</ul></li>
<li><p>Will use <em>all data</em> to fit model</p></li>
</ul></li>
<li><p>Step 4: Evaluate model</p>
<ul>
<li><p>Bootstrap cross-validation</p>
<ul>
<li><p>Sample data with replacement</p></li>
<li><p>For each bootstrap sample, the evaluation of modeling assumptions and backwards selection will be performed (these steps use the outcome)</p></li>
<li><p>Summarize predictive accuracy using a statistic (C-index, Brier score)</p></li>
</ul></li>
<li><p>Bootstrap cross-validation provides a nearly unbiased estimate of predictive accuracy (e.g.&nbsp;C-index, Brier score) while allowing the entire model to be used for model development</p>
<ul>
<li><p>C-index: Area under the ROC curve. Index near 1 indicates higher accuracy.</p></li>
<li><p>Brier score: Average squared deviation between predicted probability of event and observed outcome. A lower score represents higher accuracy.</p></li>
</ul></li>
</ul></li>
</ul>
<section id="case-study-using-lrm-in-r" class="level4" data-number="4.7.1">
<h4 data-number="4.7.1" class="anchored" data-anchor-id="case-study-using-lrm-in-r"><span class="header-section-number">4.7.1</span> Case Study using lrm() in R</h4>
<ul>
<li><p>Logistic regression model</p>
<ul>
<li><p>Main effects: sex, cholesterol (splines), age (polynomial), and blood pressure (linear)</p></li>
<li><p>Interactions: sex with cholesterol</p></li>
<li><p>(5 predictors maximum)</p></li>
</ul></li>
</ul>
<!-- -->
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> f <span class="ot">&lt;-</span> <span class="fu">lrm</span>(y <span class="sc">~</span> sex<span class="sc">*</span><span class="fu">rcs</span>(cholesterol)<span class="sc">+</span><span class="fu">pol</span>(age,<span class="dv">2</span>)<span class="sc">+</span>blood.pressure, <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> f</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>Logistic Regression Model</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lrm</span>(<span class="at">formula =</span> y <span class="sc">~</span> sex <span class="sc">*</span> <span class="fu">rcs</span>(cholesterol) <span class="sc">+</span> <span class="fu">pol</span>(age, <span class="dv">2</span>) <span class="sc">+</span> blood.pressure, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                      Model Likelihood     Discrimination    Rank Discrim.    </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                         Ratio Test            Indexes          Indexes       </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>Obs          <span class="dv">1000</span>    LR chi2      <span class="fl">84.78</span>    R2       <span class="fl">0.109</span>    C       <span class="fl">0.660</span>    </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a> <span class="dv">0</span>            <span class="dv">440</span>    d.f.            <span class="dv">12</span>    g        <span class="fl">0.704</span>    Dxy     <span class="fl">0.321</span>    </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>            <span class="dv">560</span>    <span class="fu">Pr</span>(<span class="sc">&gt;</span> chi2) <span class="sc">&lt;</span><span class="fl">0.0001</span>    gr       <span class="fl">2.023</span>    gamma   <span class="fl">0.322</span>    </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>max <span class="sc">|</span>deriv<span class="sc">|</span> <span class="fl">2e-04</span>                          gp       <span class="fl">0.160</span>    tau<span class="sc">-</span>a   <span class="fl">0.158</span>    </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                                           Brier    <span class="fl">0.226</span>                     </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                          Coef    S.E.   Wald Z <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>Z<span class="sc">|</span>)</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>Intercept                 <span class="sc">-</span><span class="fl">2.8990</span> <span class="fl">2.7445</span> <span class="sc">-</span><span class="fl">1.06</span>  <span class="fl">0.2908</span>  </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male                  <span class="sc">-</span><span class="fl">5.7526</span> <span class="fl">3.6005</span> <span class="sc">-</span><span class="fl">1.60</span>  <span class="fl">0.1101</span>  </span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>cholesterol               <span class="sc">-</span><span class="fl">0.0027</span> <span class="fl">0.0148</span> <span class="sc">-</span><span class="fl">0.18</span>  <span class="fl">0.8552</span>  </span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>cholesterol<span class="st">'              -0.0438 0.0793 -0.55  0.5804  </span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a><span class="st">cholesterol''              0.1808 0.4591  0.39  0.6937  </span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a><span class="st">cholesterol'''</span>            <span class="sc">-</span><span class="fl">0.1266</span> <span class="fl">0.7850</span> <span class="sc">-</span><span class="fl">0.16</span>  <span class="fl">0.8719</span>  </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>age                        <span class="fl">0.1253</span> <span class="fl">0.0475</span>  <span class="fl">2.64</span>  <span class="fl">0.0083</span>  </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>age<span class="sc">^</span><span class="dv">2</span>                     <span class="sc">-</span><span class="fl">0.0009</span> <span class="fl">0.0005</span> <span class="sc">-</span><span class="fl">1.88</span>  <span class="fl">0.0605</span>  </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>blood.pressure            <span class="sc">-</span><span class="fl">0.0018</span> <span class="fl">0.0045</span> <span class="sc">-</span><span class="fl">0.40</span>  <span class="fl">0.6901</span>  </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male <span class="sc">*</span> cholesterol     <span class="fl">0.0313</span> <span class="fl">0.0218</span>  <span class="fl">1.43</span>  <span class="fl">0.1515</span>  </span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male <span class="sc">*</span> cholesterol<span class="st">'    0.0190 0.1146  0.17  0.8683  </span></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="st">sex=male * cholesterol''  -0.1227 0.6718 -0.18  0.8551  </span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a><span class="st">sex=male * cholesterol'''</span>  <span class="fl">0.1315</span> <span class="fl">1.1752</span>  <span class="fl">0.11</span>  <span class="fl">0.9109</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><p>Validation…</p>
<ul>
<li><p>Backwards stepwise regression</p>
<ul>
<li><p>Different bootstrap sample will remove different covariates</p></li>
<li><p>Indicates which covariates were included for each sample</p></li>
</ul></li>
<li><p>Estimates of discrimination indexes</p></li>
</ul></li>
</ul>
<!-- -->
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">validate</span>(f, <span class="at">B=</span><span class="dv">150</span>, <span class="at">bw=</span><span class="cn">TRUE</span>, <span class="at">rule=</span><span class="st">"p"</span>, <span class="at">sls=</span>.<span class="dv">1</span>, <span class="at">type=</span><span class="st">"individual"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                Backwards Step<span class="sc">-</span>down <span class="sc">-</span> Original Model</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a> Deleted        Chi<span class="sc">-</span>Sq d.f. P      Residual d.f. P      AIC  </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a> blood.pressure <span class="fl">0.16</span>   <span class="dv">1</span>    <span class="fl">0.6901</span> <span class="fl">0.16</span>     <span class="dv">1</span>    <span class="fl">0.6901</span> <span class="sc">-</span><span class="fl">1.84</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a> cholesterol    <span class="fl">7.35</span>   <span class="dv">4</span>    <span class="fl">0.1184</span> <span class="fl">7.51</span>     <span class="dv">5</span>    <span class="fl">0.1853</span> <span class="sc">-</span><span class="fl">2.49</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>Approximate Estimates after Deleting Factors</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                                Coef      S.E.    Wald Z        P</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>Intercept                 <span class="sc">-</span><span class="fl">3.9763208</span> <span class="fl">1.1849888</span> <span class="sc">-</span><span class="fl">3.355577</span> <span class="fl">0.000792</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male                  <span class="sc">-</span><span class="fl">4.9024437</span> <span class="fl">2.6546474</span> <span class="sc">-</span><span class="fl">1.846740</span> <span class="fl">0.064785</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>age                        <span class="fl">0.1246156</span> <span class="fl">0.0473845</span>  <span class="fl">2.629884</span> <span class="fl">0.008541</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>age<span class="sc">^</span><span class="dv">2</span>                     <span class="sc">-</span><span class="fl">0.0008688</span> <span class="fl">0.0004677</span> <span class="sc">-</span><span class="fl">1.857457</span> <span class="fl">0.063246</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male <span class="sc">*</span> cholesterol     <span class="fl">0.0286721</span> <span class="fl">0.0160278</span>  <span class="fl">1.788897</span> <span class="fl">0.073631</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male <span class="sc">*</span> cholesterol<span class="st">'   -0.0252835 0.0827977 -0.305365 0.760088</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="st">sex=male * cholesterol''   0.0634986 0.4907718  0.129385 0.897053</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="st">sex=male * cholesterol'''</span> <span class="sc">-</span><span class="fl">0.0071007</span> <span class="fl">0.8750440</span> <span class="sc">-</span><span class="fl">0.008115</span> <span class="fl">0.993526</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>Factors <span class="cf">in</span> Final Model</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] sex               age               sex <span class="sc">*</span> cholesterol</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>          index.orig training   test optimism index.corrected   n</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>Dxy           <span class="fl">0.3082</span>   <span class="fl">0.3301</span> <span class="fl">0.2986</span>   <span class="fl">0.0316</span>          <span class="fl">0.2766</span> <span class="dv">150</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>R2            <span class="fl">0.0995</span>   <span class="fl">0.1184</span> <span class="fl">0.0946</span>   <span class="fl">0.0238</span>          <span class="fl">0.0757</span> <span class="dv">150</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>Intercept     <span class="fl">0.0000</span>   <span class="fl">0.0000</span> <span class="fl">0.0263</span>  <span class="sc">-</span><span class="fl">0.0263</span>          <span class="fl">0.0263</span> <span class="dv">150</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>Slope         <span class="fl">1.0000</span>   <span class="fl">1.0000</span> <span class="fl">0.8879</span>   <span class="fl">0.1121</span>          <span class="fl">0.8879</span> <span class="dv">150</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>Emax          <span class="fl">0.0000</span>   <span class="fl">0.0000</span> <span class="fl">0.0308</span>   <span class="fl">0.0308</span>          <span class="fl">0.0308</span> <span class="dv">150</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>D             <span class="fl">0.0762</span>   <span class="fl">0.0917</span> <span class="fl">0.0722</span>   <span class="fl">0.0195</span>          <span class="fl">0.0567</span> <span class="dv">150</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>U            <span class="sc">-</span><span class="fl">0.0020</span>  <span class="sc">-</span><span class="fl">0.0020</span> <span class="fl">0.0016</span>  <span class="sc">-</span><span class="fl">0.0036</span>          <span class="fl">0.0016</span> <span class="dv">150</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>Q             <span class="fl">0.0782</span>   <span class="fl">0.0937</span> <span class="fl">0.0706</span>   <span class="fl">0.0231</span>          <span class="fl">0.0551</span> <span class="dv">150</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>B             <span class="fl">0.2279</span>   <span class="fl">0.2244</span> <span class="fl">0.2295</span>  <span class="sc">-</span><span class="fl">0.0051</span>          <span class="fl">0.2330</span> <span class="dv">150</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>g             <span class="fl">0.6650</span>   <span class="fl">0.7374</span> <span class="fl">0.6452</span>   <span class="fl">0.0922</span>          <span class="fl">0.5729</span> <span class="dv">150</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>gp            <span class="fl">0.1512</span>   <span class="fl">0.1651</span> <span class="fl">0.1477</span>   <span class="fl">0.0173</span>          <span class="fl">0.1339</span> <span class="dv">150</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>Factors Retained <span class="cf">in</span> Backwards Elimination</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a> sex cholesterol age blood.pressure sex <span class="sc">*</span> cholesterol</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a> <span class="sc">*</span>               <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a> <span class="er">*</span>   <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a> <span class="er">*</span>               <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>     <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a> <span class="er">*</span>   <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a> <span class="er">*</span>   <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>     <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>     <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>(output omitted; continues <span class="cf">for</span> each bootstrap sample)</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>Frequencies of Numbers of Factors Retained</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span> </span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> <span class="dv">74</span> <span class="dv">55</span>  <span class="dv">3</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/chrissl789\.github\.io\/modern-regression\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../notes/Lec12.ANOVA.Model.Choice.html" class="pagination-link" aria-label="ANOVA and Model Choice">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">ANOVA and Model Choice</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../notes/BayesDiagnostics.html" class="pagination-link" aria-label="Bayesian Model Diagnostics">
        <span class="nav-page-text">Bayesian Model Diagnostics</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb10" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Regression Based Prediction"</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "Lecture 13"</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="an">name:</span><span class="co"> Lec13.Prediction.qmd</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rms)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">tryCatch</span>(<span class="fu">source</span>(<span class="st">'pander_registry.R'</span>), <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">invisible</span>(e))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">### Uses of Regression</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Cluster Analysis</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Focuses on identifying observations (covariates) with similar characteristics</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Interest lies in finding clusters that are more (or less) likely to have some outcome of interest</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Divide a population into subgroups based on patterns of similar measurement</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Clustering can be done by considering one variable (univariable) or multiple variables (multivariable)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Number of clusters can be known or unknown</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Examples</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Microarrays</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>fMRI</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>"Small $n$, large $p$" (few subjects, many predictors)</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Statistical techniques</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Stepwise regression</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Regression trees</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Other data-driven model building approaches</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Getting valid inference (i.e. reliable p-values, unbiased parameter estimates) particularly challenging</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Area of active research in Biostatistics</span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Quantifying and comparing distributions</span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Compare distribution of the outcome variable across levels of the grouping variable or variables</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Compare salary in males and females, across professors of the same rank, degree, experience, and field</span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Compare FEV in smokers and non-smokers, across teenagers of the same age and height</span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Need to decide which summary measure is appropriate for describing the distribution</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Common summary measures: Means, median, geometric mean, odds, rates, hazards</span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Other measures: Variance, skewness, kurtosis, likelihood of extreme values, quantiles, etc.</span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>May desire estimates within specific subgroups</span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Estimates of the association within gender, race, or age groups</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>(This is effect modification)</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Regression based prediction</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Prediction of summary measures</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Point prediction</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Best single estimate for the measurement that would be obtained, on average, for many individuals with given covariates</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Interval prediction</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Quantify the uncertainty of the average</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Range of summary measure that might be reasonable to observe</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Prediction of individual measurements</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Point prediction</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Best single estimate for the measurement that would be obtained on a single individual with given covariates</span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Interval prediction</span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Quantify the uncertainty of the individual prediction</span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Range of measurements that might reasonably be observed in a future individual with given covariates</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a><span class="fu">### Examples of Prediction</span></span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Continuous prediction: Creatinine clearance</span></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Creatinine is a continuously produced breakdown product in muscles</span>
<span id="cb10-102"><a href="#cb10-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-103"><a href="#cb10-103" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Removed by the kidney through filtration</span>
<span id="cb10-104"><a href="#cb10-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-105"><a href="#cb10-105" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Amount of creatinine cleared by the kidneys in 24 hours is a measure of renal function</span>
<span id="cb10-106"><a href="#cb10-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-107"><a href="#cb10-107" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Gold standard is to collect urine output for 24 hours, measure creatinine</span>
<span id="cb10-108"><a href="#cb10-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-109"><a href="#cb10-109" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Would prefer to find a combination of blood and urine measures that can be obtained at one time point, yet still provides accurate prediction of a patient's creatinine clearance</span>
<span id="cb10-110"><a href="#cb10-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-111"><a href="#cb10-111" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Statistical approach</span>
<span id="cb10-112"><a href="#cb10-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-113"><a href="#cb10-113" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Collect a training dataset to build a regression model for prediction</span>
<span id="cb10-114"><a href="#cb10-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-115"><a href="#cb10-115" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Measure true creatinine clearance</span>
<span id="cb10-116"><a href="#cb10-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-117"><a href="#cb10-117" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Measure age, gender, weight, height, blood makers, urinary markers, etc.</span>
<span id="cb10-118"><a href="#cb10-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-119"><a href="#cb10-119" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Fit a (data driven?) regression model to predict true creatinine clearance</span>
<span id="cb10-120"><a href="#cb10-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Collect a validation dataset</span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Use the regression estimates (the $\beta$s) from the training dataset to see how well your model predict creatinine clearance</span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Quantify the accuracy of the predictive model (e.g. mean squared error)</span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Cross validation</span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Discrimination (binary prediction): Low birth weight</span></span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Want to predict which infants are more likely to be less than 2500 grams at birth</span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Possible predictors: Age, race, blood biomarkers collected during pregnancy</span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Statistical Approach</span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Collect a training dataset to build a regression model for prediction</span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Measure birth weight</span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Measure age, race, blood biomarkers</span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Fit a (data driven?) regression model to predict low birth weight</span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Collect a validation dataset</span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Use the regression estimates (the $\beta$s) from the training dataset to see how well your model predict low birth weight</span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Quantify the accuracy of the predictive model</span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Sensitivity, specificity (ROC curves)</span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Predictive value positive, predictive value negative</span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-155"><a href="#cb10-155" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Interval prediction: Normal ranges of PSA</span></span>
<span id="cb10-156"><a href="#cb10-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-157"><a href="#cb10-157" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Identify the range of PSA values that would be expected in 95% of most healthy adult males</span>
<span id="cb10-158"><a href="#cb10-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-159"><a href="#cb10-159" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Possibly stratify by age, race</span>
<span id="cb10-160"><a href="#cb10-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-161"><a href="#cb10-161" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Statistical Approach</span>
<span id="cb10-162"><a href="#cb10-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-163"><a href="#cb10-163" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Collect a training dataset to build a regression model for prediction</span>
<span id="cb10-164"><a href="#cb10-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-165"><a href="#cb10-165" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Measure PSA and variable to predict PSA</span>
<span id="cb10-166"><a href="#cb10-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-167"><a href="#cb10-167" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Need to estimate the quantiles</span>
<span id="cb10-168"><a href="#cb10-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-169"><a href="#cb10-169" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Mean plus/minus 2 standard deviations (makes strong Normality assumption)</span>
<span id="cb10-170"><a href="#cb10-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-171"><a href="#cb10-171" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Estimate the quantiles, provide CIs around the quantiles (likely low precision)</span>
<span id="cb10-172"><a href="#cb10-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-173"><a href="#cb10-173" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Collect a validation dataset</span>
<span id="cb10-174"><a href="#cb10-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-175"><a href="#cb10-175" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Quantify the accuracy of the predictive model (e.g. coverage probabilities)</span>
<span id="cb10-176"><a href="#cb10-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-177"><a href="#cb10-177" aria-hidden="true" tabindex="-1"></a><span class="fu">### Assumptions needed for inference</span></span>
<span id="cb10-178"><a href="#cb10-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-179"><a href="#cb10-179" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference for associations</span></span>
<span id="cb10-180"><a href="#cb10-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-181"><a href="#cb10-181" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Necessary assumptions for classical regression (no robust standard errors)</span>
<span id="cb10-182"><a href="#cb10-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-183"><a href="#cb10-183" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Independence of response measurements within identified clusters</span>
<span id="cb10-184"><a href="#cb10-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-185"><a href="#cb10-185" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Have appropriately modeled the within group variance</span>
<span id="cb10-186"><a href="#cb10-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-187"><a href="#cb10-187" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Linear regression: Equal variance across groups</span>
<span id="cb10-188"><a href="#cb10-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-189"><a href="#cb10-189" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Other regressions: Appropriate mean-variance relationship</span>
<span id="cb10-190"><a href="#cb10-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-191"><a href="#cb10-191" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Lack of model fit may lead to poor estimate of the variance</span>
<span id="cb10-192"><a href="#cb10-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-193"><a href="#cb10-193" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Sample size is large enough so that parameter estimates approximately follow a Normal distribution</span>
<span id="cb10-194"><a href="#cb10-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-195"><a href="#cb10-195" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Necessary assumptions for first order trends using robust standard errors</span>
<span id="cb10-196"><a href="#cb10-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-197"><a href="#cb10-197" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Independence of response measurements within identified clusters</span>
<span id="cb10-198"><a href="#cb10-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-199"><a href="#cb10-199" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>(Robust standard errors accounts for heteroscedasticity in large samples)</span>
<span id="cb10-200"><a href="#cb10-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-201"><a href="#cb10-201" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Lack of model fit leads to conservative inference due to mixing systematic and random error</span>
<span id="cb10-202"><a href="#cb10-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-203"><a href="#cb10-203" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Sample size is large enough so that parameter estimates approximately follow a Normal distribution</span>
<span id="cb10-204"><a href="#cb10-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-205"><a href="#cb10-205" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Inference for predictions</span></span>
<span id="cb10-206"><a href="#cb10-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-207"><a href="#cb10-207" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Additional assumptions for predictions of means</span>
<span id="cb10-208"><a href="#cb10-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-209"><a href="#cb10-209" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Our regression model has accurately described the relationship between summary measures across groups</span>
<span id="cb10-210"><a href="#cb10-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-211"><a href="#cb10-211" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>For continuous covariates, often involves flexible models that allow for departures from linearity</span>
<span id="cb10-212"><a href="#cb10-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-213"><a href="#cb10-213" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Additional assumptions for predictions of individual observations</span>
<span id="cb10-214"><a href="#cb10-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-215"><a href="#cb10-215" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Also need to know the shape of the distribution within each group</span>
<span id="cb10-216"><a href="#cb10-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-217"><a href="#cb10-217" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Methods implemented in software often rely on strong assumptions like Normality</span>
<span id="cb10-218"><a href="#cb10-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-219"><a href="#cb10-219" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimation (prediction) of summary measures</span></span>
<span id="cb10-220"><a href="#cb10-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-221"><a href="#cb10-221" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Given age, height, and sex, estimate the mean (or geometric mean) FEV</span>
<span id="cb10-222"><a href="#cb10-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-223"><a href="#cb10-223" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Use linear regression to obtain estimates and CI</span>
<span id="cb10-224"><a href="#cb10-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-225"><a href="#cb10-225" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Given age and PSA, estimate the probability (or odds) of remaining in remission for 24 months</span>
<span id="cb10-226"><a href="#cb10-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-227"><a href="#cb10-227" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Use logistic regression to obtain estimates and CI</span>
<span id="cb10-228"><a href="#cb10-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-229"><a href="#cb10-229" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumptions</span>
<span id="cb10-230"><a href="#cb10-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-231"><a href="#cb10-231" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Independence (between clusters for robust SE)</span>
<span id="cb10-232"><a href="#cb10-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-233"><a href="#cb10-233" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Variance approximated by the model (relaxed for robust SE)</span>
<span id="cb10-234"><a href="#cb10-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-235"><a href="#cb10-235" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Regression model accurately describes the relationship of summary measures across groups</span>
<span id="cb10-236"><a href="#cb10-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-237"><a href="#cb10-237" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Sufficient sample sizes for asymptotic distributions of parameters to be a good approximation</span>
<span id="cb10-238"><a href="#cb10-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-239"><a href="#cb10-239" aria-hidden="true" tabindex="-1"></a><span class="fu">### Point estimates</span></span>
<span id="cb10-240"><a href="#cb10-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-241"><a href="#cb10-241" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Point estimates obtained by substitution of predictor values into the estimated regression equation</span>
<span id="cb10-242"><a href="#cb10-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-243"><a href="#cb10-243" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$E<span class="co">[</span><span class="ot">\textrm{Chol} | \textrm{Age}</span><span class="co">]</span> = 200 + 0.33 \times \textrm{Age}$</span>
<span id="cb10-244"><a href="#cb10-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-245"><a href="#cb10-245" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Expected cholesterol for 50 year old is $200 + 0.33 \times 50 = 216.5$</span>
<span id="cb10-246"><a href="#cb10-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-247"><a href="#cb10-247" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\textrm{logodds}(\textrm{Survival} | \textrm{Age}) = -0.1365 - 0.007899 \times \textrm{Age}$</span>
<span id="cb10-248"><a href="#cb10-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-249"><a href="#cb10-249" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Expected log-odds of Survival for a 50 year old is $-0.1365 - 0.007899 \times 50 = -0.53$</span>
<span id="cb10-250"><a href="#cb10-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-251"><a href="#cb10-251" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Expected odds $= e^{-.53} = 0.59$</span>
<span id="cb10-252"><a href="#cb10-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-253"><a href="#cb10-253" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Expected probability $= 0.37$</span>
<span id="cb10-254"><a href="#cb10-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-255"><a href="#cb10-255" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interval estimates</span></span>
<span id="cb10-256"><a href="#cb10-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-257"><a href="#cb10-257" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>If assumptions hold, interval estimates can be obtained</span>
<span id="cb10-258"><a href="#cb10-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-259"><a href="#cb10-259" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>We generally find a confidence interval for the transformed quantity, and then back transform to the desired quantity</span>
<span id="cb10-260"><a href="#cb10-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-261"><a href="#cb10-261" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>For logistic regression, calculate the CI for the log odds, the transform to odds or probability</span>
<span id="cb10-262"><a href="#cb10-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-263"><a href="#cb10-263" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Statistical criteria for determining the "best" estimate</span>
<span id="cb10-264"><a href="#cb10-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-265"><a href="#cb10-265" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Consistent: Correct estimate (with infinite sample size)</span>
<span id="cb10-266"><a href="#cb10-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-267"><a href="#cb10-267" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Precise: Minimum variance among (unbiased) estimators</span>
<span id="cb10-268"><a href="#cb10-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-269"><a href="#cb10-269" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Common regression methods provide the best estimate in a wide variety of settings</span>
<span id="cb10-270"><a href="#cb10-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-271"><a href="#cb10-271" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Necessary assumptions</span>
<span id="cb10-272"><a href="#cb10-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-273"><a href="#cb10-273" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Independence</span>
<span id="cb10-274"><a href="#cb10-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-275"><a href="#cb10-275" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Variance approximated by the model (relaxed for robust SE)</span>
<span id="cb10-276"><a href="#cb10-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-277"><a href="#cb10-277" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Regression model accurately describes the relationship among summary measures across groups**</span>
<span id="cb10-278"><a href="#cb10-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-279"><a href="#cb10-279" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Sufficient sample size so that asymptotic Normality of the parameter estimates holds</span>
<span id="cb10-280"><a href="#cb10-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-281"><a href="#cb10-281" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interval estimates</span>
<span id="cb10-282"><a href="#cb10-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-283"><a href="#cb10-283" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When we substitute in the predictor values, it provides an estimate of the model transformation of the summary measure</span>
<span id="cb10-284"><a href="#cb10-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-285"><a href="#cb10-285" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Model transformation of the summary measure varies by regression setting</span>
<span id="cb10-286"><a href="#cb10-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-287"><a href="#cb10-287" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Linear regression: Mean</span>
<span id="cb10-288"><a href="#cb10-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-289"><a href="#cb10-289" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Linear regression on log transformed outcome: Log geometric mean</span>
<span id="cb10-290"><a href="#cb10-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-291"><a href="#cb10-291" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Logistic regression: Log odds</span>
<span id="cb10-292"><a href="#cb10-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-293"><a href="#cb10-293" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Poisson regression: Log rate</span>
<span id="cb10-294"><a href="#cb10-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-295"><a href="#cb10-295" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Formulas for the confidence interval</span>
<span id="cb10-296"><a href="#cb10-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-297"><a href="#cb10-297" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>In general: $\textrm{(estimate)} \pm \textrm{(crit value)} \times \textrm{(std error)}$</span>
<span id="cb10-298"><a href="#cb10-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-299"><a href="#cb10-299" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>In linear regression, the $t$ distribution is usually used to obtain the confidence interval</span>
<span id="cb10-300"><a href="#cb10-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-301"><a href="#cb10-301" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Stata: $\textrm{(crit value)} = \texttt{invttail}(df, \alpha/2)$</span>
<span id="cb10-302"><a href="#cb10-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-303"><a href="#cb10-303" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>R: $\textrm{(crit value)} = \texttt{qt}(1-\alpha/2, df)$</span>
<span id="cb10-304"><a href="#cb10-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-305"><a href="#cb10-305" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Degrees of freedom $df = n - \textrm{number of predictors in model}$</span>
<span id="cb10-306"><a href="#cb10-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-307"><a href="#cb10-307" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>In other regressions, we use the standard Normal distribution</span>
<span id="cb10-308"><a href="#cb10-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-309"><a href="#cb10-309" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Stata: $\textrm{(crit value)} = \texttt{invnorm}(1 - \alpha/2) = 1.96$</span>
<span id="cb10-310"><a href="#cb10-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-311"><a href="#cb10-311" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>R: $\textrm{(crit value)} = \texttt{qnorm}(1-\alpha/2) = 1.96$</span>
<span id="cb10-312"><a href="#cb10-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-313"><a href="#cb10-313" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interval estimates in Stata</span>
<span id="cb10-314"><a href="#cb10-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-315"><a href="#cb10-315" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>After any regression command, the Stata command <span class="in">`predict`</span> will give compute estimates and standard errors</span>
<span id="cb10-316"><a href="#cb10-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-317"><a href="#cb10-317" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`predict varname, [what]`</span></span>
<span id="cb10-318"><a href="#cb10-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-319"><a href="#cb10-319" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`varname`</span> is that name of the new variable to be created</span>
<span id="cb10-320"><a href="#cb10-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-321"><a href="#cb10-321" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`what`</span> is one of</span>
<span id="cb10-322"><a href="#cb10-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-323"><a href="#cb10-323" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>xb: The linear predictor (works for all regression)</span>
<span id="cb10-324"><a href="#cb10-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-325"><a href="#cb10-325" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>stdp: Standard error of the linear prediction</span>
<span id="cb10-326"><a href="#cb10-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-327"><a href="#cb10-327" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>p: For logistic regression, to predicted probability</span>
<span id="cb10-328"><a href="#cb10-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-329"><a href="#cb10-329" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interval estimates in R</span>
<span id="cb10-330"><a href="#cb10-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-331"><a href="#cb10-331" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>After storing a model, the R function <span class="in">`predict`</span> will give compute estimates and standard errors</span>
<span id="cb10-332"><a href="#cb10-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-333"><a href="#cb10-333" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`predict(object, se.fit=FALSE, ...)`</span></span>
<span id="cb10-334"><a href="#cb10-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-335"><a href="#cb10-335" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`object`</span> is the stored fitted model</span>
<span id="cb10-336"><a href="#cb10-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-337"><a href="#cb10-337" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`se.fit`</span> will provide the standard error of the fit (defaults to <span class="in">`FALSE`</span>)</span>
<span id="cb10-338"><a href="#cb10-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-339"><a href="#cb10-339" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>See <span class="in">`help(predict)`</span> for more details and options</span>
<span id="cb10-340"><a href="#cb10-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-341"><a href="#cb10-341" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb10-342"><a href="#cb10-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-343"><a href="#cb10-343" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb10-344"><a href="#cb10-344" aria-hidden="true" tabindex="-1"></a><span class="in">. gen logfev = log(fev)</span></span>
<span id="cb10-345"><a href="#cb10-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-346"><a href="#cb10-346" aria-hidden="true" tabindex="-1"></a><span class="in">. regress logfev height age</span></span>
<span id="cb10-347"><a href="#cb10-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-348"><a href="#cb10-348" aria-hidden="true" tabindex="-1"></a><span class="in">      Source |       SS       df       MS              Number of obs =     654</span></span>
<span id="cb10-349"><a href="#cb10-349" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+------------------------------           F(  2,   651) = 1361.98</span></span>
<span id="cb10-350"><a href="#cb10-350" aria-hidden="true" tabindex="-1"></a><span class="in">       Model |  58.5363336     2  29.2681668           Prob &gt; F      =  0.0000</span></span>
<span id="cb10-351"><a href="#cb10-351" aria-hidden="true" tabindex="-1"></a><span class="in">    Residual |  13.9895809   651  .021489372           R-squared     =  0.8071</span></span>
<span id="cb10-352"><a href="#cb10-352" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+------------------------------           Adj R-squared =  0.8065</span></span>
<span id="cb10-353"><a href="#cb10-353" aria-hidden="true" tabindex="-1"></a><span class="in">       Total |  72.5259145   653  .111065719           Root MSE      =  .14659</span></span>
<span id="cb10-354"><a href="#cb10-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-355"><a href="#cb10-355" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-356"><a href="#cb10-356" aria-hidden="true" tabindex="-1"></a><span class="in">      logfev |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb10-357"><a href="#cb10-357" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb10-358"><a href="#cb10-358" aria-hidden="true" tabindex="-1"></a><span class="in">      height |   .0439913   .0016473    26.71   0.000     .0407567    .0472259</span></span>
<span id="cb10-359"><a href="#cb10-359" aria-hidden="true" tabindex="-1"></a><span class="in">         age |   .0198162   .0031805     6.23   0.000     .0135709    .0260616</span></span>
<span id="cb10-360"><a href="#cb10-360" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |  -1.971147   .0783322   -25.16   0.000    -2.124961   -1.817332</span></span>
<span id="cb10-361"><a href="#cb10-361" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-362"><a href="#cb10-362" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb10-363"><a href="#cb10-363" aria-hidden="true" tabindex="-1"></a><span class="in">. predict fitlogfev</span></span>
<span id="cb10-364"><a href="#cb10-364" aria-hidden="true" tabindex="-1"></a><span class="in">(option xb assumed; fitted values)</span></span>
<span id="cb10-365"><a href="#cb10-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-366"><a href="#cb10-366" aria-hidden="true" tabindex="-1"></a><span class="in">. predict sefit, stdp</span></span>
<span id="cb10-367"><a href="#cb10-367" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb10-368"><a href="#cb10-368" aria-hidden="true" tabindex="-1"></a><span class="in">. gen gmfev= exp(fitlogfev)</span></span>
<span id="cb10-369"><a href="#cb10-369" aria-hidden="true" tabindex="-1"></a><span class="in">. gen gmlofev = exp(fitlogfev - invttail(651, .025) * sefit)</span></span>
<span id="cb10-370"><a href="#cb10-370" aria-hidden="true" tabindex="-1"></a><span class="in">. gen gmhifev = exp(fitlogfev + invttail(651, .025) * sefit)</span></span>
<span id="cb10-371"><a href="#cb10-371" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb10-372"><a href="#cb10-372" aria-hidden="true" tabindex="-1"></a><span class="in">. list gmfev gmlofev gmhifev if age==10 &amp; height==66</span></span>
<span id="cb10-373"><a href="#cb10-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-374"><a href="#cb10-374" aria-hidden="true" tabindex="-1"></a><span class="in">     +--------------------------------+</span></span>
<span id="cb10-375"><a href="#cb10-375" aria-hidden="true" tabindex="-1"></a><span class="in">     |    gmfev    gmlofev    gmhifev |</span></span>
<span id="cb10-376"><a href="#cb10-376" aria-hidden="true" tabindex="-1"></a><span class="in">     |--------------------------------|</span></span>
<span id="cb10-377"><a href="#cb10-377" aria-hidden="true" tabindex="-1"></a><span class="in">330. | 3.097021   3.038578   3.156588 |</span></span>
<span id="cb10-378"><a href="#cb10-378" aria-hidden="true" tabindex="-1"></a><span class="in">...</span></span>
<span id="cb10-379"><a href="#cb10-379" aria-hidden="true" tabindex="-1"></a><span class="in">547. | 3.097021   3.038578   3.156588 |</span></span>
<span id="cb10-380"><a href="#cb10-380" aria-hidden="true" tabindex="-1"></a><span class="in">     +--------------------------------+</span></span>
<span id="cb10-381"><a href="#cb10-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-382"><a href="#cb10-382" aria-hidden="true" tabindex="-1"></a><span class="in">. logit smoker height age</span></span>
<span id="cb10-383"><a href="#cb10-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-384"><a href="#cb10-384" aria-hidden="true" tabindex="-1"></a><span class="in">Logistic regression                               Number of obs   =        654</span></span>
<span id="cb10-385"><a href="#cb10-385" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  LR chi2(2)      =     106.39</span></span>
<span id="cb10-386"><a href="#cb10-386" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  Prob &gt; chi2     =     0.0000</span></span>
<span id="cb10-387"><a href="#cb10-387" aria-hidden="true" tabindex="-1"></a><span class="in">Log likelihood = -158.52851                       Pseudo R2       =     0.2512</span></span>
<span id="cb10-388"><a href="#cb10-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-389"><a href="#cb10-389" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-390"><a href="#cb10-390" aria-hidden="true" tabindex="-1"></a><span class="in">      smoker |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]</span></span>
<span id="cb10-391"><a href="#cb10-391" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb10-392"><a href="#cb10-392" aria-hidden="true" tabindex="-1"></a><span class="in">      height |   .0505297   .0410562     1.23   0.218     -.029939    .1309984</span></span>
<span id="cb10-393"><a href="#cb10-393" aria-hidden="true" tabindex="-1"></a><span class="in">         age |   .4377213   .0661923     6.61   0.000     .3079868    .5674557</span></span>
<span id="cb10-394"><a href="#cb10-394" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |  -10.45429   2.351283    -4.45   0.000    -15.06272   -5.845856</span></span>
<span id="cb10-395"><a href="#cb10-395" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-396"><a href="#cb10-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-397"><a href="#cb10-397" aria-hidden="true" tabindex="-1"></a><span class="in">. predict logodds, xb</span></span>
<span id="cb10-398"><a href="#cb10-398" aria-hidden="true" tabindex="-1"></a><span class="in">. predict selogodds, stdp</span></span>
<span id="cb10-399"><a href="#cb10-399" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb10-400"><a href="#cb10-400" aria-hidden="true" tabindex="-1"></a><span class="in">. gen odds= exp(logodds)</span></span>
<span id="cb10-401"><a href="#cb10-401" aria-hidden="true" tabindex="-1"></a><span class="in">. gen oddslo= exp(logodds - 1.96 * selogodds)</span></span>
<span id="cb10-402"><a href="#cb10-402" aria-hidden="true" tabindex="-1"></a><span class="in">. gen oddshi= exp(logodds + 1.96 * selogodds)</span></span>
<span id="cb10-403"><a href="#cb10-403" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb10-404"><a href="#cb10-404" aria-hidden="true" tabindex="-1"></a><span class="in">. list odds oddslo oddshi if age==10 &amp; height==66</span></span>
<span id="cb10-405"><a href="#cb10-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-406"><a href="#cb10-406" aria-hidden="true" tabindex="-1"></a><span class="in">     +--------------------------------+</span></span>
<span id="cb10-407"><a href="#cb10-407" aria-hidden="true" tabindex="-1"></a><span class="in">     |     odds     oddslo     oddshi |</span></span>
<span id="cb10-408"><a href="#cb10-408" aria-hidden="true" tabindex="-1"></a><span class="in">     |--------------------------------|</span></span>
<span id="cb10-409"><a href="#cb10-409" aria-hidden="true" tabindex="-1"></a><span class="in">330. | .0644342   .0400909   .1035588 |</span></span>
<span id="cb10-410"><a href="#cb10-410" aria-hidden="true" tabindex="-1"></a><span class="in">...</span></span>
<span id="cb10-411"><a href="#cb10-411" aria-hidden="true" tabindex="-1"></a><span class="in">547. | .0644342   .0400909   .1035588 |</span></span>
<span id="cb10-412"><a href="#cb10-412" aria-hidden="true" tabindex="-1"></a><span class="in">     +--------------------------------+</span></span>
<span id="cb10-413"><a href="#cb10-413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-414"><a href="#cb10-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-415"><a href="#cb10-415" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction (forecasting) of individual observations</span></span>
<span id="cb10-416"><a href="#cb10-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-417"><a href="#cb10-417" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Methods are for continuous outcomes</span>
<span id="cb10-418"><a href="#cb10-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-419"><a href="#cb10-419" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Will deal with discrimination of binary outcomes in next section</span>
<span id="cb10-420"><a href="#cb10-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-421"><a href="#cb10-421" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Given age, height, and sex, predict a new subject's FEV</span>
<span id="cb10-422"><a href="#cb10-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-423"><a href="#cb10-423" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Use linear regression to obtain estimates and CI</span>
<span id="cb10-424"><a href="#cb10-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-425"><a href="#cb10-425" aria-hidden="true" tabindex="-1"></a><span class="fu">### Assumptions</span></span>
<span id="cb10-426"><a href="#cb10-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-427"><a href="#cb10-427" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Necessary assumptions to predict individual observations</span>
<span id="cb10-428"><a href="#cb10-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-429"><a href="#cb10-429" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Independence (between clusters for robust SE)</span>
<span id="cb10-430"><a href="#cb10-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-431"><a href="#cb10-431" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Variance approximated by the model (NOT relaxed for robust SE)</span>
<span id="cb10-432"><a href="#cb10-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-433"><a href="#cb10-433" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Regression model accurately describes the relationship of summary measures across groups</span>
<span id="cb10-434"><a href="#cb10-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-435"><a href="#cb10-435" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Shape of the distribution the same in each group</span>
<span id="cb10-436"><a href="#cb10-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-437"><a href="#cb10-437" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Transformation of the outcome may be very useful</span>
<span id="cb10-438"><a href="#cb10-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-439"><a href="#cb10-439" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Sufficient sample sizes for asymptotic distributions of parameters to be a good approximation</span>
<span id="cb10-440"><a href="#cb10-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-441"><a href="#cb10-441" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Assumptions are very strong</span>
<span id="cb10-442"><a href="#cb10-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-443"><a href="#cb10-443" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Consequently, we do not have many methods that provide robust inference</span>
<span id="cb10-444"><a href="#cb10-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-445"><a href="#cb10-445" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>In general, I prefer methods that make as few assumptions as possible</span>
<span id="cb10-446"><a href="#cb10-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-447"><a href="#cb10-447" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Robust standard errors will not help in this situation</span>
<span id="cb10-448"><a href="#cb10-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-449"><a href="#cb10-449" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Proper transformation of outcomes and predictors may be necessary so that underlying assumptions of classical linear regression model hold</span>
<span id="cb10-450"><a href="#cb10-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-451"><a href="#cb10-451" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Models, estimates, will need to be appropriately penalized for valid inference</span>
<span id="cb10-452"><a href="#cb10-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-453"><a href="#cb10-453" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Topic of more advanced regression courses (Regression Modeling Strategies)</span>
<span id="cb10-454"><a href="#cb10-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-455"><a href="#cb10-455" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Precise methods have been developed for</span>
<span id="cb10-456"><a href="#cb10-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-457"><a href="#cb10-457" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Binary variables (the mean specifies the variances)</span>
<span id="cb10-458"><a href="#cb10-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-459"><a href="#cb10-459" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Continuous data that follow a Normal distribution</span>
<span id="cb10-460"><a href="#cb10-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-461"><a href="#cb10-461" aria-hidden="true" tabindex="-1"></a><span class="fu">### Point and interval estimates for Normal data</span></span>
<span id="cb10-462"><a href="#cb10-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-463"><a href="#cb10-463" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Point estimates obtained by substitution into the estimated regression equation</span>
<span id="cb10-464"><a href="#cb10-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-465"><a href="#cb10-465" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$E<span class="co">[</span><span class="ot">\textrm{Chol} | \textrm{Age}</span><span class="co">]</span> = 200 + 0.33 \times \textrm{Age}$</span>
<span id="cb10-466"><a href="#cb10-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-467"><a href="#cb10-467" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Expected cholesterol for 50 year old is $200 + 0.33 \times 50 = 216.5$</span>
<span id="cb10-468"><a href="#cb10-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-469"><a href="#cb10-469" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When we substitute in age values, it provides an estimate of the forecast cholesterol</span>
<span id="cb10-470"><a href="#cb10-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-471"><a href="#cb10-471" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interval estimates</span>
<span id="cb10-472"><a href="#cb10-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-473"><a href="#cb10-473" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Under appropriate assumptions, we can obtain standard errors for such predictions</span>
<span id="cb10-474"><a href="#cb10-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-475"><a href="#cb10-475" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Standard errors must account for two sources of variability</span>
<span id="cb10-476"><a href="#cb10-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-477"><a href="#cb10-477" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Variability in estimating the regression parameters (same as in predictions of summary measures)</span>
<span id="cb10-478"><a href="#cb10-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-479"><a href="#cb10-479" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Variability due to subject</span>
<span id="cb10-480"><a href="#cb10-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-481"><a href="#cb10-481" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Additional variability about the sample mean; "within group standard deviation"</span>
<span id="cb10-482"><a href="#cb10-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-483"><a href="#cb10-483" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Estimating this sources of variability is where the additional Normality assumption is key</span>
<span id="cb10-484"><a href="#cb10-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-485"><a href="#cb10-485" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Formulas for the prediction interval</span>
<span id="cb10-486"><a href="#cb10-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-487"><a href="#cb10-487" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>In general: $\textrm{(prediction)} \pm \textrm{(crit value)} \times \textrm{(std error)}$</span>
<span id="cb10-488"><a href="#cb10-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-489"><a href="#cb10-489" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>In linear regression, the $t$ distribution is usually used to obtain the prediction interval</span>
<span id="cb10-490"><a href="#cb10-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-491"><a href="#cb10-491" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Stata: $\textrm{(crit value)} = \texttt{invttail}(df, \alpha/2)$</span>
<span id="cb10-492"><a href="#cb10-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-493"><a href="#cb10-493" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>R: $\textrm{(crit value)} = \texttt{qt}(1-\alpha/2, df)$</span>
<span id="cb10-494"><a href="#cb10-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-495"><a href="#cb10-495" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>Degrees of freedom $df = n - \textrm{number of predictors in model}$</span>
<span id="cb10-496"><a href="#cb10-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-497"><a href="#cb10-497" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interval estimates in Stata</span>
<span id="cb10-498"><a href="#cb10-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-499"><a href="#cb10-499" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>After any regression command, the Stata command <span class="in">`predict`</span> will give compute estimates and standard errors</span>
<span id="cb10-500"><a href="#cb10-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-501"><a href="#cb10-501" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`predict varname, [what]`</span></span>
<span id="cb10-502"><a href="#cb10-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-503"><a href="#cb10-503" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`varname`</span> is that name of the new variable to be created</span>
<span id="cb10-504"><a href="#cb10-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-505"><a href="#cb10-505" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`what`</span> is one of</span>
<span id="cb10-506"><a href="#cb10-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-507"><a href="#cb10-507" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>xb: The linear predictor (works for all regression)</span>
<span id="cb10-508"><a href="#cb10-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-509"><a href="#cb10-509" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>stdf: Standard error of the forecast prediction</span>
<span id="cb10-510"><a href="#cb10-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-511"><a href="#cb10-511" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Interval estimates in R</span>
<span id="cb10-512"><a href="#cb10-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-513"><a href="#cb10-513" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>After storing a model, the R function <span class="in">`predict`</span> will give compute estimates and standard errors</span>
<span id="cb10-514"><a href="#cb10-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-515"><a href="#cb10-515" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`predict(object, se.fit=FALSE, ...)`</span></span>
<span id="cb10-516"><a href="#cb10-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-517"><a href="#cb10-517" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`object`</span> is the stored fitted model</span>
<span id="cb10-518"><a href="#cb10-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-519"><a href="#cb10-519" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span><span class="in">`se.fit`</span> will provide the standard error of the fit (defaults to <span class="in">`FALSE`</span>)</span>
<span id="cb10-520"><a href="#cb10-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-521"><a href="#cb10-521" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>For the standard error of the forecast, need to include the root mean squared error</span>
<span id="cb10-522"><a href="#cb10-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-523"><a href="#cb10-523" aria-hidden="true" tabindex="-1"></a><span class="ss">            -   </span>$\textrm{se}_\textrm{pred}^2 = \textrm{se}_\textrm{fit}^2 + \textrm{RMSE}^2$</span>
<span id="cb10-524"><a href="#cb10-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-525"><a href="#cb10-525" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>General comment about software</span>
<span id="cb10-526"><a href="#cb10-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-527"><a href="#cb10-527" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Commercial software only implements prediction intervals by assuming Normal data</span>
<span id="cb10-528"><a href="#cb10-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-529"><a href="#cb10-529" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>If using R libraries (or Stata ado files) for prediction, carefully investigate and understand how they are making predictions</span>
<span id="cb10-530"><a href="#cb10-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-531"><a href="#cb10-531" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Don't trust the "black box" to be giving you results that are widely applicable to all situations</span>
<span id="cb10-532"><a href="#cb10-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-533"><a href="#cb10-533" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Be careful that you understand exactly what is going on if you are interested in making predictions</span>
<span id="cb10-534"><a href="#cb10-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-535"><a href="#cb10-535" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example: FEV by age and height</span></span>
<span id="cb10-536"><a href="#cb10-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-537"><a href="#cb10-537" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb10-538"><a href="#cb10-538" aria-hidden="true" tabindex="-1"></a><span class="in">. regress logfev height age</span></span>
<span id="cb10-539"><a href="#cb10-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-540"><a href="#cb10-540" aria-hidden="true" tabindex="-1"></a><span class="in">      Source |       SS       df       MS              Number of obs =     654</span></span>
<span id="cb10-541"><a href="#cb10-541" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+------------------------------           F(  2,   651) = 1361.98</span></span>
<span id="cb10-542"><a href="#cb10-542" aria-hidden="true" tabindex="-1"></a><span class="in">       Model |  58.5363336     2  29.2681668           Prob &gt; F      =  0.0000</span></span>
<span id="cb10-543"><a href="#cb10-543" aria-hidden="true" tabindex="-1"></a><span class="in">    Residual |  13.9895809   651  .021489372           R-squared     =  0.8071</span></span>
<span id="cb10-544"><a href="#cb10-544" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+------------------------------           Adj R-squared =  0.8065</span></span>
<span id="cb10-545"><a href="#cb10-545" aria-hidden="true" tabindex="-1"></a><span class="in">       Total |  72.5259145   653  .111065719           Root MSE      =  .14659</span></span>
<span id="cb10-546"><a href="#cb10-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-547"><a href="#cb10-547" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-548"><a href="#cb10-548" aria-hidden="true" tabindex="-1"></a><span class="in">      logfev |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]</span></span>
<span id="cb10-549"><a href="#cb10-549" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb10-550"><a href="#cb10-550" aria-hidden="true" tabindex="-1"></a><span class="in">      height |   .0439913   .0016473    26.71   0.000     .0407567    .0472259</span></span>
<span id="cb10-551"><a href="#cb10-551" aria-hidden="true" tabindex="-1"></a><span class="in">         age |   .0198162   .0031805     6.23   0.000     .0135709    .0260616</span></span>
<span id="cb10-552"><a href="#cb10-552" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |  -1.971147   .0783322   -25.16   0.000    -2.124961   -1.817332</span></span>
<span id="cb10-553"><a href="#cb10-553" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-554"><a href="#cb10-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-555"><a href="#cb10-555" aria-hidden="true" tabindex="-1"></a><span class="in">. predict fitlogfev</span></span>
<span id="cb10-556"><a href="#cb10-556" aria-hidden="true" tabindex="-1"></a><span class="in">(option xb assumed; fitted values)</span></span>
<span id="cb10-557"><a href="#cb10-557" aria-hidden="true" tabindex="-1"></a><span class="in">. predict sepredict, stdf</span></span>
<span id="cb10-558"><a href="#cb10-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-559"><a href="#cb10-559" aria-hidden="true" tabindex="-1"></a><span class="in">. gen predfev= exp(fitlogfev)</span></span>
<span id="cb10-560"><a href="#cb10-560" aria-hidden="true" tabindex="-1"></a><span class="in">. gen predlofev = exp(fitlogfev - invttail(651, .025) * sepredict)</span></span>
<span id="cb10-561"><a href="#cb10-561" aria-hidden="true" tabindex="-1"></a><span class="in">. gen predhifev = exp(fitlogfev + invttail(651, .025) * sepredict)</span></span>
<span id="cb10-562"><a href="#cb10-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-563"><a href="#cb10-563" aria-hidden="true" tabindex="-1"></a><span class="in">. list predfev predlofev predhifev if age==10 &amp; height==66</span></span>
<span id="cb10-564"><a href="#cb10-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-565"><a href="#cb10-565" aria-hidden="true" tabindex="-1"></a><span class="in">     +--------------------------------+</span></span>
<span id="cb10-566"><a href="#cb10-566" aria-hidden="true" tabindex="-1"></a><span class="in">     |  predfev   predlo~v   predhi~v |</span></span>
<span id="cb10-567"><a href="#cb10-567" aria-hidden="true" tabindex="-1"></a><span class="in">     |--------------------------------|</span></span>
<span id="cb10-568"><a href="#cb10-568" aria-hidden="true" tabindex="-1"></a><span class="in">330. | 3.097021   2.320911   4.132662 |</span></span>
<span id="cb10-569"><a href="#cb10-569" aria-hidden="true" tabindex="-1"></a><span class="in">...</span></span>
<span id="cb10-570"><a href="#cb10-570" aria-hidden="true" tabindex="-1"></a><span class="in">547. | 3.097021   2.320911   4.132662 |</span></span>
<span id="cb10-571"><a href="#cb10-571" aria-hidden="true" tabindex="-1"></a><span class="in">     +--------------------------------+</span></span>
<span id="cb10-572"><a href="#cb10-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-573"><a href="#cb10-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-574"><a href="#cb10-574" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The preceding output gave prediction for individual observations</span>
<span id="cb10-575"><a href="#cb10-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-576"><a href="#cb10-576" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We can compare these results to the prediction for summary measures done previously (see below)</span>
<span id="cb10-577"><a href="#cb10-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-578"><a href="#cb10-578" aria-hidden="true" tabindex="-1"></a>    <span class="in">```</span></span>
<span id="cb10-579"><a href="#cb10-579" aria-hidden="true" tabindex="-1"></a><span class="in">         +-----------------------------------------------------------------+</span></span>
<span id="cb10-580"><a href="#cb10-580" aria-hidden="true" tabindex="-1"></a><span class="in">         |    gmfev    gmlofev    gmhifev    predfev   pre~ofev   predhi~v |</span></span>
<span id="cb10-581"><a href="#cb10-581" aria-hidden="true" tabindex="-1"></a><span class="in">         |-----------------------------------------------------------------|</span></span>
<span id="cb10-582"><a href="#cb10-582" aria-hidden="true" tabindex="-1"></a><span class="in">    330. | 3.097021   3.038578   3.156588   3.097021   2.320911   4.132662 |</span></span>
<span id="cb10-583"><a href="#cb10-583" aria-hidden="true" tabindex="-1"></a><span class="in">         +-----------------------------------------------------------------+</span></span>
<span id="cb10-584"><a href="#cb10-584" aria-hidden="true" tabindex="-1"></a><span class="in">    ```</span></span>
<span id="cb10-585"><a href="#cb10-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-586"><a href="#cb10-586" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Point estimates identical</span>
<span id="cb10-587"><a href="#cb10-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-588"><a href="#cb10-588" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Confidence interval for individual predictions is wider</span>
<span id="cb10-589"><a href="#cb10-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-590"><a href="#cb10-590" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>As $n$ increases, the width of the prediction interval (on the log scale) approaches $\pm 1.96 \times \textrm{RMSE}$</span>
<span id="cb10-591"><a href="#cb10-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-592"><a href="#cb10-592" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>As $n$ increases, the width of the interval around the summary measure approaches $0$</span>
<span id="cb10-593"><a href="#cb10-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-594"><a href="#cb10-594" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb10-595"><a href="#cb10-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-596"><a href="#cb10-596" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>We can also calculate the standard error of the prediction</span>
<span id="cb10-597"><a href="#cb10-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-598"><a href="#cb10-598" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Example: Age is 10 and Height is 66</span>
<span id="cb10-599"><a href="#cb10-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-600"><a href="#cb10-600" aria-hidden="true" tabindex="-1"></a>    <span class="in">```stata</span></span>
<span id="cb10-601"><a href="#cb10-601" aria-hidden="true" tabindex="-1"></a><span class="in">    . gen sepredict2 = sepredict^2</span></span>
<span id="cb10-602"><a href="#cb10-602" aria-hidden="true" tabindex="-1"></a><span class="in">    . gen sefit2 = sefit^2</span></span>
<span id="cb10-603"><a href="#cb10-603" aria-hidden="true" tabindex="-1"></a><span class="in">    . list sepredict sefit sepredict2 sefit2 if age==10 &amp; heigh==66</span></span>
<span id="cb10-604"><a href="#cb10-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-605"><a href="#cb10-605" aria-hidden="true" tabindex="-1"></a><span class="in">         +------------------------------------------+</span></span>
<span id="cb10-606"><a href="#cb10-606" aria-hidden="true" tabindex="-1"></a><span class="in">         | sepred~t     sefit   sepred~2     sefit2 |</span></span>
<span id="cb10-607"><a href="#cb10-607" aria-hidden="true" tabindex="-1"></a><span class="in">         |------------------------------------------|</span></span>
<span id="cb10-608"><a href="#cb10-608" aria-hidden="true" tabindex="-1"></a><span class="in">    330. | .1469132   .009702   .0215835   .0000941 |</span></span>
<span id="cb10-609"><a href="#cb10-609" aria-hidden="true" tabindex="-1"></a><span class="in">         +------------------------------------------+</span></span>
<span id="cb10-610"><a href="#cb10-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-611"><a href="#cb10-611" aria-hidden="true" tabindex="-1"></a><span class="in">    . di .14659^2 +.0000941</span></span>
<span id="cb10-612"><a href="#cb10-612" aria-hidden="true" tabindex="-1"></a><span class="in">    .02158273</span></span>
<span id="cb10-613"><a href="#cb10-613" aria-hidden="true" tabindex="-1"></a><span class="in">    ```</span></span>
<span id="cb10-614"><a href="#cb10-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-615"><a href="#cb10-615" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\textrm{se}_\textrm{pred}^2 = \textrm{se}_\textrm{fit}^2 + \textrm{RMSE}^2$</span>
<span id="cb10-616"><a href="#cb10-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-617"><a href="#cb10-617" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$\textrm{se}_\textrm{pred} = 0.1469132$</span>
<span id="cb10-618"><a href="#cb10-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-619"><a href="#cb10-619" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$\textrm{se}_\textrm{fit} = 0.0215835$</span>
<span id="cb10-620"><a href="#cb10-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-621"><a href="#cb10-621" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>$\textrm{RMSE} = 0.14659$</span>
<span id="cb10-622"><a href="#cb10-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-623"><a href="#cb10-623" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Note that discrepancy in hand calculation versus Stata output (0.215835 vs 0.2158273) is due to rounding error</span>
<span id="cb10-624"><a href="#cb10-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-625"><a href="#cb10-625" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>This is an academic exercise in Stata, but necessary in R (unless you can find a function to do it for you)</span>
<span id="cb10-626"><a href="#cb10-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-627"><a href="#cb10-627" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mathematics of Prediction Intervals</span></span>
<span id="cb10-628"><a href="#cb10-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-629"><a href="#cb10-629" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Basic ideas behind prediction intervals</span>
<span id="cb10-630"><a href="#cb10-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-631"><a href="#cb10-631" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Model: $Y_i | X_i \sim N(\beta_0 + \beta_1 X_i, \sigma^2)$</span>
<span id="cb10-632"><a href="#cb10-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-633"><a href="#cb10-633" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Alternative specification: $Y_i | X_i = \beta_0 + \beta_1 X_i + \epsilon_i$</span>
<span id="cb10-634"><a href="#cb10-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-635"><a href="#cb10-635" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$\epsilon_i \sim N(0, \sigma^2)$</span>
<span id="cb10-636"><a href="#cb10-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-637"><a href="#cb10-637" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Estimated mean: $\hat{\beta}_0 + \hat{\beta}_1 X_i \sim N\left(\beta_0 + \beta_1 X_i, \sigma^2 V\right)$</span>
<span id="cb10-638"><a href="#cb10-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-639"><a href="#cb10-639" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Predicted mean: $\hat{\beta}_0 + \hat{\beta}_1 X_i + \epsilon_i \sim N\left(\beta_0 + \beta_1 X_i, \sigma^2 (1 + V)\right)$</span>
<span id="cb10-640"><a href="#cb10-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-641"><a href="#cb10-641" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$V = \frac{1}{n} + \frac{(X_h - \overline{X})^2}{\sum_{i=1}^n (X_i - \overline{X})^2}$</span>
<span id="cb10-642"><a href="#cb10-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-643"><a href="#cb10-643" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>$X_h$ is the chosen value of the covariate (e.g. age==10)</span>
<span id="cb10-644"><a href="#cb10-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-645"><a href="#cb10-645" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Note: As $n \rightarrow \infty, V \rightarrow 0$</span>
<span id="cb10-646"><a href="#cb10-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-647"><a href="#cb10-647" aria-hidden="true" tabindex="-1"></a><span class="fu">## Prediction of Binary Measurements</span></span>
<span id="cb10-648"><a href="#cb10-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-649"><a href="#cb10-649" aria-hidden="true" tabindex="-1"></a><span class="fu">### Classification (discrimination)</span></span>
<span id="cb10-650"><a href="#cb10-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-651"><a href="#cb10-651" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Sometimes the scientific question is one of deriving a rule to classify subjects</span>
<span id="cb10-652"><a href="#cb10-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-653"><a href="#cb10-653" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Diagnosis of prostate cancer: Based on age, race, and PSA, should we make a diagnosis of prostate cancer?</span>
<span id="cb10-654"><a href="#cb10-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-655"><a href="#cb10-655" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Prognosis of patients with primary biliary cirrhosis: Based on age, bilirubin, albumin, edema, protime, is the patient likely to die within the next year?</span>
<span id="cb10-656"><a href="#cb10-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-657"><a href="#cb10-657" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Classification can be regarded as trying to predict the value of a binary variable</span>
<span id="cb10-658"><a href="#cb10-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-659"><a href="#cb10-659" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Earlier, we were estimating the probability and odds of relapse within a particular group (a summary measure)</span>
<span id="cb10-660"><a href="#cb10-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-661"><a href="#cb10-661" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Now we want to decide whether a particular individual will relapse or not (an individual measure)</span>
<span id="cb10-662"><a href="#cb10-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-663"><a href="#cb10-663" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>There is an obvious connection between the above two ideas</span>
<span id="cb10-664"><a href="#cb10-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-665"><a href="#cb10-665" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>The probability or odds tells us everything about the distribution of values</span>
<span id="cb10-666"><a href="#cb10-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-667"><a href="#cb10-667" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>The only possible values are 0 or 1</span>
<span id="cb10-668"><a href="#cb10-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-669"><a href="#cb10-669" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Typical approach</span>
<span id="cb10-670"><a href="#cb10-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-671"><a href="#cb10-671" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>First, use regression model to estimate the probability of event in each group</span>
<span id="cb10-672"><a href="#cb10-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-673"><a href="#cb10-673" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Second, form a decision rule based on estimated probability of event</span>
<span id="cb10-674"><a href="#cb10-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-675"><a href="#cb10-675" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>If estimate $\geq c$ (or $\leq c$), predict outcome is 1</span>
<span id="cb10-676"><a href="#cb10-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-677"><a href="#cb10-677" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>If estimate $&lt; c$ (or $&gt; c$), predict outcome is 0</span>
<span id="cb10-678"><a href="#cb10-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-679"><a href="#cb10-679" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Quantify the accuracy of the decision rule</span>
<span id="cb10-680"><a href="#cb10-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-681"><a href="#cb10-681" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>For disease $D$ and test $T$</span>
<span id="cb10-682"><a href="#cb10-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-683"><a href="#cb10-683" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Sensitivity: $\textrm{Pr}(T^+ | D^+)$</span>
<span id="cb10-684"><a href="#cb10-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-685"><a href="#cb10-685" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Specificity: $\textrm{Pr}(T^- | D^-)$</span>
<span id="cb10-686"><a href="#cb10-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-687"><a href="#cb10-687" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Predicted Value Positive: $\textrm{Pr}(D^+ | T^+)$</span>
<span id="cb10-688"><a href="#cb10-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-689"><a href="#cb10-689" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Predicted Value Negative: $\textrm{Pr}(D^- | T^-)$</span>
<span id="cb10-690"><a href="#cb10-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-691"><a href="#cb10-691" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stepwise model building</span></span>
<span id="cb10-692"><a href="#cb10-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-693"><a href="#cb10-693" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Old method for considering a large number of covariates that might possibly be predictive of an outcome</span>
<span id="cb10-694"><a href="#cb10-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-695"><a href="#cb10-695" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>"If stepwise model building had been proposed today, it would not have passed peer review"</span>
<span id="cb10-696"><a href="#cb10-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-697"><a href="#cb10-697" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Available in all software as an automated tool, but should not be used</span>
<span id="cb10-698"><a href="#cb10-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-699"><a href="#cb10-699" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Avoid recreating the stepwise approach when building your own models manually</span>
<span id="cb10-700"><a href="#cb10-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-701"><a href="#cb10-701" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Major caveats</span>
<span id="cb10-702"><a href="#cb10-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-703"><a href="#cb10-703" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Overfits your dataset</span>
<span id="cb10-704"><a href="#cb10-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-705"><a href="#cb10-705" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>P-values are not true p-values; they are very anti-conservative</span>
<span id="cb10-706"><a href="#cb10-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-707"><a href="#cb10-707" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>You will often obtain different models if you use "forward" or "backward" stepwise regression</span>
<span id="cb10-708"><a href="#cb10-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-709"><a href="#cb10-709" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Ignores confounding effects (a variable could be an important confounder, but itself not be statistically significant in the model)</span>
<span id="cb10-710"><a href="#cb10-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-711"><a href="#cb10-711" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Without clustering certain predictors, may throw out covariates to make non-sensical model</span>
<span id="cb10-712"><a href="#cb10-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-713"><a href="#cb10-713" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Suppose race/ethnicity is coded as White, Black, Hispanic, Other</span>
<span id="cb10-714"><a href="#cb10-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-715"><a href="#cb10-715" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Want to model as 3 dummy variables</span>
<span id="cb10-716"><a href="#cb10-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-717"><a href="#cb10-717" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Stepwise may throw out one of your dummy variables, keep the rest</span>
<span id="cb10-718"><a href="#cb10-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-719"><a href="#cb10-719" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Pairwise significance would also be highly dependent on reference group chosen by analyst</span>
<span id="cb10-720"><a href="#cb10-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-721"><a href="#cb10-721" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Two flavors of stepwide model building</span>
<span id="cb10-722"><a href="#cb10-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-723"><a href="#cb10-723" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Start with no covariates: "Forward" stepwise regression</span>
<span id="cb10-724"><a href="#cb10-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-725"><a href="#cb10-725" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Start with all covariates: "Backward" stepwise regression</span>
<span id="cb10-726"><a href="#cb10-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-727"><a href="#cb10-727" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Stepwise procedure proceeds by adding or removing covariates from the model base on the corresponding partial $t$ or $Z$ test</span>
<span id="cb10-728"><a href="#cb10-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-729"><a href="#cb10-729" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Must pre-specify a "P to enter" and "P to remove"</span>
<span id="cb10-730"><a href="#cb10-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-731"><a href="#cb10-731" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>To avoid infinite loops, P to enter must be less than P to remove</span>
<span id="cb10-732"><a href="#cb10-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-733"><a href="#cb10-733" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>E.g. Add a variable to the model if $p &lt; 0.05$, but only remove a variable from the model if $p &gt; 0.10$</span>
<span id="cb10-734"><a href="#cb10-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-735"><a href="#cb10-735" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Repeat the process until you arrive at a final model</span>
<span id="cb10-736"><a href="#cb10-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-737"><a href="#cb10-737" aria-hidden="true" tabindex="-1"></a><span class="fu">### ROC Curves</span></span>
<span id="cb10-738"><a href="#cb10-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-739"><a href="#cb10-739" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Receiver operating characteristic (ROC) curves plot the sensitivity against the false positive rate (e.g. 1 - specificity)</span>
<span id="cb10-740"><a href="#cb10-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-741"><a href="#cb10-741" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Ideal tests will have both high sensitivity and high specificity (low false positives)</span>
<span id="cb10-742"><a href="#cb10-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-743"><a href="#cb10-743" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Graphically depicted as points in the upper left portion of the plot</span>
<span id="cb10-744"><a href="#cb10-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-745"><a href="#cb10-745" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>1:1 line represents a test that is no better than the flip of a coin</span>
<span id="cb10-746"><a href="#cb10-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-747"><a href="#cb10-747" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Test usually involves the classification of some binary outcome by a continuous predictor (or set of continuous predictors)</span>
<span id="cb10-748"><a href="#cb10-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-749"><a href="#cb10-749" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>When the continuous predictor is above some point $c$, the test is said to be positive</span>
<span id="cb10-750"><a href="#cb10-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-751"><a href="#cb10-751" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>ROC curves plots the sensitivity and false positive rate for all possible values of $c$</span>
<span id="cb10-752"><a href="#cb10-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-753"><a href="#cb10-753" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Major drawbacks to ROC analysis</span>
<span id="cb10-754"><a href="#cb10-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-755"><a href="#cb10-755" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Tempts analyst to find a cutoff point ($c$) when none really exists</span>
<span id="cb10-756"><a href="#cb10-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-757"><a href="#cb10-757" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Better to treat your covariate or linear prediction as a continuous variable</span>
<span id="cb10-758"><a href="#cb10-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-759"><a href="#cb10-759" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 1: Age or height to predict smoking</span></span>
<span id="cb10-760"><a href="#cb10-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-761"><a href="#cb10-761" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Question: Is age or height a better predictor of smoking status?</span>
<span id="cb10-762"><a href="#cb10-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-763"><a href="#cb10-763" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Will compare the ROC curves</span>
<span id="cb10-764"><a href="#cb10-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-765"><a href="#cb10-765" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Often done use the area under the curve (AUC)</span>
<span id="cb10-766"><a href="#cb10-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-767"><a href="#cb10-767" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Model with higher AUC is better</span>
<span id="cb10-768"><a href="#cb10-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-769"><a href="#cb10-769" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A null model (not predictive of outcome) will have area of 0.50</span>
<span id="cb10-770"><a href="#cb10-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-771"><a href="#cb10-771" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Maximum AUC is 1.0</span>
<span id="cb10-772"><a href="#cb10-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-773"><a href="#cb10-773" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Stata</span>
<span id="cb10-774"><a href="#cb10-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-775"><a href="#cb10-775" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Fit the logistic regression model</span>
<span id="cb10-776"><a href="#cb10-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-777"><a href="#cb10-777" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`lroc`</span> creates the ROC curve</span>
<span id="cb10-778"><a href="#cb10-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-779"><a href="#cb10-779" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`predict`</span> to save the fitted curves</span>
<span id="cb10-780"><a href="#cb10-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-781"><a href="#cb10-781" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span><span class="in">`roccomp`</span> to compare the curves</span>
<span id="cb10-782"><a href="#cb10-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-783"><a href="#cb10-783" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb10-784"><a href="#cb10-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-785"><a href="#cb10-785" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb10-786"><a href="#cb10-786" aria-hidden="true" tabindex="-1"></a><span class="in">. logit smoker height</span></span>
<span id="cb10-787"><a href="#cb10-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-788"><a href="#cb10-788" aria-hidden="true" tabindex="-1"></a><span class="in">Logistic regression                               Number of obs   =        654</span></span>
<span id="cb10-789"><a href="#cb10-789" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  LR chi2(1)      =      58.27</span></span>
<span id="cb10-790"><a href="#cb10-790" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  Prob &gt; chi2     =     0.0000</span></span>
<span id="cb10-791"><a href="#cb10-791" aria-hidden="true" tabindex="-1"></a><span class="in">Log likelihood = -182.58748                       Pseudo R2       =     0.1376</span></span>
<span id="cb10-792"><a href="#cb10-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-793"><a href="#cb10-793" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-794"><a href="#cb10-794" aria-hidden="true" tabindex="-1"></a><span class="in">      smoker |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]</span></span>
<span id="cb10-795"><a href="#cb10-795" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb10-796"><a href="#cb10-796" aria-hidden="true" tabindex="-1"></a><span class="in">      height |   .2067181   .0307986     6.71   0.000     .1463539    .2670824</span></span>
<span id="cb10-797"><a href="#cb10-797" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |  -15.32622   2.017127    -7.60   0.000    -19.27972   -11.37273</span></span>
<span id="cb10-798"><a href="#cb10-798" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-799"><a href="#cb10-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-800"><a href="#cb10-800" aria-hidden="true" tabindex="-1"></a><span class="in">. lroc, nograph</span></span>
<span id="cb10-801"><a href="#cb10-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-802"><a href="#cb10-802" aria-hidden="true" tabindex="-1"></a><span class="in">Logistic model for smoker</span></span>
<span id="cb10-803"><a href="#cb10-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-804"><a href="#cb10-804" aria-hidden="true" tabindex="-1"></a><span class="in">number of observations =      654</span></span>
<span id="cb10-805"><a href="#cb10-805" aria-hidden="true" tabindex="-1"></a><span class="in">area under ROC curve   =   0.7882</span></span>
<span id="cb10-806"><a href="#cb10-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-807"><a href="#cb10-807" aria-hidden="true" tabindex="-1"></a><span class="in">. predict xb1, xb</span></span>
<span id="cb10-808"><a href="#cb10-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-809"><a href="#cb10-809" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb10-810"><a href="#cb10-810" aria-hidden="true" tabindex="-1"></a><span class="in">. logit smoker age</span></span>
<span id="cb10-811"><a href="#cb10-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-812"><a href="#cb10-812" aria-hidden="true" tabindex="-1"></a><span class="in">Logistic regression                               Number of obs   =        654</span></span>
<span id="cb10-813"><a href="#cb10-813" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  LR chi2(1)      =     104.88</span></span>
<span id="cb10-814"><a href="#cb10-814" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  Prob &gt; chi2     =     0.0000</span></span>
<span id="cb10-815"><a href="#cb10-815" aria-hidden="true" tabindex="-1"></a><span class="in">Log likelihood = -159.28248                       Pseudo R2       =     0.2477</span></span>
<span id="cb10-816"><a href="#cb10-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-817"><a href="#cb10-817" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-818"><a href="#cb10-818" aria-hidden="true" tabindex="-1"></a><span class="in">      smoker |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]</span></span>
<span id="cb10-819"><a href="#cb10-819" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb10-820"><a href="#cb10-820" aria-hidden="true" tabindex="-1"></a><span class="in">         age |   .4836394   .0551278     8.77   0.000      .375591    .5916878</span></span>
<span id="cb10-821"><a href="#cb10-821" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |  -7.743905   .7089008   -10.92   0.000    -9.133325   -6.354485</span></span>
<span id="cb10-822"><a href="#cb10-822" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-823"><a href="#cb10-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-824"><a href="#cb10-824" aria-hidden="true" tabindex="-1"></a><span class="in">. lroc, nograph</span></span>
<span id="cb10-825"><a href="#cb10-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-826"><a href="#cb10-826" aria-hidden="true" tabindex="-1"></a><span class="in">Logistic model for smoker</span></span>
<span id="cb10-827"><a href="#cb10-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-828"><a href="#cb10-828" aria-hidden="true" tabindex="-1"></a><span class="in">number of observations =      654</span></span>
<span id="cb10-829"><a href="#cb10-829" aria-hidden="true" tabindex="-1"></a><span class="in">area under ROC curve   =   0.8677</span></span>
<span id="cb10-830"><a href="#cb10-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-831"><a href="#cb10-831" aria-hidden="true" tabindex="-1"></a><span class="in">. predict xb2, xb</span></span>
<span id="cb10-832"><a href="#cb10-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-833"><a href="#cb10-833" aria-hidden="true" tabindex="-1"></a><span class="in">. roccomp smoker xb1 xb2, graph summary</span></span>
<span id="cb10-834"><a href="#cb10-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-835"><a href="#cb10-835" aria-hidden="true" tabindex="-1"></a><span class="in">                              ROC                    -Asymptotic Normal--</span></span>
<span id="cb10-836"><a href="#cb10-836" aria-hidden="true" tabindex="-1"></a><span class="in">                   Obs       Area     Std. Err.      [95% Conf. Interval]</span></span>
<span id="cb10-837"><a href="#cb10-837" aria-hidden="true" tabindex="-1"></a><span class="in">-------------------------------------------------------------------------</span></span>
<span id="cb10-838"><a href="#cb10-838" aria-hidden="true" tabindex="-1"></a><span class="in">xb1                654     0.7882       0.0225        0.74414     0.83227</span></span>
<span id="cb10-839"><a href="#cb10-839" aria-hidden="true" tabindex="-1"></a><span class="in">xb2                654     0.8677       0.0185        0.83152     0.90393</span></span>
<span id="cb10-840"><a href="#cb10-840" aria-hidden="true" tabindex="-1"></a><span class="in">-------------------------------------------------------------------------</span></span>
<span id="cb10-841"><a href="#cb10-841" aria-hidden="true" tabindex="-1"></a><span class="in">Ho: area(xb1) = area(xb2)</span></span>
<span id="cb10-842"><a href="#cb10-842" aria-hidden="true" tabindex="-1"></a><span class="in">    chi2(1) =    11.20       Prob&gt;chi2 =   0.0008</span></span>
<span id="cb10-843"><a href="#cb10-843" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-844"><a href="#cb10-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-845"><a href="#cb10-845" aria-hidden="true" tabindex="-1"></a><span class="al">![image](./figures/roc1.png)</span>{height="4in"}</span>
<span id="cb10-846"><a href="#cb10-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-847"><a href="#cb10-847" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Age has a significantly larger AUC than Height ($p &lt; 0.001$)</span>
<span id="cb10-848"><a href="#cb10-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-849"><a href="#cb10-849" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>For any given false positive rate, the sensitivity is higher for age</span>
<span id="cb10-850"><a href="#cb10-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-851"><a href="#cb10-851" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Predicted value positive would also always be higher</span>
<span id="cb10-852"><a href="#cb10-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-853"><a href="#cb10-853" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example 2: Multiple predictors of smoking</span></span>
<span id="cb10-854"><a href="#cb10-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-855"><a href="#cb10-855" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Will consider age, height, sex, and fev as predictors of smoking</span>
<span id="cb10-856"><a href="#cb10-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-857"><a href="#cb10-857" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Fit a multivariable logistic regression model using these covariates in a training sample</span>
<span id="cb10-858"><a href="#cb10-858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-859"><a href="#cb10-859" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Training sample will contain 60% of the observation in the current study</span>
<span id="cb10-860"><a href="#cb10-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-861"><a href="#cb10-861" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Develop a model on the training sample, see how well it fits in the validation sample (the remaining 40% of the data)</span>
<span id="cb10-862"><a href="#cb10-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-863"><a href="#cb10-863" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Consider a rule that predicts a subject will smoke if their predicted probability is greater than 0.5</span>
<span id="cb10-864"><a href="#cb10-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-865"><a href="#cb10-865" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Could choose other cutoffs than 0.5</span>
<span id="cb10-866"><a href="#cb10-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-867"><a href="#cb10-867" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Other cutoffs will be represented on the ROC curves</span>
<span id="cb10-868"><a href="#cb10-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-869"><a href="#cb10-869" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Sensitivity, specificity will vary by the cutoff chosen</span>
<span id="cb10-870"><a href="#cb10-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-871"><a href="#cb10-871" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb10-872"><a href="#cb10-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-873"><a href="#cb10-873" aria-hidden="true" tabindex="-1"></a><span class="in">```stata</span></span>
<span id="cb10-874"><a href="#cb10-874" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb10-875"><a href="#cb10-875" aria-hidden="true" tabindex="-1"></a><span class="in">. xi: logit smoker age height i.sex fev if training &lt; .6</span></span>
<span id="cb10-876"><a href="#cb10-876" aria-hidden="true" tabindex="-1"></a><span class="in">i.sex             _Isex_1-2           (_Isex_1 for sex==female omitted)</span></span>
<span id="cb10-877"><a href="#cb10-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-878"><a href="#cb10-878" aria-hidden="true" tabindex="-1"></a><span class="in">Logistic regression                               Number of obs   =        385</span></span>
<span id="cb10-879"><a href="#cb10-879" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  LR chi2(4)      =      80.02</span></span>
<span id="cb10-880"><a href="#cb10-880" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  Prob &gt; chi2     =     0.0000</span></span>
<span id="cb10-881"><a href="#cb10-881" aria-hidden="true" tabindex="-1"></a><span class="in">Log likelihood = -70.223945                       Pseudo R2       =     0.3629</span></span>
<span id="cb10-882"><a href="#cb10-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-883"><a href="#cb10-883" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-884"><a href="#cb10-884" aria-hidden="true" tabindex="-1"></a><span class="in">      smoker |      Coef.   Std. Err.      z    P&gt;|z|     [95% Conf. Interval]</span></span>
<span id="cb10-885"><a href="#cb10-885" aria-hidden="true" tabindex="-1"></a><span class="in">-------------+----------------------------------------------------------------</span></span>
<span id="cb10-886"><a href="#cb10-886" aria-hidden="true" tabindex="-1"></a><span class="in">         age |   .6611145   .1276124     5.18   0.000     .4109988    .9112302</span></span>
<span id="cb10-887"><a href="#cb10-887" aria-hidden="true" tabindex="-1"></a><span class="in">      height |   .1834778   .0960597     1.91   0.056    -.0047957    .3717514</span></span>
<span id="cb10-888"><a href="#cb10-888" aria-hidden="true" tabindex="-1"></a><span class="in">     _Isex_2 |  -.7128769   .5392144    -1.32   0.186    -1.769718    .3439639</span></span>
<span id="cb10-889"><a href="#cb10-889" aria-hidden="true" tabindex="-1"></a><span class="in">         fev |  -1.123659   .4514655    -2.49   0.013    -2.008515   -.2388024</span></span>
<span id="cb10-890"><a href="#cb10-890" aria-hidden="true" tabindex="-1"></a><span class="in">       _cons |  -18.18847   5.100367    -3.57   0.000    -28.18501   -8.191936</span></span>
<span id="cb10-891"><a href="#cb10-891" aria-hidden="true" tabindex="-1"></a><span class="in">------------------------------------------------------------------------------</span></span>
<span id="cb10-892"><a href="#cb10-892" aria-hidden="true" tabindex="-1"></a><span class="in">. predict pfit</span></span>
<span id="cb10-893"><a href="#cb10-893" aria-hidden="true" tabindex="-1"></a><span class="in">(option pr assumed; Pr(smoker))</span></span>
<span id="cb10-894"><a href="#cb10-894" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb10-895"><a href="#cb10-895" aria-hidden="true" tabindex="-1"></a><span class="in">. gen pfit50=pfit</span></span>
<span id="cb10-896"><a href="#cb10-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-897"><a href="#cb10-897" aria-hidden="true" tabindex="-1"></a><span class="in">. recode pfit50 0/0.5=0 0.5/1=1</span></span>
<span id="cb10-898"><a href="#cb10-898" aria-hidden="true" tabindex="-1"></a><span class="in">(pfit50: 654 changes made)</span></span>
<span id="cb10-899"><a href="#cb10-899" aria-hidden="true" tabindex="-1"></a><span class="in">. </span></span>
<span id="cb10-900"><a href="#cb10-900" aria-hidden="true" tabindex="-1"></a><span class="in">. tabulate smoker pfit50 if training &gt; .6, row col </span></span>
<span id="cb10-901"><a href="#cb10-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-902"><a href="#cb10-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-903"><a href="#cb10-903" aria-hidden="true" tabindex="-1"></a><span class="in">           |        pfit50</span></span>
<span id="cb10-904"><a href="#cb10-904" aria-hidden="true" tabindex="-1"></a><span class="in">    smoker |         0          1 |     Total</span></span>
<span id="cb10-905"><a href="#cb10-905" aria-hidden="true" tabindex="-1"></a><span class="in">-----------+----------------------+----------</span></span>
<span id="cb10-906"><a href="#cb10-906" aria-hidden="true" tabindex="-1"></a><span class="in">         0 |       226         10 |       236 </span></span>
<span id="cb10-907"><a href="#cb10-907" aria-hidden="true" tabindex="-1"></a><span class="in">           |     95.76       4.24 |    100.00 </span></span>
<span id="cb10-908"><a href="#cb10-908" aria-hidden="true" tabindex="-1"></a><span class="in">           |     90.04      55.56 |     87.73 </span></span>
<span id="cb10-909"><a href="#cb10-909" aria-hidden="true" tabindex="-1"></a><span class="in">-----------+----------------------+----------</span></span>
<span id="cb10-910"><a href="#cb10-910" aria-hidden="true" tabindex="-1"></a><span class="in">         1 |        25          8 |        33 </span></span>
<span id="cb10-911"><a href="#cb10-911" aria-hidden="true" tabindex="-1"></a><span class="in">           |     75.76      24.24 |    100.00 </span></span>
<span id="cb10-912"><a href="#cb10-912" aria-hidden="true" tabindex="-1"></a><span class="in">           |      9.96      44.44 |     12.27 </span></span>
<span id="cb10-913"><a href="#cb10-913" aria-hidden="true" tabindex="-1"></a><span class="in">-----------+----------------------+----------</span></span>
<span id="cb10-914"><a href="#cb10-914" aria-hidden="true" tabindex="-1"></a><span class="in">     Total |       251         18 |       269 </span></span>
<span id="cb10-915"><a href="#cb10-915" aria-hidden="true" tabindex="-1"></a><span class="in">           |     93.31       6.69 |    100.00 </span></span>
<span id="cb10-916"><a href="#cb10-916" aria-hidden="true" tabindex="-1"></a><span class="in">           |    100.00     100.00 |    100.00 </span></span>
<span id="cb10-917"><a href="#cb10-917" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-918"><a href="#cb10-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-919"><a href="#cb10-919" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Using a cutoff of 0.50</span>
<span id="cb10-920"><a href="#cb10-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-921"><a href="#cb10-921" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Sensitivity: $8/33 = 24.24$</span>
<span id="cb10-922"><a href="#cb10-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-923"><a href="#cb10-923" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Specificity: $226/236 = 95.76$</span>
<span id="cb10-924"><a href="#cb10-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-925"><a href="#cb10-925" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>PVP: $8/18 = 44.44$</span>
<span id="cb10-926"><a href="#cb10-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-927"><a href="#cb10-927" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>PVN: $226/251 = 90.04$</span>
<span id="cb10-928"><a href="#cb10-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-929"><a href="#cb10-929" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Thresholds other than 0.50 give different values for sensitivity, specificity, PVP, PVN</span>
<span id="cb10-930"><a href="#cb10-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-931"><a href="#cb10-931" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>ROC curve displayed gives all possible thresholds</span>
<span id="cb10-932"><a href="#cb10-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-933"><a href="#cb10-933" aria-hidden="true" tabindex="-1"></a><span class="al">![image](./figures/roc2.png)</span>{height="4in"}</span>
<span id="cb10-934"><a href="#cb10-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-935"><a href="#cb10-935" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis of ROC curves in R</span></span>
<span id="cb10-936"><a href="#cb10-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-937"><a href="#cb10-937" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>There are a number of add on packages that will conduct ROC analysis in R</span>
<span id="cb10-938"><a href="#cb10-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-939"><a href="#cb10-939" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span><span class="in">`ROCR`</span> is one popular package</span>
<span id="cb10-940"><a href="#cb10-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-941"><a href="#cb10-941" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multivariable prognostic models</span></span>
<span id="cb10-942"><a href="#cb10-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-943"><a href="#cb10-943" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Reference</span>
<span id="cb10-944"><a href="#cb10-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-945"><a href="#cb10-945" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Harrell FE Jr, Lee KL, Mark DB. Multivariable prognostic models: issues in developing models, evaluating assumptions and adequacy, and measuring and reducing errors. Statistics in Medicine. 15(4): 361-87, Feb 1996</span>
<span id="cb10-946"><a href="#cb10-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-947"><a href="#cb10-947" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>A "Tutorial is Biostatistics" (frequently appears in Statistics in Medicine)</span>
<span id="cb10-948"><a href="#cb10-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-949"><a href="#cb10-949" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>From abstract of paper</span>
<span id="cb10-950"><a href="#cb10-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-951"><a href="#cb10-951" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>"Multivariable regression models are powerful tools that are frequently used in clinical outcomes... however uncritical application of modeling techniques can result in models that poorly fit the dataset at hand, or, even more likely, inaccurately predict outcomes on new subjects."</span>
<span id="cb10-952"><a href="#cb10-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-953"><a href="#cb10-953" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>"... predictive accuracy should be unbiasedly validated using bootstrapping or cross-validation before using predictions in new data series."</span>
<span id="cb10-954"><a href="#cb10-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-955"><a href="#cb10-955" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Common problem: Number of predictors being considered ($p$) is larger than the number of events ($m$)</span>
<span id="cb10-956"><a href="#cb10-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-957"><a href="#cb10-957" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Recommendation: Consider no more than $m/10$ potential predictors in a model</span>
<span id="cb10-958"><a href="#cb10-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-959"><a href="#cb10-959" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>e.g. if event rate is $10\%$ and $n=200$ then $m=20$; only $2$ potential predictors</span>
<span id="cb10-960"><a href="#cb10-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-961"><a href="#cb10-961" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Step 1: Consider your dataset</span>
<span id="cb10-962"><a href="#cb10-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-963"><a href="#cb10-963" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Missing data (imputation?)</span>
<span id="cb10-964"><a href="#cb10-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-965"><a href="#cb10-965" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Interactions (scientific relevance?)</span>
<span id="cb10-966"><a href="#cb10-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-967"><a href="#cb10-967" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Transformation of predictors (scientific relevance?)</span>
<span id="cb10-968"><a href="#cb10-968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-969"><a href="#cb10-969" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Step 2: Data Reduction</span>
<span id="cb10-970"><a href="#cb10-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-971"><a href="#cb10-971" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Reduce the number of predictors to a manageable amount</span>
<span id="cb10-972"><a href="#cb10-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-973"><a href="#cb10-973" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Utilize methods that do not consider the outcome ("unsupervised" learning)</span>
<span id="cb10-974"><a href="#cb10-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-975"><a href="#cb10-975" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>If you do not use the outcome at this stage, your statistical inference is preserved</span>
<span id="cb10-976"><a href="#cb10-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-977"><a href="#cb10-977" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Correlations among predictors: Variable clustering, principle components analysis</span>
<span id="cb10-978"><a href="#cb10-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-979"><a href="#cb10-979" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Scientifically meaningful summary measures</span>
<span id="cb10-980"><a href="#cb10-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-981"><a href="#cb10-981" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Step 3: Fit the model and ...</span>
<span id="cb10-982"><a href="#cb10-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-983"><a href="#cb10-983" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Evaluate modeling assumptions: Linearity, additivity, distributional assumptions</span>
<span id="cb10-984"><a href="#cb10-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-985"><a href="#cb10-985" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Use backwards stepwise selection to find a simpler model</span>
<span id="cb10-986"><a href="#cb10-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-987"><a href="#cb10-987" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Harrell: Remove predictor if $\chi^2 &gt; 2$ ($p &gt; 0.16$)</span>
<span id="cb10-988"><a href="#cb10-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-989"><a href="#cb10-989" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Will use *all data* to fit model</span>
<span id="cb10-990"><a href="#cb10-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-991"><a href="#cb10-991" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Step 4: Evaluate model</span>
<span id="cb10-992"><a href="#cb10-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-993"><a href="#cb10-993" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Bootstrap cross-validation</span>
<span id="cb10-994"><a href="#cb10-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-995"><a href="#cb10-995" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Sample data with replacement</span>
<span id="cb10-996"><a href="#cb10-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-997"><a href="#cb10-997" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>For each bootstrap sample, the evaluation of modeling assumptions and backwards selection will be performed (these steps use the outcome)</span>
<span id="cb10-998"><a href="#cb10-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-999"><a href="#cb10-999" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Summarize predictive accuracy using a statistic (C-index, Brier score)</span>
<span id="cb10-1000"><a href="#cb10-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1001"><a href="#cb10-1001" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Bootstrap cross-validation provides a nearly unbiased estimate of predictive accuracy (e.g. C-index, Brier score) while allowing the entire model to be used for model development</span>
<span id="cb10-1002"><a href="#cb10-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1003"><a href="#cb10-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>C-index: Area under the ROC curve. Index near 1 indicates higher accuracy.</span>
<span id="cb10-1004"><a href="#cb10-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1005"><a href="#cb10-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Brier score: Average squared deviation between predicted probability of event and observed outcome. A lower score represents higher accuracy.</span>
<span id="cb10-1006"><a href="#cb10-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1007"><a href="#cb10-1007" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Case Study using lrm() in R</span></span>
<span id="cb10-1008"><a href="#cb10-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1009"><a href="#cb10-1009" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Logistic regression model</span>
<span id="cb10-1010"><a href="#cb10-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1011"><a href="#cb10-1011" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Main effects: sex, cholesterol (splines), age (polynomial), and blood pressure (linear)</span>
<span id="cb10-1012"><a href="#cb10-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1013"><a href="#cb10-1013" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Interactions: sex with cholesterol</span>
<span id="cb10-1014"><a href="#cb10-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1015"><a href="#cb10-1015" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>(5 predictors maximum)</span>
<span id="cb10-1016"><a href="#cb10-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1017"><a href="#cb10-1017" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb10-1018"><a href="#cb10-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1019"><a href="#cb10-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb10-1020"><a href="#cb10-1020" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> f <span class="ot">&lt;-</span> <span class="fu">lrm</span>(y <span class="sc">~</span> sex<span class="sc">*</span><span class="fu">rcs</span>(cholesterol)<span class="sc">+</span><span class="fu">pol</span>(age,<span class="dv">2</span>)<span class="sc">+</span>blood.pressure, <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>)</span>
<span id="cb10-1021"><a href="#cb10-1021" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> f</span>
<span id="cb10-1022"><a href="#cb10-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1023"><a href="#cb10-1023" aria-hidden="true" tabindex="-1"></a>Logistic Regression Model</span>
<span id="cb10-1024"><a href="#cb10-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1025"><a href="#cb10-1025" aria-hidden="true" tabindex="-1"></a><span class="fu">lrm</span>(<span class="at">formula =</span> y <span class="sc">~</span> sex <span class="sc">*</span> <span class="fu">rcs</span>(cholesterol) <span class="sc">+</span> <span class="fu">pol</span>(age, <span class="dv">2</span>) <span class="sc">+</span> blood.pressure, </span>
<span id="cb10-1026"><a href="#cb10-1026" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="cn">TRUE</span>, <span class="at">y =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-1027"><a href="#cb10-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1028"><a href="#cb10-1028" aria-hidden="true" tabindex="-1"></a>                      Model Likelihood     Discrimination    Rank Discrim.    </span>
<span id="cb10-1029"><a href="#cb10-1029" aria-hidden="true" tabindex="-1"></a>                         Ratio Test            Indexes          Indexes       </span>
<span id="cb10-1030"><a href="#cb10-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1031"><a href="#cb10-1031" aria-hidden="true" tabindex="-1"></a>Obs          <span class="dv">1000</span>    LR chi2      <span class="fl">84.78</span>    R2       <span class="fl">0.109</span>    C       <span class="fl">0.660</span>    </span>
<span id="cb10-1032"><a href="#cb10-1032" aria-hidden="true" tabindex="-1"></a> <span class="dv">0</span>            <span class="dv">440</span>    d.f.            <span class="dv">12</span>    g        <span class="fl">0.704</span>    Dxy     <span class="fl">0.321</span>    </span>
<span id="cb10-1033"><a href="#cb10-1033" aria-hidden="true" tabindex="-1"></a> <span class="dv">1</span>            <span class="dv">560</span>    <span class="fu">Pr</span>(<span class="sc">&gt;</span> chi2) <span class="sc">&lt;</span><span class="fl">0.0001</span>    gr       <span class="fl">2.023</span>    gamma   <span class="fl">0.322</span>    </span>
<span id="cb10-1034"><a href="#cb10-1034" aria-hidden="true" tabindex="-1"></a>max <span class="sc">|</span>deriv<span class="sc">|</span> <span class="fl">2e-04</span>                          gp       <span class="fl">0.160</span>    tau<span class="sc">-</span>a   <span class="fl">0.158</span>    </span>
<span id="cb10-1035"><a href="#cb10-1035" aria-hidden="true" tabindex="-1"></a>                                           Brier    <span class="fl">0.226</span>                     </span>
<span id="cb10-1036"><a href="#cb10-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1037"><a href="#cb10-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1038"><a href="#cb10-1038" aria-hidden="true" tabindex="-1"></a>                          Coef    S.E.   Wald Z <span class="fu">Pr</span>(<span class="sc">&gt;</span><span class="er">|</span>Z<span class="sc">|</span>)</span>
<span id="cb10-1039"><a href="#cb10-1039" aria-hidden="true" tabindex="-1"></a>Intercept                 <span class="sc">-</span><span class="fl">2.8990</span> <span class="fl">2.7445</span> <span class="sc">-</span><span class="fl">1.06</span>  <span class="fl">0.2908</span>  </span>
<span id="cb10-1040"><a href="#cb10-1040" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male                  <span class="sc">-</span><span class="fl">5.7526</span> <span class="fl">3.6005</span> <span class="sc">-</span><span class="fl">1.60</span>  <span class="fl">0.1101</span>  </span>
<span id="cb10-1041"><a href="#cb10-1041" aria-hidden="true" tabindex="-1"></a>cholesterol               <span class="sc">-</span><span class="fl">0.0027</span> <span class="fl">0.0148</span> <span class="sc">-</span><span class="fl">0.18</span>  <span class="fl">0.8552</span>  </span>
<span id="cb10-1042"><a href="#cb10-1042" aria-hidden="true" tabindex="-1"></a>cholesterol<span class="st">'              -0.0438 0.0793 -0.55  0.5804  </span></span>
<span id="cb10-1043"><a href="#cb10-1043" aria-hidden="true" tabindex="-1"></a><span class="st">cholesterol''              0.1808 0.4591  0.39  0.6937  </span></span>
<span id="cb10-1044"><a href="#cb10-1044" aria-hidden="true" tabindex="-1"></a><span class="st">cholesterol'''</span>            <span class="sc">-</span><span class="fl">0.1266</span> <span class="fl">0.7850</span> <span class="sc">-</span><span class="fl">0.16</span>  <span class="fl">0.8719</span>  </span>
<span id="cb10-1045"><a href="#cb10-1045" aria-hidden="true" tabindex="-1"></a>age                        <span class="fl">0.1253</span> <span class="fl">0.0475</span>  <span class="fl">2.64</span>  <span class="fl">0.0083</span>  </span>
<span id="cb10-1046"><a href="#cb10-1046" aria-hidden="true" tabindex="-1"></a>age<span class="sc">^</span><span class="dv">2</span>                     <span class="sc">-</span><span class="fl">0.0009</span> <span class="fl">0.0005</span> <span class="sc">-</span><span class="fl">1.88</span>  <span class="fl">0.0605</span>  </span>
<span id="cb10-1047"><a href="#cb10-1047" aria-hidden="true" tabindex="-1"></a>blood.pressure            <span class="sc">-</span><span class="fl">0.0018</span> <span class="fl">0.0045</span> <span class="sc">-</span><span class="fl">0.40</span>  <span class="fl">0.6901</span>  </span>
<span id="cb10-1048"><a href="#cb10-1048" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male <span class="sc">*</span> cholesterol     <span class="fl">0.0313</span> <span class="fl">0.0218</span>  <span class="fl">1.43</span>  <span class="fl">0.1515</span>  </span>
<span id="cb10-1049"><a href="#cb10-1049" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male <span class="sc">*</span> cholesterol<span class="st">'    0.0190 0.1146  0.17  0.8683  </span></span>
<span id="cb10-1050"><a href="#cb10-1050" aria-hidden="true" tabindex="-1"></a><span class="st">sex=male * cholesterol''  -0.1227 0.6718 -0.18  0.8551  </span></span>
<span id="cb10-1051"><a href="#cb10-1051" aria-hidden="true" tabindex="-1"></a><span class="st">sex=male * cholesterol'''</span>  <span class="fl">0.1315</span> <span class="fl">1.1752</span>  <span class="fl">0.11</span>  <span class="fl">0.9109</span>  </span>
<span id="cb10-1052"><a href="#cb10-1052" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb10-1053"><a href="#cb10-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1054"><a href="#cb10-1054" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Validation...</span>
<span id="cb10-1055"><a href="#cb10-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1056"><a href="#cb10-1056" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Backwards stepwise regression</span>
<span id="cb10-1057"><a href="#cb10-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1058"><a href="#cb10-1058" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Different bootstrap sample will remove different covariates</span>
<span id="cb10-1059"><a href="#cb10-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1060"><a href="#cb10-1060" aria-hidden="true" tabindex="-1"></a><span class="ss">        -   </span>Indicates which covariates were included for each sample</span>
<span id="cb10-1061"><a href="#cb10-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1062"><a href="#cb10-1062" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>Estimates of discrimination indexes</span>
<span id="cb10-1063"><a href="#cb10-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1064"><a href="#cb10-1064" aria-hidden="true" tabindex="-1"></a><span class="co">&lt;!-- --&gt;</span></span>
<span id="cb10-1065"><a href="#cb10-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1066"><a href="#cb10-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```r</span></span>
<span id="cb10-1067"><a href="#cb10-1067" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">validate</span>(f, <span class="at">B=</span><span class="dv">150</span>, <span class="at">bw=</span><span class="cn">TRUE</span>, <span class="at">rule=</span><span class="st">"p"</span>, <span class="at">sls=</span>.<span class="dv">1</span>, <span class="at">type=</span><span class="st">"individual"</span>)</span>
<span id="cb10-1068"><a href="#cb10-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1069"><a href="#cb10-1069" aria-hidden="true" tabindex="-1"></a>                Backwards Step<span class="sc">-</span>down <span class="sc">-</span> Original Model</span>
<span id="cb10-1070"><a href="#cb10-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1071"><a href="#cb10-1071" aria-hidden="true" tabindex="-1"></a> Deleted        Chi<span class="sc">-</span>Sq d.f. P      Residual d.f. P      AIC  </span>
<span id="cb10-1072"><a href="#cb10-1072" aria-hidden="true" tabindex="-1"></a> blood.pressure <span class="fl">0.16</span>   <span class="dv">1</span>    <span class="fl">0.6901</span> <span class="fl">0.16</span>     <span class="dv">1</span>    <span class="fl">0.6901</span> <span class="sc">-</span><span class="fl">1.84</span></span>
<span id="cb10-1073"><a href="#cb10-1073" aria-hidden="true" tabindex="-1"></a> cholesterol    <span class="fl">7.35</span>   <span class="dv">4</span>    <span class="fl">0.1184</span> <span class="fl">7.51</span>     <span class="dv">5</span>    <span class="fl">0.1853</span> <span class="sc">-</span><span class="fl">2.49</span></span>
<span id="cb10-1074"><a href="#cb10-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1075"><a href="#cb10-1075" aria-hidden="true" tabindex="-1"></a>Approximate Estimates after Deleting Factors</span>
<span id="cb10-1076"><a href="#cb10-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1077"><a href="#cb10-1077" aria-hidden="true" tabindex="-1"></a>                                Coef      S.E.    Wald Z        P</span>
<span id="cb10-1078"><a href="#cb10-1078" aria-hidden="true" tabindex="-1"></a>Intercept                 <span class="sc">-</span><span class="fl">3.9763208</span> <span class="fl">1.1849888</span> <span class="sc">-</span><span class="fl">3.355577</span> <span class="fl">0.000792</span></span>
<span id="cb10-1079"><a href="#cb10-1079" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male                  <span class="sc">-</span><span class="fl">4.9024437</span> <span class="fl">2.6546474</span> <span class="sc">-</span><span class="fl">1.846740</span> <span class="fl">0.064785</span></span>
<span id="cb10-1080"><a href="#cb10-1080" aria-hidden="true" tabindex="-1"></a>age                        <span class="fl">0.1246156</span> <span class="fl">0.0473845</span>  <span class="fl">2.629884</span> <span class="fl">0.008541</span></span>
<span id="cb10-1081"><a href="#cb10-1081" aria-hidden="true" tabindex="-1"></a>age<span class="sc">^</span><span class="dv">2</span>                     <span class="sc">-</span><span class="fl">0.0008688</span> <span class="fl">0.0004677</span> <span class="sc">-</span><span class="fl">1.857457</span> <span class="fl">0.063246</span></span>
<span id="cb10-1082"><a href="#cb10-1082" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male <span class="sc">*</span> cholesterol     <span class="fl">0.0286721</span> <span class="fl">0.0160278</span>  <span class="fl">1.788897</span> <span class="fl">0.073631</span></span>
<span id="cb10-1083"><a href="#cb10-1083" aria-hidden="true" tabindex="-1"></a>sex<span class="ot">=</span>male <span class="sc">*</span> cholesterol<span class="st">'   -0.0252835 0.0827977 -0.305365 0.760088</span></span>
<span id="cb10-1084"><a href="#cb10-1084" aria-hidden="true" tabindex="-1"></a><span class="st">sex=male * cholesterol''   0.0634986 0.4907718  0.129385 0.897053</span></span>
<span id="cb10-1085"><a href="#cb10-1085" aria-hidden="true" tabindex="-1"></a><span class="st">sex=male * cholesterol'''</span> <span class="sc">-</span><span class="fl">0.0071007</span> <span class="fl">0.8750440</span> <span class="sc">-</span><span class="fl">0.008115</span> <span class="fl">0.993526</span></span>
<span id="cb10-1086"><a href="#cb10-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1087"><a href="#cb10-1087" aria-hidden="true" tabindex="-1"></a>Factors <span class="cf">in</span> Final Model</span>
<span id="cb10-1088"><a href="#cb10-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1089"><a href="#cb10-1089" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>] sex               age               sex <span class="sc">*</span> cholesterol</span>
<span id="cb10-1090"><a href="#cb10-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1091"><a href="#cb10-1091" aria-hidden="true" tabindex="-1"></a>          index.orig training   test optimism index.corrected   n</span>
<span id="cb10-1092"><a href="#cb10-1092" aria-hidden="true" tabindex="-1"></a>Dxy           <span class="fl">0.3082</span>   <span class="fl">0.3301</span> <span class="fl">0.2986</span>   <span class="fl">0.0316</span>          <span class="fl">0.2766</span> <span class="dv">150</span></span>
<span id="cb10-1093"><a href="#cb10-1093" aria-hidden="true" tabindex="-1"></a>R2            <span class="fl">0.0995</span>   <span class="fl">0.1184</span> <span class="fl">0.0946</span>   <span class="fl">0.0238</span>          <span class="fl">0.0757</span> <span class="dv">150</span></span>
<span id="cb10-1094"><a href="#cb10-1094" aria-hidden="true" tabindex="-1"></a>Intercept     <span class="fl">0.0000</span>   <span class="fl">0.0000</span> <span class="fl">0.0263</span>  <span class="sc">-</span><span class="fl">0.0263</span>          <span class="fl">0.0263</span> <span class="dv">150</span></span>
<span id="cb10-1095"><a href="#cb10-1095" aria-hidden="true" tabindex="-1"></a>Slope         <span class="fl">1.0000</span>   <span class="fl">1.0000</span> <span class="fl">0.8879</span>   <span class="fl">0.1121</span>          <span class="fl">0.8879</span> <span class="dv">150</span></span>
<span id="cb10-1096"><a href="#cb10-1096" aria-hidden="true" tabindex="-1"></a>Emax          <span class="fl">0.0000</span>   <span class="fl">0.0000</span> <span class="fl">0.0308</span>   <span class="fl">0.0308</span>          <span class="fl">0.0308</span> <span class="dv">150</span></span>
<span id="cb10-1097"><a href="#cb10-1097" aria-hidden="true" tabindex="-1"></a>D             <span class="fl">0.0762</span>   <span class="fl">0.0917</span> <span class="fl">0.0722</span>   <span class="fl">0.0195</span>          <span class="fl">0.0567</span> <span class="dv">150</span></span>
<span id="cb10-1098"><a href="#cb10-1098" aria-hidden="true" tabindex="-1"></a>U            <span class="sc">-</span><span class="fl">0.0020</span>  <span class="sc">-</span><span class="fl">0.0020</span> <span class="fl">0.0016</span>  <span class="sc">-</span><span class="fl">0.0036</span>          <span class="fl">0.0016</span> <span class="dv">150</span></span>
<span id="cb10-1099"><a href="#cb10-1099" aria-hidden="true" tabindex="-1"></a>Q             <span class="fl">0.0782</span>   <span class="fl">0.0937</span> <span class="fl">0.0706</span>   <span class="fl">0.0231</span>          <span class="fl">0.0551</span> <span class="dv">150</span></span>
<span id="cb10-1100"><a href="#cb10-1100" aria-hidden="true" tabindex="-1"></a>B             <span class="fl">0.2279</span>   <span class="fl">0.2244</span> <span class="fl">0.2295</span>  <span class="sc">-</span><span class="fl">0.0051</span>          <span class="fl">0.2330</span> <span class="dv">150</span></span>
<span id="cb10-1101"><a href="#cb10-1101" aria-hidden="true" tabindex="-1"></a>g             <span class="fl">0.6650</span>   <span class="fl">0.7374</span> <span class="fl">0.6452</span>   <span class="fl">0.0922</span>          <span class="fl">0.5729</span> <span class="dv">150</span></span>
<span id="cb10-1102"><a href="#cb10-1102" aria-hidden="true" tabindex="-1"></a>gp            <span class="fl">0.1512</span>   <span class="fl">0.1651</span> <span class="fl">0.1477</span>   <span class="fl">0.0173</span>          <span class="fl">0.1339</span> <span class="dv">150</span></span>
<span id="cb10-1103"><a href="#cb10-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1104"><a href="#cb10-1104" aria-hidden="true" tabindex="-1"></a>Factors Retained <span class="cf">in</span> Backwards Elimination</span>
<span id="cb10-1105"><a href="#cb10-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1106"><a href="#cb10-1106" aria-hidden="true" tabindex="-1"></a> sex cholesterol age blood.pressure sex <span class="sc">*</span> cholesterol</span>
<span id="cb10-1107"><a href="#cb10-1107" aria-hidden="true" tabindex="-1"></a> <span class="sc">*</span>               <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb10-1108"><a href="#cb10-1108" aria-hidden="true" tabindex="-1"></a> <span class="er">*</span>   <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb10-1109"><a href="#cb10-1109" aria-hidden="true" tabindex="-1"></a> <span class="er">*</span>               <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb10-1110"><a href="#cb10-1110" aria-hidden="true" tabindex="-1"></a>     <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb10-1111"><a href="#cb10-1111" aria-hidden="true" tabindex="-1"></a> <span class="er">*</span>   <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb10-1112"><a href="#cb10-1112" aria-hidden="true" tabindex="-1"></a> <span class="er">*</span>   <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb10-1113"><a href="#cb10-1113" aria-hidden="true" tabindex="-1"></a>     <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb10-1114"><a href="#cb10-1114" aria-hidden="true" tabindex="-1"></a>     <span class="er">*</span>           <span class="er">*</span>                  <span class="er">*</span>                </span>
<span id="cb10-1115"><a href="#cb10-1115" aria-hidden="true" tabindex="-1"></a>(output omitted; continues <span class="cf">for</span> each bootstrap sample)</span>
<span id="cb10-1116"><a href="#cb10-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1117"><a href="#cb10-1117" aria-hidden="true" tabindex="-1"></a>Frequencies of Numbers of Factors Retained</span>
<span id="cb10-1118"><a href="#cb10-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-1119"><a href="#cb10-1119" aria-hidden="true" tabindex="-1"></a> <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span> </span>
<span id="cb10-1120"><a href="#cb10-1120" aria-hidden="true" tabindex="-1"></a><span class="dv">18</span> <span class="dv">74</span> <span class="dv">55</span>  <span class="dv">3</span> </span>
<span id="cb10-1121"><a href="#cb10-1121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2024-2025, James C Slaughter</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/chrissl789/modern-regression/edit/main/notes/Lec13.Prediction.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/chrissl789/modern-regression/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>This page is built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>